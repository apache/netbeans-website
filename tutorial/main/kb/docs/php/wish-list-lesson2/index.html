<!doctype html>
<html class="no-js" lang="en" dir="ltr">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Lesson 2: Designing the Application. Reading from the Database</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Lesson 2: Designing the Application. Reading from the Database - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Creating a Database Driven Application With PHP">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="../../../../../../_/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
    <link rel="stylesheet" href="../../../../../../_/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../../../_/images/fav/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../../../_/images/fav/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../../../_/images/fav/favicon-16x16.png">
    <link rel="manifest" href="../../../../../../_/images/fav/site.webmanifest">
    <link rel="mask-icon" href="../../../../../../_/images/fav/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="../../../../../../_/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="../../../../../../index.html"><img src='../../../../../../_/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <input id="search-input" type="text" placeholder="Search the docs"> </li>
            <li> <a href="../../../../../../front/main/community">Community</a> </li>
            <li> <a href="../../../../../../front/main/participate">Participate</a> </li>
            <li> <a href="../../../../../../front/main/blogs">Blog</a></li>
            <li> <a href="../../../../../../front/main/help">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="../../../../../../front/main/download">Download</a> </li>
        </ul>
    </div>
</div>

    <!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 19</h1>
            <p><a class="button success" href="../../../../../../front/main/download/nb19">Download</a></p>
        </div>
    </div>
</section>
    <div class='grid-container main-content tutorial'>
      <article class="doc">
      <h1 class="sect0">Lesson 2: Designing the Application. Reading from the Database</h1>
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-antora-tutorials/edit/main/modules/ROOT/pages/kb/docs/php/wish-list-lesson2.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="../../../../../../tutorial/main/kb/docs/contributing">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_creating_a_php_project">Creating a PHP Project</a></li>
<li><a href="#_defining_a_page_flow_diagram">Defining a Page Flow Diagram</a></li>
<li><a href="#_adding_a_form_to_index_php">Adding a Form To index.php</a></li>
<li><a href="#_creating_wishlist_php_and_testing_the_application">Creating wishlist.php and Testing the Application</a></li>
<li><a href="#_establishing_the_connection_and_getting_the_wisher_id">Establishing the Connection and Getting the Wisher ID</a></li>
<li><a href="#_displaying_a_table_of_wishes">Displaying a Table of Wishes</a></li>
<li><a href="#_application_source_code_after_the_current_lesson_is_completed">Application Source Code after the Current Lesson Is Completed</a></li>
<li><a href="#_next_step">Next Step</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this lesson you create and configure the PHP project to develop your application, create a list of pages in the application, and define the relations between them. You also develop basic application functionality and test it against the data you entered in the sample database in lesson 1.</p>
</div>
<div class="paragraph">
<p>The PHP code you write in this lesson performs the following functions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Gets the name of a person that the user types in.</p>
</li>
<li>
<p>Checks whether that person is really in the database. Exits with an error message if the person is not in the database.</p>
</li>
<li>
<p>Displays a table of that person&#8217;s wishes.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The current document is a part of the Creating a Database-Driven Application in the NetBeans IDE for PHP tutorial.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_php_project"><a class="anchor" href="#_creating_a_php_project"></a>Creating a PHP Project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Select File &gt; New Project (Ctrl-Shift-N on Windows and Linux, ⌘-Shift-N on MacOS). Create a new PHP project named "wishlist". When you create a PHP project, it contains the index file  <code>index.php</code>  by default. For information on creating and configuring a PHP project, see <a href="../project-setup/" class="xref page">Setting Up a PHP Project</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_defining_a_page_flow_diagram"><a class="anchor" href="#_defining_a_page_flow_diagram"></a>Defining a Page Flow Diagram</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The scope of your application covers the following use cases:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user views the wish list of a person.</p>
</li>
<li>
<p>The user registers as a new wisher.</p>
</li>
<li>
<p>The user logs in and creates her/his wish list.</p>
</li>
<li>
<p>The user logs in and edits his/her wish list.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To cover this basic functionality, you will need to implement the following PHP files:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The "front" page index.php for logging in, registering, and switching to wish lists of other users.</p>
</li>
<li>
<p>The wishlist.php page for viewing the wish list of a particular wisher.</p>
</li>
<li>
<p>The createNewWisher.php page for registering as a wisher.</p>
</li>
<li>
<p>The editWishList.php page for editing a wish list by its owner.</p>
</li>
<li>
<p>The editWish.php page for creating and editing wishes.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/page-flow-diagram.png" alt="page flow diagram">
</div>
</div>
<div class="paragraph">
<p>Now that you have finished the preliminary steps, you can start implementing the basic functionality of your application. Start with viewing the wish list of a wisher. This feature does not involve any validations and can be easily tested as you have already entered the test data into the database. The feature&#8217;s functionality will be implemented on two pages, index.php and wishlist.php.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adding_a_form_to_index_php"><a class="anchor" href="#_adding_a_form_to_index_php"></a>Adding a Form To index.php</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The index.php file will not contain any PHP code so you can easily remove the following block:</p>
</div>
<div class="paragraph">
<p>The  <code>index.php</code>  file is used for two purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Displaying a page with controls for entering data.</p>
</li>
<li>
<p>Transferring the entered data to another PHP file, where the data is processed. In this tutorial, the data is passed to a file named  <code>wishlist.php</code> , which you create and code in the next section.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These actions are performed using an HTML form. Each HTML form contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A set of fields that correspond to the controls on the page.</p>
</li>
<li>
<p>The "action" that is performed after the user submits the data on the form. The action is represented by the path to the page that processes the data.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>To add a form to index.php:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Switch to the Projects window, expand your project node and the Source Files node, and double click the  <code>index.php</code>  file. The  <code>index.php</code>  file opens in the main IDE editor area. The file contains a template for entering HTML and PHP code.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can ignore warnings from the HTML validator.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Remove the PHP block. The index.php file will not contain any PHP code.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/remove-php-block.png" alt="remove php block">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the Palette from the Window menu or by pressing Ctrl-Shift-8.</p>
</li>
<li>
<p>From the Palette&#8217;s* HTML Forms* section, drag and drop a Form into the &lt;body&gt; section of  <code>index.php</code> .</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/form-dnd.png" alt="form dnd">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The Insert Form dialog opens. In the Action field, type the path to the file to which the form will transfer data. In this case, type in  <code>wishlist.php</code> . (You will create this file in the same location as  <code>index.php</code> . See <a href="#createNewFile">Creating wishlist.php and Testing the Application</a>.) Select the GET method for transferring data. Give the form an arbitrary name, such as  <code>wishList</code> . Click OK when you are done.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/insert-form-dialog.png" alt="insert form dialog">
</div>
</div>
<div class="paragraph">
<p>The file now looks like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/blank-form.png" alt="blank form">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Between the opening and closing tags of the form, type the text "Show wish list of: ".</p>
</li>
<li>
<p>Drag a Text Input component from the <strong>HTML Forms</strong> section of the Palette to the space after the text "Show wish list of: ". The Insert Text Input dialog opens.</p>
</li>
<li>
<p>Name the input  <code>user</code> . Select input type  <code>text</code> . Leave all other fields empty and click OK.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/insert-text-input.png" alt="insert text input">
</div>
</div>
<div class="paragraph">
<p>The file now looks like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/form-with-text-input.png" alt="form with text input">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add a blank line above the &lt;/form&gt; tag. Into this blank line, drag and drop a Button component from the* HTML Forms* section of the Palette.</p>
</li>
<li>
<p>The Insert Button dialog opens. Type  <code>Go</code>  into the Label field and click OK.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/insert-button-dialog.png" alt="insert button dialog">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The form now looks like the code below, with one difference. In the code below, the  <code>method</code>  attribute is explicit in the <code>&lt;form&gt;</code> tag. NetBeans IDE did not add a method attribute to your form because GET is the default value of this attribute. However, you might understand the code more easily if the  <code>method</code>  attribute is explicit.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;form action="wishlist.php" method="GET" name="wishList"&gt;
    Show wish list of:
    &lt;input type="text" name="user" value=""/&gt;
    &lt;input type="submit" value="Go" /&gt;
&lt;/form&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note the following elements of the form:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The opening &lt;form&gt; tag contains the  <code>action</code>  attribute. The action attribute specifies the file to which the form transfers data. In this case, the file is named  <code>wishlist.php</code>  and it is in the same folder as  <code>index.php</code> . (You will create this file in the section <a href="#createNewFile">Creating wishlist.php and Testing the Application</a>.)</p>
</li>
<li>
<p>The opening &lt;form&gt; tag also contains the method to be applied to transferring data (GET). PHP uses a  <code>$_GET</code>  or  <code>$_POST</code>  array for the values passed by this form depending on the value of the  <code>method</code>  attribute. In this case, PHP uses  <code>$_GET</code> .</p>
</li>
<li>
<p>A  <code>text</code>  input component. This component is a text field for entering the name of the user whose wish list one wants to view. The starting value of the text field is an empty string. The name of this field is  <code>user</code> . PHP uses the name of the field when creating an array for the values of the field. In this case, the array for the values of this field is  <code>htmlentities($_GET["user"])</code> .</p>
</li>
<li>
<p>A  <code>submit</code>  input component with the value "Go". The "submit" type means that the input field appears on the page as a button. The value "Go" is the label of the button. When the user clicks the button, the data in the  <code>text</code>  component is transferred to the file specified in the  <code>action</code>  attribute.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_wishlist_php_and_testing_the_application"><a class="anchor" href="#_creating_wishlist_php_and_testing_the_application"></a>Creating wishlist.php and Testing the Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In <a href="#transferDataFromIndexToWishlist">Adding a Form To index.php</a> you created a form in which the user submits the name of someone whose wish list the user wants to see. The name is passed to the page  <code>wishlist.php</code> . However, this page does not exist. If you run  <code>index.php</code> , you will get a 404: File Not Found error when you submit a name. In this section, you create  <code>wishlist.php</code>  then test the application.</p>
</div>
<div class="paragraph">
<p><strong>To create wishlist.php and test the application:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Inside the "wishlist" project you created, click the right mouse button on the Source files node and from the context menu choose New &gt; PHP Web Page. The New PHP Web Page wizard opens.</p>
</li>
<li>
<p>Type  <code>wishlist</code>  in the File Name field and press Finish.</p>
</li>
<li>
<p>Click the right mouse button on the Sources node and choose Run Project from the context menu or click the Run Main Project icon <span class="image"><img src="../../../../_images/kb/docs/php/run-main-project-button.png" alt="run main project button"></span>on the toolbar if you have set your project as Main.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/index-php-works.png" alt="index php works">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the Show wish list of: edit box, enter Tom and click Go. An empty page with the following URL appears: <a href="http://localhost:90/Lesson2/wishlist.php?user=tom" class="bare">http://localhost:90/Lesson2/wishlist.php?user=tom</a>. This URL indicates that your main page works properly.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_establishing_the_connection_and_getting_the_wisher_id"><a class="anchor" href="#_establishing_the_connection_and_getting_the_wisher_id"></a>Establishing the Connection and Getting the Wisher ID</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, you first add code to  <code>wishlist.php</code>  that creates a connection to the database. You then add code to retrieve the ID number of the wisher whose name was typed into the  <code>index.php</code>  form.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Double click the wishlist.php file. The template that opens is different from index.php. Begin and end the file with &lt;html&gt;&lt;/html&gt; and &lt;body&gt;&lt;/body&gt; tags as the file will contain HTML code too.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
        &lt;title&gt;&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;?php
            // put your code here
        ?&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To display the title, enter the following code block immediately after the opening &lt;body&gt; tag, before the generated &lt;?php tag:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html"> Wish List of &lt;?php echo htmlentities($_GET["user"])."&lt;br/&gt;";?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code now looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;body&gt;
    Wish List of &lt;?php echo htmlentities($_GET["user"])."&lt;br/&gt;"; ?&gt;
    &lt;?php
        // put your code here
    ?&gt;
&lt;/body&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The PHP code block displays the data that is received through the method GET in the field "user". This data is transferred from  <code>index.php</code>  where the name of the wish list owner Tom was entered in the text field "user". Repeat the steps from <a href="#createNewFile">Testing index.php</a> to see that wishlist.php works properly.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/wishlist-php-title-works.png" alt="wishlist php title works">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Delete the commented section in the template PHP block. In its place, type or paste in the following code. This code opens the connection to the database.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>For the MySQL database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">$con = mysqli_connect("localhost", "phpuser", "phpuserpw");
if (!$con) {
    exit('Connect Error (' . mysqli_connect_errno() . ') '. mysqli_connect_error());
}
//set the default client character
set mysqli_set_charset($con, 'utf-8');</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>For the Oracle database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">$con = oci_connect("phpuser", "phpuserpw", "localhost/XE", "AL32UTF8");
if (!$con) {
    $m = oci_error();
    exit('Connect Error ' . $m['message']);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code attempts to open a connection to the database and gives an error message if there is a failure.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You may need to alter the database connection in the  <code>oci_connect</code>  command. The standard syntax is "hostname/service name". The connection to an Oracle XE database in this snippet is "localhost/XE" to follow that syntax.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can use NetBeans IDE&#8217;s code completion for either mysqli or OCI8 functions.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/codecompletion.png" alt="codecompletion">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/codecompletion-oci.png" alt="codecompletion oci">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Beneath the code to open the connection to the database, in the same PHP block, type or paste the following code. This code retrieves the ID of the wisher whose wish list was requested. If the wisher is not in the database, the code kills/exits the process and displays an error message.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>For the MySQL database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">mysqli_select_db($con, "wishlist");
$user = mysqli_real_escape_string($con, htmlentities($_GET["user"]));
$wisher = mysqli_query($con, "SELECT id FROM wishers WHERE name='" . $user . "'");
if (mysqli_num_rows($wisher) &lt; 1) {
    exit("The person " . htmlentities($_GET["user"]) . " is not found. Please check the spelling and try again");
}
$row = mysqli_fetch_row($wisher);
$wisherID = $row[0];
mysqli_free_result($wisher);</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>For the Oracle database:</strong> (Note that oci8 does not have an equivalent to  <code>mysqli_num_rows</code> )</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">$query = "SELECT id FROM wishers WHERE NAME = :user_bv";
$stid = oci_parse($con, $query);
$user = $_GET['user'];

oci_bind_by_name($stid, ':user_bv', $user);
oci_execute($stid);

//Because user is a unique value I only expect one row
$row = oci_fetch_array($stid, OCI_ASSOC);
if (!$row) {
    exit("The person " . $user . " is not found. Please check the spelling and try again" );
}
$wisherID = $row['ID'];
oci_free_statement($stid);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The data is selected from the  <code>wishlist</code>  database through the $con connection. The selection criterion is the name received from the index.php as "user".</p>
</div>
<div class="paragraph">
<p>The syntax of a  <code>SELECT</code>  SQL statement can be briefly described as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>After SELECT, specify the fields from which you want to get data. An asterisk (*) stands for all fields.</p>
</li>
<li>
<p>After FROM clause, specify the name of the table from which the data must be retrieved.</p>
</li>
<li>
<p>The WHERE clause is optional. Specify the filter conditions in it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The mysqli query returns a result object. OCI8 returns an executed statement. In either case, you fetch a row from the result of the executed query and extract the value of the ID row, storing it in the variable  <code>$wisherID</code> .</p>
</div>
<div class="paragraph">
<p>Lastly, you free the mysqli result or OCI8 statement. You need to free all resources that use a connection before the connection will physically be closed. Otherwise PHP&#8217;s internal refcounting system will keep the underlying DB connection open even if  <code>$con</code>  is not usable following a  <code>mysqli_close()</code>  or  <code>oci_close()</code>  call.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Security Note: For MySQL, the  <code>htmlentities($_GET["user"])</code>  parameter is escaped in order to prevent SQL injection attacks. See <a href="https://en.wikipedia.org/wiki/SQL_injection">Wikipedia on SQL injections</a> and the <a href="http://us3.php.net/mysql_real_escape_string">mysql_real_escape_string documentation</a>. Although in the context of this tutorial you are not at risk of harmful SQL injections, it is best practice to escape strings in MySQL queries that would be at risk of such an attack. OCI8 avoids this through bind variables.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This PHP block is now complete. If you are using a MySQL database, the  <code>wishlist.php</code>  file now looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">Wish List of &lt;?php echo htmlentities($_GET["user"]) . "&lt;br/&gt;"; ?&gt;&lt;?php$con = mysqli_connect("localhost", "phpuser", "phpuserpw");
  if (!$con) {
     exit('Connect Error (' . mysqli_connect_errno() . ') ' . mysqli_connect_error());
  }//set the default client character set
  mysqli_set_charset($con, 'utf-8');
  mysqli_select_db($con, "wishlist");
  $user = mysqli_real_escape_string($con, htmlentities($_GET["user"]));
  $wisher = mysqli_query($con, "SELECT id FROM wishers WHERE name='" . $user . "'");
  if (mysqli_num_rows($wisher) &lt; 1) {
     exit("The person " . htmlentities($_GET["user"]) . " is not found. Please check the spelling and try again");
  }
  $row = mysqli_fetch_row($wisher);
  $wisherID = $row[0];
  mysqli_free_result($wisher);
  ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are using an Oracle database, the  <code>wishlist.php</code>  file now looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">Wish List of &lt;?php echo htmlentities($_GET["user"]) . "&lt;br/&gt;"; ?&gt;
  &lt;?php
  $con = oci_connect("phpuser", "phpuserpw", "localhost/XE", "AL32UTF8");
  if (!$con) {
     $m = oci_error();
     exit('Connect Error ' . $m['message'];
     exit;
  }
  $query = "SELECT id FROM wishers WHERE name = :user_bv";
  $stid = oci_parse($con, $query);
  $user = htmlentities($_GET["user"]);
  oci_bind_by_name($stid, ':user_bv', $user);
  oci_execute($stid);//Because user is a unique value I only expect one row
  $row = oci_fetch_array($stid, OCI_ASSOC);
  if (!$row) {
     exit("The person " . $user . " is not found. Please check the spelling and try again" );
  }
  $wisherID = $row["ID"];
  oci_free_statement($stid);
  ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you test the application and enter an invalid user, the following message appears.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/wishlist-php-title-user-not-found-works.png" alt="wishlist php title user not found works">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_displaying_a_table_of_wishes"><a class="anchor" href="#_displaying_a_table_of_wishes"></a>Displaying a Table of Wishes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, you add code that displays an HTML table of the wishes associated with the wisher. The wisher is identified by the ID you retrieved in the code in the previous section.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Beneath the PHP block, type or paste the following HTML code block. This code opens a table, specifies the color of its borders (black), and "draws" the table header with the columns "Item" and "Due Date."</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;table border="black"&gt;
    &lt;tr&gt;
        &lt;th&gt;Item&lt;/th&gt;
        &lt;th&gt;Due Date&lt;/th&gt;
    &lt;/tr&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The &lt;/table&gt; tag closes the table.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enter the following PHP code block above the closing &lt;/table&gt; tag.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>For the MySQL database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php
    $result = mysqli_query($con, "SELECT description, due_date FROM wishes WHERE wisher_id=" . $wisherID);
    while ($row = mysqli_fetch_array($result)) {
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["description"]) . "&lt;/td&gt;";
        echo "&lt;td&gt;" . htmlentities($row["due_date"]) . "&lt;/td&gt;&lt;/tr&gt;\n";
    }
    mysqli_free_result($result);mysqli_close($con);
?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>For the Oracle database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-php hljs" data-lang="php">&lt;?php
    $query = "SELECT description, due_date FROM wishes WHERE wisher_id = :id_bv";
    $stid = oci_parse($con, $query);
    oci_bind_by_name($stid, ":id_bv", $wisherID);
    oci_execute($stid);
	while ($row = oci_fetch_array($stid)) {
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["DESCRIPTION"]) . "&lt;/td&gt;";
	    echo "&lt;td&gt;" . htmlentities($row["DUE_DATE"]) . "&lt;/td&gt;&lt;/tr&gt;\n";
	}
    oci_free_statement($stid);
	oci_close($con);
?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Within the code:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The SELECT query retrieves the wishes with their due dates for the specified wisher by his ID, which was retrieved in step 4, and stores the wishes and due dates in an array $result.</p>
</li>
<li>
<p>A loop displays the items of the $result array as rows in the table while the array is not empty.</p>
</li>
<li>
<p>The <code>&lt;tr&gt;&lt;/tr&gt;</code> tags form rows, the <code>&lt;td&gt;&lt;/td&gt;</code> tags form cells within rows, and <code>\n</code> starts a new line.</p>
</li>
<li>
<p>The  <code>htmlentities</code>  function converts all characters that have HTML entity equivalents into HTML entities. This helps to prevent <a href="https://en.wikipedia.org/wiki/Cross-site_scripting">cross-site scripting</a>.</p>
</li>
<li>
<p>Functions at the end free all resources (mysqli results and OCI8 statements) and close the database connection. Note you need to free all resources that use a connection before the connection can physically be closed. Otherwise PHP&#8217;s internal refcounting system keeps the underlying DB connection open even if the connection is not usable following an  <code>oci_close()</code>  or  <code>mysqli_close()</code>  call.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Make sure you type the names of database fields exactly as they are specified during the database table creation. For Oracle, column names are returned as uppercase by default.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To test the application, run the project as described in the section <a href="#createNewFile">Testing index.php</a>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/php/wishlist-php-works.png" alt="wishlist php works">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_application_source_code_after_the_current_lesson_is_completed"><a class="anchor" href="#_application_source_code_after_the_current_lesson_is_completed"></a>Application Source Code after the Current Lesson Is Completed</h2>
<div class="sectionbody">
<div class="paragraph">
<p>MySQL users: Click <a href="https://netbeans.org/files/documents/4/1928/lesson2.zip">+ here+</a> to download the source code that reflects the project state after the lesson is completed.</p>
</div>
<div class="paragraph">
<p>Oracle Database users: Click <a href="https://netbeans.org/projects/www/downloads/download/php%252Foracle-lesson2.zip">here</a> to download the source code that reflects the project state after the lesson is completed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_step"><a class="anchor" href="#_next_step"></a>Next Step</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="../wish-list-lesson1/" class="xref page">&lt;&lt; Previous lesson</a></p>
</div>
<div class="paragraph">
<p><a href="../wish-list-lesson3/" class="xref page">Next lesson &gt;&gt;</a></p>
</div>
<div class="paragraph">
<p><a href="../wish-list-tutorial-main-page/" class="xref page">Back to the Tutorial Main page</a></p>
</div>
</div>
</div>
      <section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        <li><a href="https://github.com/apache/netbeans-antora-tutorials/edit/main/modules/ROOT/pages/kb/docs/php/wish-list-lesson2.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>
      </article>
    </div>
        <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="../../../../../../_/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
            <h1><a href="../../../../../../front/main/about">About</a></h1>
            <ul>
              <li><a href="../../../../../../front/main/community/who">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../../../front/main/community">Community</a></h1>
            <ul>
              <li><a href="../../../../../../front/main/community/mailing-lists">Mailing lists</a></li>
              <li><a href="../../../../../../front/main/community/committer">Becoming a committer</a></li>
              <li><a href="../../../../../../front/main/community/events">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../../../front/main/participate">Participate</a></h1>
            <ul>
              <li><a href="../../../../../../front/main/participate/submit-pr">Submitting Pull Requests</a></li>
              <li><a href="../../../../../../front/main/participate/report-issue">Reporting Issues</a></li>
              <li><a href="../../../../../../front/main/participate/#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../../../front/main/help">Get Help</a></h1>
            <ul>
              <li><a href="../../../../../../front/main/help/#documentation">Documentation</a></li>
              <li><a href="../../../../../../wiki/main/wiki">Wiki</a></li>
              <li><a href="../../../../../../front/main/help/#support">Community Support</a></li>
              <li><a href="../../../../../../front/main/help/commercial-support">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../../../front/main/download">Download</a></h1>
            <ul>
              <li><a href="../../../../../../front/main/download">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="../../../../../../front/main/download/#_daily_builds_and_building_from_source">Building from source</a></li>
              <li><a href="../../../../../../front/main/download/#_older_releases">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
      </div>
    </div>

    
<script src="../../../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../../../.." data-snippet-length="100" data-stylesheet="../../../../../../_/css/search.css"></script>
<script async src="../../../../../../search-index.js"></script>
    <script src="../../../../../../_/js/vendor/jquery-3.7.1.min.js"></script>
    <script src="../../../../../../_/js/vendor/what-input.js"></script>
    <script src="../../../../../../_/js/vendor/foundation.min.js"></script>
    <script src="../../../../../../_/js/vendor/jquery.colorbox-min.js"></script>
    <script src="../../../../../../_/js/netbeans.js"></script>
    <script>
       $(function(){ $(document).foundation(); });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
      $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); });
    </script>
  </body>
</html>
