<!doctype html>
<html class="no-js" lang="en" dir="ltr">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>End-to-End Binary SOAP Attachment part 3: Coding and Testing the Web Service</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="End-to-End Binary SOAP Attachment part 3: Coding and Testing the Web Service - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, End-to-End Binary SOAP Attachment part 3: Coding and Testing the Web Service">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="../../../../../../_/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
    <link rel="stylesheet" href="../../../../../../_/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../../../_/images/fav/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../../../_/images/fav/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../../../_/images/fav/favicon-16x16.png">
    <link rel="manifest" href="../../../../../../_/images/fav/site.webmanifest">
    <link rel="mask-icon" href="../../../../../../_/images/fav/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="../../../../../../_/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="../../../../../../index.html"><img src='../../../../../../_/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <input id="search-input" type="text" placeholder="Search the docs"> </li>
            <li> <a href="../../../../../../front/main/community">Community</a> </li>
            <li> <a href="../../../../../../front/main/participate">Participate</a> </li>
            <li> <a href="../../../../../../front/main/blogs">Blog</a></li>
            <li> <a href="../../../../../../front/main/help">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="../../../../../../front/main/download">Download</a> </li>
        </ul>
    </div>
</div>

    <!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 21</h1>
            <p><a class="button success" href="../../../../../../front/main/download/nb21">Download</a></p>
        </div>
    </div>
</section>
    <div class='grid-container main-content tutorial'>
      <article class="doc">
      <h1 class="sect0">End-to-End Binary SOAP Attachment part 3: Coding and Testing the Web Service</h1>
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-antora-tutorials/edit/main/modules/ROOT/pages/kb/docs/websvc/flower-code-ws.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="../../../../../../tutorial/main/kb/docs/contributing">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#coding-ws">Coding the Web Service</a>
<ul class="sectlevel2">
<li><a href="#retrieve-jpeg-as-bytes">Get a JPEG File as an Array of Bytes</a></li>
<li><a href="#read-bytes-as-image">Read an Array of Bytes as an Image</a></li>
<li><a href="#implement-getflower">Implement getFlower</a></li>
<li><a href="#create-byte-array-list">Create a List of Byte Arrays for All JPEG Files</a></li>
<li><a href="#implement-getthumbnails">Implement getThumbnails</a></li>
</ul>
</li>
<li><a href="#test-ws">Testing the Web Service</a></li>
<li><a href="#_next_step">Next step:</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this lesson you add code to the web service/session bean class to convert JPEG files to byte arrays and byte arrays to  <code>java.awt.Image</code>  objects. You also add code to the public web service operations so they return these  <code>Image</code>  objects. Lastly, you test the web service in a browser, using the NetBeans IDE&#8217;s Test Web Service utility.</p>
</div>
<div class="paragraph">
<p>You can download a complete sample of the web service from the <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FWeb%2520Services%252FWeb%2520Service%2520Passing%2520Binary%2520Data%2520--%2520EE6%252FFlowerAlbumService.zip">NetBeans Samples Catalog</a>.</p>
</div>
<div class="paragraph">
<p><strong>Lessons In This Tutorial</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/websvc/netbeans-stamp-80-74-73.png" alt="netbeans stamp 80 74 73">
</div>
<div class="title">Figure 1. Content on this page applies to the NetBeans IDE 7.2, 7.3, 7.4 and 8.0</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="../flower_overview/" class="xref page">Overview</a></p>
</li>
<li>
<p><a href="../flower_ws/" class="xref page">+ Creating the Web Service+</a></p>
</li>
<li>
<p>&#8658; Coding and Testing the Web Service</p>
</li>
<li>
<p><a href="../flower_wsdl_schema/" class="xref page">+ Modifying the Schema and WSDL Files to Pass Binary Data+</a></p>
</li>
<li>
<p><a href="../flower_swing/" class="xref page">+ Creating the Swing Client+</a></p>
</li>
<li>
<p><a href="#coding-ws">Coding the Web Service</a></p>
</li>
<li>
<p><a href="#retrieve-jpeg-as-bytes">Get a JPEG File as an Array of Bytes</a></p>
</li>
<li>
<p><a href="#read-bytes-as-image">Read an Array of Bytes as an Image</a></p>
</li>
<li>
<p><a href="#implement-getflower">Implement getFlower</a></p>
</li>
<li>
<p><a href="#create-byte-array-list">Create a List of Byte Arrays for All JPEG Files</a></p>
</li>
<li>
<p><a href="#implement-getthumbnails">Implement getThumbnails</a></p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p><a href="#test-ws">Testing the Web Service</a></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="coding-ws"><a class="anchor" href="#coding-ws"></a>Coding the Web Service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You now have a web application containing a set of JPEG files and a web service. The web service is implemented as a stateless session bean. The web service contains two empty web operations. In this lesson you add code to the web service to convert JPEG files to byte arrays and byte arrays to  <code>java.awt.Image</code>  objects. You also add code to the public web service operations so they return these  <code>Image</code>  objects.</p>
</div>
<div class="sect2">
<h3 id="retrieve-jpeg-as-bytes"><a class="anchor" href="#retrieve-jpeg-as-bytes"></a>Get a JPEG File as an Array of Bytes</h3>
<div class="paragraph">
<p>In this section, you add a pair of private methods to the  <code>FlowerService </code> class body. These methods take the name of a flower, create a path to the flower&#8217;s JPEG file, and return a binary representation of the JPEG file (an array of bytes). In later sections you add code to the public web service operations so the operations call these private methods.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the Source view of the project. You need to add code that takes the name of an image, creates a path to the image based on that name, and retrieves the image as an array of bytes. Type or paste the following code into the  <code>FlowerService</code>  class body:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private byte[] getFlowerBytes(String name) throws IOException {
    URL resource = this.getClass().getResource("/org/flower/resources/"+name+".jpg");
    return getBytes(resource);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>A warning appears that the IDE cannot find the class  <code>URL</code> . Add an import statement for  <code><a href="http://download.oracle.com/javase/6/docs/api/java/net/URL.html">+java.net.URL+</a></code> , either manually or by pressing Ctrl-Shift-I (⌘-Shift-I on Mac).</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>A new warning appears. The warning states that the IDE cannot find the  <code>getBytes</code>  method. Left-click the warning icon and click the tip to create the  <code>getBytes</code>  method.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/websvc/create-method-tip.png" alt="create method tip">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>The editor focuses on the  <code>getBytes</code>  method you just created. Add the following code to the method. This code <a href="http://download.oracle.com/javase/6/docs/api/java/net/URL.html#openStream%28%29">opens a connection to the URL</a> you passed from the  <code>getFlowerBytes</code>  method and returns an  <code><a href="http://download.oracle.com/javase/6/docs/api/java/io/InputStream.html">+InputStream+</a></code> . The code then reads the input stream 1024 bytes at a time, stores the bytes in a byte array buffer, and writes from the buffer to a  <code><a href="http://download.oracle.com/javase/6/docs/api/java/io/ByteArrayOutputStream.html">+ByteArrayOutputStream+</a></code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private byte[] getBytes(URL resource) throws IOException {
    InputStream in = resource.openStream();
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    byte[] buf = new byte[1024];
    for(int read; (read = in.read(buf)) != -1;) {
        bos.write(buf, 0, read);
    }
    return bos.toByteArray();
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Add import statements for  <code>java.io.InputStream</code>  and  <code>java.io.ByteArrayOutputStream</code> .</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="read-bytes-as-image"><a class="anchor" href="#read-bytes-as-image"></a>Read an Array of Bytes as an Image</h3>
<div class="paragraph">
<p>In this section, you add a private method to the  <code>FlowerService</code>  class body. This method takes an array of bytes that represent a JPEG file and returns a <code> java.awt.Image</code>  object. Note that the array of bytes is created by the  <code>getBytes(URL)</code>  method that you created in the section <a href="#retrieve-jpeg-as-bytes">Get a JPEG File as an Array of Bytes</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the  <code>FlowerService</code>  class body, add the following private method, called  <code>getImage</code> . The  <code>getImage</code>  method&#8217;s return type is  <code>Image</code> . The method takes two parameters. The first parameter is a byte array that is created by the  <code>getBytes</code>  method. The second parameter is a boolean that indicates whether the image is a thumbnail. The  <code>getImage</code>  method throws an  <code>IOException</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private Image getImage(byte[] bytes, boolean isThumbnail) throws IOException {
    }</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>In the  <code>getImage</code>  method body, add a line that creates a  <code><a href="http://download.oracle.com/javase/6/docs/api/java/io/ByteArrayInputStream.html">+ByteArrayInputStream+</a></code>  from the byte array that the method takes as a parameter.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ByteArrayInputStream bis = new ByteArrayInputStream(bytes);</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Add a line that creates an  <code>Object</code>  from the  <code>ByteArrayInputStream</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Object source = bis;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Add a line that creates an  <code><a href="http://download.oracle.com/javase/6/docs/api/javax/imageio/stream/ImageInputStream.html">+ImageInputStream+</a></code>  from the generic  <code>Object</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ImageInputStream iis = ImageIO.createImageInputStream(source);</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Add a line that creates an  <code><a href="http://download.oracle.com/javase/6/docs/api/java/util/Iterator.html">+Iterator+</a></code>  of all currently registered  <code><a href="http://download.oracle.com/javase/6/docs/api/javax/imageio/ImageReader.html">+ImageReader+</a></code> s that can decode JPEG files.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Iterator readers = ImageIO.getImageReadersByFormatName("jpeg");</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Add a line that creates an  <code>ImageReader</code>  from the next element in the  <code>Iterator</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ImageReader reader = (ImageReader) readers.next();</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Add lines that create default <a href="http://download.oracle.com/javase/6/docs/api/javax/imageio/IIOParam.html">image read parameters</a> but add 1-in-4 <a href="http://download.oracle.com/javase/6/docs/api/javax/imageio/IIOParam.html#setSourceSubsampling%28int,%20int,%20int,%20int%29">subsampling</a> to the image read parameters  if the  <code>Image</code>  represents a thumbnail.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ImageReadParam param = reader.getDefaultReadParam();
if (isThumbnail) {
    param.setSourceSubsampling(4, 4, 0, 0);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Lastly, add code that uses the  <code>ImageReader</code>  object to read the  <code>ImageInputStream</code>  object and to return an  <code>Image</code>  based on that object and the image read parameters.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">reader.setInput(iis, true);
return reader.read(0, param);</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Press Ctrl-Shift-I (⌘-Shift-I on MacOS). The Fix All Imports dialog opens. Accept the default suggestions of the Fix All Imports dialog and click OK.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/websvc/fix-getimage-imports.png" alt="fix getimage imports">
</div>
</div>
<div class="paragraph">
<p>The  <code>getImage</code>  method is now complete.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private Image getImage(byte[] bytes, boolean isThumbnail) throws IOException {
    ByteArrayInputStream bis = new ByteArrayInputStream(bytes);
    Object source = bis; // File or InputStream
    ImageInputStream iis = ImageIO.createImageInputStream(source);
    Iterator readers = ImageIO.getImageReadersByFormatName("jpeg");
    ImageReader reader = (ImageReader) readers.next();
    ImageReadParam param = reader.getDefaultReadParam();
    if (isThumbnail) {
        param.setSourceSubsampling(4, 4, 0, 0);
    }
    reader.setInput(iis, true);
    return reader.read(0, param);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="implement-getflower"><a class="anchor" href="#implement-getflower"></a>Implement getFlower</h3>
<div class="paragraph">
<p>Add the following implementation code to the  <code>getFlower()</code>  method to get a flower by its name and return the image of that flower, as follows. Note that this code calls the private  <code>getFlowerBytes(name)</code>  method to get the JPEG file as an array of bytes. The code then calls the private  <code>getImage</code>  method to return the array of bytes as an  <code>Image</code>  object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@WebMethod(operationName = "getFlower")
public Image getFlower(@WebParam(name = "name") String name) throws IOException {
    byte[] bytes = getFlowerBytes(name);
    return getImage(bytes, false);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-byte-array-list"><a class="anchor" href="#create-byte-array-list"></a>Create a List of Byte Arrays for All JPEG Files</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>At the top of the class body of  <code>FlowerService</code> , create an array of Strings of the names of every flower.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private static final String[] FLOWERS = {"aster", "honeysuckle", "rose", "sunflower"};</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Add a method that creates an  <code><a href="http://download.oracle.com/javase/6/docs/api/java/util/ArrayList.html">+ArrayList+</a></code>  and adds a byte array for every flower to the  <code>List</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private List allFlowers() throws IOException {
    List flowers = new ArrayList();
    for (String flower:FLOWERS) {
        URL resource = this.getClass().getResource("/org/flower/resources/"+flower+".jpg");
        flowers.add(getBytes(resource));
    }
    return flowers;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Add import statements for  <code>java.util.ArrayList</code>  and  <code>java.util.List</code> .</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="implement-getthumbnails"><a class="anchor" href="#implement-getthumbnails"></a>Implement getThumbnails</h3>
<div class="paragraph">
<p>Change the  <code>getThumbnails()</code>  method as follows. Note that you add the implementation code and change the return type from  <code>List</code>  to  <code>List&lt;Image&gt;</code> . Also note that you pass the boolean  <code>isThumbnail </code> value of  <code>true</code>  to the  <code>getImage</code>  method. The  <code>getThumbnails</code>  implementation code calls the  <code>allFlowers</code>  method to <a href="#create-byte-array-list">create a list of byte arrays for all the JPEG files</a>. The  <code>getThumbnails</code>  method then creates a  <code>List</code>  of  <code>Image</code> s and calls the  <code>getImage</code>  method for each flower, to return the array of bytes for that flower as an  <code>Image</code>  object and add that  <code>Image</code>  to the  <code>List</code> .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@WebMethod(operationName = "getThumbnails")
public List&lt;Image&gt; getThumbnails() throws IOException {
    List&lt;byte[]&gt; flowers = allFlowers();
    List&lt;Image&gt; flowerList = new ArrayList&lt;Image&gt;(flowers.size());
    for (byte[] flower : flowers) {
        flowerList.add(getImage(flower, true));
    }
    return flowerList;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The combined web service/session bean is now complete. The final form of the web service class follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.flower.service;import java.awt.Image;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.net.URL;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebService;
import javax.ejb.Stateless;
import javax.imageio.ImageIO;
import javax.imageio.ImageReadParam;
import javax.imageio.ImageReader;
import javax.imageio.stream.ImageInputStream;@WebService(serviceName = "FlowerService")
@Stateless()
public class FlowerService {private static final String[] FLOWERS = {"aster", "honeysuckle", "rose", "sunflower"};@WebMethod(operationName = "getFlower")
    public Image getFlower(@WebParam(name = "name") String name) throws IOException {
        byte[] bytes = getFlowerBytes(name);
        return getImage(bytes, false);
    }@WebMethod(operationName = "getThumbnails")
    public List&lt;Image&gt; getThumbnails() throws IOException {
        List flowers = allFlowers();
        List&lt;Image&gt; flowerList = new ArrayList&lt;Image&gt;(flowers.size());
        for (byte[] flower : flowers) {
            flowerList.add(getImage(flower, true));
        }
        return flowerList;
    }private byte[] getFlowerBytes(String name) throws IOException {
        URL resource = this.getClass().getResource("/org/flower/resources/" + name + ".jpg");
        return getBytes(resource);
    }private byte[] getBytes(URL resource) throws IOException {
        InputStream in = resource.openStream();
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        byte[] buf = new byte[1024];
        for (int read; (read = in.read(buf)) != -1;) {
            bos.write(buf, 0, read);
        }
        return bos.toByteArray();
    }private Image getImage(byte[] bytes, boolean isThumbnail) throws IOException {
        ByteArrayInputStream bis = new ByteArrayInputStream(bytes);
        Iterator readers = ImageIO.getImageReadersByFormatName("jpeg");
        ImageReader reader = (ImageReader) readers.next();
        Object source = bis; // File or InputStream
        ImageInputStream iis = ImageIO.createImageInputStream(source);
        reader.setInput(iis, true);
        ImageReadParam param = reader.getDefaultReadParam();
        if (isThumbnail) {
            param.setSourceSubsampling(4, 4, 0, 0);
        }
        return reader.read(0, param);
    }private List allFlowers() throws IOException {
        List flowers = new ArrayList();
        for (String flower : FLOWERS) {
            URL resource = this.getClass().getResource("/flower/album/resources/" + flower + ".jpg");
            flowers.add(getBytes(resource));
        }
        return flowers;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="test-ws"><a class="anchor" href="#test-ws"></a>Testing the Web Service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that the web service is complete, you can deploy and test it.</p>
</div>
<div class="paragraph">
<p><strong>To test the web service:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Right-click the FlowerAlbumService node and select Deploy. The IDE compiles the source code, launches the GlassFish server, and deploys the project&#8217;s WAR file to the server. If you open the Services window, you can see the deployed  <code>FlowerService</code>  in the server&#8217;s Applications node.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Important:</strong> The GlassFish Server Open Source Edition must be Version 3.1 or later.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/websvc/deployed-service.png" alt="deployed service">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Expand the project&#8217;s Web Services node. Right-click the FlowerService and select Test Web Service.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/websvc/test-ws-node.png" alt="test ws node">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>The web service tester opens in your browser. Type "rose" in the  <code>getFlower</code>  parameter field.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/websvc/ws-tester.png" alt="ws tester">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Press the  <code>getFlower</code>  button. The IDE shows you information about the invocation in the browser. When you look at the "Method Returned", you see that it is garbled. You want to see an image, not a series of symbols. However, since  <code>java.awt.Image</code>  is not a valid schema type, you need to manually configure the schema file to return binary image/jpeg data. You will do this in the next tutorial.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/kb/docs/websvc/ws-tester-badschema.png" alt="ws tester badschema">
</div>
</div>
<div class="paragraph">
<p>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_step"><a class="anchor" href="#_next_step"></a>Next step:</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="../flower_wsdl_schema/" class="xref page">+ Modifying the Schema and WSDL Files to Pass Binary Data+</a></p>
</div>
<div class="paragraph">
<p><a href="../../../../../../front/main/community/mailing-lists/" class="xref page">Send Feedback on This Tutorial</a></p>
</div>
<div class="paragraph">
<p>To send comments and suggestions, get support, and keep informed about the latest developments on the NetBeans IDE Java EE development features, <a href="../../../../../../front/main/community/mailing-lists/" class="xref page">join the nbj2ee@netbeans.org mailing list</a>.</p>
</div>
</div>
</div>
      <section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        <li><a href="https://github.com/apache/netbeans-antora-tutorials/edit/main/modules/ROOT/pages/kb/docs/websvc/flower-code-ws.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>
      </article>
    </div>
        <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="../../../../../../_/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
            <h1><a href="../../../../../../front/main/about">About</a></h1>
            <ul>
              <li><a href="../../../../../../front/main/community/who">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../../../front/main/community">Community</a></h1>
            <ul>
              <li><a href="../../../../../../front/main/community/mailing-lists">Mailing lists</a></li>
              <li><a href="../../../../../../front/main/community/committer">Becoming a committer</a></li>
              <li><a href="../../../../../../front/main/community/events">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../../../front/main/participate">Participate</a></h1>
            <ul>
              <li><a href="../../../../../../front/main/participate/submit-pr">Submitting Pull Requests</a></li>
              <li><a href="../../../../../../front/main/participate/report-issue">Reporting Issues</a></li>
              <li><a href="../../../../../../front/main/participate/#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../../../front/main/help">Get Help</a></h1>
            <ul>
              <li><a href="../../../../../../front/main/help/#documentation">Documentation</a></li>
              <li><a href="../../../../../../wiki/main/wiki">Wiki</a></li>
              <li><a href="../../../../../../front/main/help/#support">Community Support</a></li>
              <li><a href="../../../../../../front/main/help/commercial-support">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../../../front/main/download">Download</a></h1>
            <ul>
              <li><a href="../../../../../../front/main/download">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="../../../../../../front/main/download/#_daily_builds_and_building_from_source">Building from source</a></li>
              <li><a href="../../../../../../front/main/download/#_older_releases">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2024 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
      </div>
    </div>

    
<script src="../../../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../../../.." data-snippet-length="100" data-stylesheet="../../../../../../_/css/search.css"></script>
<script async src="../../../../../../search-index.js"></script>
    <script src="../../../../../../_/js/vendor/jquery-3.7.1.min.js"></script>
    <script src="../../../../../../_/js/vendor/what-input.js"></script>
    <script src="../../../../../../_/js/vendor/foundation.min.js"></script>
    <script src="../../../../../../_/js/vendor/jquery.colorbox-min.js"></script>
    <script src="../../../../../../_/js/netbeans.js"></script>
    <script>
       $(function(){ $(document).foundation(); });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
      $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); });
    </script>
  </body>
</html>
