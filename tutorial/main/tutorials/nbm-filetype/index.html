<!doctype html>
<html class="no-js" lang="en" dir="ltr">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>File Type Integration Tutorial</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="File Type Integration Tutorial - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans Platform, Platform Tutorials, File Type Integration Tutorial">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="../../../../_/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
    <link rel="stylesheet" href="../../../../_/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../_/images/fav/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../_/images/fav/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../_/images/fav/favicon-16x16.png">
    <link rel="manifest" href="../../../../_/images/fav/site.webmanifest">
    <link rel="mask-icon" href="../../../../_/images/fav/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="../../../../_/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="../../../../index.html"><img src='../../../../_/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <input id="search-input" type="text" placeholder="Search the docs"> </li>
            <li> <a href="../../../../front/main/community">Community</a> </li>
            <li> <a href="../../../../front/main/participate">Participate</a> </li>
            <li> <a href="../../../../front/main/blogs">Blog</a></li>
            <li> <a href="../../../../front/main/help">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="../../../../front/main/download">Download</a> </li>
        </ul>
    </div>
</div>

    <!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 19</h1>
            <p><a class="button success" href="../../../../front/main/download/nb19">Download</a></p>
        </div>
    </div>
</section>
    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">File Type Integration Tutorial</h1>
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-antora-tutorials/edit/main/modules/ROOT/pages/tutorials/nbm-filetype.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="../../../../tutorial/main/kb/docs/contributing">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
        <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_introduction_to_file_type_integration">Introduction to File Type Integration</a></li>
<li><a href="#_creating_the_module_project">Creating the Module Project</a></li>
<li><a href="#_recognizing_abc_files">Recognizing Abc Files</a></li>
<li><a href="#_installing_and_trying_out_the_functionality">Installing and Trying Out the Functionality</a></li>
<li><a href="#_creating_features_for_abc_files">Creating Features for Abc Files</a>
<ul class="sectlevel2">
<li><a href="#_adding_a_context_sensitive_action">Adding a Context-Sensitive Action</a></li>
<li><a href="#_creating_additional_multiview_windows">Creating Additional Multiview Windows</a></li>
<li><a href="#_parsing_the_file">Parsing the File</a></li>
<li><a href="#_extending_the_properties_window">Extending the Properties Window</a></li>
<li><a href="#_creating_synchronized_views">Creating Synchronized Views</a></li>
</ul>
</li>
<li><a href="#_next_steps">Next Steps</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial shows you how to write a module that lets the IDE, or any other application built on the NetBeans Platform, recognize a new file type.</p>
</div>
<div class="paragraph">
<p>For troubleshooting purposes, you are welcome to download the  <a href="http://web.archive.org/web/20170409072842/http://java.net/projects/nb-api-samples/show/versions/8.0/tutorials/AbcFileType">completed tutorial source code</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction_to_file_type_integration"><a class="anchor" href="#_introduction_to_file_type_integration"></a>Introduction to File Type Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>File types that are recognized in the IDE have their own icons, menu items, and behavior. The "files" being shown are  <code>FileObjects</code> —wrappers around  <code>java.io.File</code>  or, in the case of configuration files, typically wrappers around data stored in some other way, such as inside XML files in modules. What you actually <em>see</em> are  <code>Nodes</code> , which provide functionality like actions and localized names to objects like files. In between  <code>Nodes</code>  and  <code>FileObjects</code>  are  <code>DataObjects</code> . A  <code>DataObject</code>  is like a  <code>FileObject</code> , except that it knows what kind of file is being shown, and there are usually different types of  <code>DataObject</code>  for files with different extensions and XML files with different namespaces. Each  <code>DataObject</code>  is provided by a different module, each implementing support for one or more file types—for example, the Image module makes it possible to recognize and open  <code>.gif</code>  and  <code>.png</code>  files.</p>
</div>
<div class="paragraph">
<p>A module that recognizes a file type installs a  <code>DataLoader</code> —a factory for a file-type-specific  <code>DataObject</code> . When a folder is expanded, the IDE asks each known  <code>DataLoader</code> , "Do you know what this is?" The first one that says "Yes" creates the  <code>DataObject</code>  for the file. In order to actually display something for each file, the system calls  <code>DataObject.getNodeDelegate()</code>  for each  <code>DataObject</code>  and the  <code>Nodes</code>  are what you actually see in the IDE.</p>
</div>
<div class="paragraph">
<p>Below, the diagram on the left shows what each item mentioned above makes available:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_diagram-dataobject2.png" alt="filetype diagram dataobject2">
</div>
</div>
<div class="paragraph">
<p>In this tutorial, you create a module that installs a  <code>DataLoader</code>  for imaginary "Abc" files ( <code>.abc</code>  file extension). By default, a file with the "abc" extension is treated as any other file that the IDE does not recognize—it is treated as a text file and, as a result, the IDE provides the same functionality for Abc files as it does for text files. Once you have created the module, you will be shown how to enhance it with functionality that will be available to Abc files only. When you complete the development cycle, you can easily let others make use of your module—the IDE lets you create a binary that you can share with others, who can then install it through the Plugin Manager of their application.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_the_module_project"><a class="anchor" href="#_creating_the_module_project"></a>Creating the Module Project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, we use a wizard to create the source structure that every NetBeans module requires. The source structure consists of certain folders in specific places and a set of files that are always needed. For example, every NetBeans module requires a  <code>nbproject</code>  folder, which holds the project&#8217;s metadata, such as a  <code>build.xml</code>  file with Ant targets for building and running the module.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Choose File &gt; New Project (Ctrl-Shift-N). Under Categories, select NetBeans Modules. Under Projects, select Module. Click Next.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
In the Name and Location panel, type  <code>AbcFileType</code>  in Project Name. Change the Project Location to any directory on your computer. Click Next.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>In the Basic Module Configuration panel, type  <code>org.myorg.abcfiletype</code>  as the Code Name Base. Click Finish.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The IDE creates the  <code>AbcFileType</code>  project. The project contains all of your sources and project metadata, such as the project&#8217;s Ant build script. The project opens in the IDE. You can view its logical structure in the Projects window (Ctrl-1) and its file structure in the Files window (Ctrl-2).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recognizing_abc_files"><a class="anchor" href="#_recognizing_abc_files"></a>Recognizing Abc Files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, we use the New File Type wizard to create the classes and other files necessary for recognizing Abc files as being distinct from all other files.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Right-click the project node and choose New &gt; Other &gt; Module Development &gt; File Type:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_new-filetype-1.png" alt="filetype 72 new filetype 1">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>In the File Recognition panel, do the following:</p>
<div class="ulist">
<ul>
<li>
<p>In the MIME Type field, type  <code>text/x-abc</code> .</p>
</li>
<li>
<p>In the Filename Extension field, type  <code>abc ABC</code> .</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The File Recognition panel should now look as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_new-filetype-2.png" alt="filetype 72 new filetype 2">
</div>
</div>
<div class="paragraph">
<p>Note the following about the fields in the File Recognition panel:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>MIME Type.</strong> Specifies the data object&#8217;s unique MIME type.</p>
</li>
<li>
<p>by</p>
</li>
<li>
<p><strong>Filename Extension.</strong> Specifies one or more file extensions that the IDE will recognize as belonging to the specified MIME type. Separators are commas, spaces, or both. Therefore, all of the following are valid:</p>
</li>
<li>
<p><code>abc,def</code></p>
</li>
<li>
<p><code>abc def</code></p>
</li>
<li>
<p><code>abc def</code></p>
</li>
<li>
<p><code>abc, def ghi, wow</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s imagine that Abc files can be case-sensitive. For this reason, you specify <em>two</em> MIME types in this tutorial— <code>abc</code>  and  <code>ABC</code> .</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>XML Root Element.</strong> Specifies a unique namespace that distinguishes the XML file type from all other XML file types. Since many XML files have the same extension ( <code>xml</code> ), the IDE distinguishes between XML files via their XML root elements. More specifically, the IDE can distinguish between namespaces and the first XML element in XML files. You can use this to, for example, distinguish between a JBoss deployment descriptor and a WebLogic deployment descriptor. Once you have made this distinction, you can ensure that menu items added to the JBoss deployment descriptor&#8217;s contextual menu are not available to the WebLogic deployment descriptor. For an example, see the  <a href="../nbm-palette-api2/" class="xref page">NetBeans Component Palette Module Tutorial</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Click Next.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>In the Name, Icon and Location panel, type  <code>Abc</code>  as the Class Name Prefix and browse to any 16x16 pixel image file as the new file type&#8217;s icon, as shown below:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_new-filetype-3.png" alt="filetype 72 new filetype 3">
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> You can use any icon of a 16x16 pixel dimension. If you like, you can right-click on this one and save it locally, and then specify it in the wizard step above:
<span class="image"><img src="../../_images/tutorials/filetype_Datasource.gif" alt="filetype Datasource"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click Finish.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The Projects window should now look as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_new-filetype-4.png" alt="filetype 72 new filetype 4">
</div>
</div>
<div class="paragraph">
<p>Each of the newly generated files is briefly introduced:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>AbcDataObject.java.</strong> Wraps a  <code>FileObject</code> . DataObjects are produced by DataLoaders. For more information, see  <a href="../../../../wiki/main/wiki/DevFaqDataObject/" class="xref page">What is a DataObject?</a>.</p>
</li>
<li>
<p><strong>AbcTemplate.abc.</strong> Provides the basis of a file template that is registered in the  <code>layer.xml</code>  via an annotation defined in the  <code>package-info.java</code>  file, such that it will be installed in the New File dialog as a new template.</p>
</li>
<li>
<p><strong>AbcVisualElement.java.</strong> Sample visual tab in multiview editor.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installing_and_trying_out_the_functionality"><a class="anchor" href="#_installing_and_trying_out_the_functionality"></a>Installing and Trying Out the Functionality</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s now install the module and then use the basic functionality we&#8217;ve created so far.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>In the Projects window, right-click the  <code>AbcFileType</code>  project and choose Run. A new instance of the IDE starts, installing your module into itself.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Choose File | New Project and create a new Java application.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Once you have a new application, go to the New File dialog and you will see your new file template:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_trying-out-1.png" alt="filetype 72 trying out 1">
</div>
</div>
<div class="paragraph">
<p>Click Next, choose a folder to store the template, and click Finish.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Open the file and you see a text editor:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_trying-out-2.png" alt="filetype 72 trying out 2">
</div>
</div>
<div class="paragraph">
<p>Click the "Visual" tab and notice that you have a starting point for creating a visual page in a multiview editor:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_trying-out-3.png" alt="filetype 72 trying out 3">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_features_for_abc_files"><a class="anchor" href="#_creating_features_for_abc_files"></a>Creating Features for Abc Files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that the NetBeans Platform is able to distinguish Abc files from all other types of files, it is time to add features specifically for these types of files. In this section, we add a menu item on the right-click contextual menu of the file&#8217;s node in the explorer windows, such as in the Projects window, and we enable the file to open into a window, instead of into an editor.</p>
</div>
<div class="sect2">
<h3 id="_adding_a_context_sensitive_action"><a class="anchor" href="#_adding_a_context_sensitive_action"></a>Adding a Context-Sensitive Action</h3>
<div class="paragraph">
<p>In this subsection, we use the New Action wizard to create a Java class that will perform an action for our file type.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Right-click the  <code>org.myorg.abcfiletype</code>  package and choose New &gt; Action.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
In the Action Type panel, click Conditionally Enabled. Type  <code>AbcDataObject</code> , which is the fully qualified name of the data object generated above by the New File Type wizard, as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_new-action-1.png" alt="filetype 72 new action 1">
</div>
</div>
<div class="paragraph">
<p>Click Next.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>In the GUI Registration panel, select the 'File' category in the Category drop-down list. The Category drop-down list controls where an action is shown in the Keyboard Shortcuts editor in the IDE.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Next, Unselect Global Menu Item and then select File Type Contect Menu Item. In the Content Type drop-down list, select the MIME type you specified above in the New File Type wizard, as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_new-action-2.png" alt="filetype 72 new action 2">
</div>
</div>
<div class="paragraph">
<p>Notice that you can set the position of the menu item and that you can separate the menu item from the item before it and after it. Click Next.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>In the Name and Location panel, type  <code>StartAnalyzerActionListener</code>  as the Class Name and type  <code>Start Analyzer</code>  as the Display Name. Optionally, provide an icon to be displayed.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_new-action-3.png" alt="filetype 72 new action 3">
</div>
</div>
<div class="paragraph">
<p>Click Finish and  <code>StartAnalyzerActionListener.java</code>  is added to the  <code>org.myorg.abcfiletype</code>  package.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.myorg.abcfiletype;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import org.openide.awt.ActionID;
import org.openide.awt.ActionReference;
import org.openide.awt.ActionRegistration;
import org.openide.util.NbBundle.Messages;

@ActionID(
    category = "File",
    id = "org.myorg.abcfiletype.StartAnalyzerActionListener")
@ActionRegistration(
    displayName = "#CTL_StartAnalyzerActionListener")
@ActionReference(path = "Loaders/text/x-abc/Actions", position = 0)
@Messages("CTL_StartAnalyzerActionListener=Start Analyzer")
public final class StartAnalyzerActionListener implements ActionListener {

    private final AbcDataObject context;

    public StartAnalyzerActionListener(AbcDataObject context) {
        this.context = context;
    }

    @Override
    public void actionPerformed(ActionEvent ev) {
        // TODO use context
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>In the Source Editor, add some code to the action&#8217;s  <code>actionPerformed</code>  method:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
public void actionPerformed(ActionEvent ev) {
   FileObject f = context.getPrimaryFile();
   String displayName = FileUtil.getFileDisplayName(f);
   String msg = "I am " + displayName + ". Hear me roar!";
   NotifyDescriptor nd = new NotifyDescriptor.Message(msg);
   DialogDisplayer.getDefault().notify(nd);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Press Ctrl-Shift-I. The IDE automatically adds import statements to the top of the class.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Run the module again, as you did in the previous section.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
Create an Abc file, using the template shown in the previous section, and right-click the file&#8217;s node in one of the explorer views, such as in the Projects window or Favorites window.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_new-action-4.png" alt="filetype 72 new action 4">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Choose the new menu item, the Abc file&#8217;s name and location are shown:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_new-action-5.png" alt="filetype 72 new action 5">
</div>
</div>
<div class="paragraph">
<p>You now know how to create a new context-sensitive action that appears in the context menu of a file of the given type, in the Projects window, Files window or the Favorites window.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creating_additional_multiview_windows"><a class="anchor" href="#_creating_additional_multiview_windows"></a>Creating Additional Multiview Windows</h3>
<div class="paragraph">
<p>Let&#8217;s create a new multiview window. The first tab of a multiview window is typically used to display the source view of the file, while the second and subsequent tabs typically show various visual views. More than two tabs can also be provided, each tab providing further levels of detail about the opened file.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>For each tab that you want to create in the multiview window, create a class that implements JPanel and MultiViewElement. For purposes of this tutorial, start by creating a class called  <code>AbcVisualElement2</code> , implementing the specified classes:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import javax.swing.Action;
import javax.swing.JComponent;
import javax.swing.JPanel;
import javax.swing.JToolBar;
import org.netbeans.core.spi.multiview.CloseOperationState;
import org.netbeans.core.spi.multiview.MultiViewElement;
import org.netbeans.core.spi.multiview.MultiViewElementCallback;
import org.openide.awt.UndoRedo;
import org.openide.util.Lookup;
import org.openide.util.NbBundle;
import org.openide.windows.TopComponent;

@MultiViewElement.Registration(displayName = "#LBL_Abc_VISUAL2",
iconBase = "org/myorg/abcfiletype/Datasource.gif",
mimeType = "text/x-abc",
persistenceType = TopComponent.PERSISTENCE_NEVER,
preferredID = "AbcVisual2",
position = 3000)
@NbBundle.Messages({
    "LBL_Abc_VISUAL2=Visual2"
})
public class AbcVisualElement2 extends JPanel implements MultiViewElement {

    private AbcDataObject obj;
    private JToolBar toolbar = new JToolBar();
    private transient MultiViewElementCallback callback;

    public AbcVisualElement2(Lookup lkp) {
        obj = lkp.lookup(AbcDataObject.class);
        assert obj != null;
    }

    @Override
    public String getName() {
        return "AbcVisualElement2";
    }

    @Override
    public JComponent getVisualRepresentation() {
        return this;
    }

    @Override
    public JComponent getToolbarRepresentation() {
        return toolbar;
    }

    @Override
    public Action[] getActions() {
        return new Action[0];
    }

    @Override
    public Lookup getLookup() {
        return obj.getLookup();
    }

    @Override
    public void componentOpened() {
    }

    @Override
    public void componentClosed() {
    }

    @Override
    public void componentShowing() {
    }

    @Override
    public void componentHidden() {
    }

    @Override
    public void componentActivated() {
    }

    @Override
    public void componentDeactivated() {
    }

    @Override
    public UndoRedo getUndoRedo() {
        return UndoRedo.NONE;
    }

    @Override
    public void setMultiViewCallback(MultiViewElementCallback callback) {
        this.callback = callback;
    }

    @Override
    public CloseOperationState canCloseElement() {
        return CloseOperationState.STATE_OK;
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Install and open the file again. Now you have a multiview window with an additional visual tab.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You now have two visual tabs in a multiview window. For each additional tab, create a new class just like the above.</p>
</div>
</div>
<div class="sect2">
<h3 id="_parsing_the_file"><a class="anchor" href="#_parsing_the_file"></a>Parsing the File</h3>
<div class="paragraph">
<p>A  <code>DataObject</code>  is like a  <code>FileObject</code> , except that it knows what kind of file is being shown. The "New File Type" wizard created a  <code>DataObject</code>  for our file type, so let&#8217;s now use it to parse the underlying file and expose its content as new nodes in the explorer views, e.g., the Projects window, Files window, and the Favorites window.</p>
</div>
<div class="paragraph">
<p>For background to this section and complete details on support for nodes on the NetBeans Platform, see  <a href="../nbm-nodesapi2/" class="xref page">NetBeans Nodes API Tutorial</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Open the  <code>AbcDataObject</code>  class and add this method:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
protected Node createNodeDelegate() {
    return new DataNode(this, Children.LEAF, getLookup());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The method above provides a default Node for the underlying file. The default Node has no child nodes, which is evident by the "Children.LEAF" parameter that you see above.</p>
</div>
<div class="paragraph">
<p>Instead of passing in "Children.LEAF", let&#8217;s now use the  <code>ChildFactory</code>  class to create new child nodes of our Node class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
protected Node createNodeDelegate() {
    return new DataNode(
            this,
            *Children.create(new AbcChildFactory(this), true),*
            getLookup());
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Define the  <code>ChildFactory</code>  as an inner class, as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private static class AbcChildFactory extends ChildFactory&lt;String&gt; {

    private final AbcDataObject dObj;

    public AbcChildFactory(AbcDataObject dObj) {
        this.dObj = dObj;
    }

    @Override
    protected boolean createKeys(List list) {
        FileObject fObj = dObj.getPrimaryFile();
        try {
            List&lt;String&gt; dObjContent = fObj.asLines();
            list.addAll(dObjContent);
        } catch (IOException ex) {
            Exceptions.printStackTrace(ex);
        }
        return true;
    }

    @Override
    protected Node createNodeForKey(String key) {
        Node childNode = new AbstractNode(Children.LEAF);
        childNode.setDisplayName(key);
        return childNode;
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>In your module sources, open  <code>AbcTemplate.abc</code>  and enter the following text, or something like it, i.e., add several lines of text to your template file:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">hello
world
how are things
today</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Run the module again, create an Abc file from the template again, and then notice that you can expand the generated file:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_new-action-6.png" alt="filetype 72 new action 6">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_extending_the_properties_window"><a class="anchor" href="#_extending_the_properties_window"></a>Extending the Properties Window</h3>
<div class="paragraph">
<p>Our Node now has child Nodes. In this section, we also assign properties to our Node. The properties are displayed in the Properties window.</p>
</div>
<div class="paragraph">
<p>For background to this section and complete details on support for properties on the NetBeans Platform, see  <a href="../nbm-property-editors/" class="xref page">NetBeans Property Editor Tutorial</a>.</p>
</div>
<div class="paragraph">
<p>By default, the following properties are shown in the Properties window for our new file:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_new-action-9.png" alt="filetype 72 new action 9">
</div>
</div>
<div class="paragraph">
<p>We will now change the default properties to show a custom property instead.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Open the  <code>AbcDataObject</code>  class and change the  <code>createNodeDelegate</code>  method so that our own  <code>AbcNode</code>  will be created instead of the generic  <code>DataNode</code> :</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
protected Node createNodeDelegate() {
    return new *AbcNode*(
            this,
            Children.create(new AbcChildFactory(this), true),
            getLookup());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The  <code>AbcNode</code>  does not exist yet, you will create it in the next step.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Define the  <code>AbcNode</code>  as an inner class, as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">class AbcNode extends DataNode {

    public AbcNode(AbcDataObject aThis, Children kids, Lookup lookup) {
        super(aThis, kids, lookup);
    }

    @Override
    protected Sheet createSheet() {
        Sheet sheet = super.createSheet();
        Sheet.Set set = Sheet.createPropertiesSet();
        sheet.put(set);
        set.put(new LineCountProperty(this));
        return sheet;
    }

    private class LineCountProperty extends ReadOnly&lt;Integer&gt; {

        private final AbcNode node;

        public LineCountProperty(AbcNode node) {
            super("lineCount", Integer.class, "Line Count", "Number of Lines");
            this.node = node;
        }

        @Override
        public Integer getValue() throws IllegalAccessException, InvocationTargetException {
            int lineCount = 0;
            DataObject abcDobj = node.getDataObject();
            FileObject abcFo = abcDobj.getPrimaryFile();
            try {
                lineCount = abcFo.asLines().size();
            } catch (IOException ex) {
                Exceptions.printStackTrace(ex);
            }
            return lineCount;
        }

    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Run the module again, open the Properties window, and notice your property is displayed:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_new-action-7.png" alt="filetype 72 new action 7">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_synchronized_views"><a class="anchor" href="#_creating_synchronized_views"></a>Creating Synchronized Views</h3>
<div class="paragraph">
<p>Let&#8217;s now illustrate via a small example how the various views can be synchronized.</p>
</div>
<div class="paragraph">
<p>For background to this section and complete details on the Visual Library in the NetBeans Platform, see "NetBeans APIs for Visualizing Data" in the  <a href="../../kb/docs/platform/" class="xref page">NetBeans Platform Learning Trail</a>, especially the  <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/doc-files/documentation.html">official Visual Library documentation</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Right-click the Libraries node, choose Add Module Dependency, and add a dependency on the Visual Library API.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Create a new Java class named "AbcVisualElementPanel".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Define the class as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.myorg.abcfiletype;

import java.awt.BorderLayout;
import java.awt.Point;
import java.util.List;
import javax.swing.JPanel;
import org.netbeans.api.visual.action.ActionFactory;
import org.netbeans.api.visual.widget.LabelWidget;
import org.netbeans.api.visual.widget.LayerWidget;
import org.netbeans.api.visual.widget.Scene;
import org.openide.filesystems.FileChangeAdapter;
import org.openide.filesystems.FileEvent;

public class AbcVisualElementPanel extends JPanel {

    public AbcVisualElementPanel(final AbcDataObject dobj) {
        setLayout(new BorderLayout());
        final Scene scene = new Scene();
        final LayerWidget layer = new LayerWidget(scene);
        refresh(scene, layer, dobj);
        dobj.getPrimaryFile().addFileChangeListener(new FileChangeAdapter() {
            @Override
            public void fileChanged(FileEvent fe) {
                layer.removeChildren();
                refresh(scene, layer, dobj);
                scene.validate();
            }
        });
        scene.addChild(layer);
        add(scene.createView(), BorderLayout.CENTER);
    }

    private void refresh(Scene scene, LayerWidget layer, AbcDataObject dobj) {
        try {
            List&lt;String&gt; lines = dobj.getPrimaryFile().asLines();
            for (int i = 0; i &lt; lines.size(); i++) {
                String line = lines.get(i);
                LabelWidget widget = new LabelWidget(scene, line);
                widget.getActions().addAction(ActionFactory.createMoveAction());
                widget.setPreferredLocation(new Point(20, 90 * i));
                layer.addChild(widget);
            }
        } catch (Exception e) {
        }
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>In "AbcVisualElement", return the  <code>JPanel</code>  created above, as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
public JComponent getVisualRepresentation() {
    return new AbcVisualElementPanel(obj);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Run the module again and notice that the first tab is synchronized with the second tab:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/filetype_72_new-action-8.png" alt="filetype 72 new action 8">
</div>
</div>
<div class="paragraph">
<p>Make a change in the source view, save the change, switch to this visual view, and notice that the visual view reflects the changed source view.</p>
</div>
<div class="paragraph">
<p><a href="../../../../front/main/community/mailing-lists/" class="xref page">Send Us Your Feedback</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps"><a class="anchor" href="#_next_steps"></a>Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For more information about creating and developing NetBeans modules, see the following resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://netbeans.apache.org/platform/index.html">NetBeans Platform Homepage</a></p>
</li>
<li>
<p><a href="https://bits.netbeans.org/dev/javadoc/">NetBeans API List (Current Development Version)</a></p>
</li>
<li>
<p><a href="../../kb/docs/platform/" class="xref page">Other Related Tutorials</a></p>
</li>
</ul>
</div>
</div>
</div>
        <section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        <li><a href="https://github.com/apache/netbeans-antora-tutorials/edit/main/modules/ROOT/pages/tutorials/nbm-filetype.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>
    </div>
        <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="../../../../_/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/about">About</a></h1>
            <ul>
              <li><a href="../../../../front/main/community/who">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/community">Community</a></h1>
            <ul>
              <li><a href="../../../../front/main/community/mailing-lists">Mailing lists</a></li>
              <li><a href="../../../../front/main/community/committer">Becoming a committer</a></li>
              <li><a href="../../../../front/main/community/events">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/participate">Participate</a></h1>
            <ul>
              <li><a href="../../../../front/main/participate/submit-pr">Submitting Pull Requests</a></li>
              <li><a href="../../../../front/main/participate/report-issue">Reporting Issues</a></li>
              <li><a href="../../../../front/main/participate/#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/help">Get Help</a></h1>
            <ul>
              <li><a href="../../../../front/main/help/#documentation">Documentation</a></li>
              <li><a href="../../../../wiki/main/wiki">Wiki</a></li>
              <li><a href="../../../../front/main/help/#support">Community Support</a></li>
              <li><a href="../../../../front/main/help/commercial-support">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/download">Download</a></h1>
            <ul>
              <li><a href="../../../../front/main/download">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="../../../../front/main/download/#_daily_builds_and_building_from_source">Building from source</a></li>
              <li><a href="../../../../front/main/download/#_older_releases">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
      </div>
    </div>

    
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
    <script src="../../../../_/js/vendor/jquery-3.7.1.min.js"></script>
    <script src="../../../../_/js/vendor/what-input.js"></script>
    <script src="../../../../_/js/vendor/foundation.min.js"></script>
    <script src="../../../../_/js/vendor/jquery.colorbox-min.js"></script>
    <script src="../../../../_/js/netbeans.js"></script>
    <script>
       $(function(){ $(document).foundation(); });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
      $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); });
    </script>
  </body>
</html>
