<!doctype html>
<html class="no-js" lang="en" dir="ltr">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>NetBeans Visual Library Tutorial</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NetBeans Visual Library Tutorial - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans Platform, Platform Tutorials, NetBeans Visual Library Tutorial">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="../../../../_/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
    <link rel="stylesheet" href="../../../../_/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../_/images/fav/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../_/images/fav/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../_/images/fav/favicon-16x16.png">
    <link rel="manifest" href="../../../../_/images/fav/site.webmanifest">
    <link rel="mask-icon" href="../../../../_/images/fav/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="../../../../_/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="../../../../index.html"><img src='../../../../_/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <input id="search-input" type="text" placeholder="Search the docs"> </li>
            <li> <a href="../../../../front/main/community">Community</a> </li>
            <li> <a href="../../../../front/main/participate">Participate</a> </li>
            <li> <a href="../../../../front/main/blogs">Blog</a></li>
            <li> <a href="../../../../front/main/help">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="../../../../front/main/download">Download</a> </li>
        </ul>
    </div>
</div>

    <!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 19</h1>
            <p><a class="button success" href="../../../../front/main/download/nb19">Download</a></p>
        </div>
    </div>
</section>
    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">NetBeans Visual Library Tutorial</h1>
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-antora-tutorials/edit/main/modules/ROOT/pages/tutorials/nbm-visual_library.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="../../../../tutorial/main/kb/docs/contributing">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
        <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_setting_up_the_module">Setting Up the Module</a></li>
<li><a href="#_creating_the_scene">Creating the Scene</a></li>
<li><a href="#_creating_a_component_palette_for_the_scene">Creating a Component Palette for the Scene</a></li>
<li><a href="#_adding_a_layerwidget">Adding a LayerWidget</a></li>
<li><a href="#_adding_an_iconnodewidget_via_drag_and_drop_functionality">Adding an IconNodeWidget via Drag and Drop Functionality</a></li>
<li><a href="#_adding_functionality_to_the_scene">Adding Functionality to the Scene</a></li>
<li><a href="#_adding_functionality_to_the_iconnodewidget">Adding Functionality to the IconNodeWidget</a></li>
<li><a href="#_next_steps">Next Steps</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this tutorial, you will learn how to use the main features provided by the  <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/overview-summary.html">NetBeans Visual Library API</a>. The library provides a set of reusable pieces, called "widgets". When you compose them together, you are able to create a visualization in a simple and flexible way. Each widget has, built into it, various properties, such as "layout", "border", and "actions". The set of predefined widgets provided by the library can be extended.</p>
</div>
<div class="paragraph">
<p>All the pluggable pieces are declared as interfaces or abstract classes, such as "WidgetAction", "Anchor", "AnchorShape", "PointShape", "Animator", "Border", "GraphLayout", "LookFeel", "Layout", "SceneLayout", "Router", and "CollisionsCollector".</p>
</div>
<div class="paragraph">
<p>In summary, the Visual Library API is a visualization API, useful in the context of modeling and graphing features.</p>
</div>
<div class="paragraph">
<p>Also, you will use 3 icons in the tutorial. You can right-click them here and save them locally, then copy them to the module project&#8217;s location, after you create the module project later in this tutorial. Here are the 3 icons:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/vislib_image1.png" alt="vislib image1">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/vislib_image2.png" alt="vislib image2">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/vislib_image3.png" alt="vislib image3">
</div>
</div>
<div class="paragraph">
<p>All the information you need to know for working with the Visual Library API is collected at these two locations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#../projects/platform/graph/index.adoc" class="xref unresolved">Visual Library Project Page</a></p>
</li>
<li>
<p><a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/doc-files/documentation.html">Visual Library 2.0 - Documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_up_the_module"><a class="anchor" href="#_setting_up_the_module"></a>Setting Up the Module</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, we use wizards to create a module project and a custom window component.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Choose File &gt; New Project (Ctrl+Shift+N). Under Categories, select NetBeans Modules. Under Projects, select Module. Click Next.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>In the Name and Location panel, type  <code>ShapeSample</code>  in the Project Name field. Change the Project Location to any directory on your computer. Leave the Standalone Module option and Set as Main Project checkbox selected. Click Next.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
In the Basic Module Configuration panel, type  <code>org.netbeans.shapesample</code>  in Code Name Base. Click Finish.</p>
</div>
<div class="paragraph">
<p>The IDE creates the  <code>ShapeSample</code>  project. The project contains all of your sources and project metadata, such as the project&#8217;s Ant build script. The project opens in the IDE. You can view its logical structure in the Projects window (Ctrl+1) and its file structure in the Files window (Ctrl+2).</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Right-click the module project, choose New &gt; Other and choose Window from the Module Development category. Click Next. Choose  <code>editor</code>  in the drop-down list and select Open on Application Start. Click Next.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
Type  <code>Shape</code>  in Class Name Prefix. Optionally, add an icon with a dimension of 16x16 pixels. Click Finish.</p>
</div>
<div class="paragraph">
<p>A Java class is created, named  <code>ShapeTopComponent</code> . Open this file in "Design" mode. You should now see this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/vislib_71_shapetopcomponent.png" alt="vislib 71 shapetopcomponent">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Right-click the project, choose Properties, click Libraries in the Project Properties dialog box and declare a dependency on the Visual Library API.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Visual Library is not one of the modules included in a new NetBeans Platform application. To set a dependency on it in a new NetBeans Platform application, you first need to include it in the application. To do so, right-click the application, choose Properties, go to Libraries panel, expand 'platform', and at the end of the list select Visual Library. Then you can set a dependency on it in your module.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Click OK.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_the_scene"><a class="anchor" href="#_creating_the_scene"></a>Creating the Scene</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Programming with the Visual Library API is similar to programming in Swing. You build and modify a tree of visual elements that are called "widgets". The root of the tree is represented by a Scene class which holds all the visual data of the scene. The scene is a widget. You have to create a scene view, which is a JComponent. You must then add the JComponent to a JScrollPane.</p>
</div>
<div class="paragraph">
<p>In this section, we add a JScrollPane to our TopComponent. Then we create a new scene. Next, we pass the scene view to the TopComponent, so that it can be displayed in the TopComponent&#8217;s JScrollPane. We then install the module project and display our first scene.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>In the  <code>org.netbeans.shapesample</code>  package, create a Java class called  <code>GraphSceneImpl</code> . Let the class extend  <code>GraphScene</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A red error underline and a lightbulb appears. Let the IDE generate the import statement.</p>
</div>
<div class="paragraph">
<p>A red error underline and a lightbulb appears again. Let the IDE generate the class&#8217;s abstract methods.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Create a dummy implementation of the class by adding meaningful identifiers and setting  <code>null</code>  to be returned where necessary, so that all of the class&#8217;s requirements are fulfilled:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class GraphSceneImpl extends GraphScene {

    public GraphSceneImpl() {
    }

    @Override
    protected Widget attachNodeWidget(Object node) {
        return null;
    }

    @Override
    protected Widget attachEdgeWidget(Object edge) {
        return null;
    }

    @Override
    protected void attachEdgeSourceAnchor(Object edge, Object oldSourceNode, Object newSourceNode) {

    }

    @Override
    protected void attachEdgeTargetAnchor(Object edge, Object oldTargetNode, Object newTargetNode) {

    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Now use the TopComponent&#8217;s constructor to hold an instance of the  <code>GraphSceneImpl</code>  class. To do so, add the following to the end of the  <code>ShapeTopComponent</code>  class&#8217;s constructor:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">setLayout(new BorderLayout());

GraphSceneImpl scene = new GraphSceneImpl();

JScrollPane shapePane = new JScrollPane();

shapePane.setViewportView(scene.createView());

add(shapePane, BorderLayout.CENTER);
add(scene.createSatelliteView(), BorderLayout.WEST);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that we are creating two views. The first will be a large view for visualization of your graphs or models, and so on. The second is a satellite view, which we have placed in the WEST (i.e., the left side) of the TopComponent. This will let the user navigate quickly across the view and gives an overview of the entire scene.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Right-click the project node and choose "Run".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A new instance of the application starts up. When the module installs, look under the Window menu and you will find a new menu item called "Shape", at the top of the list of menu items. Choose it and you will see the start of your Visual Library API implementation:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/vislib_firstscene.png" alt="vislib firstscene">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_component_palette_for_the_scene"><a class="anchor" href="#_creating_a_component_palette_for_the_scene"></a>Creating a Component Palette for the Scene</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To do something useful with the Visual Library API, we will implement the  <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-spi-palette/overview-summary.html">Palette API</a> so that we end up with a Component Palette containing the shapes shown at the start of this tutorial. Later, we will add the Visual Library API&#8217;s drag and drop functionality so that we can drag and drop the shapes into the scene. After that, we will be able to enrich the scene with additional features, such as the ability to zoom and pan in the scene.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Since the focus of this tutorial is the Visual Library API, and not the Palette API, no time will be spent here explaining how the Palette API works. Many tutorials exist on this subject already ( <a href="../../kb/docs/platform/" class="xref page">here</a>). Therefore, you can simply copy and paste the following files into a new package called  <code>org.netbeans.shapesample.palette</code> :</p>
<div class="ulist">
<ul>
<li>
<p><a href="images/vislib_Category.java">Category.java</a></p>
</li>
<li>
<p><a href="images/vislib_CategoryChildren.java">CategoryChildren.java</a></p>
</li>
<li>
<p><a href="images/vislib_CategoryNode.java">CategoryNode.java</a></p>
</li>
<li>
<p><a href="images/vislib_PaletteSupport.java">PaletteSupport.java</a></p>
</li>
<li>
<p><a href="images/vislib_Shape.java">Shape.java</a></p>
</li>
<li>
<p><a href="images/vislib_ShapeChildren.java">ShapeChildren.java</a></p>
</li>
<li>
<p><a href="images/vislib_ShapeNode.java">ShapeNode.java</a></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>In the same way as explained in step 3 of the section called "Getting Started", earlier in this tutorial, add dependencies on the Actions API, Nodes API, and Common Palette API.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Next, add the palette to the TopComponent&#8217;s Lookup, by adding this line to the end of the TopComponent&#8217;s constructor:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">associateLookup( Lookups.singleton(PaletteSupport.createPalette() ));</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>The IDE will prompt you to insert import statements for  <code>org.openide.util.lookup.Lookups</code>  and  <code>org.netbeans.shapesample.palette.PaletteSupport</code> . Accept the prompts and let the IDE generate the import statements.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
Place the images found at the start of this tutorial into the  <code>org.netbeans.shapesample.palette</code>  package. The Projects window should now look as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/vislib_71_proj-window.png" alt="vislib 71 proj window">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Install the module again. The new Component Palette is shown to the right of the scene:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/vislib_firstpalette.png" alt="vislib firstpalette">
</div>
</div>
<div class="paragraph">
<p>When you try to drag and drop a widget onto the scene, nothing happens because you need a  <code>LayerWidget</code>  on which you will be able to drop your widgets. You will be shown how to do so in the next section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adding_a_layerwidget"><a class="anchor" href="#_adding_a_layerwidget"></a>Adding a LayerWidget</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A  <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/LayerWidget.html">LayerWidget</a> represents a glasspane, similar to JGlassPane in Swing. It is transparent by default. So, before we go any further, we will add a LayerWidget to the scene, so that we have somewhere to place the visible widgets that we will drag and drop onto the scene.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>In the  <code>GraphSceneImpl</code>  class, declare the LayerWidget:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private LayerWidget mainLayer;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>In the  <code>GraphSceneImpl</code>  class&#8217;s constructor, add the LayerWidget as a child of the scene:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">mainLayer = new LayerWidget (this);
addChild (mainLayer);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, when we drag and drop items from the palette as widgets to the scene, we will add them as children of the LayerWidget. Because LayerWidgets are transparent by default, you could have various LayerWidgets transparently on top of each other so that, for example, you can add a background image to the scene.</p>
</div>
<div class="paragraph">
<p>For details, see  <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/LayerWidget.html">LayerWidget</a> in the Javadoc.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adding_an_iconnodewidget_via_drag_and_drop_functionality"><a class="anchor" href="#_adding_an_iconnodewidget_via_drag_and_drop_functionality"></a>Adding an IconNodeWidget via Drag and Drop Functionality</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Earlier, we used the  <code>GraphSceneImpl</code>  class&#8217;s constructor to pass a scene to the TopComponent&#8217;s JScrollPane. So far, the scene exists but has no behavior. Behavior is added through actions. The action that we will look at in this section is called  <code> <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/doc-files/documentation.html#AcceptAction">AcceptAction</a></code> . This action enables drag and drop functionality. The drag and drop functionality could be applied to a widget, but here we apply it to the scene itself.</p>
</div>
<div class="paragraph">
<p>We use  <code>createAcceptAction</code>  to specify what should happen when an item from the palette is dragged over the scene. Two methods are involved here. The first,  <code>isAcceptable()</code> , is used to determine whether the item is acceptable to the scene. Here you can test the item, by using the transferable. You can also set the drag image, which is all that we do in the implementation below. If  <code>true</code>  is returned, the  <code>accept</code>  method is called. Here we get the image from the transferable, using the same helper method as before. Then we call the  <code>addNode</code>  method, instantiating a new  <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/general/IconNodeWidget.html">IconNodeWidget</a> and passing the image retrieved from the transferable.</p>
</div>
<div class="paragraph">
<p>All the code in this section is interrelated, and you will receive red error underlines in your code until all the methods below have been added, but we will try to add everything in some kind of logical order anyway!</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>First, add the  <code>createAcceptAction</code> , with its two methods, to the  <code>GraphSceneImpl</code>  class&#8217;s constructor:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">getActions().addAction(ActionFactory.createAcceptAction(new AcceptProvider() {

    @Override
    public ConnectorState isAcceptable(Widget widget, Point point, Transferable transferable) {
        Image dragImage = getImageFromTransferable(transferable);
        JComponent view = getView();
        Graphics2D g2 = (Graphics2D) view.getGraphics();
        Rectangle visRect = view.getVisibleRect();
        view.paintImmediately(visRect.x, visRect.y, visRect.width, visRect.height);
        g2.drawImage(dragImage,
                AffineTransform.getTranslateInstance(point.getLocation().getX(),
                point.getLocation().getY()),
                null);
        return ConnectorState.ACCEPT;
    }

    @Override
    public void accept(Widget widget, Point point, Transferable transferable) {
        Image image = getImageFromTransferable(transferable);
        Widget w = GraphSceneImpl.this.addNode(new MyNode(image));
        w.setPreferredLocation(widget.convertLocalToScene(point));
    }

}));</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
After you add the above code, some red underlines will remain, denoting that there are errors. These errors are because the code above refers to a method and a class that you have not yet created. You will create them in the next steps.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Next, in the  <code>GraphSceneImpl</code>  class, add a helper method for retrieving the image from the transferable:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private Image getImageFromTransferable(Transferable transferable) {
    Object o = null;
    try {
        o = transferable.getTransferData(DataFlavor.imageFlavor);
    } catch (IOException ex) {
    } catch (UnsupportedFlavorException ex) {
    }
    return o instanceof Image ? (Image) o : ImageUtilities.loadImage("org/netbeans/shapesample/palette/shape1.png");
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can define any kind of image when an image is not successfully returned from this helper method. For now we will use the " <code>shape1.png</code> " image instead.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Create a new class called  <code>MyNode</code> . This class represents a node in a graph-oriented model. It cannot be an image directly, since each node has to be unique (checked by "equals" method) in the model. If you would use the images directly, then you would be able to have only 3 nodes (one for each image) in the scene. Using the MyNode class, you can have multiple nodes and each node can have its own or a shared image instance.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MyNode {

    private Image image;

    public MyNode(Image image) {
        this.image = image;
    }

    public Image getImage() {
        return image;
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Change the signature of the  <code>GraphSceneImpl</code>  class to the following, so that the node is received by the Visual Library implementation class:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">extends GraphScene&lt;MyNode, String&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You must let the IDE generate new stubs for the abstract methods.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Finally, define the new widget in the  <code>GraphSceneImpl</code>  class. This method is called automatically by the  <code>accept</code>  method. Use it to define a Visual Library widget when the palette item is dropped.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
protected Widget attachNodeWidget(MyNode node) {
    IconNodeWidget widget = new IconNodeWidget(this);
    widget.setImage(node.getImage());
    widget.setLabel(Long.toString(node.hashCode()));
    widget.getActions().addAction(ActionFactory.createMoveAction());
    mainLayer.addChild(widget);
    return widget;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that we set the image retrieved from the node. We also generate a random number so that we have a label. By default, the widget exists but has no behavior. Here, we create a move action, so that the widget can be moved in the scene. Finally, before returning the widget to the scene, we add it as a child to the LayerWidget that we created in the previous section.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Run the module and open the Shape window again.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now you can drag and drop items from the palette. As you drag an item over the scene, you will see the drag image. When you drop an item, it becomes a widget and is visible within the scene as well as within the satellite view, as you can see here:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/vislib_finishedscene.png" alt="vislib finishedscene">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adding_functionality_to_the_scene"><a class="anchor" href="#_adding_functionality_to_the_scene"></a>Adding Functionality to the Scene</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the previous section, we added  <code> <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/doc-files/documentation.html#AcceptAction">AcceptAction</a></code>  to the scene. We had to define two methods to specify whether the item should be dropped and for resolving the item. In this section, we use  <code> <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/doc-files/documentation.html#ZoomAction">ZoomAction</a></code> , to add zoom/unzoom functionality to the scene.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>At the end of the  <code>GraphSceneImpl</code>  class&#8217;s constructor, add this line:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">getActions().addAction(ActionFactory.createZoomAction());</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Install the module again.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
While holding CTRL key, use the mouse wheel to zoom in and out of the scene:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/vislib_zoom.png" alt="vislib zoom">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/vislib_unzoom.png" alt="vislib unzoom">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The shapes are rendered as images. SVG is currently not supported.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the same way as described above, you can add Pan functionality to the scene, by means of this line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">getActions().addAction(ActionFactory.createPanAction());</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you add this line, the user will be able to hold down the mouse wheel and then scroll in any direction in the scene.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adding_functionality_to_the_iconnodewidget"><a class="anchor" href="#_adding_functionality_to_the_iconnodewidget"></a>Adding Functionality to the IconNodeWidget</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Earlier we added  <code> <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/doc-files/documentation.html#MoveAction">MoveAction</a></code>  to the IconNodeWidget, to enable move behavior for the widget. In the same way, a lot of other behavior can be added to the widget. In this section, we add  <code> <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/doc-files/documentation.html#HoverAction">HoverAction</a></code> ,  <code> <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/doc-files/documentation.html#SelectAction">SelectAction</a></code> , and  <code> <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/doc-files/documentation.html#InplaceEditorAction">InplaceEditorAction</a></code> .</p>
</div>
<div class="paragraph">
<p>The  <code>InplaceEditorAction</code>  will let the user change the label:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/vislib_editable.png" alt="vislib editable">
</div>
</div>
<div class="paragraph">
<p>The  <code>SelectAction</code>  will change the color of the label when the widget is selected, while the  <code>HoverAction</code>  will change the color of the label when the mouse hovers over the widget:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/vislib_selectable-hoverable.png" alt="vislib selectable hoverable">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>First define the editor action that we will add to the IconNodeWidget:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private WidgetAction editorAction = ActionFactory.createInplaceEditorAction(new LabelTextFieldEditor());</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Now define the  <code>LabelTextFieldEditor</code> , as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private class LabelTextFieldEditor implements TextFieldInplaceEditor {

    public boolean isEnabled(Widget widget) {
        return true;
    }

    public String getText(Widget widget) {
        return ((LabelWidget) widget).getLabel();
    }

    public void setText(Widget widget, String text) {
        ((LabelWidget) widget).setLabel(text);
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Finally, assign the editor action to the IconNodeWidget, in the same way as done for the move action earlier:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">widget.getLabelWidget().getActions().addAction(editorAction);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, we first get the IconNodeWidget&#8217;s LabelWidget. Then we add the editor action to the LabelWidget.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>The IDE will prompt you to add several import statements. In each case, accept the suggestion offered by the IDE.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Next, in the case of  <code>SelectAction</code>  and  <code>HoverAction</code> , you need do nothing more than assign these actions to the IconNodeWidget:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">widget.getActions().addAction(createSelectAction());
widget.getActions().addAction(createObjectHoverAction());</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Next, you need to think about the order of the actions that you have created. For details, see the  <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/doc-files/documentation.html#OrderOfActions">Order of Actions</a> section in the documentation. After you have reordered the actions, the  <code>attachNodeWidget</code>  should look as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">protected Widget attachNodeWidget(MyNode node) {
    IconNodeWidget widget = new IconNodeWidget(this);
    widget.setImage(node.getImage());
    widget.setLabel(Long.toString(node.hashCode()));

    //double-click, the event is consumed while double-clicking only:
    widget.getLabelWidget().getActions().addAction(editorAction);

    //single-click, the event is not consumed:
    widget.getActions().addAction(createSelectAction());

    //mouse-dragged, the event is consumed while mouse is dragged:
    widget.getActions().addAction(ActionFactory.createMoveAction());

    //mouse-over, the event is consumed while the mouse is over the widget:
    widget.getActions().addAction(createObjectHoverAction());

    mainLayer.addChild(widget);
    return widget;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Install and try out the module again. As shown at the start of this section, when you hover over a widget&#8217;s label, or when you select it, its color will change. Also, when you click on a label, you are able to edit its content.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Congratulations, you have completed your first Visual Library scene.</p>
</div>
<div class="paragraph">
<p><a href="../../../../front/main/community/mailing-lists/" class="xref page">Send Us Your Feedback</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps"><a class="anchor" href="#_next_steps"></a>Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For more information on working with the Visual Library API, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#../projects/platform/graph/index.adoc" class="xref unresolved">Visual Library Project Page</a></p>
</li>
<li>
<p><a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-api-visual/org/netbeans/api/visual/widget/doc-files/documentation.html">Visual Library 2.0 - Documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
        <section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        <li><a href="https://github.com/apache/netbeans-antora-tutorials/edit/main/modules/ROOT/pages/tutorials/nbm-visual_library.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>
    </div>
        <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="../../../../_/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/about">About</a></h1>
            <ul>
              <li><a href="../../../../front/main/community/who">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/community">Community</a></h1>
            <ul>
              <li><a href="../../../../front/main/community/mailing-lists">Mailing lists</a></li>
              <li><a href="../../../../front/main/community/committer">Becoming a committer</a></li>
              <li><a href="../../../../front/main/community/events">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/participate">Participate</a></h1>
            <ul>
              <li><a href="../../../../front/main/participate/submit-pr">Submitting Pull Requests</a></li>
              <li><a href="../../../../front/main/participate/report-issue">Reporting Issues</a></li>
              <li><a href="../../../../front/main/participate/#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/help">Get Help</a></h1>
            <ul>
              <li><a href="../../../../front/main/help/#documentation">Documentation</a></li>
              <li><a href="../../../../wiki/main/wiki">Wiki</a></li>
              <li><a href="../../../../front/main/help/#support">Community Support</a></li>
              <li><a href="../../../../front/main/help/commercial-support">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/download">Download</a></h1>
            <ul>
              <li><a href="../../../../front/main/download">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="../../../../front/main/download/#_daily_builds_and_building_from_source">Building from source</a></li>
              <li><a href="../../../../front/main/download/#_older_releases">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
      </div>
    </div>

    
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
    <script src="../../../../_/js/vendor/jquery-3.7.1.min.js"></script>
    <script src="../../../../_/js/vendor/what-input.js"></script>
    <script src="../../../../_/js/vendor/foundation.min.js"></script>
    <script src="../../../../_/js/vendor/jquery.colorbox-min.js"></script>
    <script src="../../../../_/js/netbeans.js"></script>
    <script>
       $(function(){ $(document).foundation(); });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
      $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); });
    </script>
  </body>
</html>
