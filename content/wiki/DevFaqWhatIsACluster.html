

<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>What is a Cluster?</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Apache NetBeans wiki DevFaqWhatIsACluster">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans wiki DevFaqWhatIsACluster">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>

  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 19</h1>
            <p><a class="button success" href="/download/nb19/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content'>
      <h1 class="sect1">What is a Cluster?</h1>
      
      
<div class='aside' style='text-align: center; padding: 20px;'>
    <a href="/wiki/index.html" title="Apache NetBeans WIKI">Apache NetBeans Wiki Index</a>
    <p><b>Note:</b> These pages are being reviewed.</p>
</div>

      
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_suites_vs_clusters">Suites vs. Clusters</a></li>
<li><a href="#_why_have_clusters">Why Have Clusters?</a></li>
<li><a href="#_what_does_a_cluster_look_like">What Does A Cluster Look Like?</a>
<ul class="sectlevel2">
<li><a href="#_metadata">Metadata</a></li>
</ul>
</li>
<li><a href="#_clusters_and_compatibility">Clusters and Compatibility</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A cluster is a directory on disk.  A cluster contains <a href="DevFaqWhatIsAModule.html">modules</a>.  If you are writing a small NetBeans-based application, you probably do not need to be too concerned about clusters, although you may encounter the concept if you need to bundle additional files (native executables, for example) with a module.  Clusters become important if you are writing an extensible application (or multiple applications) of your own, where you are sharing some common modules between multiple applications.</p>
</div>
<div class="paragraph">
<p>The NetBeans launcher is passed a list of <em>cluster directories</em> on startup (see <code>$NB_HOME/etc/netbeans.clusters</code> in the IDE - the names in this file are relative paths from the IDE install directory - but they could also be absolute paths on disk).  The launcher looks for the modules (JAR files) which it should load in those &quot;cluster directories&quot;.  A NetBeans-based application typically consists of, at a minimum, the <code>platform</code> cluster and at least one application-specific cluster which contains modules that implement the business logic of that application.</p>
</div>
<div class="paragraph">
<p><em>Cluster directories are not necessarily all located under the same parent directory. They just happen to be in a typical NetBeans IDE install.</em></p>
</div>
<div class="paragraph">
<p>The NetBeans platform expects cluster directories to have a certain minimal structure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There will be a <code>modules/</code> subdirectory containing module JAR files</p>
</li>
<li>
<p>There will be a <code>config/Modules/</code> subdirectory containing XML files that describe if/when each module should be enabled</p>
</li>
<li>
<p>There will be an <code>update_tracking/</code> subdirectory which contains metadata that allows the module system to determine if another version of each module is newer than, older than, or the same as the one in this cluster, using dates and checksums</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A cluster may contain additional files and folders as needed.  For example, it is common for modules which bundle 3rd-party libraries to include those JAR files in <code>modules/ext/</code>.  A cluster can contain whatever other files a module needs at runtime - for example, a module that installs a mobile phone emulator would probably include the native emulator executable.</p>
</div>
<div class="paragraph">
<p>To include additional files in your cluster, simply create a directory <code>release/</code> underneath your module&#8217;s project directory (<em>not</em> the <code>src/</code> directory for your module, but its parent folder - the one that <em>is</em> your module project).  Anything under <code>$PROJECT/release/</code> will be copied into your cluster by the build process.  To find the file at runtime, use <a href="https://bits.netbeans.org/dev/javadoc/org-openide-modules/org/openide/modules/InstalledFileLocator.html">InstalledFileLocator</a>, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">File emulatorBinary = InstalledFileLocator.getDefault().locate(
  "phone/bin/emulator.exe", "com.foo.my.module.code.name", false);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_suites_vs_clusters">Suites vs. Clusters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <em>result of</em> compiling a module suite is typically a cluster. A cluster is something the runtime understands; a suite is a a project you develop.  For more information see <a href="DevFaqSuitesVsClusters.html">the suite-versus-cluster FAQ</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_have_clusters">Why Have Clusters?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here&#8217;s the history of clusters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Originally, NetBeans didn&#8217;t have "clusters"&#8201;&#8212;&#8201;there was just $NB_HOME/modules/, a bunch of JAR files, and some XML files saying what was enabled and what was not.  You looked up the installation directory using <code>System.getProperty(&quot;netbeans.home&quot;)</code></p>
</li>
<li>
<p>Modules are libraries - like any other library or DLL or <code>.so</code> used by applications - and it is normal for multiple applications to use the same copy of some library</p>
</li>
<li>
<p>Sun had a number of NetBeans-based applications. So might anyone creating a <a href="http://platform.netbeans.org">NetBeans Platform-based application</a>.  The platform is the same for all of them;  so are some other parts depending on what modules those applications use.</p>
</li>
<li>
<p>Some operating systems will <em>not allow</em> you to distribute native OS packages that will clutter up a user&#8217;s disk with extra copies of files the user already has.  The guidelines for Solaris, Debian, Ubuntu and other operating systems, all request or require that, if a library already exists on the target machine, you should use that library in-place, not install your own copy of it.  If we wanted Ubuntu and Debian users to be able to type <code>apt get netbeans</code>, we needed to solve this problem for the NetBeans IDE and other NetBeans-based applications.</p>
</li>
<li>
<p>The platform, and other parts of NetBeans therefore should be able to be shared among multiple applications and used by them at the same time.</p>
</li>
<li>
<p>Therefore, a NetBeans-based application should not assume that all of its parts ("clusters" of modules which interdepend) are underneath the same directory on disk&#8201;&#8212;&#8201;the platform might be in one directory, while the Java modules are someplace else entirely.</p>
</li>
<li>
<p>Before this, a typical way to find a file underneath a NetBeans install was new File(System.getProperty("netbeans.home")) to get the NB install directory;  then you could try to find a file somewhere under that directory.</p>
</li>
<li>
<p>If there is not necessarily an "install directory" at all, then you need something like <a href="https://bits.netbeans.org/dev/javadoc/org-openide-modules/org/openide/modules/InstalledFileLocator.html">InstalledFileLocator</a>, which knows about the cluster directories being used in the running application, and can look in all of them.  That is much cleaner than you having to write the code to figure out where all of those directories are and look in each one.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In short, while it is typical for all of the parts of an application to be under a common parent directory, that is neither required nor guaranteed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_does_a_cluster_look_like">What Does A Cluster Look Like?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here is the structure of the (comparatively small - it contains only one module) <code>ergonomics</code> cluster in a NetBeans 6.9 development build.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ergonomics/</strong> <em>The cluster directory</em></p>
<div class="ulist">
<ul>
<li>
<p>.lastModified <em>An empty file used as a timestamp so NetBeans can cache information about the cluster for performance, but know if its cache is out-of-date</em></p>
</li>
<li>
<p><strong>config/</strong> <em>Contains metadata about module state</em></p>
<div class="ulist">
<ul>
<li>
<p><strong>Modules/</strong> <em>Contains files which tell NetBeans some things about the module, mostly relating to if/when it should be enabled</em></p>
<div class="ulist">
<ul>
<li>
<p>org-netbeans-modules-ide-ergonomics.xml <em>Metadata about the Ergonomics module, whose code-name is org.netbeans.modules.ide.ergonomics</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>modules/</strong> <em>Directory that contains the actual (multiple) module JAR files and any 3rd-party libraries they include</em></p>
<div class="ulist">
<ul>
<li>
<p>org-netbeans-modules-ide-ergonomics.jar <em>This is the actual JAR file of the Ergonomics module&#8217;s classes</em></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>update_tracking/</strong> <em>Contains metadata about the module which is needed by Tools &gt; Plugins</em></p>
<div class="ulist">
<ul>
<li>
<p>org-netbeans-modules-ide-ergonomics.xml <em>Contains installation date, version and CRC checksums of module JAR and enablement data</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In a larger cluster, all of the child directories described above would contain one file for each module (i.e. module JAR file, etc.).</p>
</div>
<div class="sect2">
<h3 id="_metadata">Metadata</h3>
<div class="paragraph">
<p>The metadata in <code>$CLUSTER/config/Modules/$MODULE.xml</code> is fairly simple and straightforward - it enables the NetBeans module-system to determine when a module should be loaded:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE module PUBLIC "-//NetBeans//DTD Module Status 1.0//EN"
                        "<a href="http://www.netbeans.org/dtds/module-status-1_0.dtd">http://www.netbeans.org/dtds/module-status-1_0.dtd</a>"&gt;
&lt;module name="org.netbeans.modules.ide.ergonomics"&gt;
    &lt;param name="autoload"&gt;false&lt;/param&gt;
    &lt;param name="eager"&gt;false&lt;/param&gt;
    &lt;param name="enabled"&gt;true&lt;/param&gt;
    &lt;param name="jar"&gt;modules/org-netbeans-modules-ide-ergonomics.jar&lt;/param&gt;
    &lt;param name="reloadable"&gt;false&lt;/param&gt;
&lt;/module&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, the metadata in <code>$CLUSTER/update_tracking/$MODULE.xml</code> contains data about the module generated when it is installed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;module codename="org.netbeans.modules.ide.ergonomics"&gt;
    &lt;module_version install_time="1266357743218" last="true"
                    origin="installer" specification_version="1.7"&gt;
        &lt;file crc="3871934416"
              name="config/Modules/org-netbeans-modules-ide-ergonomics.xml"/&gt;
        &lt;file crc="1925067367"
              name="modules/org-netbeans-modules-ide-ergonomics.jar"/&gt;
    &lt;/module_version&gt;
&lt;/module&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This data allows the <strong>Tools &gt; Plugins</strong> updater functionality to determine if the version of the module on an update server is a newer version than the copy which the user has installed, so that it can decide if it should offer an update.  More importantly, since this is done with checksums, it can do this check without sending data about what is on the user&#8217;s machine to a remote server, users privacy is maintained.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_clusters_and_compatibility">Clusters and Compatibility</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <em>cluster</em> is a compatibility unit and has a version. It is set of modules that is developed by the same group of people, built and released at one time.</p>
</div>
<div class="paragraph">
<p>Most of the reasoning that lead to creation of the concept can be found in:
<a href="../projects/platform/articles/installation.html">Installation Structure</a></p>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/wiki/DevFaqWhatIsACluster.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
