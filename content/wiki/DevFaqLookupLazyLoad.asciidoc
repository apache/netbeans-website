

<!doctype html>
<html class="no-js" lang="en" dir="ltr">
    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>DevFaqLookupLazyLoad</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Apache NetBeans wiki DevFaqLookupLazyLoad">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans wiki DevFaqLookupLazyLoad">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet"> 
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
</head>


    <body>
        

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="/plugins/index.html">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


        
<!-- src/templates/news -->
<section class="hero news alternate" style='margin-bottom: 2em'>
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Just released!</div>
            <h1>Apache NetBeans 9.0 Beta</h1>
            <p><a class="button success" href="/download/nb90/nb90-beta.html">Read more</a></p>
        </div>
    </div>
</section>

        <div class='grid-container main-content'>
            
<div class='aside' style='text-align: center; padding: 20px;'>
    <a href="/wiki/index.asciidoc" title="Apache NetBeans WIKI">Apache NetBeans Wiki Index</a>
    <p><b>Note:</b> These pages are being reviewed.</p>
</div>

            <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel3">
<li><a href="#_how_do_i_lazy_load_an_item_in_the_lookup">How do I lazy-load an item in the Lookup?</a></li>
<li><a href="#_override_the_code_beforelookup_lookup_template_template_code_method">Override the <code>beforeLookup(Lookup.Template&lt;?&gt; template)</code> method</a></li>
<li><a href="#_use_code_instancecontent_convertor_code_to_create_a_placeholder_object">Use <code>InstanceContent.Convertor</code> to create a placeholder object</a></li>
<li><a href="#_code_that_creates_a_lookup_and_registers_the_instancecontent">Code that creates a Lookup and registers the InstanceContent:</a></li>
<li><a href="#_lifecycle_with_instancecontent_converter">Lifecycle With InstanceContent.Converter</a></li>
<li><a href="#_apache_migration_information">Apache Migration Information</a></li>
</ul>
</div>
<div class="sect3">
<h4 id="_how_do_i_lazy_load_an_item_in_the_lookup">How do I lazy-load an item in the Lookup?</h4>
<div class="paragraph">
<p>A node is typically used to represent some business object and it&#8217;s a common idiom to place that business object in the node&#8217;s lookup so that, for example, a context-sensitive action can operate on it.  Sometimes fully initializing that business object can involve an expensive operation that would be wasted effort if the user never invoked the action that used it anyway.</p>
</div>
<div class="paragraph">
<p>So how can you defer loading or initializing the business object until it is truly needed?</p>
</div>
<div class="paragraph">
<p>There are probably several ways, but two common ones are:</p>
</div>
</div>
<div class="sect3">
<h4 id="_override_the_code_beforelookup_lookup_template_template_code_method">Override the <code>beforeLookup(Lookup.Template&lt;?&gt; template)</code> method</h4>
<div class="paragraph">
<p>If you are using the <code>AbstractLookup</code> class to create the lookup, you can override the <code>beforeLookup(Lookup.Template&lt;?&gt; template)</code>.  By doing this, you will be notified just before a lookup query is processed and you could check to see if the template would match the objects for which you&#8217;ve deferred loading, giving you an opportunity to load them now and add them to the <code>InstanceContent</code> used by the <code>AbstractLookup</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_use_code_instancecontent_convertor_code_to_create_a_placeholder_object">Use <code>InstanceContent.Convertor</code> to create a placeholder object</h4>
<div class="paragraph">
<p>The <code>InstanceContent.Convertor</code> class can be registered in an <code>AbstractLookup</code> such that it provides a typesafe placeholder until the actual object type is requested, and at that point, the convertor can create and return the actual object.</p>
</div>
<div class="paragraph">
<p>Consider the following example in which you have a <code>Token</code> class which represents a database record ID and a business object class <code>AnExpensiveClass</code> which will be populated from the database based on the supplied token&#8217;s ID.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public final class Token {

    private final long id;

    public Token(long id) {
        this.id = id;
    }

    public long getId() {
       return id;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we will write a converter.  Until the first time something calls <code>theLookup.lookup(AnExpensiveClass.class)</code>, only our quick-to-create <code>Token</code> object is in memory.  On the first such lookup call, the following code is run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class LazyLoadingDelegate implements InstanceContent.Convertor&lt;Token, AnExpensiveClass&gt; {

    @Override
    public AnExpensiveClass convert(Token token) {
        // Return an instance based on the supplied token (i.e. assume that
        // the AnExpensiveClass constructor will load data from the database
        // and populate the instance we're returning).
        return new AnExpensiveClass(token);
    }

    @Override
    public Class&lt;? extends AnExpensiveClass&gt; type(Token token) {
        return AnExpensiveClass.class;
    }

    @Override
    public String id(Token token) {
        return String.valueOf(token.getId());
    }

    @Override
    public String displayName(Token token) {
        return "my lazy loading delegate";
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_code_that_creates_a_lookup_and_registers_the_instancecontent">Code that creates a Lookup and registers the InstanceContent:</h4>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">    ic = new InstanceContent();
    al = new AbstractLookup(ic);

    Token token = new Token(12345);
    ic.add(token, new LazyLoadingDelegate());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your <a href="http://bits.netbeans.org/dev/javadoc/org-openide-awt/org/openide/awt/Actions.html#context">context-sensitive action</a> will behave normally&mdash;it does not need to know about the lazy loading (code not relevant to lazy loading has been removed for the sake of brevity):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public final class ExpensiveClassAction implements ActionListener {
    private final AnExpensiveClass expensiveClass;
    public ExpensiveClassAction(AnExpensiveClass a) {
      this.expensiveClass = a;
    }

    public void actionPerformed(ActionEvent ev) {
        // now you have the actual do AnExpensiveClass instance,
        // in variable expensiveClass
        // so do something with it...
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lifecycle_with_instancecontent_converter">Lifecycle With InstanceContent.Converter</h4>
<div class="paragraph">
<p>Objects created using an InstanceContent.Converter are only weakly cached by default.  That means that, after AnExpensiveClass is instantiated, it can be garbage collected if no object holds a reference to it in a field.  If the object is going to be queried for repeatedly, you may want your InstanceContent.Converter to cache the last-created value, either for some period of time, or using a SoftReference or hard reference or other caching strategy.</p>
</div>
</div>
<div class="sect2">
<h3 id="_apache_migration_information">Apache Migration Information</h3>
<div class="paragraph">
<p>The content in this page was kindly donated by Oracle Corp. to the
Apache Software Foundation.</p>
</div>
<div class="paragraph">
<p>This page was exported from <a href="http://wiki.netbeans.org/DevFaqLookupLazyLoad">http://wiki.netbeans.org/DevFaqLookupLazyLoad</a> ,
that was last modified by NetBeans user Jtulach
on 2010-07-24T20:19:40Z.</p>
</div>
<div class="paragraph">
<p><strong>NOTE:</strong> This document was automatically converted to the AsciiDoc format on 2018-02-07, and needs to be reviewed.</p>
</div>
</div>
            
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/incubator-netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://netbeans.signup.team/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="JIRA" href="https://issues.apache.org/jira/projects/NETBEANS/summary"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/incubator-netbeans-website/blob/master/netbeans.apache.org/src/content/wiki/DevFaqLookupLazyLoad.asciidoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in github.</a></li>
    </ul>
</section>

        </div>
        

<div class='grid-container incubator-area'>
    <div class='grid-x grid-padding-x'>
        <div class='large-auto cell'>
        </div>
    </div>
</div>
<footer>
    <div class="grid-container">
        <div class="grid-x grid-padding-x">
            <div class="large-auto cell">
                
                <h1>About</h1>
                <ul>
                    <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                    <li><a href="http://www.apache.org/security/">Security</a></li>
                    <li><a href="http://incubator.apache.org/projects/netbeans.html">Incubation Status</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/community/index.html">Community</a></h1>
                <ul>
                    <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
                    <li><a href="/community/committer.html">Becoming a commiter</a></li>
                    <li><a href="/community/events.html">NetBeans Events</a></li>
                    <li><a href="/community/who.html">Who is who</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/participate/index.html">Participate</a></h1>
                <ul>
                    <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
                    <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
                    <li><a href="/participate/netcat.html">NetCAT - Community Acceptance Testing</a></li>
                    <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/help/index.html">Get Help</a></h1>
                <ul>
                    <li><a href="/help/index.html#documentation">Documentation</a></li>
                    <li><a href="/wiki/index.asciidoc">Wiki</a></li>
                    <li><a href="/help/index.html#support">Community Support</a></li>
                    <li><a href="/help/commercial-support.html">Commercial Support</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/download/index.html">Download</a></h1>
                <ul>
                    <li><a href="/download/index.html#releases">Releases</a></li>
                    <ul>
                        <li><a href="/download/nb90/index.html">Apache NetBeans 9.0 (beta)</a></li>
                    </ul>
                    <li><a href="/plugins/index.html">Plugins</a></li>
                    <li><a href="/download/index.html#source">Building from source</a></li>
                    <li><a href="/download/index.html#previous">Previous releases</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<div class='footer-disclaimer'>
    <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2018 the <a href="//www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the <a href="//www.apache.org/licenses/">Apache Software License, version 2.0.</a></p>
        <p><a href="https://incubator.apache.org/" alt="Apache Incubator"><img src='/images/incubator_feather_egg_logo_bw_crop.png' title='Apache Incubator'></img></a></p>
        <div style='max-width: 40em; margin: 0 auto'>
            <p>Apache NetBeans is an effort undergoing incubation at The Apache Software Foundation</a> (ASF).</p>
            <p>Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner
            consistent with other successful ASF projects.</p>
            <p>While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the Apache Software Foundation.</p>
            <p>Apache Incubator, Apache, the Apache feather logo, and the Apache Incubator project logo are trademarks of <a href="//www.apache.org">The Apache Software Foundation</a>.</p>
            <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
        </div>
        
    </div>
</div>


        <script src="/js/vendor/jquery-3.2.1.min.js"></script>
        <script src="/js/vendor/what-input.js"></script>
        <script src="/js/vendor/foundation.min.js"></script>
        <script src="/js/netbeans.js"></script>
        <script src="/js/vendor/jquery.colorbox-min.js"></script>
        <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
        <script>
            
            $(function(){ $(document).foundation(); });
        </script>
    </body>
</html>
