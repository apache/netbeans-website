

<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>NetBeans 4.x Project &amp; Build System How-To</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NetBeans 4.x Project &amp; Build System How-To">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="null">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>

  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content'>
      
<div class='aside' style='text-align: center; padding: 20px;'>
    <a href="/wiki/index.adoc" title="Apache NetBeans WIKI">Apache NetBeans Wiki Index</a>
    <p><b>Note:</b> These pages are being reviewed.</p>
</div>

      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#Overview">Overview</a></li>
<li><a href="#How_to_Write_a_Project_Type_.28Generally.29">How to Write a Project Type (Generally)</a>
<ul class="sectlevel2">
<li><a href="#Decide_on_a_Project_Layout">Decide on a Project Layout</a></li>
<li><a href="#Write_the_Project_Object">Write the Project Object</a></li>
<li><a href="#What_to_Put_in_Lookup">What to Put in Lookup</a></li>
<li><a href="#General_Appearance">General Appearance</a></li>
<li><a href="#File_Structure_and_Templates">File Structure and Templates</a></li>
<li><a href="#Building_and_Other_Actions">Building and Other Actions</a></li>
<li><a href="#Java-Specific_Behavior">Java-Specific Behavior</a></li>
<li><a href="#Project_Dependencies">Project Dependencies</a></li>
<li><a href="#Miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li><a href="#How_to_Write_an_Ant-Based_Project_Type">How to Write an Ant-Based Project Type</a>
<ul class="sectlevel2">
<li><a href="#Deciding_on_a_Source_Layout">Deciding on a Source Layout</a></li>
<li><a href="#Writing_a_Prototypical_Build_Script">Writing a Prototypical Build Script</a></li>
<li><a href="#Parametrizing_Build_Scripts">Parametrizing Build Scripts</a></li>
<li><a href="#Writing_Stylesheets">Writing Stylesheets</a></li>
<li><a href="#Writing_the_Project_Type_Skeleton">Writing the Project Type Skeleton</a></li>
<li><a href="#Handling_Build_Script_.28Re-.29generation">Handling Build Script (Re-)generation</a></li>
<li><a href="#Populating_the_Project_Lookup">Populating the Project Lookup</a></li>
</ul>
</li>
<li><a href="#Creating_a_Properties_Dialog">Creating a Properties Dialog</a></li>
<li><a href="#Handling_Upgrades">Handling Upgrades</a></li>
<li><a href="#How_to_Use_Project-Related_APIs_from_Other_Modules">How to Use Project-Related APIs from Other Modules</a></li>
<li><a href="#Some_Interesting_Things_which_are_Impossible">Some Interesting Things which are Impossible</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="Overview">Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide should give developers of NetBeans modules (extensions) a basic idea
of how to write new project types for NetBeans 4.x, as well as use certain
importants parts of the project and build system functionality from other kinds
of modules.</p>
</div>
<div class="paragraph">
<p>The reader is assumed to be familiar with the basics of developing NetBeans
modules: how to compile Java sources against API-providing modules, make the
JAR, write the manifest and XML layer, register services in global lookup, etc.</p>
</div>
<div class="paragraph">
<p>For background, the reader is encouraged to first look at the [design.html
general design document] which explains how the different pieces of the
architecture work together to provide the user functionality.</p>
</div>
<div class="paragraph">
<p>Quick architectural summary:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The NetBeans IDE (starting with version 4.0) organizes user work into projects. Each project corresponds to exactly one project folder on disk. (A given disk folder may be a project folder or not; you cannot have two projects in one folder.)</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A project owns all files inside its project folder or subfolders (except when a subfolder is itself another project folder, which is allowed); it might also own files located elsewhere on disk, to permit a user to keep IDE-specific configuration separate from existing “pristine” sources.</p>
</li>
<li>
<p>There are different types of projects available, according to what modules you have installed. Different project types may behave very differently, or look almost alike, depending on their intent.</p>
</li>
<li>
<p>A project defines what appears beneath its node in the <strong>Projects</strong> tab—sometimes called its logical view. It can also define a customizer action, usually opening a properties dialog.</p>
</li>
<li>
<p>A project can be opened or closed via the GUI. It can also be loaded though not open; an open project is however always loaded. A project can be garbage collected if it is closed; attempting to refer to it again (via its project directory) will automatically load it again.</p>
</li>
<li>
<p>A project may list subprojects, other projects it somehow depends on. This is used mainly when opening a project using the <strong>Open Project</strong> action.</p>
</li>
<li>
<p>The IDE defines certain generic actions such as <strong>Build</strong> which can be invoked on a project, which have corresponding commands, simple strings like <code>build</code>. Some actions can be sensitive to the selected file. Often Apache Ant is used as a build tool to produce a final program or other delierable from sources, but this is not required.</p>
</li>
<li>
<p>Interaction between project implementations and other functionality in the IDE is normally done using queries, a pattern whereby a client can ask a concrete question (e.g. ClassPath.getClassPath(someJavaFile, ClassPath.COMPILE)) and possibly receive an answer; query implementations are registered (using <code>Lookup.default</code>) by any modules, and asked in turn. For queries mentioned here, usually the query implementation may be registered in the project (using <code>Project.lookup</code>) rather than globally, and the project associated with the file mentioned in the question (e.g. FileOwnerQuery.getOwner(someJavaFile) in the last example) will be asked to provide an answer.</p>
</li>
<li>
<p>Though project type providers are allowed a great deal of leeway in how they implement the project SPIs, there is a fairly extensive SPI support suite which assumes that the project uses Ant as a build tool, and defines a number of convenience implementations optimized towards this system.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
all API classes and interfaces are referred to by simple name. You can look up the Javadoc for any of these classes quickly using the <a href="https://bits.netbeans.org/dev/javadocallclasses.html">master class index</a> for the NetBeans APIs.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="How_to_Write_a_Project_Type_.28Generally.29">How to Write a Project Type (Generally)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section discusses general things you need to do in order to write a new project type. Later on we will discuss more concrete suggestions for Ant-based projects using the standard infrastructure.</p>
</div>
<div class="paragraph">
<p>Generally a project type should be contained in a module dedicated to implementing that project type. <em>Do not expose any APIs from this module.</em> If other modules need special information about your project’s structure not available through the existing APIs, you can define new APIs <em>in separate API modules</em> that both the clients and your project type depend on. This rule helps enforce a clean architecture on the system and ensures that other project types could mimic some of the behavior of your project type if they needed to.</p>
</div>
<div class="paragraph">
<p>An interesting tutorial on writing a (non-Ant-based) project type from scratch is available: <a href="http://openide.netbeans.org/povraytutorial/">Tim Boudreau’s POV-Ray tutorial</a></p>
</div>
<div class="sect2">
<h3 id="Decide_on_a_Project_Layout">Decide on a Project Layout</h3>
<div class="paragraph">
<p>The first step for any kind of project type is to decide what the project will look like! You should have a clear idea of what files will reside in the project directory (or perhaps externally), using what file names, what the contents should be, what files will be updated by the IDE’s GUI, what by text editing, how future updates will affect file formats, etc.</p>
</div>
<div class="paragraph">
<p>If you use the standard Ant-based infrastructure (below), some of these decisions are made for you.</p>
</div>
<div class="paragraph">
<p>Most project types will define an <code>AntBasedProjectType</code> and keep basic project metadata in <code>''$projdir''/nbproject/project.xml</code> (below). If you do not do this, e.g. if you need to support a third-party project layout (such as Apache Maven uses), then you will need to implement <code>ProjectFactory</code> yourself to recognize and load projects using your format. A project factory should be designed to be able to quickly reject candidate directories which are <em>not</em> in your layout. (Positive identification of your projects can be a little slower.)</p>
</div>
</div>
<div class="sect2">
<h3 id="Write_the_Project_Object">Write the Project Object</h3>
<div class="paragraph">
<p>Every project is represented by a <code>Project</code> object, which is created by your factory. Its only mandatory behavior is to be able to report the project directory it is associated with. Other than that, all of its behavior is controlled by its <code>Lookup</code>, basically a bag of optional capabilities. Usually <code>org.openide.util.lookup.Lookups</code> can be used to make a <code>Lookup</code> with a fixed list of entries.</p>
</div>
<div class="paragraph">
<p><em>All outside code</em> should interact with your project via interfaces found in its lookup. Outside code can check to see if a given project has a capability, and if so, use it. <em>Never make your <code>Project</code> implementation class publicly accessible.</em> Whatever capabilities you wish to expose, do so from the lookup—you can define additional interfaces to expose to clients (public or semi-public, in API-exposing modules) and add implementations to your lookup (in non-public classes in your project type module) if you need to. Beware that the project infrastructure reserves the right to hide the original <code>Project</code> your factory creates and expose only a wrapper to outside callers, so it would never be correct to try to cast a <code>Project</code> object to an implementation class, even if you could access that implementation class.</p>
</div>
</div>
<div class="sect2">
<h3 id="What_to_Put_in_Lookup">What to Put in Lookup</h3>
<div class="paragraph">
<p>Since all the project’s behavior is controlled by its lookup, the question becomes: what interfaces should I implement? There is a suggested list in the Javadoc for <code>Project.getLookup()</code>. Here is an overview of major kinds of interfaces and why you might need them.</p>
</div>
</div>
<div class="sect2">
<h3 id="General_Appearance">General Appearance</h3>
<div class="paragraph">
<p>Almost all project types will want to define their general appearance and behavior in the IDE’s GUI.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ProjectInformation</code></dt>
<dd>
<p>Lets you control the display name and icon of the project. Typically all projects of a given type will share an icon, but there may be badging etc. applied as well, and it is possible to have basically different icons depending on project metadata.</p>
</dd>
<dt class="hdlist1"><code>LogicalViewProvider</code></dt>
<dd>
<p>Controls the display in the <strong>Projects</strong> tab. You can show whatever subnodes you like, according to the project’s semantics. Typically you will show important source roots (try <code>PackageView</code> in the case of Java package roots), or important files. You can also show nodes which do not directly correspond to individual files—e.g. an EJB project shows EJB and web services nodes which are derived from combinations of source files and deployment descriptor information.The root node for the project should usually have a name and icon matching that given in <code>ProjectInformation</code>. The precise context menu will vary by project type, so look at existing project types to keep consistency. Many of these items can be created easily using <code>CommonProjectActions</code> and <code>ProjectSensitiveActions</code>.Remember that you need to include the <code>Project</code> in the lookup of the root node, or project-sensitive actions will not generally work.Note: the <strong>Files</strong> tab is not under a project’s direct control. It always shows top-level “generic” source groups (acc. to <code>Sources</code>—see below) from the project as top-level nodes, beneath which there is a plain directory tree (filtered according to <code>VisibilityQuery</code>). In most cases there is one node per project—the project directory—but projects using external source roots may display additional nodes.</p>
</dd>
<dt class="hdlist1"><code>CustomizerProvider</code></dt>
<dd>
<p>Implements the <strong>Project Properties</strong> action in the <strong>File</strong> menu (also <code>CommonProjectAction.customizeProjectAction</code>). Usually this action should open a dialog containing general GUI configuration for the project, according to its needs. Of course the project may expose additional UI for customization, if appropriate, using context menu items on the project node, subnodes in the logical view, etc.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="File_Structure_and_Templates">File Structure and Templates</h3>
<div class="paragraph">
<p>Most project types will wish to define some aspects of how their source directories are laid out, what they contain, and what may be added to them.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>Sources</code></dt>
<dd>
<p>Basic information about what directories are contained in the project. Technically optional—the default assumption is that the project contains just an untyped project directory—but recommended.Generic source roots refer to top-level directories containing project files. The contents of the <strong>Files</strong> tab is determined by these.Typed source roots refer to particular directories (which should be inside, or equal to, some generic source root) used for particular purposes. For example, roots of type <code>JavaProjectConstants.SOURCES_TYPE_JAVA</code> refer to Java package roots. Some templates need to be placed in source roots of a certain type; for example, the wizard for adding a Java source file requires a source root of type <code>SOURCES_TYPE_JAVA</code>.</p>
</dd>
<dt class="hdlist1"><code>SharabilityQueryImplementation</code></dt>
<dd>
<p>Optionally lets the project declare that certain folders (or, perhaps, files) are not intended for sharing with other users, typically in a version control system. If your project type defines a build folder, or a folder containing private data (such as file paths on the developer’s local disk), marked in unsharable. The IDE’s VCS integration can use this information to avoid trying to commit such folders to VCS. Other IDE features may use this information too, for example to avoid searching in build folders.</p>
</dd>
<dt class="hdlist1"><code>RecommendedTemplates</code></dt>
<dd>
<p>Optionally define categories of file templates that this project type should allow to be added. For example, a J2ME-oriented project type would probably want to exclude Swing forms and servlets, but permit MIDlets.</p>
</dd>
<dt class="hdlist1"><code>PrivilegedTemplates</code></dt>
<dd>
<p>Defines a set of specific templates that are likely to be important to users of the project type. Used to create the default <strong>New</strong> submenu in the project’s context menu.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="Building_and_Other_Actions">Building and Other Actions</h3>
<div class="paragraph">
<p>Most project types will have some kind of actions which can be performed on the project: build it, run some program it represents, etc.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ActionProvider</code></dt>
<dd>
<p>A simple interface used to specify how certain “standard”
actions like <strong>Build</strong> should behave when applied to your project (e.g. from the
IDE’s toolbar). Such actions might run an Ant target, for example.Note that you
do not need to include mappings in <code>ActionProvider</code> which will be used only
from GUI your module provides itself. For example, you can add context menu
items to your project’s node that perform additional actions without going
through <code>ActionProvider.</code> This interface exists to permit GUI coöperation</p>
</dd>
<dt class="hdlist1">between your project and the rest of the IDE.  <code>FileBuiltQueryImplementation</code></dt>
<dd>
<p>If some files have a source representation and can be somehow processed
individually into “built” or “compiled” versions, you want to add a
<code>FileBuiltQueryImplementation</code> to represent this fact. Currently only <code>*.java</code>
files make use of <code>FileBuiltQuery</code>, to show an out-of-date badge, though nodes
for other file types could be extended to do so in the future as well.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="Java-Specific_Behavior">Java-Specific Behavior</h3>
<div class="paragraph">
<p>Several queries are used to permit integration of various Java editing and browsing features in the IDE with the project system. Any projects which deal with Java sources should try to implement these queries.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ClassPathProvider</code></dt>
<dd>
<p>Important query used to specify the class path used for a Java file or source root. Without this query, much important functionality will be broken, e.g. completion in the source editor and refactoring. See its Javadoc for details on usage.</p>
</dd>
<dt class="hdlist1"><code>SourceLevelQueryImplementation</code></dt>
<dd>
<p>Also important—instructs the editor, parser, and other IDE components what Java source level to use for a file. For example, assertions will only be recognized if the level is at least <code>1.4</code>, and generics only if at least <code>1.5</code>.</p>
</dd>
<dt class="hdlist1"><code>SourceForBinaryQueryImplementation</code></dt>
<dd>
<p>Also an important query, as it is needed for source stepping when debugging, interproject dependencies, and other purposes. If your project’s Java sources are ever compiled to some build directory, and perhaps packed into JARs after that, you must implement this query in order for other parts of the IDE to understand where to find sources corresponding to the build product.</p>
</dd>
<dt class="hdlist1"><code>JavadocForBinaryQueryImplementation</code></dt>
<dd>
<p>Important if you ever produce or bundle Javadoc in your project. This query enables Javadoc search to work correctly when someone is depending on classes from your project.</p>
</dd>
<dt class="hdlist1"><code>UnitTestForSourceQueryImplementation</code></dt>
<dd>
<p>Helpful to implement in case you have unit tests in your project (typically in JUnit format). The JUnit support module will then be able to properly configure some wizards and actions.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="Project_Dependencies">Project Dependencies</h3>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>SubprojectProvider</code></dt>
<dd>
<p>If you have a formal way of representing “subprojects” of your project—which might be projects physically packaged into your project, or located inside it on disk, or just used by it at build time, etc.—you can enumerate them with this interface. This is optional and is currently only used for the subproject list in the <strong>Open Project</strong> dialog (subprojects may be opened automatically) and for <code>CommonProjectActions.openSubprojectsAction</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="Miscellaneous">Miscellaneous</h3>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ProjectOpenedHook</code></dt>
<dd>
<p>You can perform various kinds of special actions when your project is being opened or closed <em>in the GUI</em>. Remember that your project can be loaded in memory without being open, and is expected to function reasonably anyway. The Javadoc mentions various typical actions you might perform here.</p>
</dd>
<dt class="hdlist1"><code>AuxiliaryConfiguration</code></dt>
<dd>
<p>Strongly recommended to implement if possible. Permits foreign code to store extra metadata inside your project, in XML format. Used for example to store files open in the editor from a project, and editor bookmarks.</p>
</dd>
<dt class="hdlist1"><code>CacheDirectoryProvider</code></dt>
<dd>
<p>Also recommended to implement though not yet in use. Permits foreign code to store cache files associated with your project.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="How_to_Write_an_Ant-Based_Project_Type">How to Write an Ant-Based Project Type</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While a project can be written directly to the bare SPIs such as <code>ProjectFactory</code> and various interfaces (such as <code>SubprojectsProvider</code>) placed into project lookup, you may wish to reuse the basic Ant-based project infrastructure used by most IDE project types. This support SPI conveys several major benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You do not need your own <code>ProjectFactory</code>; any folder containing a file <code>nbproject/project.xml</code> containing a project type identifier you choose will be recognized as yours. The project load and save cycle is managed for you.</p>
</li>
<li>
<p>There is support for storing project metadata in structured ways, such as in <code>nbproject/project.xml</code> or <code>nbproject/project.properties</code>. For properties-based storage it is possible to load and evaluate multiple properties files in a rich way, and listen to dynamic changes in properties-based configuration.</p>
</li>
<li>
<p>There is direct support for managing Ant builds (of course). You can have build script(s) generated based on <code>project.xml</code> and an XSLT stylesheet you provide. This is usually used to make an <code>nbproject/build-impl.xml</code> file containing default build steps and imported from an editable <code>build.xml</code>.</p>
</li>
<li>
<p>There are default implementations of various queries and other interfaces needed for your lookup, such as <code>Sources</code>, loading configuration from properties files (shared by the Ant script) where appropriate.</p>
</li>
<li>
<p>It is possible to manage references to files (such as libraries) or other projects in a structured way, with a predefined storage format, automatic synchronization to properties files, enumeration of subprojects, and a default GUI for resolving broken references.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following sections describe what steps you need to take in order to write an Ant-based project type, in addition to or instead of steps taken for general project types.</p>
</div>
<div class="paragraph">
<p>For a complete example of an Ant-based project type you may wish to look at the implementation of the “general Java project” type, located in netbeans.org CVS under <code>java/j2seproject/</code> (<a href="http://www.netbeans.org/source/browse/java/j2seproject/">browse online</a>).</p>
</div>
<div class="sect2">
<h3 id="Deciding_on_a_Source_Layout">Deciding on a Source Layout</h3>
<div class="paragraph">
<p>Ant-based projects always have an <code>nbproject</code> subdirectory in the project directory with a file <code>nbproject/project.xml</code> which identifies the project and can contain some metadata. Typically there are several other files in standard locations. See the [design.html#project-layout design document] for an overview of the general Ant-based project layout if you are not yet familiar with it, and study some actual project in the IDE such as a plain Java library project.</p>
</div>
<div class="paragraph">
<p>Now think about layout details specific to your project type. Perhaps you want to add another properties file for some unforeseen reason; this is up to you (almost all of the Ant-based project infrastructure classes will work happily with such a setup, except perhaps for <code>ReferenceHelper</code>, described below). Certainly you will want to decide what kinds of source files reside where and in what structure. For example, for a plain Java project, the specifics of the structure are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>main Java sources in <code>${src.dir}</code>, default <code>${basedir}/src</code> or an external root; may be more than one such source directory</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>(optional) unit test sources in <code>${test.src.dir}</code>, default <code>${basedir}/test</code> or an external root; again, may be more than one such directory</p>
</li>
<li>
<p>(optional) JAR manifest in <code>${manifest.file}</code>, default <code>${basedir}/manifest.mf</code></p>
</li>
<li>
<p><code>${build.dir}</code> (default <code>${basedir}/build</code>) holds various transient build products (e.g. compiled classes not yet packed into a JAR)</p>
</li>
<li>
<p><code>${dist.dir}</code> (default <code>${basedir}/dist</code>) holds the finished JAR as well as any generated Javadoc. Furthermore, you need to decide what project metadata you will store. This includes the structure of <code>project.xml</code> (and perhaps <code>private.xml</code> if you need to use it for anything), as well as a list of recognized keys and their semantics for <code>project.properties</code> and/or <code>private.properties</code>. For example, for a plain Java project, <code>project.xml</code> can specify:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>the project name</p>
</li>
<li>
<p>a list of source roots (giving in each case the name of the Ant property specifying its actual location)</p>
</li>
<li>
<p>the minimum Ant version needed to build (probably <code>1.6</code>)</p>
</li>
<li>
<p>(optional) an explicit platform marker indicating that the build should refer to a particular JDK</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>These decisions are codified in an XML schema for the <code>project.xml</code> file (<a href="http://www.netbeans.org/ns/j2se-project/2.xsd">example</a>). Currently the schema is not used for runtime validation, but that is expected to change; in the meantime, you are strongly recommended to define a schema to make sure you have clearly defined what can and cannot be stored in <code>project.xml</code>.</p>
</div>
<div class="paragraph">
<p>Your project type does not directly control the whole <code>project.xml</code> file. Rather, the Ant-based infrastructure will manage loading, parsing, and saving it, using APIs to be described below; and you only control one section of it, called the primary configuration data. You need to select an XML element name and namespace that will identify this block. For example, general Java projects use an element <code>&lt;data xmlns="<a href="http://www.netbeans.org/ns/j2se-project/2">http://www.netbeans.org/ns/j2se-project/2</a>"&gt;</code>. The target namespace for your XML schema should be this namespace: your schema will validate this block only, not the complete file.</p>
</div>
<div class="paragraph">
<p>You also need to define a primary configuration data block name for <code>private.xml</code> in the <code>nbproject/private/</code> folder, whether or not you plan to write anything to this file. For example, general Java projects use <code>&lt;data xmlns="<a href="http://www.netbeans.org/ns/j2se-project-private/1">http://www.netbeans.org/ns/j2se-project-private/1</a>"&gt;</code>. You can just define an empty schema for this block that allows no content (<a href="http://www.netbeans.org/ns/j2se-project-private/1.xsd">example</a>), or you can store real information here—some information about the project that should not be shared with other users and is not easily kept in properties files.</p>
</div>
<div class="paragraph">
<p>Also related to <code>project.xml</code>, you need to pick a project type identifier. This is just a short string—it could be the code name base of your module—which uniquely identifies your project type. This will be stored in the <code>&lt;type&gt;</code> element at the top of <code>project.xml</code>.</p>
</div>
<div class="paragraph">
<p>A Java project can likewise use a number of different Ant properties, such as <code>src.dir</code>, <code>main.class</code>, <code>javac.classpath</code>, <code>run.jvmargs</code>, etc. <strong>(XXX link to spec when available)</strong> You will need to decide what properties your project type will recognize and what the values should mean, while working on the build script (below).</p>
</div>
</div>
<div class="sect2">
<h3 id="Writing_a_Prototypical_Build_Script">Writing a Prototypical Build Script</h3>
<div class="paragraph">
<p>Make a prototype of a real project—it does not need to be loadable by the IDE as a project yet, just have realistic source files and be buildable by Ant (either from the command line or through the IDE using e.g. the <strong>Favorites</strong> node). Write an empty <code>build.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;project name="x" default="choose-something" basedir="."&gt;
    &lt;import file="nbproject/build-impl.xml"/&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>And write an <code>nbproject/build-impl.xml</code> that does the various build steps you would like the project to do. Generally it should load some properties files first, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;project name="x-impl" basedir=".."&gt; &lt;!-- note basedir is project directory --&gt;
    &lt;target name="-pre-init"&gt;&lt;!-- placeholder --&gt;&lt;/target&gt;
    &lt;target name="-init-private" depends="-pre-init"&gt;
        &lt;property file="nbproject/private/private.properties"/&gt;
    &lt;/target&gt;
    &lt;target name="-init-user" depends="-init-private"&gt;
        &lt;property file="${user.properties.file}"/&gt;
    &lt;/target&gt;
    &lt;target name="-init-project" depends="-init-user"&gt;
        &lt;property file="nbproject/project.properties"/&gt;
    &lt;/target&gt;
    &lt;target name="-init" depends="-init-project"&gt;
        &lt;!-- maybe some other stuff... --&gt;
    &lt;/target&gt;
    &lt;!-- now normal targets... --&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that it is conventional to begin the names of “internal” targets that should not be run directly (only as dependencies) with a hyphen (-).</p>
</div>
<div class="paragraph">
<p>Think about which targets the user should override in <code>build.xml</code> for what purpose. It is nice to put in “placeholder” targets which by default do nothing but which can easily be overridden to insert some custom steps at a certain point in the build.</p>
</div>
<div class="sect3">
<h4 id="Selecting_Ant_Tasks">Selecting Ant Tasks</h4>
<div class="paragraph">
<p>Which Ant tasks are available to you? Naturally you are free to use any standard Ant task which comes with the Ant distribution and does not require a special library to run. (Make sure you decide which version of Ant your scripts will require at a minimum—generally this will be the version currently shipped with the IDE. Later versions should work as well.) However some other tasks may require a bit of special setup. In particular:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Bundled optional tasks requiring special libraries</dt>
<dd>
<p>Some tasks come with Ant but require a special library in order to run. In the current design of Ant, these can only be run if the IDE includes the library directly in Ant’s main classpath. For example, the <code>&lt;junit&gt;</code> task runs inside the IDE without any user setup because the <code>org.netbeans.modules.junit</code> module requests that <code>junit.jar</code> be added to Ant’s classpath. Other modules may request such classpath additions by implementing <code>AutomaticExtraClasspathProvider</code>.</p>
</dd>
<dt class="hdlist1">Non-bundled custom tasks</dt>
<dd>
<p>You may wish to have your project’s build script run some Ant tasks which do not ship with Ant. (Do so only when really required, because it is annoying to users to have their build infrastructure depend on special things.) Some module (perhaps your project type module, perhaps not) must supply the task definition JAR(s):</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure the task JAR, as well as any special libraries it may need, is installed in the IDE distribution by including it in the module’s NBM file.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define a project library of type <code>j2se</code> and place it in the <code>org-netbeans-api-project-libraries/Libraries/</code> folder of your module XML layer. Example definition (see the Project Libraries API for more details):</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE library PUBLIC
          "-//NetBeans//DTD Library Declaration 1.0//EN"
          "<a href="http://www.netbeans.org/dtds/library-declaration-1_0.dtd">http://www.netbeans.org/dtds/library-declaration-1_0.dtd</a>"&gt;
&lt;library version="1.0"&gt;
    &lt;name&gt;mytasks&lt;/name&gt;
    &lt;type&gt;j2se&lt;/type&gt;
    &lt;localizing-bundle&gt;org.netbeans.modules.thismodule.Bundle&lt;/localizing-bundle&gt;
    &lt;volume&gt;
        &lt;type&gt;classpath&lt;/type&gt;
        &lt;resource&gt;jar:nbinst://org.my.module.name/ant/extra/mytasks-1.2.3.jar!/&lt;/resource&gt;
    &lt;/volume&gt;
&lt;/library&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Now <code>build.properties</code> in the user directory will be populated with the actual path to the library, so you can use it in your build script:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;target name="-init-taskdefs" depends="-init"&gt;
    &lt;!-- Assumes 1.6-style antlib is present: --&gt;
    &lt;taskdef resource="org/netbeans/mytasks/antlib.xml" uri="antlib:org.netbeans.mytasks"&gt;
        &lt;classpath&gt;
            &lt;pathelement path="${libs.mytasks.classpath}"/&gt;
        &lt;/classpath&gt;
    &lt;/taskdef&gt;
&lt;/target&gt;
&lt;target name="use-taskdefs" depends="-init-taskdefs"&gt;
    &lt;mytask xmlns="antlib:org.netbeans.mytasks" someattr="true"/&gt;
&lt;/target&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You could also manually update <code>build.properties</code> using <code>PropertyUtils</code> to define some other property name not using the <code>libs.<em>name</em>.classpath</code> format, e.g. when your project type module is restored or a project of your type is opened. Using the library manager is easier because <code>build.properties</code> is managed for you.If you wrote the task(s) for this purpose, you are <em>strongly recommended</em> to make task source code available as open source (e.g. under the Sun Public License), so that users retain full control over all software actually used to perform their builds (besides the JDK).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">In-VM tasks present in existing modules</dt>
<dd>
<p>NetBeans has the ability to run special Ant tasks which interact with other parts of the IDE (and cannot be run outside the IDE). A few commonly required tasks ship with the IDE; if you want to use them, declare a dependency on the module which defines them. You can refer to the tasks by simple name, but when using Ant 1.6+ it is preferable to use the correct “antlib” namespace. (Note that when prototyping a build script you can use the IDE’s code completion for attributes and subelements of these tasks.)</p>
</dd>
<dt class="hdlist1">Web browser integration (<code>antlib:org.netbeans.modules.browsetask)</code></dt>
<dd>
<p><code>&lt;nbbrowse&gt;</code> lets you open the IDE’s configured web browser on a given URL (or file).</p>
</dd>
<dt class="hdlist1">JPDA debugger integration (<code>antlib:org.netbeans.modules.debugger.jpda.ant</code>)</dt>
<dd>
<p><code>&lt;nbjpdastart&gt;</code> asks the IDE’s debugger to start listening on a new JPDA port, and define an Ant property with the port so you can launch a Java process which will connect to that port as a client. <code>&lt;nbjpdaconnect&gt;</code> connects to an existing port; more useful for server applications. <code>&lt;nbjpdareload&gt;</code> reloads Java classes using “fix &amp; continue” technology.</p>
</dd>
<dt class="hdlist1">Custom in-VM tasks</dt>
<dd>
<p>You can also define your own in-VM tasks and use them the same way as the predefined ones. See the <a href="https://bits.netbeans.org/dev/javadocAntModuleAPI/org/apache/tools/ant/module/spi/package-summary.html#register-defs">Ant SPI</a> for details.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Parametrizing_Build_Scripts">Parametrizing Build Scripts</h3>
<div class="paragraph">
<p>Some project types have several variants for <code>build-impl.xml</code>, parametrized somehow. For example, plain Java projects behave a little differently depending on whether you are building and running against the “default platform” (the IDE’s own JDK) or an explicit JDK. The former case might look like (excluding irrelevant details):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;target name="compile"&gt;
    &lt;javac srcdir="..." destdir="..." classpath="..."/&gt;
&lt;/target&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>whereas the latter case might look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;target name="compile"&gt;
    &lt;javac srcdir="..." destdir="..." classpath="..." fork="true" executable="..."/&gt;
&lt;/target&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The rule of thumb here is simple. <em>If some aspect of the build can be parametrized using Ant properties in a straightforward way using the Ant tasks you have available, do so.</em> For example, there is no need to create a different <code>build-impl.xml</code> just to change the build directory; this can be done using a property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;target name="compile"&gt;
    &lt;javac srcdir="..." destdir="${build.classes.dir}" classpath="..."/&gt;
&lt;/target&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>But in other cases, this is not possible. For example, Ant’s <code>&lt;junit&gt;</code> task can take a <code>jvm</code> attribute to specify an explicit JDK to run against. If you include this attribute, you have to set the JDK. When using the default platform, this attribute must not be there; when using an explicit platform, it must be there. Therefore <code>build-impl.xml</code> needs to be a bit different in these two cases (unless you included both versions in different targets and switched between them at runtime, though this can cause bloat in the build script). Build prototype scripts using all the variants you expect to encounter and verify that they all work the way you want.</p>
</div>
<div class="paragraph">
<p>Now to go back to <code>project.xml</code> for a moment: whatever variations in <code>build-impl.xml</code> you wish to support must be codified as metadata in <code>project.xml</code>. For example, a plain Java project can include an <code>&lt;explicit-platform&gt;</code> element or not; the presence or absence of this element determines which <code>build-impl.xml</code> variant is produced.</p>
</div>
</div>
<div class="sect2">
<h3 id="Writing_Stylesheets">Writing Stylesheets</h3>
<div class="paragraph">
<p>When you are satisfied with the <code>build-impl.xml</code> you have drafted (perhaps in multiple variants), it is time to write an <a href="http://www.w3c.org/TR/xslt">XSLT stylesheet</a> which produces it. The input to the stylesheet is the <code>project.xml</code> file and the output is the build script. Typically you will just copy most of the prototype build script verbatim into the stylesheet as the default content. You will also want to examine the <code>project.xml</code> input at least for a project name, and optionally also for any other information you need to construct different build script variants. For example, with a <code>project.xml</code> looking like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;project xmlns="<a href="http://www.netbeans.org/ns/project/1">http://www.netbeans.org/ns/project/1</a>"&gt;
    &lt;type&gt;org.netbeans.modules.myprojecttype&lt;/type&gt;
    &lt;configuration&gt;
        &lt;data xmlns="<a href="http://www.netbeans.org/ns/my-project-type/1">http://www.netbeans.org/ns/my-project-type/1</a>"&gt;
            &lt;name&gt;Test Project&lt;/name&gt;
            &lt;style&gt;first&lt;/style&gt; &lt;!-- whatever this means to you --&gt;
        &lt;/data&gt;
    &lt;/configuration&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You might have a stylesheet like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;xsl:stylesheet version="1.0"
                xmlns:xsl="<a href="http://www.w3.org/1999/XSL/Transform">http://www.w3.org/1999/XSL/Transform</a>"
                xmlns:p="<a href="http://www.netbeans.org/ns/project/1">http://www.netbeans.org/ns/project/1</a>"
                xmlns:xalan="<a href="http://xml.apache.org/xslt">http://xml.apache.org/xslt</a>"
                xmlns:myproj="<a href="http://www.netbeans.org/ns/my-project-type/1">http://www.netbeans.org/ns/my-project-type/1</a>"
                exclude-result-prefixes="xalan p myproj"&gt;
    &lt;xsl:output method="xml" indent="yes" encoding="UTF-8" xalan:indent-amount="4"/&gt;
    &lt;xsl:template match="/"&gt;
        &lt;xsl:comment&gt;&lt;![CDATA[
<strong>* GENERATED FROM project.xml - DO NOT EDIT  </strong>*
<strong>*         EDIT ../build.xml INSTEAD         </strong>*
]]&gt;&lt;/xsl:comment&gt;
        &lt;xsl:variable name="name" select="/p:project/p:configuration/myproj:data/myproj:name"/&gt;
        &lt;xsl:variable name="codename" select="translate($name, ' ', '_')"/&gt;
        &lt;project name="{$codename}-impl" basedir=".."&gt;
            &lt;!-- ... --&gt;
            &lt;target name="shows-variants"&gt;
                &lt;xsl:variable name="style" select="/p:project/p:configuration/myproj:data/myproj:style"/&gt;
                &lt;xsl:choose&gt;
                    &lt;xsl:when test="$style = 'first'"&gt;
                        &lt;do-one-thing-in-ant/&gt;
                    &lt;/xsl:when&gt;
                    &lt;xsl:when test="$style = 'second'"&gt;
                        &lt;do-another-thing-in-ant/&gt;
                    &lt;/xsl:when&gt;
                    &lt;xsl:otherwise&gt;
                        &lt;!-- error --&gt;
                    &lt;/xsl:otherwise&gt;
                &lt;/xsl:choose&gt;
            &lt;/target&gt;
        &lt;/project&gt;
    &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Remember</em> that { and } in attribute values have a special meaning in XSLT: if you want to use braces literally, e.g. for Ant property references, double them, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;!-- this is in XSLT: --&gt;
&lt;target name="something"&gt;
    &lt;mkdir dir="${{build.classes.dir"/&gt;
    &lt;!-- ... --&gt;
&lt;/target&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will also want a stylesheet to generate <code>build.xml</code>, though typically this is quite simple:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;xsl:stylesheet version="1.0"
                xmlns:xsl="<a href="http://www.w3.org/1999/XSL/Transform">http://www.w3.org/1999/XSL/Transform</a>"
                xmlns:project="<a href="http://www.netbeans.org/ns/project/1">http://www.netbeans.org/ns/project/1</a>"
                xmlns:myproj="<a href="http://www.netbeans.org/ns/my-project-type/1">http://www.netbeans.org/ns/my-project-type/1</a>"
                xmlns:xalan="<a href="http://xml.apache.org/xslt">http://xml.apache.org/xslt</a>"
                exclude-result-prefixes="xalan project myproj"&gt;
    &lt;xsl:output method="xml" indent="yes" encoding="UTF-8" xalan:indent-amount="4"/&gt;
    &lt;xsl:template match="/"&gt;
        &lt;xsl:comment&gt; You may freely edit this file. See commented blocks below for &lt;/xsl:comment&gt;
        &lt;xsl:comment&gt; some examples of how to customize the build. &lt;/xsl:comment&gt;
        &lt;xsl:comment&gt; (If you delete it and reopen the project it will be recreated.) &lt;/xsl:comment&gt;
        &lt;xsl:variable name="name" select="/project:project/project:configuration/myproj:data/myproj:name"/&gt;
        &lt;xsl:variable name="codename" select="translate($name, ' ', '_')"/&gt;
        &lt;project name="{$codename}"&gt;
            &lt;xsl:attribute name="default"&gt;default&lt;/xsl:attribute&gt;
            &lt;xsl:attribute name="basedir"&gt;.&lt;/xsl:attribute&gt;
            &lt;description&gt;Builds, tests, and runs the project &lt;xsl:value-of select="$name"/&gt;.&lt;/description&gt;
            &lt;import file="nbproject/build-impl.xml"/&gt;
            &lt;xsl:comment&gt;&lt;![CDATA[
    You could add descriptions of overridable targets here, or just link to online help...
    ]]&gt;&lt;/xsl:comment&gt;
        &lt;/project&gt;
    &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can fine-tune the XSLT for your build scripts, as well as the <code>project.xml</code> format and the list of Ant properties you want to recognize, <em>without writing one line of NetBeans module source code</em>. (Just run <code>project.xml</code> through your stylesheets to see the output, using any XSLT tool, such as that built into the NetBeans IDE.) All you are doing at this stage is defining some metadata for the project and verifying that Ant scripts generated from it do indeed build and run an example project the way you want.</p>
</div>
</div>
<div class="sect2">
<h3 id="Writing_the_Project_Type_Skeleton">Writing the Project Type Skeleton</h3>
<div class="paragraph">
<p>Now it is time to begin writing the project type provider module proper. First you will need an implementation of <code>AntBasedProjectType</code> which registers your project type in the system. (Place this implementation in default lookup, e.g. using the <code>META-INF/services/</code> section of your module JAR.) The project type class does not do much except report the project type identifier, and the local name and namespace used for the shared and private primary configuration data blocks (in <code>project.xml</code> and <code>private.xml</code>). The <code>createProject</code> method must create a particular project object; it is passed an <code>AntProjectHelper</code> object which gives you access to a variety of different Ant-based project functionality in a convenient way. You can immediately throw an <code>IOException</code> in case there is something badly wrong with the project on disk; a future version of NetBeans should also let you perform XML validation on <code>project.xml</code> at this time (cf. #42686).</p>
</div>
<div class="paragraph">
<p>You will need a separate class for the <code>Project</code> implementation, which will usually hold onto the instance of <code>AntProjectHelper</code> and use it to service requests.</p>
</div>
<div class="paragraph">
<p>Another common thing to set up in your project’s constructor is a property evaluator, which can load the current values of various properties from <code>project.properties</code>, <code>private.properties</code>, and <code>build.properties</code>, using Ant’s property evaluation semantics, and notify you of changes even in specific properties. A <code>PropertyEvaluator</code> instance is also a required parameter for many convenience factory methods and constructors in the Ant-based project support. Many projects can just call <code>AntProjectHelper.getStandardPropertyEvaluator()</code> to load properties from these three files in the usual way. If you have other property files your build script loads, or default values set in the build script, you can make a custom evaluator using factory methods in <code>PropertyUtils</code>—but beware that <code>ReferenceHelper</code> expects the standard semantics (so that it can store relative paths in <code>project.properties</code> and absolute paths in <code>private.properties</code>) and so may not work appropriately if you have a very different property loading model.</p>
</div>
<div class="paragraph">
<p>The project should create a <code>Lookup</code> containing its particular abilities and return this from the <code>getLookup()</code> method. Normally <code>Lookups.fixed</code> is adequate for this purpose. In principle a project’s lookup could change dynamically, but this is not normally required. More information on what to put in the lookup can be found below.</p>
</div>
</div>
<div class="sect2">
<h3 id="Handling_Build_Script_.28Re-.29generation">Handling Build Script (Re-)generation</h3>
<div class="paragraph">
<p>The normal way that <code>build.xml</code> and <code>build-impl.xml</code> are created is that these files are automatically generated whenever they are missing; and regenerated when they are out of date relative to the current XSLT stylesheet and <code>project.xml</code>, <em>but</em> not modified by the user. (<code>private.xml</code> is not considered: since it is per-user, the shared build script cannot be changed according to its contents.) Note that <code>build-impl.xml</code> is not <em>supposed</em> to be modified by the user, but at least if it is, those modifications will never be clobbered. <code>build.xml</code> can be modified, so if it is, it will not be regenerated; however it is not likely to need regeneration often or at all.</p>
</div>
<div class="paragraph">
<p>To configure the normal (re-)generation semantics, make sure your project’s lookup contains:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A <code>ProjectXmlSavedHook</code>, used when <code>project.xml</code> is modified and saved.</p>
</li>
<li>
<p>A <code>ProjectOpenedHook</code>, used when the project is opened.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The Javadoc for <code>GeneratedFilesHelper.refreshBuildScript</code> describes the recommended parameters that should be passed to it from these two hooks. Remember that your XSLT stylesheets should be packaged in the module JAR so they can be passed to this method.</p>
</div>
<div class="paragraph">
<p>Other kinds of behavior are possible; check the <code>GeneratedFilesHelper</code> Javadoc for more information. You could also produce Ant build scripts using some method other than XSLT transformations (e.g. manual DOM manipulation), but <code>GeneratedFilesHelper</code> will not currently (#42735) help you determine whether the scripts are modified or out of date if you do this, so you would need to write this logic yourself.</p>
</div>
</div>
<div class="sect2">
<h3 id="Populating_the_Project_Lookup">Populating the Project Lookup</h3>
<div class="paragraph">
<p><strong>PENDING</strong></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Creating_a_Properties_Dialog">Creating a Properties Dialog</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>PENDING</strong></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Handling_Upgrades">Handling Upgrades</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>PENDING</strong></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="How_to_Use_Project-Related_APIs_from_Other_Modules">How to Use Project-Related APIs from Other Modules</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>PENDING</strong></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Some_Interesting_Things_which_are_Impossible">Some Interesting Things which are Impossible</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is no general API for accessing project settings from the outside, and anyway it comes in various forms depending on the particular project type. For example, J2SE projects currently let you configure a main class, a working directory, etc. These things make no sense for web applications. Conversely, context root is critical for a web application but senseless for a J2SE project. There are no plans to ever have a general API for accessing this kind of project configuration from the outside.</p>
</div>
<div class="paragraph">
<p>Someday there may be an SPI for plugging in natures (behaviors for a project), in response to accumulated feedback and experience from people trying to do this sort of thing (e.g. the JFluid project); currently there are no plans for it. The project type is currently expected to directly handle all of the significant build/run scenarios which it could support, such as running, debugging, and unit testing.</p>
</div>
<div class="paragraph">
<p>Currently the JFluid module accomplishes its profiler integration for a fixed list of known project types by relying on knowledge of the disk layout and file formats of those project types, and either running the app directly based on settings read in this way, or generating auxiliary Ant scripts in <code>nbproject/</code> which can launch the app with specialized parameters in addition to the normal properties-file-based settings.</p>
</div>
<div class="paragraph">
<p>Note that you can use e.g. <code>ClassPath.getClassPath(FileObject)</code> to find various classpaths which the project claims it uses to build or run the app. How the project actually builds or runs the app is its own business; the API-exposed information is intended for use in code completion, refactoring, and similar development-time-only features, and is intentionally the bare minimum information required for these features. For example, getting the classpath for a <em>particular</em> source root contained in the project is exposed, since the editor and refactoring features need this. Getting the main class of the project (if there is such a thing) is not exposed, since they do not.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The content in this page was kindly donated by Oracle Corp. to the Apache Software Foundation.</p>
</div>
<div class="paragraph">
<p>This page was exported from <a href="http://wiki.netbeans.org/BuildSystemHowTo">http://wiki.netbeans.org/BuildSystemHowTo</a> , that was last modified by NetBeans user Jglick on 2010-02-19T17:17:47Z.</p>
</div>
<div class="paragraph">
<p>This document was automatically converted to the AsciiDoc format on 2020-03-12, and needs to be reviewed.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/wiki/BuildSystemHowTo.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
