
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Lição 7: Atualizando e Deletando Entradas no Banco de Dados</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Lição 7: Atualizando e Deletando Entradas no Banco de Dados - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Lição 7: Atualizando e Deletando Entradas no Banco de Dados">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>

  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 19</h1>
            <p><a class="button success" href="/download/nb19/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">Lição 7: Atualizando e Deletando Entradas no Banco de Dados</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/php/wish-list-lesson7_pt_BR.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_código_fonte_da_aplicação_da_lição_anterior">Código-fonte da Aplicação da Lição Anterior</a></li>
<li><a href="#_editando_um_desejo">Editando um Desejo</a>
<ul class="sectlevel2">
<li><a href="#_implementando_o_botão_editar">Implementando o Botão Editar</a></li>
<li><a href="#_expandindo_o_array_wish">Expandindo o Array  <code>$wish</code></a></li>
<li><a href="#_atualizando_o_form_de_entrada_html">Atualizando o Form de Entrada HTML</a></li>
<li><a href="#_atualizando_o_desejo_no_banco_de_dados">Atualizando o Desejo no Banco de Dados</a></li>
</ul>
</li>
<li><a href="#_testando_a_funcionalidade_editar_desejo">Testando a Funcionalidade Editar Desejo</a></li>
<li><a href="#_deletando_um_desejo">Deletando um Desejo</a></li>
<li><a href="#_testando_a_funcionalidade_deletar_desejo">Testando a Funcionalidade Deletar Desejo</a></li>
<li><a href="#_o_código_fonte_da_aplicação_após_a_lição_atual_está_concluído">O código-fonte da Aplicação após a Lição Atual está Concluído</a></li>
<li><a href="#_próximas_etapas">Próximas Etapas</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Nesta lição, você expandirá a funcionalidade da aplicação com duas funcionalidades:</p>
</div>
<div class="paragraph">
<p>Para implementar essas funcionalidades, edite os arquivos  <code>editWishList.php</code>  e  <code>editWish.php</code> . Crie também um novo arquivo chamado  <code>deleteWish.php</code> .</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/page-flow-diagram-l7.png" alt="page flow diagram l7">
</div>
</div>
<div class="paragraph">
<p>O documento atual é uma parte do tutorial Criando uma Aplicação CRUD no NetBeans IDE para PHP.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_código_fonte_da_aplicação_da_lição_anterior">Código-fonte da Aplicação da Lição Anterior</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Usuários MySQL: clique <a href="https://netbeans.org/files/documents/4/1932/lesson6.zip">aqui</a> para fazer o download do código-fonte que reflete o estado do projeto depois que a lição anterior estiver concluída.</p>
</div>
<div class="paragraph">
<p>Usuários do banco de dados Oracle: clique <a href="https://netbeans.org/projects/www/downloads/download/php%252Foracle-lesson6.zip">aqui</a> para fazer o download do código-fonte que reflete o estado do projeto depois que a lição anterior for concluída.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_editando_um_desejo">Editando um Desejo</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A funcionalidade suporta o seguinte caso de uso:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Na página  <code>editWishList.php</code> , o usuário pressiona o botão Editar à direita de um desejo. A página  <code>editWish.php</code>  com os dados do desejo selecionado abre.</p>
</li>
<li>
<p>O usuário altera a descrição e/ou a data de vencimento do desejo e pressiona o botão Salvar Alterações.</p>
</li>
<li>
<p>Se a descrição <em>não</em> for preenchida, uma mensagem de erro é exibida e o usuário retorna para a página  <code>editWish.php</code> .</p>
</li>
<li>
<p>Se a descrição for preenchida, a aplicação retorna à página  <code>editWishList.php</code> , onde o desejo é atualizado.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A implementação consiste nas seguintes etapas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_implementing_the_edit_button">Adicionar um botão Editar na página editWishList</a></p>
</li>
<li>
<p><a href="#_expanding_the_code_wish_code_array">Na página editWish.php, atualizar o array $wish para armazenar os dados do desejo</a></p>
</li>
<li>
<p><a href="#_updating_the_html_input_form">Atualizar o form de entrada na página editWish.php</a></p>
</li>
<li>
<p><a href="#_updating_the_wish_in_the_database">Validar os dados enviados e atualizar o desejo no banco de dados</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_implementando_o_botão_editar">Implementando o Botão Editar</h3>
<div class="paragraph">
<p>Em  <code>editWishList.php</code> , uma tabela com os desejos de um wisher é implementada por um loop (uma instrução  <code>while</code> ) que exibe linhas com desejos enquanto os desejos são selecionados no banco de dados. Adicione um botão Editar como a célula da extrema direita em uma linha.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Para transferir o ID de um desejo usando o form de entrada HTML, armazene-o em uma variável. Insira a seguinte linha de código no fim do loop  <code>while</code> :</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">while ($row = mysqli_fetch_array($result)):
    echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row['description']) . "&lt;/td&gt;";
    echo "&lt;td&gt;" . htmlentities($row['due_date']) . "&lt;/td&gt;";
    $wishID = $row['id'];
    echo "&lt;td&gt;WishID=" . $wishID . "&lt;/td&gt;";
    //The loop is left open
    ?&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Implemente o botão Editar. Adicione outra célula à tabela antes de fechar a tag &lt;/table&gt; com o form editWish. Esse form contém um componente botão e um componente oculto que envia o valor  <code>$wishID</code>  ao clicar no botão. (O código para o banco de dados MySQL é mostrado, mas o código adicionado é o mesmo, no mesmo local, para o banco de dados Oracle).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">Hello &lt;?php echo $_SESSION["user"]; ?&gt;&lt;br/&gt;
&lt;table border="black"&gt;
    &lt;tr&gt;&lt;th&gt;Item&lt;/th&gt;&lt;th&gt;Due Date&lt;/th&gt;&lt;/tr&gt;
    &lt;?php
    require_once("Includes/db.php");
    $wisherID = WishDB::getInstance()-&gt;get_wisher_id_by_name($_SESSION["user"]);
    $result = WishDB::getInstance()-&gt;get_wishes_by_wisher_id($wisherID);
    while ($row = mysqli_fetch_array($result)) {
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["description"]) . "&lt;/td&gt;";
        echo "&lt;td&gt;" . htmlentities($row["due_date"]) . "&lt;/td&gt;&lt;/tr&gt;\n";
    }
    mysqli_free_result($result);
    ?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"&gt;
            &lt;input type="submit" name="editWish" value="Edit"&gt;
        &lt;/form&gt;
    &lt;/td&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Altere o loop  <code>while</code>  para usar a <a href="http://www.php.net/manual/en/control-structures.alternative-syntax.php">sintaxe alternativa</a>. Isso facilita a execução de blocos HTML dentro do loop  <code>while</code> . Na sintaxe alternativa do loop  <code>while</code> , as chaves de abertura { são substituídas por dois-pontos : e as chaves de fechamento } são substituídas pela instrução  <code>endwhile;</code> . Substitua as chaves de abertura por dois-pontos, delete as chaves de fechamento e adicione um novo bloco PHP antes da tag de fechamento &lt;/table&gt; com a instrução  <code>endwhile;</code> . Isso incorpora a nova célula da tabela para o loop  <code>while</code> . Mova o código instrução livre/resultado para após a instrução  <code>endwhile.</code>  (O código para o MySQL é exibido novamente, mas o código muda e o local é o mesmo para o banco de dados da Oracle).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">   while ($row = mysqli_fetch_array($result)){:
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["description"]) . "&lt;/td&gt;";
        echo "&lt;td&gt;" . htmlentities($row["due_date"]) . "&lt;/td&gt;&lt;/tr&gt;\n";
    }
    mysqli_free_result($result);
    ?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
           &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"&gt;
           &lt;input type="submit" name="editWish" value="Edit"&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;?php
    endwhile;
    mysqli_free_result($result);
    ?&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>.
Conserte a sintaxe da linha da tabela. Mova os caracteres de final de linha &lt;/tr&gt;\n da instrução de exibição de data de vencimento para a nova instrução logo acima do  <code>endwhile;</code> .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">    while ($row = mysqli_fetch_array($result)):
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["description"]) . "&lt;/td&gt;";
        echo "&lt;td&gt;" . htmlentities($row["due_date"]) . "&lt;/td&gt;&lt;/tr&gt;\n";
    ?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
           &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"&gt;
           &lt;input type="submit" name="editWish" value="Edit"&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;?php
    echo "&lt;/tr&gt;\n";
    endwhile;
    mysqli_free_result($result);
    ?&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>.
A tabela inteira, incluindo o form com o botão Editar dentro do loop  `while ` , agora tem a seguinte aparência:</p>
</div>
<div class="paragraph">
<p><strong>Para o banco de dados MySQL:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">&lt;table border="black"&gt;
    &lt;tr&gt;&lt;th&gt;Item&lt;/th&gt;&lt;th&gt;Due Date&lt;/th&gt;&lt;/tr&gt;
    &lt;?php
    require_once("Includes/db.php");
    $wisherID = WishDB::getInstance()-&gt;get_wisher_id_by_name($_SESSION["user"]);
    $result = WishDB::getInstance()-&gt;get_wishes_by_wisher_id($wisherID);
    while($row = mysqli_fetch_array($result)):
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row['description']) . "&lt;/td&gt;";
        echo "&lt;td&gt;" . htmlentities($row['due_date']) . "&lt;/td&gt;";
        $wishID = $row["id"];
    ?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="editWish" value="Edit"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;?php
    echo "&lt;/tr&gt;\n";
    endwhile;
    mysqli_free_result($result);
    ?&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Para banco de dados Oracle:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">&lt;table border="black"&gt;
    &lt;tr&gt;&lt;th&gt;Item&lt;/th&gt;&lt;th&gt;Due Date&lt;/th&gt;&lt;/tr&gt;
    &lt;?php
    require_once("Includes/db.php");
    $wisherID = WishDB::getInstance()-&gt;get_wisher_id_by_name($_SESSION["user"]);
    $stid = WishDB::getInstance()-&gt;get_wishes_by_wisher_id($wisherID);
    while ($row = oci_fetch_array($stid)):
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["DESCRIPTION"]) . "&lt;/td&gt;";
        echo "&lt;td&gt;" . htmlentities($row["DUE_DATE"]) . "&lt;/td&gt;";
        $wishID = $row["ID"];
    ?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="editWish" value="Edit"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;td&gt;
        &lt;form name="deleteWish" action="deleteWish.php" method="POST"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="deleteWish" value="Delete"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;?php
    echo "&lt;/tr&gt;\n";
    endwhile;
    oci_free_statement($stid);
   ?&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_expandindo_o_array_wish">Expandindo o Array  <code>$wish</code></h3>
<div class="paragraph">
<p>Quando o botão Editar é pressionado na página  <code>editWishList.php</code> , o wisher ID selecionado é transferido para a página  <code>editWish.php</code>  usando o método de Solicitação de Servidor GET. Para armazenar o wisher ID, você precisa adicionar um novo elemento ao array  <code>$wish</code> .</p>
</div>
<div class="paragraph">
<p>Como acontece quando um novo desejo é adicionado, o form de entrada pode ser acessado da página  <code>editWishList.php</code>  e da página  <code>editWish.php</code>  após uma tentativa malsucedida de salvar. Os casos são distinguidos pelo método de Solicitação de Servidor por meio do qual os dados são transferidos. O GET indica que o form é exibido quando o usuário chega pela primeira vez à página, pressionando Editar Desejo. O POST indica que o usuário é redirecionado para o form após tentar salvar um desejo sem uma descrição.</p>
</div>
<div class="paragraph">
<p>Em  <code>editWish.php</code> , substitua o bloco PHP na tag HTML &lt;body&gt; acima do form de entrada  <code>EditWish</code>  com o código expandido para o array  <code>$wish</code> .</p>
</div>
<div class="paragraph">
<p><strong>Para o banco de dados MySQL:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">&lt;?php
if ($_SERVER["REQUEST_METHOD"] == "POST")
    $wish = array("id" =&gt; $_POST["wishID"], "description" =&gt;
            $_POST["wish"], "due_date" =&gt; $_POST["dueDate"]);
else if (array_key_exists("wishID", $_GET))
    $wish = mysqli_fetch_array(WishDB::getInstance()-&gt;get_wish_by_wish_id($_GET["wishID"]));
else
    $wish = array("id" =&gt; "", "description" =&gt; "", "due_date" =&gt; "");
?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Para o banco de dados Oracle:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">&lt;?php
if ($_SERVER["REQUEST_METHOD"] == "POST")
    $wish = array("id" =&gt; $_POST["wishID"], "description" =&gt;
                $_POST["wish"], "due_date" =&gt; $_POST["dueDate"]);
else if (array_key_exists("wishID", $_GET)) {
    $stid = WishDB::getInstance()-&gt;get_wish_by_wish_id($_GET["wishID"]);
    $row = oci_fetch_array($stid, OCI_ASSOC);
    $wish = array("id" =&gt; $row["ID"], "description" =&gt;
                $row["DESCRIPTION"], "due_date" =&gt; $row["DUE_DATE"]);
    oci_free_statement($stid);
} else
    $wish = array("id" =&gt; "", "description" =&gt; "", "due_date" =&gt; "");
?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>O código inicializa o array  <code>$wish</code>  com três elementos:  <code>id</code> ,  <code>description</code>  e  <code>due_date</code> . Os valores desses elementos dependem do método de Solicitação de Servidor. Se o método de Solicitação de Servidor for POST, os valores serão recebidos do form de entrada. Caso contrário, se o método de Solicitação de Servidor for GET e o array $_GET contiverem um elemento com a chave "wishID", os valores serão recuperados do banco de dados pela função get_wish_by_wish_id. Finalmente, se o método de Solicitação do Servidor não for POST nem GET, o que significa que o caso de uso Adicionar Novo Desejo acontece, os elementos ficam vazios.</p>
</div>
<div class="paragraph">
<p>O código precedente cobre os casos de criação e edição de desejos. Agora você precisa atualizar o form de entrada para que ele possa ser usado por ambos os casos.</p>
</div>
</div>
<div class="sect2">
<h3 id="_atualizando_o_form_de_entrada_html">Atualizando o Form de Entrada HTML</h3>
<div class="paragraph">
<p>Atualmente, o form de entrada funciona quando você quer criar um novo desejo e não há id de desejo. Para que o form funcione ao editar um desejo existente, é necessário adicionar um campo oculto para transferir o ID de um desejo. O valor do campo oculto deve ser recuperado no array $wish. O valor deve ser uma string vazia durante a criação de um novo desejo. Se o desejo for editado, o valor do campo oculto deve ser alterado para o wisher ID. Para criar esse campo oculto, adicione a linha seguinte à parte superior do form de entrada  <code>EditWish</code>  em  <code>editWish.php</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">&lt;input type="hidden" name="wishID" value="&lt;?php echo  `$wish` ["id"];?&gt;" /&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_atualizando_o_desejo_no_banco_de_dados">Atualizando o Desejo no Banco de Dados</h3>
<div class="paragraph">
<p>Agora você precisa atualizar o código que verifica os dados de entrada e insere o desejo no banco de dados. O código atual não distingue entre a criação de um novo caso de desejo e a atualização de um existente. Na implementação atual, um novo registro sempre é adicionado ao banco de dados porque o código não verifica o valor do wisher ID transferido do form de entrada.</p>
</div>
<div class="paragraph">
<p>Você precisa adicionar as seguintes funções:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Se o elemento transferido "wishID" for uma string vazia, crie um novo desejo.</p>
</li>
<li>
<p>Caso contrário, se o elemento "wishID" não for uma string vazia, atualize o desejo.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Para atualizar o editWish.php para que ele verifique se um desejo é novo e atualizá-lo caso não seja novo:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione a função  <code>update_wish</code>  ao  <code>db.php</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Para o banco de dados MySQL:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">public function update_wish($wishID, $description, $duedate) {
    $description = $this-&gt;real_escape_string($description);
    if ($duedate==''){
        $this-&gt;query("UPDATE wishes SET description = '" . $description . "',
            due_date = NULL WHERE id = " . $wishID);
    } else
        $this-&gt;query("UPDATE wishes SET description = '" . $description .
            "', due_date = " . $this-&gt;format_date_for_sql($duedate)
            . " WHERE id = " . $wishID);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Para o banco de dados Oracle:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">public function update_wish($wishID, $description, $duedate) {
    $query = "UPDATE wishes SET description = :desc_bv, due_date = to_date(:due_date_bv, 'YYYY-MM-DD')
                WHERE id = :wish_id_bv";
    $stid = oci_parse($this-&gt;con, $query);
    oci_bind_by_name($stid, ':wish_id_bv', $wishID);
    oci_bind_by_name($stid, ':desc_bv', $description);
    oci_bind_by_name($stid, ':due_date_bv', $this-&gt;format_date_for_sql($duedate));
    oci_execute($stid);

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>.
Adicione a função  <code>get_wish_by_wish_id</code>  ao  <code>db.php</code> .</p>
</div>
<div class="paragraph">
<p><strong>Para o banco de dados MySQL:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">public function get_wish_by_wish_id ($wishID) {
    return $this-&gt;query("SELECT id, description, due_date FROM wishes WHERE id = " . $wishID);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Para o banco de dados Oracle:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">public function get_wish_by_wish_id($wishID) {
    $query = "SELECT id, description, due_date FROM wishes WHERE id = :wish_id_bv";
    $stid = oci_parse($this-&gt;con, $query);
    oci_bind_by_name($stid, ':wish_id_bv', $wishID);
    oci_execute($stid);
    return $stid;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na parte principal, no bloco PHP superior do  <code>editWish.php</code> , adicione uma condição para a instrução`else` final. Esta é a instrução  <code>else</code>  que insere o desejo no banco de dados. Trocar para instrução  <code>else if</code> :</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">else if ($_POST["wishID"]=="") {
    WishDB::getInstance()-&gt;insert_wish($wisherID, $_POST["wish"], $_POST["dueDate"]);
    header('Location: editWishList.php' );
    exit;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Digite ou cole outra instrução  <code>else if</code>  abaixo daquela que você acabou de editar:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">else if ($_POST["wishID"]!="") {
    WishDB::getInstance()-&gt;update_wish($_POST["wishID"], $_POST["wish"], $_POST["dueDate"]);
    header('Location: editWishList.php' );
    exit;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>O código verifica se o elemento  <code>wishID</code>  no array  <code>$_POST</code>  não é uma string vazia, o que significa que o usuário foi redirecionado da página  <code>editWishList.php</code> , pressionando o botão Editar, e se o usuário preencheu a descrição do desejo. Se a verificação for bem-sucedida, o código chamará a função  <code>update_wish</code>  com os parâmetros de entrada  <code>wishid</code> ,  <code>description</code> e  <code>duedate. ` Esses parâmetros são recebidos do form de entrada HTML usando o método post. Depois que o  `update_wish</code>  for chamado, a aplicação será redirecionada para a página  <code>editWishList.php</code>  e o processamento de PHP será cancelado.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testando_a_funcionalidade_editar_desejo">Testando a Funcionalidade Editar Desejo</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Execute a aplicação. Na página index.php, preencha os campos: no campo Nome do Usuário, digite "Tom", e no campo Senha, digite "tomcat".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/user-logon-to-edit-wish-list.png" alt="user logon to edit wish list">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Pressione o botão Editar Minha Lista de Desejos. A página  <code>editWishList.php</code>  abre.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/edit-wish-list-edit-wish.png" alt="edit wish list edit wish">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Editar ao lado de Icecream. A página  <code>editWish.php</code>  abre.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/edit-wish.png" alt="edit wish">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Edite os campos e pressione Voltar à Lista. A página  <code>editWishList.php</code>  abre, mas as alterações não são salvas.</p>
</li>
<li>
<p>Pressione Editar ao lado de Icecream. Limpe o campo Descreva seu desejo e pressione Salvar Alterações. Uma mensagem de erro é exibida.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/editWishEmptyDescription.png" alt="editWishEmptyDescription">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Insira Chocolate Icecream no campo Descreva seu desejo e pressione Salvar Alterações. A página  <code>editWishList.php</code>  abre com uma lista atualizada.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/editWishListWishAdded.png" alt="editWishListWishAdded">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deletando_um_desejo">Deletando um Desejo</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Agora que você pode criar, ler e editar desejos, adicione um método para deletar um desejo.</p>
</div>
<div class="paragraph">
<p><strong>Para permitir que o usuário delete desejos:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione uma função ` delete_wish`  ao  <code>db.php</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Para o banco de dados MySQL:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">function delete_wish ($wishID){
    $this-&gt;query("DELETE FROM wishes WHERE id = " . $wishID);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Para o banco de dados Oracle:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">public function delete_wish($wishID) {
    $query = "DELETE FROM wishes WHERE id = :wish_id_bv";
    $stid = oci_parse($this-&gt;con, $query);
    oci_bind_by_name($stid, ':wish_id_bv', $wishID);
    oci_execute($stid);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Crie um novo arquivo PHP chamado  <code>deleteWish.php</code>  e insira o seguinte código no &lt;? php?&gt;:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">require_once("Includes/db.php");
WishDB::getInstance()-&gt;delete_wish ($_POST["wishID"]);
header('Location: editWishList.php' );</code></pre>
</div>
</div>
<div class="paragraph">
<p>O código permite o uso do arquivo  <code>db.php</code> . Em seguida, ele chama a função  <code>delete_wish</code>  a partir de uma instância do WishDB, com o  <code>wishID</code>  como o parâmetro de entrada. Finalmente, a aplicação é redirecionada para a página  <code>editWishList.php</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Para implementar o botão Deletar, adicione outra célula da tabela ao loop  <code>while</code>  no  <code>editWishList.php</code> , diretamente abaixo do código do bloco para o botão  <code>editWish</code> . O form de entrada HTML contém um campo oculto para  <code>wishID</code>  e um botão de envio chamado Deletar. (O código para o banco de dados MySQL é mostrado, mas o código adicionado é o mesmo, no mesmo local, para o banco de dados Oracle).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">    while ($row = mysqli_fetch_array($result)):
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["description"]) . "&lt;/td&gt;";
        echo "&lt;td&gt;" . htmlentities($row["due_date"]) . "&lt;/td&gt;&lt;/tr&gt;\n";
    ?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
           &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"&gt;
           &lt;input type="submit" name="editWish" value="Edit"&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;td&gt;
        &lt;form name="deleteWish" action="deleteWish.php" method="POST"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="deleteWish" value="Delete"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;?php
    echo "&lt;/tr&gt;\n";
    endwhile;
    mysqli_free_result($result);
    ?&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>A tabela inteira, incluindo o form com o botão Editar dentro do loop  `while ` , agora tem a seguinte aparência:</p>
</div>
<div class="paragraph">
<p><strong>Para o banco de dados MySQL:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">&lt;table border="black"&gt;
    &lt;tr&gt;&lt;th&gt;Item&lt;/th&gt;&lt;th&gt;Due Date&lt;/th&gt;&lt;/tr&gt;
    &lt;?php
    require_once("Includes/db.php");
    $wisherID = WishDB::getInstance()-&gt;get_wisher_id_by_name($_SESSION["user"]);
    $result = WishDB::getInstance()-&gt;get_wishes_by_wisher_id($wisherID);
    while($row = mysqli_fetch_array($result)):
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row['description']) . "&lt;/td&gt;";
        echo "&lt;td&gt;" . htmlentities($row['due_date']) . "&lt;/td&gt;";
        $wishID = $row["id"];
    ?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="editWish" value="Edit"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;td&gt;
        &lt;form name="deleteWish" action="deleteWish.php" method="POST"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="deleteWish" value="Delete"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;?php
    echo "&lt;/tr&gt;\n";
    endwhile;
    mysqli_free_result($result);
    ?&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Para banco de dados Oracle:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="php">&lt;table border="black"&gt;
    &lt;tr&gt;&lt;th&gt;Item&lt;/th&gt;&lt;th&gt;Due Date&lt;/th&gt;&lt;/tr&gt;
    &lt;?php
    require_once("Includes/db.php");
    $wisherID = WishDB::getInstance()-&gt;get_wisher_id_by_name($_SESSION["user"]);
    $stid = WishDB::getInstance()-&gt;get_wishes_by_wisher_id($wisherID);
    while ($row = oci_fetch_array($stid)):
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["DESCRIPTION"]) . "&lt;/td&gt;";
        echo "&lt;td&gt;" . htmlentities($row["DUE_DATE"]) . "&lt;/td&gt;";
        $wishID = $row["ID"];
    ?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="editWish" value="Edit"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;td&gt;
        &lt;form name="deleteWish" action="deleteWish.php" method="POST"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="deleteWish" value="Delete"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;?php
    echo "&lt;/tr&gt;\n";
    endwhile;
    oci_free_statement($stid);
   ?&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testando_a_funcionalidade_deletar_desejo">Testando a Funcionalidade Deletar Desejo</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para verificar se a funcionalidade foi implementada corretamente, pressione Deletar ao lado de qualquer item na página  <code>editWishList.php</code> . O item não está mais na lista.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/deleteWish.png" alt="deleteWish">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_o_código_fonte_da_aplicação_após_a_lição_atual_está_concluído">O código-fonte da Aplicação após a Lição Atual está Concluído</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Usuários MySQL: clique <a href="https://netbeans.org/files/documents/4/1933/lesson7.zip">aqui</a> para fazer o download do código-fonte que reflete o estado do projeto depois que a lição estiver concluída.</p>
</div>
<div class="paragraph">
<p>Usuários do banco de dados Oracle: clique <a href="https://netbeans.org/projects/www/downloads/download/php%252Foracle-lesson7.zip">aqui</a> para fazer o download do código-fonte que reflete o estado do projeto depois que a lição for concluída.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_próximas_etapas">Próximas Etapas</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="wish-list-lesson6.html">&lt;&lt; Lição anterior</a></p>
</div>
<div class="paragraph">
<p><a href="wish-list-lesson8.html">Próxima lição &gt;&gt;</a></p>
</div>
<div class="paragraph">
<p><a href="wish-list-tutorial-main-page.html">Voltar à página principal do Tutorial</a></p>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20PHP%20Wish%20List%20CRUD%207:%20Updating%20and%20Deleting%20DB%20Entries">Enviar Feedback neste Tutorial</a></p>
</div>
<div class="paragraph">
<p>Para enviar comentários e sugestões, obter suporte e manter-se informado sobre os desenvolvimentos mais recentes das funcionalidades de desenvolvimento PHP do NetBeans IDE, <a href="../../../community/lists/top.html">junte-se à lista de correspondência users@php.netbeans.org</a>.</p>
</div>
<div class="paragraph">
<p><a href="../../trails/php.html">Voltar à Trilha de Aprendizado PHP</a></p>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/php/wish-list-lesson7_pt_BR.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
