
<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Lesson 7: Updating and Deleting Entries in the Database</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Lesson 7: Updating and Deleting Entries in the Database - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Lesson 7: Updating and Deleting Entries in the Database">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
     <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet"> 
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
</head>


    <body>
        

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans (incubating)</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="/plugins/index.html">Plugins</a> </li>
            <li> <a href="/download/nb100/nb100.html">Download</a> </li>
        </ul>
    </div>
</div>


        
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Just released!</div>
            <h1 syle='font-size: 2rem'>Apache NetBeans 10.0</h1>
            <p><a class="button success" href="/download/nb100/nb100.html">Read more</a></p>
        </div>
    </div>
</section>

        <div class='grid-container main-content tutorial'>
            <h1 class="sect0">Lesson 7: Updating and Deleting Entries in the Database</h1>
            <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel3">
<li><a href="#_tutorial_contents">Tutorial contents:</a></li>
<li><a href="#_application_source_code_from_the_previous_lesson">Application Source Code from the Previous Lesson</a></li>
<li><a href="#_editing_a_wish">Editing a Wish</a>
<ul class="sectlevel2">
<li><a href="#_implementing_the_edit_button">Implementing the Edit Button</a></li>
<li><a href="#_expanding_the_code_wish_code_array">Expanding the  <code>$wish</code>  Array</a></li>
<li><a href="#_updating_the_html_input_form">Updating the HTML Input Form</a></li>
<li><a href="#_updating_the_wish_in_the_database">Updating the Wish in the Database</a></li>
</ul>
</li>
<li><a href="#_testing_the_edit_wish_functionality">Testing the Edit Wish Functionality</a></li>
<li><a href="#_deleting_a_wish">Deleting a Wish</a></li>
<li><a href="#_testing_the_delete_wish_functionality">Testing the Delete Wish Functionality</a></li>
<li><a href="#_application_source_code_after_the_current_lesson_is_completed">Application Source Code after the Current Lesson Is Completed</a></li>
<li><a href="#_next_steps">Next Steps</a></li>
</ul>
</div>
<div class="sect3">
<h4 id="_tutorial_contents">Tutorial contents:</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="wish-list-tutorial-main-page.html">Creating a Database Driven Application With PHP - Main page</a>
2.
Creating the Database</p>
</li>
<li>
<p><a href="wish-list-lesson1.html">Creating a MySQL Database</a></p>
</li>
<li>
<p><a href="wish-list-oracle-lesson1.html">Creating Oracle Database Tables</a>
3.
<a href="wish-list-lesson2.html">Designing the Application. Reading from the Database</a></p>
</li>
<li>
<p><a href="wish-list-lesson3.html">+Creating a New Application User +</a></p>
</li>
<li>
<p><a href="wish-list-lesson4.html">Optimizing the Code</a></p>
</li>
<li>
<p><a href="wish-list-lesson5.html">Adding Security. Implementing Application User Logon</a></p>
</li>
<li>
<p><a href="wish-list-lesson6.html">+ Adding a New Wish to the Database+</a>
8.
<strong>&#8658; Updating and Deleting Entries in the Database</strong></p>
<div class="ulist">
<ul>
<li>
<p><a href="#previousLessonSourceCode">Application Source Code from the Previous Lesson</a></p>
</li>
<li>
<p><a href="#editWish">Editing a Wish</a></p>
</li>
<li>
<p><a href="#addEditButton">Implementing the Edit Button</a></p>
</li>
<li>
<p><a href="#wishArrayUpdate">Expanding the $wish Array </a></p>
</li>
<li>
<p><a href="#updateInputForm">Updating the HTML Input Form</a></p>
</li>
<li>
<p><a href="#updateWishRecord">Updating the Wish in the Database</a></p>
</li>
<li>
<p><a href="#testingEditWishFunctionality">Testing the Edit Wish Functionality</a></p>
</li>
<li>
<p><a href="#deleteWish">Deleting a Wish</a></p>
</li>
<li>
<p><a href="#testingDeleteWishFunctionality">Testing the Delete Wish Functionality</a></p>
</li>
<li>
<p><a href="#lessonResultSourceCode">Application Source Code After the Current Lesson Is Completed</a></p>
</li>
<li>
<p><a href="#nextSteps">Next Steps</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="wish-list-lesson8.html">Making the Application Look Better Using the CSS Technology</a></p>
</li>
<li>
<p><a href="wish-list-lesson9.html">Deploying the Application on a Remote Web Server</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In this lesson you will expand the application&#8217;s functionality with two features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#editWish">Editing a wish</a></p>
</li>
<li>
<p><a href="#deleteWish">Deleting a wish</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To implement these features, you edit the  <code>editWishList.php</code>  and  <code>editWish.php</code>  files. You also create a new file named  <code>deleteWish.php</code> .</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/page-flow-diagram-l7.png" alt="page flow diagram l7">
</div>
</div>
<div class="paragraph">
<p>The current document is a part of the Creating a CRUD Application in the NetBeans IDE for PHP tutorial.</p>
</div>
</div>
<div class="sect1">
<h2 id="_application_source_code_from_the_previous_lesson">Application Source Code from the Previous Lesson</h2>
<div class="sectionbody">
<div class="paragraph">
<p>MySQL users: Click <a href="https://netbeans.org/files/documents/4/1932/lesson6.zip">here</a> to download the source code that reflects the project state after the previous lesson is completed.</p>
</div>
<div class="paragraph">
<p>Oracle Database users: Click <a href="https://netbeans.org/projects/www/downloads/download/php%252Foracle-lesson6.zip">+ here+</a> to download the source code that reflects the project state after the previous lesson is completed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_editing_a_wish">Editing a Wish</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The functionality supports the following use case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On the  <code>editWishList.php</code>  page, the user presses the Edit button to the right of a wish. The  <code>editWish.php</code>  page with the data of the selected wish opens.</p>
</li>
<li>
<p>The user changes the description and/or the due date of the wish and presses the Save Changes button.</p>
</li>
<li>
<p>If the description is <em>not</em> filled in, an error message is displayed and the user returns to the  <code>editWish.php</code>  page.</p>
</li>
<li>
<p>If the description is filled in, the application returns to the  <code>editWishList.php</code>  page, where the wish is updated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The implementation consists of the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#addEditButton">Adding an Edit button on the editWishList page</a></p>
</li>
<li>
<p><a href="#wishArrayUpdate">On the editWish.php page, updating the array $wish for storing wish data</a></p>
</li>
<li>
<p><a href="#updateInputForm">Updating the input form on the editWish.php page</a></p>
</li>
<li>
<p><a href="#updateWishRecord">Validation of the submitted data and updating the wish in the database</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_implementing_the_edit_button">Implementing the Edit Button</h3>
<div class="paragraph">
<p>In  <code>editWishList.php</code> , a table with the wishes of a wisher is implemented by a loop (a  <code>while </code> statement) that displays rows with wishes while the wishes are selected from the database. Add an Edit button as the extreme right cell in a row.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To transfer the ID of a wish through the HTML input form, store it in a variable. Enter the following code line at the end of the  <code>while </code> loop:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">while ($row = ...) {echo ...echo ...*$wishID = $row["id"];*}
?&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Implement the edit button. Add another table cell before the closing &lt;/table&gt; tag, with the editWish form. This form contains a button component and a hidden component that sends the value of  <code>$wishID</code>  when the button is clicked. (Code for the MySQL database is shown, but the added code is the same and in the same location for Oracle Database.)</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-php" data-lang="php">   Hello &lt;?php echo $_SESSION["user"]; ?&gt;&lt;br/&gt;&lt;table border="black"&gt;&lt;tr&gt;&lt;th&gt;Item&lt;/th&gt;&lt;th&gt;Due Date&lt;/th&gt;&lt;/tr&gt;&lt;?phprequire_once("Includes/db.php");$wisherID = WishDB::getInstance()-&gt;get_wisher_id_by_name($_SESSION["user"]);$result = WishDB::getInstance()-&gt;get_wishes_by_wisher_id($wisherID);while ($row = mysqli_fetch_array($result)) {echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["description"]) . "&lt;/td&gt;";echo "&lt;td&gt;" . htmlentities($row["due_date"]) . "&lt;/td&gt;&lt;/tr&gt;\n";}mysqli_free_result($result);?&gt;
            *&lt;td&gt;
                &lt;form name="editWish" action="editWish.php" method="GET"&gt;
                    &lt;input type="hidden" name="wishID" value="&lt;?php echo  ``$wish`` ID; ?&gt;"&gt;
                    &lt;input type="submit" name="editWish" value="Edit"&gt;
                    &lt;/form&gt;
            &lt;/td&gt;*&lt;/table&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Change the  <code>while</code>  loop to use <a href="http://www.php.net/manual/en/control-structures.alternative-syntax.php">alternative syntax</a>. This makes it easy to execute HTML blocks inside the  <code>while</code>  loop. In the alternative  <code>while</code>  loop syntax, the opening curly bracket { is replaced by a colon :, and the ending curly bracket } is replaced by the statement  <code>endwhile;</code> . Replace the opening curly bracket with a colon, delete the closing curly bracket, and add a new PHP block before the closing &lt;/table&gt; tag with the  <code>endwhile;</code>  statement. This encorporates the new table cell into the  <code>while</code>  loop. Move the free result/free statement code to after the  <code>endwhile;</code>  statement. (Again, the code for MySQL is shown, but the code change and location is the same for Oracle Database.)</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-php" data-lang="php">    while ($row = mysqli_fetch_array($result))[.line-through]#{#*:*echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["description"]) . "&lt;/td&gt;";echo "&lt;td&gt;" . htmlentities($row["due_date"]) . "&lt;/td&gt;&lt;/tr&gt;\n";[.line-through]#    }mysqli_free_result($result);#?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
           &lt;input type="hidden" name="wishID" value="&lt;?php echo  ``$wish`` ID; ?&gt;"&gt;
           &lt;input type="submit" name="editWish" value="Edit"&gt;
        &lt;/form&gt;
    &lt;/td&gt;
*    &lt;?php
    endwhile;
    mysqli_free_result($result);
    ?&gt;*
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>4.
Fix the table row syntax. Move the row-closing &lt;/tr&gt;\n characters from the due date echo statement to a new echo statement just above the  <code>endwhile;</code> .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-php" data-lang="php">    while ($row = mysqli_fetch_array($result))*:*echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["description"]) . "&lt;/td&gt;";echo "&lt;td&gt;" . htmlentities($row["due_date"]) . "&lt;/td&gt;[.line-through]#&lt;/tr&gt;\n#";?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
           &lt;input type="hidden" name="wishID" value="&lt;?php echo  ``$wish`` ID; ?&gt;"&gt;
           &lt;input type="submit" name="editWish" value="Edit"&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;?php
    *echo "&lt;/tr&gt;\n";*
    endwhile;
    mysqli_free_result($result);
    ?&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>5.
The entire table, including the form with the Edit button inside the  <code>while </code> loop, now looks like this:</p>
</div>
<div class="paragraph">
<p><strong>For the MySQL database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-php" data-lang="php">&lt;table border="black"&gt;
    &lt;tr&gt;&lt;th&gt;Item&lt;/th&gt;&lt;th&gt;Due Date&lt;/th&gt;&lt;/tr&gt;
    &lt;?php
    require_once("Includes/db.php");
    $wisherID = WishDB::getInstance()-&gt;get_wisher_id_by_name($_SESSION["user"]);
    $result = WishDB::getInstance()-&gt;get_wishes_by_wisher_id($wisherID);
    while($row = mysqli_fetch_array($result)):
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row['description']) . "&lt;/td&gt;";
        echo "&lt;td&gt;" . htmlentities($row['due_date']) . "&lt;/td&gt;";
        $wishID = $row["id"];
    ?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="editWish" value="Edit"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;?php
    echo "&lt;/tr&gt;\n";
    endwhile;
    mysqli_free_result($result);
    ?&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>For Oracle database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-php" data-lang="php">&lt;table border="black"&gt;
    &lt;tr&gt;&lt;th&gt;Item&lt;/th&gt;&lt;th&gt;Due Date&lt;/th&gt;&lt;/tr&gt;
    &lt;?php
    require_once("Includes/db.php");
    $wisherID = WishDB::getInstance()-&gt;get_wisher_id_by_name($_SESSION["user"]);
    $stid = WishDB::getInstance()-&gt;get_wishes_by_wisher_id($wisherID);
    while ($row = oci_fetch_array($stid)):
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["DESCRIPTION"]) . "&lt;/td&gt;";
        echo "&lt;td&gt;" . htmlentities($row["DUE_DATE"]) . "&lt;/td&gt;";
        $wishID = $row["ID"];
    ?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="editWish" value="Edit"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;td&gt;
        &lt;form name="deleteWish" action="deleteWish.php" method="POST"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="deleteWish" value="Delete"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;?php
    echo "&lt;/tr&gt;\n";
    endwhile;
    oci_free_statement($stid);
   ?&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_expanding_the_code_wish_code_array">Expanding the  <code>$wish</code>  Array</h3>
<div class="paragraph">
<p>Upon pressing the Edit button on the  <code>editWishList.php</code>  page, the ID of the selected wish is transferred to the  <code>editWish.php</code>  page through the Server Request method GET. To store the id of the wish, you need to add a new element to the  <code>$wish</code>  array.</p>
</div>
<div class="paragraph">
<p>As when adding a new wish, the input form can be accessed both from the  <code>editWishList.php</code>  page and from the  <code>editWish.php</code>  page after an unsuccessful attempt to save. The cases are distinguished by the Server Request method through which the data is transferred. GET indicates that the form is displayed when the user first gets to the page by pressing Edit Wish. POST indicates that the user is redirected to the form after attempting to save a wish without a description.</p>
</div>
<div class="paragraph">
<p>In  <code>editWish.php</code> , replace the PHP block in the HTML &lt;body&gt; above the  <code>EditWish</code>  input form with expanded code for the  <code>$wish</code>  array.</p>
</div>
<div class="paragraph">
<p><strong>For the MySQL database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-php" data-lang="php">&lt;?phpif ($_SERVER["REQUEST_METHOD"] == "POST")$wish = array("id" =&gt; $_POST["wishID"], "description" =&gt;
        $_POST["wish"], "due_date" =&gt; $_POST["dueDate"]);else if (array_key_exists("wishID", $_GET))$wish = mysqli_fetch_array(WishDB::getInstance()-&gt;get_wish_by_wish_id($_GET["wishID"]));else$wish = array("id" =&gt; "", "description" =&gt; "", "due_date" =&gt; "");?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>For the Oracle database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-php" data-lang="php">&lt;?php
if ($_SERVER["REQUEST_METHOD"] == "POST")
    $wish = array("id" =&gt; $_POST["wishID"], "description" =&gt;
            $_POST["wish"], "due_date" =&gt; $_POST["dueDate"]);
else if (array_key_exists("wishID", $_GET)) {
    $stid = WishDB::getInstance()-&gt;get_wish_by_wish_id($_GET["wishID"]);
    $row = oci_fetch_array($stid, OCI_ASSOC);
    $wish = array("id" =&gt; $row["ID"], "description" =&gt;
                $row["DESCRIPTION"], "due_date" =&gt; $row["DUE_DATE"]);
    oci_free_statement($stid);
} else
$wish = array("id" =&gt; "", "description" =&gt; "", "due_date" =&gt; "");
?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code initializes the  <code>$wish</code>  array with three elements:  <code>id</code> ,  <code>description</code> , and  <code>due_date</code> . The values of these elements depend on the Server Request method. If the Server Request method is POST, the values are received from the input form. Otherwise, if the Server Request method is GET and the $_GET array contains an element with the key "wishID", the values are retrieved from the database by the function get_wish_by_wish_id. Finally, if the Server Request method is neither POST nor GET, which means the Add New Wish use case takes place, the elements are empty.</p>
</div>
<div class="paragraph">
<p>The preceding code covers the cases for creation and editing wishes. Now you need to update the input form so that it can be also used for both cases.</p>
</div>
</div>
<div class="sect2">
<h3 id="_updating_the_html_input_form">Updating the HTML Input Form</h3>
<div class="paragraph">
<p>Currently the input form works when you want to create a new wish and there is no wish id. For the form to work when you want to edit an existing wish, you need to add a hidden field for transferring the ID of a wish. The value of the hidden field must be retrieved from the $wish array. The value must be an empty string during the creation of a new wish. If the wish is edited, the value of the hidden field must change to the ID of the wish. To create this hidden field, add the following line to the top of the  <code>EditWish</code>  input form in  <code>editWish.php</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-php" data-lang="php">&lt;input type="hidden" name="wishID" value="&lt;?php echo  ``$wish`` ["id"];?&gt;" /&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_updating_the_wish_in_the_database">Updating the Wish in the Database</h3>
<div class="paragraph">
<p>Now you need to update the code that verifies the input data and inserts the wish to the database. The current code does not distinguish between creating a new wish case and updating an existing one. In the current implementation, a new record is always added to the database because the code does not verify the value of the wish ID transferred from the input form.</p>
</div>
<div class="paragraph">
<p>You need to add the following functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the transferred element "wishID" is an empty string, create a new wish.</p>
</li>
<li>
<p>Otherwise, if the element "wishID" is not an empty string, update the wish.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>To update editWish.php so that it verifies if a wish is new and updates it if it is not new:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the  <code>update_wish</code>  function to  <code>db.php</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>For the MySQL database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public function update_wish($wishID, $description, $duedate){
    $description = $this-&gt;real_escape_string($description);if ($duedate==''){$this-&gt;query("UPDATE wishes SET description = '" . $description . "',due_date = NULL WHERE id = " . $wishID);} else$this-&gt;query("UPDATE wishes SET description = '" . $description ."', due_date = " . $this-&gt;format_date_for_sql($duedate). " WHERE id = " . $wishID);}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>For the Oracle database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public function update_wish($wishID, $description, $duedate) {
    $query = "UPDATE wishes SET description = :desc_bv, due_date = to_date(:due_date_bv,
              'YYYY-MM-DD')  WHERE id = :wish_id_bv";
    $stid = oci_parse($this-&gt;con, $query);
    oci_bind_by_name($stid, ':wish_id_bv', $wishID);
    oci_bind_by_name($stid, ':desc_bv', $description);
    oci_bind_by_name($stid, ':due_date_bv', $this-&gt;format_date_for_sql($duedate));
    oci_execute($stid);

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the  <code>get_wish_by_wish_id</code>  function to  <code>db.php</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>For the MySQL database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public function get_wish_by_wish_id ($wishID) {return $this-&gt;query("SELECT id, description, due_date FROM wishes WHERE id = " . $wishID);}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>For the Oracle database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public function get_wish_by_wish_id($wishID) {
    $query = "SELECT id, description, due_date FROM wishes WHERE id = :wish_id_bv";
    $stid = oci_parse($this-&gt;con, $query);
    oci_bind_by_name($stid, ':wish_id_bv', $wishID);
    oci_execute($stid);
    return $stid;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the main, top PHP block of  <code>editWish.php</code> , add a condition to the final <code>else</code> statement. This is the  <code>else</code>  statement that inserts the wish to the database. Change it to an  <code>else if</code>  statement:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">else if ($_POST["wishID"]=="") {WishDB::getInstance()-&gt;insert_wish($wisherID, $_POST["wish"], $_POST["dueDate"]);header('Location:  ``editWishList.php`` ' );exit;}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Type or paste another  <code>else if</code>  statement below the one you just edited:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">else if ($_POST["wishID"]!="") {WishDB::getInstance()-&gt;update_wish($_POST["wishID"], $_POST["wish"], $_POST["dueDate"]);header('Location:  ``editWishList.php`` ' );exit;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code checks that the  <code>wishID</code>  element in the  <code>$_POST</code>  array is not an empty string, which means that the user was redirected from the  <code>editWishList.php</code>  page by pressing the Edit button and that the user has filled in the description of the wish. If the check is successful, the code calls the function  <code>update_wish</code>  with the input parameters  <code>wishID</code> ,  <code>description</code> , and  <code>dueDate. </code> These parameters are received from the HTML input form through the POST method. After  <code>update_wish</code>  is called, the application is redirected to the  <code>editWishList.php</code>  page and the PHP processing is canceled.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_the_edit_wish_functionality">Testing the Edit Wish Functionality</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the application. On the index.php page, fill in the fields: in the Username field, enter "Tom", in the Password field, enter "tomcat".
image::images/user-logon-to-edit-wish-list.png[]</p>
</li>
<li>
<p>Press the Edit My Wish List button. The  <code>editWishList.php</code>  page opens.
image::images/edit-wish-list-edit-wish.png[]</p>
</li>
<li>
<p>Click Edit next to Icecream. The  <code>editWish.php</code>  page opens.
image::images/edit-wish.png[]</p>
</li>
<li>
<p>Edit the fields and press Back to the List. The  <code>editWishList.php</code>  page opens but the changes are not saved.</p>
</li>
<li>
<p>Press Edit next to Icecream. Clear the Describe your wish field and press Save Changes. An error message is displayed.
image::images/editWishEmptyDescription.png[]</p>
</li>
<li>
<p>Enter Chocolate icecream in the Describe your wish field and press Save Changes. The  <code>editWishList.php</code>  page opens with the updated list.
image::images/editWishListWishAdded.png[]</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deleting_a_wish">Deleting a Wish</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that you can create, read, and update wishes, add a method for deleting a wish.</p>
</div>
<div class="paragraph">
<p><strong>To enable the user to delete wishes:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add a <code> delete_wish</code>  function to  <code>db.php</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>For the MySQL database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">function delete_wish ($wishID){$this-&gt;query("DELETE FROM wishes WHERE id = " . $wishID);}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>For the Oracle database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public function delete_wish($wishID) {
    $query = "DELETE FROM wishes WHERE id = :wish_id_bv";
    $stid = oci_parse($this-&gt;con, $query);
    oci_bind_by_name($stid, ':wish_id_bv', $wishID);
    oci_execute($stid);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new PHP file named  <code>deleteWish.php</code>  and enter the following code into the &lt;? php ?&gt; block:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">require_once("Includes/db.php");WishDB::getInstance()-&gt;delete_wish ($_POST["wishID"]);header('Location:  ``editWishList.php`` ' );</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code enables the use of the  <code>db.php</code>  file. It then calls the function  <code>delete_wish</code>  from an instance of WishDB, with the  <code>wishID</code>  as the input parameter. Finally, the application is redirected to the  <code>editWishList.php</code>  page.
3. To implement the Delete button, add another HTML table cell to the  <code>while</code>  loop in  <code>editWishList.php</code> , directly below the code block for the  <code>editWish</code>  button. The HTML input form contains a hidden field for the  <code>wishID</code>  and a submit button labelled Delete. (Code for the MySQL database is shown, but the added code is the same and in the same location for Oracle Database.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-php" data-lang="php">    while ($row = mysqli_fetch_array($result))*:*echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["description"]) . "&lt;/td&gt;";echo "&lt;td&gt;" . htmlentities($row["due_date"]) . "&lt;/td&gt;[.line-through]#&lt;/tr&gt;\n#";?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
           &lt;input type="hidden" name="wishID" value="&lt;?php echo  ``$wish`` ID; ?&gt;"&gt;
           &lt;input type="submit" name="editWish" value="Edit"&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    *&lt;td&gt;
        &lt;form name="deleteWish" action="deleteWish.php" method="POST"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="deleteWish" value="Delete"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;*
    &lt;?php
    echo "&lt;/tr&gt;\n";
    endwhile;
    mysqli_free_result($result);
    ?&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The entire table, including the form with the Edit button inside the  <code>while </code> loop, now looks like this:</p>
</div>
<div class="paragraph">
<p><strong>For the MySQL database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-php" data-lang="php">&lt;table border="black"&gt;
    &lt;tr&gt;&lt;th&gt;Item&lt;/th&gt;&lt;th&gt;Due Date&lt;/th&gt;&lt;/tr&gt;
    &lt;?php
    require_once("Includes/db.php");
    $wisherID = WishDB::getInstance()-&gt;get_wisher_id_by_name($_SESSION["user"]);
    $result = WishDB::getInstance()-&gt;get_wishes_by_wisher_id($wisherID);
    while($row = mysqli_fetch_array($result)):
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row['description") . "&lt;/td&gt;";
        echo "&lt;td&gt;" . htmlentities($row['due_date']) . "&lt;/td&gt;";
        $wishID = $row["id"];
    ?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="editWish" value="Edit"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;td&gt;
        &lt;form name="deleteWish" action="deleteWish.php" method="POST"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="deleteWish" value="Delete"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;?php
    echo "&lt;/tr&gt;\n";
    endwhile;
    mysqli_free_result($result);
    ?&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>For Oracle database:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-php" data-lang="php">&lt;table border="black"&gt;
    &lt;tr&gt;&lt;th&gt;Item&lt;/th&gt;&lt;th&gt;Due Date&lt;/th&gt;&lt;/tr&gt;
    &lt;?php
    require_once("Includes/db.php");
    $wisherID = WishDB::getInstance()-&gt;get_wisher_id_by_name($_SESSION["user"]);
    $stid = WishDB::getInstance()-&gt;get_wishes_by_wisher_id($wisherID);
    while ($row = oci_fetch_array($stid)):
        echo "&lt;tr&gt;&lt;td&gt;" . htmlentities($row["DESCRIPTION"]) . "&lt;/td&gt;";
        echo "&lt;td&gt;" . htmlentities($row["DUE_DATE"]) . "&lt;/td&gt;";
        $wishID = $row["ID"];
    ?&gt;
    &lt;td&gt;
        &lt;form name="editWish" action="editWish.php" method="GET"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="editWish" value="Edit"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;td&gt;
        &lt;form name="deleteWish" action="deleteWish.php" method="POST"&gt;
            &lt;input type="hidden" name="wishID" value="&lt;?php echo $wishID; ?&gt;"/&gt;
            &lt;input type="submit" name="deleteWish" value="Delete"/&gt;
        &lt;/form&gt;
    &lt;/td&gt;
    &lt;?php
    echo "&lt;/tr&gt;\n";
    endwhile;
    oci_free_statement($stid);
   ?&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_the_delete_wish_functionality">Testing the Delete Wish Functionality</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To check that the functionality is implemented correctly, press Delete next to any item on the  <code>editWishList.php</code>  page. The item is no longer on the list.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/deleteWish.png" alt="deleteWish">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_application_source_code_after_the_current_lesson_is_completed">Application Source Code after the Current Lesson Is Completed</h2>
<div class="sectionbody">
<div class="paragraph">
<p>MySQL users: Click <a href="https://netbeans.org/files/documents/4/1933/lesson7.zip">+ here+</a> to download the source code that reflects the project state after the lesson is completed.</p>
</div>
<div class="paragraph">
<p>Oracle Database users: Click <a href="https://netbeans.org/projects/www/downloads/download/php%252Foracle-lesson7.zip">+ here+</a> to download the source code that reflects the project state after the lesson is completed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps">Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="wish-list-lesson6.html">&lt;&lt; Previous lesson</a></p>
</div>
<div class="paragraph">
<p><a href="wish-list-lesson8.html">Next lesson &gt;&gt;</a></p>
</div>
<div class="paragraph">
<p><a href="wish-list-tutorial-main-page.html">Back to the Tutorial main page</a></p>
</div>
</div>
</div>
            
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/incubator-netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="JIRA" href="https://issues.apache.org/jira/projects/NETBEANS/summary"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/incubator-netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/php/wish-list-lesson7.asciidoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

        </div>
        

<div class='grid-container incubator-area' style='margin-top: 64px'>
    <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/">
                <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
            </a>
        </div>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/events/current-event.html">
               <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
            </a>
        </div>
    </div>
</div>
<footer>
    <div class="grid-container">
        <div class="grid-x grid-padding-x">
            <div class="large-auto cell">
                
                <h1>About</h1>
                <ul>
                    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                    <li><a href="https://www.apache.org/security/">Security</a></li>
                    <li><a href="https://incubator.apache.org/projects/netbeans.html">Incubation Status</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/community/index.html">Community</a></h1>
                <ul>
                    <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
                    <li><a href="/community/committer.html">Becoming a committer</a></li>
                    <li><a href="/community/events.html">NetBeans Events</a></li>
                    <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
                    <li><a href="/community/who.html">Who is who</a></li>
                    <li><a href="/community/nekobean.html">NekoBean</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/participate/index.html">Participate</a></h1>
                <ul>
                    <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
                    <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
                    <li><a href="/participate/netcat.html">NetCAT - Community Acceptance Testing</a></li>
                    <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/help/index.html">Get Help</a></h1>
                <ul>
                    <li><a href="/help/index.html#documentation">Documentation</a></li>
                    <li><a href="/help/getting-started.html">Platform videos</a></li>
                    <li><a href="/wiki/index.asciidoc">Wiki</a></li>
                    <li><a href="/help/index.html#support">Community Support</a></li>
                    <li><a href="/help/commercial-support.html">Commercial Support</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/download/nb100/nb100.html">Download</a></h1>
                <ul>
                    <li><a href="/download/index.html#releases">Releases</a></li>
                    <ul>
                        <li><a href="/download/nb100/nb100.html">Apache NetBeans 10.0</a></li>
                        <li><a href="/download/nb90/nb90.html">Apache NetBeans 9.0</a></li>
                    </ul>
                    <li><a href="/plugins/index.html">Plugins</a></li>
                    <li><a href="/download/index.html#source">Building from source</a></li>
                    <li><a href="/download/index.html#previous">Previous releases</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<div class='footer-disclaimer'>
    <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2019 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <p><a href="https://incubator.apache.org/" alt="Apache Incubator"><img src='/images/incubator_feather_egg_logo_bw_crop.png' title='Apache Incubator'></img></a></p>
        <div style='max-width: 40em; margin: 0 auto'>
            <p>Apache NetBeans is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</p>
            <p>Apache Incubator, Apache, Apache NetBeans, NetBeans, the Apache feather logo, the Apache NetBeans logo, and the Apache Incubator project logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
            <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
        </div>
        
    </div>
</div>



        <script src="/js/vendor/jquery-3.2.1.min.js"></script>
        <script src="/js/vendor/what-input.js"></script>
        <script src="/js/vendor/jquery.colorbox-min.js"></script>
        <script src="/js/vendor/foundation.min.js"></script>
        <script src="/js/netbeans.js"></script>
        <script>
            
            $(function(){ $(document).foundation(); });
        </script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        <script>
         $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
        </script>
        
    </body>
</html>
