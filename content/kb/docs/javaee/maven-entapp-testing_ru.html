
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Тестирование приложения Maven уровня предприятия</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Тестирование приложения Maven уровня предприятия - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Тестирование приложения Maven уровня предприятия">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet"> 
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 15</h1>
            <p><a class="button success" href="/download/nb15/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">Тестирование приложения Maven уровня предприятия</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/maven-entapp-testing_ru.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_использование_maven_в_среде_ide">Использование Maven в среде IDE</a></li>
<li><a href="#_создание_приложения_уровня_предприятия">Создание приложения уровня предприятия</a>
<ul class="sectlevel2">
<li><a href="#_создание_проекта_веб_приложения">Создание проекта веб-приложения</a></li>
<li><a href="#_создание_класса_сущности">Создание класса сущности</a></li>
<li><a href="#_создание_компонента_сеанса">Создание компонента сеанса</a></li>
</ul>
</li>
<li><a href="#_создание_теста_сеансного_компонента">Создание теста сеансного компонента</a></li>
<li><a href="#_дополнительные_сведения">Дополнительные сведения</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial demonstrates how to test a simple enterprise application using IDE NetBeans and Maven archetypes. В ходе данного учебного курса вы создадите приложение уровня предприятия, содержащее класс сущности и сеансный компонент. Вы будете использовать·мастер для создания простого тестового класса для класса компонента, а затем запустите тестирование в среде IDE. Класс теста создаст экземпляр контейнера EJB, встроенного в GlassFish, для тестирования подключения к базе данных.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Если вы используете GlassFish 3.1.x, ознакомьтесь с разделом <a href="../../73/javaee/maven-entapp-testing.html">Тестирование корпоративного приложения Maven с помощью встроенного сервера GlassFish Server 3.1</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Упражнения по темам руководства</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#intro">Использование Maven в среде IDE</a></p>
</li>
<li>
<p><a href="#Exercise_1">Создание приложения уровня предприятия</a></p>
</li>
<li>
<p><a href="#Exercise_1a">Создание проекта веб-приложения</a></p>
</li>
<li>
<p><a href="#Exercise_1b">Создание класса сущностей</a></p>
</li>
<li>
<p><a href="#Exercise_1c">Создание сеансового компонента</a></p>
</li>
<li>
<p><a href="#Exercise_2">Создание теста сеансного компонента</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Для работы с этим учебным курсом требуется следующее программное обеспечение и ресурсы.</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Программное обеспечение или материал</th>
<th class="tableblock halign-left valign-top">Требуемая версия</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">IDE NetBeans</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.4, 8.0, комплект Java EE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Комплект для разработчика на языке Java (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">версия 7 или 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GlassFish Server Open Source Edition 3.1.2.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.0</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Программа установки для GlassFish Server 3.1.1 включена в загружаемый пакет Java EE. You can install and register GlassFish as part of the IDE NetBeans installation process.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Предпосылки</strong></p>
</div>
<div class="paragraph">
<p>Предполагается, что читатель обладает базовыми знаниями по следующим технологиям или опытом программирования с их использованием:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Программирование на Java</p>
</li>
<li>
<p>IDE NetBeans</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Перед изучением этого учебного курса можно ознакомиться со следующей документацией:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://wiki.netbeans.org/MavenBestPractices">Испытанные приемы для Apache Maven в IDE NetBeans</a></p>
</li>
<li>
<p><a href="http://books.sonatype.com/mvnref-book/reference/introduction.html">Глава 1. Введение в Apache Maven</a> (из книги <a href="http://books.sonatype.com/mvnref-book/reference/index.html">+Maven: The Complete Reference +</a>)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_использование_maven_в_среде_ide">Использование Maven в среде IDE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Support for Maven is fully integrated in IDE NetBeans. Разработка проекта, в котором используется платформа Maven, практически идентична случаю разработки с использованием Ant. Однако в случае Maven имеются некоторые отличия, касающиеся способа сборки проектов и работы с зависимостями. Советы, приведенные ниже, могут помочь избегнуть ряда проблем при первом создании приложения Maven.</p>
</div>
<div class="paragraph">
<p><strong>Проверка параметров Maven</strong></p>
</div>
<div class="paragraph">
<p>Если это ваш первый проект Maven, проверьте параметры настройки Maven в окне "Параметры". Для работы с этим учебным курсом необходимо установить Maven на локальный компьютер. Maven включен в комплект IDE и устанавливается при установке среды IDE.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте окно 'Настройки' в IDE (Сервис &gt; Параметры; NetBeans&gt; Предпочтения на Mac).</p>
</li>
<li>
<p>Выберите в окне "Параметры" категорию "Java" и перейдите на вкладку "Maven".</p>
</li>
<li>
<p>Подтвердите указание домашней страницы Maven.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Можно использовать версию Maven, входящую в комплект среды IDE, либо указать местоположение локальной установки Maven (требуется версия 2.0.9 или более поздняя).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Для закрытия окна "Параметры" нажмите кнопку "ОК".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Примечания.</strong> Поддержка Maven автоматически включается при включении Java в среде IDE. Если нет, необходимо включить подключаемый модуль Java EE.</p>
</div>
<div class="paragraph">
<p><strong>Обновите репозитории Maven</strong></p>
</div>
<div class="paragraph">
<p>Локальные и удаленные репозитории Maven используются для автозавершения кода, а также при сборке проектов. Обновление индексов удаленных репозиториев Maven требуется для обеспечения немедленной доступности всех артефактов, которые могут потребоваться при разработке проекта. Частоту проверки наличия обновлений можно настроить на вкладке "Maven" в окне "Параметры" среды IDE. Вы можете выполнить немедленную проверку обновлений и проверку локальных и удаленных репозиториев Maven в окне 'Службы'.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите меню "Окно" &gt; "Службы". Откроется окно "Службы".</p>
</li>
<li>
<p>Разверните узел 'Репозитории Maven' в окне 'Службы'.</p>
</li>
<li>
<p>Щелкните правой кнопкой мыши узел репозитория и выберите во всплывающем меню 'Обновить индекс'.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При нажатии кнопки "Обновить индексы" в среде IDE выполняется проверка и загрузка самого свежего индекса для каждого из настроенных удаленных репозиториев Maven. Индекс представляет текущее состояние артефактов, расположенных в репозитории, и используется для предоставления ссылок на артефакты, доступных для использования в приложении. По умолчанию артефакты не загружаются из репозитория автоматически без явно обозначенной необходимости в них.</p>
</div>
<div class="paragraph">
<p><strong>Примечания.</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Размер индексов довольно велик и обновление всех индексов может занять значительное время.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Дополнительные сведения об использовании Maven в IDE NetBeans см. в разделе <a href="https://netbeans.org/kb/docs/java/maven-hib-java-se.html#02">Настройка Maven</a> в учебном курсе <a href="https://netbeans.org/kb/docs/java/maven-hib-java-se.html">Создание приложения Swing Maven с помощью Hibernate</a>, а также в <a href="http://wiki.netbeans.org/MavenBestPractices">Испытанные приемы для Apache Maven в IDE NetBeans</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_создание_приложения_уровня_предприятия">Создание приложения уровня предприятия</h2>
<div class="sectionbody">
<div class="paragraph">
<p>В данном разделе вы создадите простое веб-приложение, содержащее класс сущности и сеансный компонент, имеющий доступ к классу сущности.</p>
</div>
<div class="sect2">
<h3 id="_создание_проекта_веб_приложения">Создание проекта веб-приложения</h3>
<div class="paragraph">
<p>Цель этого упражнения заключается в создании веб-приложения Java EE на основе архетипа Maven с помощью мастера создания проектов. После создания проекта с помощью мастера необходимо указать GlassFish Server 3.1.1 в качестве целевого сервера.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите 'Файл' &gt; 'Новый проект' (Ctrl-Shift-N; ⌘-Shift-N в Mac) в главном меню, чтобы открыть мастер создания проектов.</p>
</li>
<li>
<p>Выберите "Веб-приложение" в категории Maven. Нажмите кнопку "Далее".</p>
</li>
<li>
<p>Дайте проекту имя <strong>mavenwebtestapp</strong> и задайте местоположение проекта. Нажмите кнопку "Далее".</p>
</li>
<li>
<p>Выберите сервер GlassFish в раскрывающемся списке 'Сервер'.</p>
</li>
<li>
<p>Выберите Java EE 6 Web или Java EE 7 Web в списке 'Версия Java EE'. Нажмите кнопку "Готово".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>После нажатия кнопки "Готово" среда IDE создает веб-приложение и открывает проект в окне "Проекты".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-testing-projects.png" alt="maven testing projects">
</div>
<div class="title">Figure 1. В окне 'Проекты' отображаются созданные проекты</div>
</div>
<div class="paragraph">
<p>Если развернуть узел проекта в окне 'Проекты', можно увидеть, что файл JAR  <code>javaee-web-api</code>  указан в качестве зависимости проекта, а JDK - в качестве зависимости Java. Среда IDE создала файл POM проекта  <code>pom.xml</code> , и этот файл указан в списке в узле "Файлы проекта".</p>
</div>
</div>
<div class="sect2">
<h3 id="_создание_класса_сущности">Создание класса сущности</h3>
<div class="paragraph">
<p>В данном упражнении будет использован мастер создания файла для создания класса сущности. После создания класса сущности выберите в мастере источник данных  <code>jdbc/sampl</code> . Нет необходимости создавать или регистрировать новый источник данных, поскольку источник данных  <code>jdbc/sample</code>  был зарегистрирован при установке сервера.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Если необходимо создать новый источник данных или использовать другой источник данных, источник данных должен быть зарегистрирован на сервере до тестирования приложения, используя встроенный контейнер. При тестировании приложения с помощью встроенного контейнера среда IDE не зарегистрирует источник данных, в отличие от развертывания на экземпляре сервер GlassFish.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните узел проекта правой кнопкой мыши и выберите команду "Создать" &gt; "Класс сущности".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>В качестве альтернативы можно использовать 'Файл' &gt; 'Создать файл' (Ctrl-N; ⌘-N в Mac) в главном меню и выбрать 'Класс сущности' в категории 'Сохраняемость'.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Введите <strong>MyEntity</strong> для имени класса.</p>
</li>
<li>
<p>Выберите  <code>com.mycompany.mavenwebtestapp</code>  в качестве пакета и установите тип первичного ключа * <code>int</code> *.</p>
</li>
<li>
<p>Подтвердите выбор "Создать единицу сохранения состояния". Нажмите кнопку "Далее".</p>
</li>
<li>
<p>Выберите <strong>jdbc/sample</strong> из раскрывающегося списка "Источник данных".</p>
</li>
<li>
<p>Подтвердите выбор "Использовать интерфейсы API транзакций Java" и выберите "Удалить и создать" в качестве стратегии создания таблицы. Нажмите кнопку 'Готово'.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-testing-pu.png" alt="maven testing pu">
</div>
<div class="title">Figure 2. В окне 'Проекты' отображаются созданные проекты</div>
</div>
<div class="paragraph">
<p>После нажатия кнопки "Готово" среда IDE создает класс MyEntity и открывает его в редакторе исходного кода. В качестве зависимостей проекта IDE добавляет артефакты  <code>eclipselink</code> ,  <code>javax.persistence</code>  и  <code>org.eclipse.persistence.jpa.modelgen.processor</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В редакторе исходного поля добавьте к классу закрытое поле  <code>имя</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private String name;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Правой кнопкой мыши щелкните редактор и выберите "Методы получения и установки" во всплывающем меню "Вставка кода" (Alt-Insert; Ctrl-I на Mac), чтобы создать метод получения и установки для поля  <code>имя</code> .</p>
</li>
<li>
<p>Добавьте следующий конструктор.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public MyEntity(int id) {
    this.id = id;
    name = "Entity number " + id + " created at " + new Date();
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте следующие аннотации  <code>@NamedQueries</code>  и  <code>@NamedQuery</code>  (выделено жирным), чтобы создать запрос SQL с именем, который выполнит поиск всех записей в таблице MyEntity.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Entity
*@NamedQueries({
    @NamedQuery(name = "MyEntity.findAll", query = "select e from MyEntity e")})*
public class MyEntity implements Serializable {</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните подсказку в поле слева, рядом с объявлением класса, и выберите подсказку <strong>Создать конструктор по умолчанию</strong>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-testing-createconstructor.png" alt="maven testing createconstructor">
</div>
<div class="title">Figure 3. В окне 'Проекты' отображаются созданные проекты</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Исправьте импортированные операторы (Ctrl-Shift-I; ⌘-Shift-I в Mac) для добавления операторов импорта для  <code>javax.persistence.NamedQuery</code> ,  <code>javax.persistence.NamedQueries</code>  и  <code>java.util.Date</code> . Сохраните изменения.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_создание_компонента_сеанса">Создание компонента сеанса</h3>
<div class="paragraph">
<p>В данном упражнении для создания сеансного фасада для класса сущности  <code>MyEntity</code>  используется мастер. При использовании мастера для создания фасада среда IDE также создает абстрактный фасад, содержащий такие методы. как  <code>create</code>  и  <code>find</code> , широко используемые при доступе к классам сущностей. Затем к фасаду добавляются два метода.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните узел проекта правой кнопкой мыши и выберите команду "Создать" &gt; "Другие".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>В качестве альтернативы можно использовать 'Файл' &gt; 'Создать файл' (Ctrl-N; ⌘-N в Mac) в главном меню, чтобы открыть мастер создания файлов.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите сеансные компоненты для классов сущностей в категории Enterprise JavaBeans. Нажмите кнопку "Далее".</p>
</li>
<li>
<p>Выберите класс  <code>MyEntity</code>  из списка доступных классов сущностей и нажмите кнопку "Добавить". Нажмите кнопку "Далее".</p>
</li>
<li>
<p>Используйте свойства по умолчанию на панели мастера "Созданные сеансные компоненты". Нажмите кнопку 'Готово'.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При нажатии кнопки "Готово" среда IDE создает  <code>AbstractFacade.java</code>  и  <code>MyEntityFacade.java</code>  в пакете  <code>com.mycompany.mavenwebtestapp</code>  и открывает классы в редакторе исходных кодов.</p>
</div>
<div class="paragraph">
<p>В редакторе исходных кодов можно увидеть, что среда IDE создала код для  <code>EntityManager</code>  и добавила аннотацию  <code>@PersistenceContext</code>  для указания единицы сохранения состояния.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Stateless
public class MyEntityFacade extends AbstractFacade&lt;MyEntity&gt; {
    @PersistenceContext(unitName = "com.mycompany_mavenwebtestapp_war_1.0-SNAPSHOTPU")
    private EntityManager em;

    @Override
    protected EntityManager getEntityManager() {
        return em;
    }

    public MyEntityFacade() {
        super(MyEntity.class);
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте следующие методы к  <code>MyEntityFacade.java</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    @PermitAll
    public int verify() {
        String result = null;
        Query q = em.createNamedQuery("MyEntity.findAll");
        Collection entities = q.getResultList();
        int s = entities.size();
        for (Object o : entities) {
            MyEntity se = (MyEntity) o;
            System.out.println("Found: " + se.getName());
        }

        return s;
    }

    @PermitAll
    public void insert(int num) {
        for (int i = 1; i &lt;= num; i++) {
            System.out.println("Inserting # " + i);
            MyEntity e = new MyEntity(i);
            em.persist(e);
        }
    }</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Исправьте операторы импорта, чтобы добавить импорт всего, что нужно. Сохраните изменения.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-testing-fiximports.png" alt="maven testing fiximports">
</div>
<div class="title">Figure 4. В окне 'Проекты' отображаются созданные проекты</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Убедитесь, что * <code>javax.persistence.Query</code> * выбран в диалоговом окне 'Исправить все выражения импорта'.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_создание_теста_сеансного_компонента">Создание теста сеансного компонента</h2>
<div class="sectionbody">
<div class="paragraph">
<p>В данном разделе создается тестовый класс для сеансного фасада  <code>MyEntityFacade</code> . Среда IDE создаст схему тестовых методов для каждого метода в классе фасада, а также для каждого метода в абстрактном фасаде. Будут аннотированы тестовые методы, созданные для методов в абстрактном фасаде, чтобы указать среде IDE и средству тестирования JUnit игнорировать их. Затем будет изменен тестовый метод для метода <code>verify</code> , добавленного в  <code>MyEntityFacade</code> .</p>
</div>
<div class="paragraph">
<p>В созданных тестах вы увидите, что среда IDE автоматически добавляет код, вызывающий  <code>EJBContainer</code> , для создания экземпляра контейнера EJB.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Правой кнопкой мыши щелкните  <code>MyEntityFacade.java</code>  в окне 'Проекты' и выберите 'Сервис' &gt; 'Создать тесты'.</p>
</li>
<li>
<p>Выберите платформу тестирования из раскрывающегося списка 'Платформа'</p>
</li>
<li>
<p>В диалоговом окне "Создать тесты" используйте параметры по умолчанию. Нажмите кнопку "ОК".</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
При первом создании теста JUnit необходимо указать версию платформы JUnit. Выберите JUnit 4.x как версию JUnit и нажмите 'Выбрать'.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>По умолчанию среда IDE создает скелет тестового класса, содержащий тесты для каждого из методов в  <code>MyEntityFacade</code>  и  <code>AbstractFacade</code> . Среда IDE автоматически добавляет к файлу POM зависимость от JUnit 4.10.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Аннотируйте каждый из тестовых методов, кроме  <code>testVerify</code> , с помощью аннотации  <code>@Ignore</code> . Выполняя тесты, среда IDE пропустит все тесты с аннотацией  <code>@Ignore</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Также можно удалить все тестовые методы, кроме  <code>testVerify</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Расположите метод теста  <code>testVerify</code>  в тестовом классе.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Тест содержит строку, вызывающую  <code>EJBContainer</code> .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    @Test
    public void testVerify() throws Exception {
        System.out.println("verify");
        EJBContainer container = javax.ejb.embeddable.EJBContainer.createEJBContainer();
        MyEntityFacade instance = (MyEntityFacade)container.getContext().lookup("java:global/classes/MyEntityFacade");
        int expResult = 0;
        int result = instance.verify();
        assertEquals(expResult, result);
        container.close();
        // TODO review the generated test code and remove the default call to fail.
        fail("The test case is a prototype.");
    }</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Внесите следующие изменения (выделено полужирным) в схему метода теста  <code>testVerify</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Test
public void testVerify() throws Exception {
    System.out.println("verify");
    EJBContainer container = javax.ejb.embeddable.EJBContainer.createEJBContainer();
    MyEntityFacade instance = (MyEntityFacade)container.getContext().lookup("java:global/classes/MyEntityFacade");
    *System.out.println("Inserting entities...");
    instance.insert(5);*
    int result = instance.verify();
    *System.out.println("JPA call returned: " + result);
    System.out.println("Done calling EJB");
    Assert.assertTrue("Unexpected number of entities", (result == 5));*
    container.close();
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Исправьте выражения импорта для добавления  <code>junit.framework.Assert</code> . Сохраните изменения.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Теперь необходимо внести изменения в файл POM и добавить зависимость от файла  <code>&lt;glassfish.embedded-static-shell.jar&gt;</code> , расположенного в локальном каталоге установки сервера GlassFish.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте файл  <code>pom.xml</code>  в редакторе и найдите элемент  <code>&lt;properties&gt;</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">    &lt;properties&gt;
        &lt;endorsed.dir&gt;${project.build.directory}/endorsed&lt;/endorsed.dir&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Отредактируйте элемент  <code>&lt;properties&gt;</code> , добавив в него элемент  <code>&lt;glassfish.embedded-static-shell.jar&gt;</code>  (выделен <strong>полужирным шрифтом</strong>), указывающий местоположение файла JAR в локальном каталоге установки GlassFish. Затем необходимо создать ссылку на это свойство в зависимости артефакта.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">    &lt;properties&gt;
        &lt;endorsed.dir&gt;${project.build.directory}/endorsed&lt;/endorsed.dir&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        *&lt;glassfish.embedded-static-shell.jar&gt;_&lt;INSTALLATION_PATH&gt;_/glassfish-4.0/glassfish/lib/embedded/glassfish-embedded-static-shell.jar&lt;/glassfish.embedded-static-shell.jar&gt;*

    &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code><em>&lt;INSTALLATION_PATH&gt;</em></code>  - абсолютный путь к локальному каталогу установки GlassFish. В случае изменения пути к локальной установке потребуется изменить этот элемент в файле POM.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните правой кнопкой мыши узел "Зависимости" в окне проектов и выберите пункт "Добавить зависимость".</p>
</li>
<li>
<p>В диалоговом окне 'Добавление зависимости' в текстовом поле 'Запрос' введите <strong>embedded-static-shell</strong>.</p>
</li>
<li>
<p>Выделите файл 4.0 JAR в результатах поиска и нажмите 'Добавить'.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/add-shell-dependency.png" alt="add shell dependency">
</div>
<div class="title">Figure 5. Окно 'Результаты теста'</div>
</div>
<div class="paragraph">
<p>При нажатии на кнопку 'Добавить' среда IDE добавляет зависимость к файлу POM.</p>
</div>
<div class="paragraph">
<p>Теперь нужно внести изменения в файл POM, указав локальный каталог установки GlassFish в качестве источника JAR.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Найдите соответствующую зависимость в файле POM и внесите изменения (выделены <strong>полужирным шрифтом</strong>). Создайте в элементе ссылку на ранее добавленное свойство  <code>&lt;glassfish.embedded-static-shell.jar&gt;</code>  и укажите область ( <code>&lt;scope&gt;</code> ). Сохраните изменения.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">        &lt;dependency&gt;
            &lt;groupId&gt;org.glassfish.main.extras&lt;/groupId&gt;
            &lt;artifactId&gt;glassfish-embedded-static-shell&lt;/artifactId&gt;
            &lt;version&gt;4.0&lt;/version&gt;
            *&lt;scope&gt;system&lt;/scope&gt;
            &lt;systemPath&gt;${glassfish.embedded-static-shell.jar}&lt;/systemPath&gt;*
        &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В окне 'Службы' щелкните правой кнопкой мыши узел GlassFish Server и выберите 'Пуск'.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Сервер базы данных JavaDB будет также запускаться при запуске сервера GlassFish.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В окне 'Проекты' щелкните правой кнопкой мыши узел проекта и выберите 'Тестирование'.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>После выбора пункта "Тест" среда IDE создаст приложение и запустит этап тестирования жизненного цикла сборки. Модульные тесты будут выполнены при помощи подключаемого модуля surefire, который поддерживает запуск тестов JUnit 4.x. Подробнее о подключаемом модуле surefire см. <a href="http://maven.apache.org/plugins/maven-surefire-plugin/">http://maven.apache.org/plugins/maven-surefire-plugin/</a>.</p>
</div>
<div class="paragraph">
<p>Результаты теста отображаются в окне 'Результаты теста'. Можно открыть окно 'Результаты теста', выбрав 'Окно'&gt; 'Выходные данные'&gt; 'Результаты тестов' в главном меню.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-test-results.png" alt="maven test results">
</div>
<div class="title">Figure 6. Окно 'Результаты теста'</div>
</div>
<div class="paragraph">
<p>В окне 'Результаты теста' вы можете нажать на значок 'Прошел успешно' (<span class="image"><img src="images/test-ok_16.png" alt="test ok 16" title="Значок 'Прошел успешно'"></span>), чтобы отобразить список всех тестов, которые прошли успешно. В данном примере можно увидеть девять результатов. Если посмотреть на окно 'Результаты', можно увидеть, что был запущен только один тест, а восемь было пропущено. Пропущенные тесты включены в список тестов, которые прошли в окне 'Результаты теста'.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Running com.mycompany.mavenwebtestapp.MyEntityFacadeTest
verify
...
Inserting entities...
Inserting # 1
Inserting # 2
Inserting # 3
Inserting # 4
Inserting # 5
Found: Entity number 2 created at Wed Oct 09 19:06:59 CEST 2013
Found: Entity number 4 created at Wed Oct 09 19:06:59 CEST 2013
Found: Entity number 3 created at Wed Oct 09 19:06:59 CEST 2013
Found: Entity number 1 created at Wed Oct 09 19:06:59 CEST 2013
Found: Entity number 5 created at Wed Oct 09 19:06:59 CEST 2013
JPA call returned: 5
Done calling EJB
...

Results :

Tests run: 9, Failures: 0, Errors: 0, Skipped: 8</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Creating%20an%20Enterprise%20Application%20Using%20Maven">Отправить отзыв по этому учебному курсу</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_дополнительные_сведения">Дополнительные сведения</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Подробнее об использовании IDE NetBeans для разработки приложений Java EE см. в следующих ресурсах:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javaee-intro.html">+Введение в технологию Java EE +</a></p>
</li>
<li>
<p><a href="javaee-gettingstarted.html">Начало работы с приложениями Java EE</a></p>
</li>
<li>
<p><a href="maven-entapp.html">Создание приложения уровня предприятия с помощью Maven</a></p>
</li>
<li>
<p><a href="../../trails/java-ee.html">Учебная карта по Java EE и Java Web</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Дополнительные сведения по использованию компонентов уровня предприятия приведены в <a href="http://download.oracle.com/javaee/6/tutorial/doc/">учебном курсе по Java EE 6</a>.</p>
</div>
<div class="paragraph">
<p>To send comments and suggestions, get support, and keep informed on the latest developments on the IDE NetBeans Java EE development features, <a href="../../../community/lists/top.html">join the nbj2ee mailing list</a>.</p>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/maven-entapp-testing_ru.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2022 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
