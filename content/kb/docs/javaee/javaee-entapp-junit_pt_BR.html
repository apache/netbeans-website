
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Usando o Container EJB Incorporado para Testar Aplicações Corporativas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Usando o Container EJB Incorporado para Testar Aplicações Corporativas - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Usando o Container EJB Incorporado para Testar Aplicações Corporativas">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">Usando o Container EJB Incorporado para Testar Aplicações Corporativas</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/javaee-entapp-junit_pt_BR.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_testando_um_bean_de_sessão">Testando um Bean de Sessão</a>
<ul class="sectlevel2">
<li><a href="#_criando_o_projeto">Criando o Projeto</a></li>
<li><a href="#_criando_o_bean_de_sessão">Criando o Bean de Sessão</a></li>
<li><a href="#_testando_o_bean_de_sessão">Testando o Bean de Sessão</a></li>
<li><a href="#_modificando_o_teste_para_especificar_propriedades_do_container">Modificando o Teste para Especificar Propriedades do Container</a></li>
<li><a href="#_usando_anotações_beforeclass_e_afterclass">Usando Anotações  <code>@BeforeClass</code>  e  <code>@AfterClass</code></a></li>
</ul>
</li>
<li><a href="#_testando_uma_classe_de_entidade">Testando uma Classe de Entidade</a>
<ul class="sectlevel2">
<li><a href="#_criando_a_classe_de_entidade">Criando a Classe de Entidade</a></li>
<li><a href="#_modificando_o_bean_de_sessão">Modificando o Bean de Sessão</a></li>
<li><a href="#_testando_a_classe_de_entidade">Testando a Classe de Entidade</a></li>
</ul>
</li>
<li><a href="#_fazendo_download_do_projeto_da_solução">Fazendo Download do Projeto da Solução</a></li>
<li><a href="#_consulte_também">Consulte Também</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Esse tutorial demonstra como criar e executar testes JUnit para uma aplicação enterprise Java EE. Neste tutorial, você criará uma aplicação web com uma classe de entidade e um bean de sessão. Primeiro, você criará uma classe de teste JUnit para o bean de sessão e executará o teste no contêiner EJB incorporado. Em seguida, você adicionará uma classe de entidade ao projeto e modificará a classe de teste para adicionar um método de teste para a classe de entidade.</p>
</div>
<div class="paragraph">
<p><strong>Exercícios do Tutorial</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#Exercise_1">Testando um Bean de Sessão</a></p>
</li>
<li>
<p><a href="#Exercise_1a">Criando o Projeto</a></p>
</li>
<li>
<p><a href="#Exercise_1b">Criando o Bean de Sessão</a></p>
</li>
<li>
<p><a href="#Exercise_1c">Testando o Bean de Sessão</a></p>
</li>
<li>
<p><a href="#Exercise_1d">Modificando o Teste para Especificar Propriedades do Container</a></p>
</li>
<li>
<p><a href="#Exercise_1e">Usando Anotações @BeforeClass e @AfterClass</a></p>
</li>
<li>
<p><a href="#Exercise_2">Testando uma Classe de Entidade</a></p>
</li>
<li>
<p><a href="#Exercise_2a">Criando a Classe de Entidade</a></p>
</li>
<li>
<p><a href="#Exercise_2b">Modificando o Bean de Sessão</a></p>
</li>
<li>
<p><a href="#Exercise_2c">Testando a Classe de Entidade</a></p>
</li>
<li>
<p><a href="#Exercise_3">Fazendo Download do Projeto da Solução</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Para seguir este tutorial, são necessários os recursos e o software a seguir.</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software ou Recurso</th>
<th class="tableblock halign-left valign-top">Versão Necessária</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/downloads/">NetBeans IDE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pacote Java EE 7.2, 7.3, 7.4, 8.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK (Java Development Kit)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">versão 7 ou 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GlassFish Server Open Source Edition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.1.x ou 4.x</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Este tutorial requer o plug-in JUnit. Se você não tiver instalado o plug-in JUnit quando instalou o IDE, abra o Gerenciador de Plug-ins, selecione a guia plug-ins Disponíveis e instale o plug-in JUnit.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Pré-requisitos</strong></p>
</div>
<div class="paragraph">
<p>Este tutorial pressupõe que você tenha algum conhecimento básico das tecnologias a seguir, ou alguma experiência de programação com elas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Programação em Java</p>
</li>
<li>
<p>NetBeans IDE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Antes de começar este tutorial, você pode se familiarizar com os seguintes documentos.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javaee-gettingstarted.html">Conceitos Básicos sobre Aplicações do Java EE</a></p>
</li>
<li>
<p><a href="../java/junit-intro.html">Escrevendo Testes JUnit no NetBeans IDE</a></p>
</li>
<li>
<p><a href="http://download.oracle.com/docs/cd/E19798-01/821-1754/gjlde/index.html">Usando a API integrada do EJB 3.1 com o GlassFish Server Incorporado</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Você pode fazer download <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FWebAppJUnit.zip">de um arquivo compactado zip do projeto finalizado</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testando_um_bean_de_sessão">Testando um Bean de Sessão</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nesta sessão, você criará uma aplicação web Java EE simples que conterá uma classe de entidade e um bean de sessão.</p>
</div>
<div class="sect2">
<h3 id="_criando_o_projeto">Criando o Projeto</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Selecione Arquivo &gt; Novo Projeto (Ctrl-Shift-N; ⌘-Shift-N no Mac) no menu principal.</p>
</li>
<li>
<p>Na categoria Java Web, selecione Aplicação Web. Clique em Próximo.</p>
</li>
<li>
<p>Chame o projeto de <strong>WebAppJUnit</strong> e defina a localização do projeto.</p>
</li>
<li>
<p>Desmarque a opção Usar Pasta Dedicada, se ela estiver selecionada.
Clique em Próximo.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Defina o servidor como <strong>GlassFish Server</strong> e defina a versão do Java EE para <strong>Java EE 6 Web</strong> ou <strong>Java EE 7 Web</strong>.
Clique em Finalizar.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_criando_o_bean_de_sessão">Criando o Bean de Sessão</h3>
<div class="paragraph">
<p>Neste exercício, você criará um bean de sessão muito simples que contém um método que adiciona dois números.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no projeto WebAppJUnit na janela Projetos e selecione Novo &gt; Outro.</p>
</li>
<li>
<p>Selecione o Bean de Sessão na categoria Enterprise JavaBeans. Clique em Próximo.</p>
</li>
<li>
<p>Digite <strong>MyBean</strong> como o Nome EJB.</p>
</li>
<li>
<p>Insira <strong>bean</strong> como o Nome do Pacote.</p>
</li>
<li>
<p>Selecione Sem Estado para o Tipo de Sessão. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, a nova classe é aberta no editor.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>No editor, adicione o seguinte método  <code>addNumbers</code>  à classe.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Stateless
public class MyBean {
    *public int addNumbers(int numberA, int numberB) {
        return numberA + numberB;
    }*
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Ele não é necessário para adicionar uma anotação  <code>@LocalBean</code>  ou implementar uma interface neste tutorial. Por default, o bean expõe uma view sem interface quando nenhuma view é especificada explicitamente.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Salve as alterações.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_testando_o_bean_de_sessão">Testando o Bean de Sessão</h3>
<div class="paragraph">
<p>Neste exercício, você criará uma classe de teste para o bean de sessão que testará o método  <code>addNumbers</code> . O IDE pode gerar os novos métodos de classe de teste e de teste esqueleto com base nos métodos da classe de destino.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse na classe  <code>MyBean</code>  na janela Projetos e selecione Ferramentas &gt; Criar Testes.</p>
</li>
<li>
<p>Selecione JUnit na lista drop-down Frameworks.</p>
</li>
<li>
<p>Use os valores default na caixa de diálogo Criar Testes. Clique em OK.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/create-tests-dialog.png" alt="create tests dialog">
</div>
<div class="title">Figure 1. Caixa de diálogo Criar Testes</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Na primeira vez que você criar um teste da unidade JUnit, deverá especificar a versão de JUnit. Selecione a JUnit 4.x na caixa de diálogo Selecionar Versão do JUnit e clique em Selecionar.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Quando você clica em OK, o IDE gera o arquivo  <code>MyBeanTest.java</code>  e abre a classe no editor.</p>
</div>
<div class="paragraph">
<p>Na janela Projetos, você pode ver que o IDE gerou a classe de teste no nó Testar Pacotes. Por default, o IDE gera um método de teste esqueleto na classe de teste que chama  <code>javax.ejb.embeddable.EJBContainer.createEJBContainer()</code>  para criar uma instância do contêiner EJB. O método  <code>createEJBContainer()</code>  é um dos métodos na classe <a href="http://download.oracle.com/javaee/6/api/javax/ejb/embeddable/EJBContainer.html">+  <code>EJBContainer</code> +</a> que faz parte da API integrada do EJB 3.1.</p>
</div>
<div class="paragraph">
<p>Se você expandir o nó Bibliotecas de Teste na janela Projetos, poderá ver que o IDE adicionou automaticamente o GlassFish Server (contêiner incorporado) e o JUnit 4.x como bibliotecas de teste. Se você expandir a biblioteca do GlassFish Server, verá que a biblioteca contém o  <code>glassfish-embedded-static-shell.jar</code> .</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/embedded-static-shell-jar.png" alt="embedded static shell jar">
</div>
<div class="title">Figure 2. Estrutura do projeto na janela Projetos</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
O JAR  <code>glassfish-embedded-static-shell.jar</code>  não contém os códigos-fonte do contêiner EJB incorporado. O JAR  <code>glassfish-embedded-static-shell.jar</code>  requer uma instalação local do GlassFish. O classpath para a instalação local do GlassFish é determinado pelo servidor de destino do projeto. Você pode alterar o servidor de destino na caixa de diálogo Propriedades do projeto.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Modifique o método de teste esqueleto gerado para especificar valores para  <code>numberA</code> ,  <code>numberB</code>  e  <code>expResult</code>  e remova a chamada default para falha.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Test
public void testAddNumbers() throws Exception {
    System.out.println("addNumbers");
    *int numberA = 1;
    int numberB = 2;*
    EJBContainer container = javax.ejb.embeddable.EJBContainer.createEJBContainer();
    MyBean instance = (MyBean)container.getContext().lookup("java:global/classes/MyBean");
    *int expResult = 3;*
    int result = instance.addNumbers(numberA, numberB);
    assertEquals(expResult, result);
    container.close();
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no projeto na janela Projetos e selecione Testar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você executa o teste, a janela Resultados do Teste é aberta no IDE e exibe o andamento e os resultados do teste.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/test-results1.png" alt="test results1">
</div>
<div class="title">Figure 3. Janela Resultados do Teste</div>
</div>
<div class="paragraph">
<p>Você verá uma saída semelhante à seguinte na janela de Saída:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Testsuite: bean.MyBeanTest
addNumbers
...
Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 31.272 sec

------------- Standard Output ---------------
addNumbers
...
------------- ---------------- ---------------
test-report:
test:
BUILD SUCCESSFUL (total time: 35 seconds)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modificando_o_teste_para_especificar_propriedades_do_container">Modificando o Teste para Especificar Propriedades do Container</h3>
<div class="paragraph">
<p>Quando você usou o assistente Criar Testes, o IDE gerou uma classe de teste esqueleto default que continha código para iniciar o contêiner EJB. Neste exercício, você modificará o código gerado que inicia o contêiner para permitir a especificação de propriedades adicionais para a instância do contêiner incorporado.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione o seguinte código (em negrito) à classe de teste.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Test
public void testAddNumbers() throws Exception {
    System.out.println("addNumbers");
    int numberA = 1;
    int numberB = 2;

    // Create a properties map to pass to the embeddable container:
    *Map&lt;String, Object&gt; properties = new HashMap&lt;String, Object&gt;();*
    // Use the MODULES property to specify the set of modules to be initialized,
    // in this case a java.io.File
    *properties.put(EJBContainer.MODULES, new File("build/jar"));*

    // Create the container instance, passing it the properties map:
    EJBContainer container = javax.ejb.embeddable.EJBContainer.createEJBContainer(*properties*);

    // Create the instance using the container context to look up the bean
    // in the directory that contains the built classes
    MyBean instance = (MyBean) container.getContext().lookup("java:global/classes/MyBean");

    int expResult = 3;

    // Invoke the addNumbers method on the bean instance:
    int result = instance.addNumbers(numberA, numberB);

    assertEquals(expResult, result);

    // Close the embeddable container:
    container.close();
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no editor e selecione Corrigir Importações (Alt-Shift-I; ⌘-Shift-I no Mac) para adicionar instruções de importação para  <code>java.util.HashMap</code>  e  <code>java.util.Map</code> .</p>
</li>
<li>
<p>Execute novamente o teste para confirmar se o teste modificado funciona e se o contêiner foi criado corretamente.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Você pode clicar no botão Reexecutar na janela Resultados do Teste.</p>
</div>
</div>
<div class="sect2">
<h3 id="_usando_anotações_beforeclass_e_afterclass">Usando Anotações  <code>@BeforeClass</code>  e  <code>@AfterClass</code></h3>
<div class="paragraph">
<p>Neste exercício, você modificará a classe de teste para criar métodos individuais para criar e encerrar a instância do contêiner. Isso pode ser útil quando você desejar executar vários testes que podem usar a mesma instância do contêiner. Dessa forma, não é necessário abrir e fechar uma instância do contêiner para cada teste e criar, em vez disso, uma instância que é criada de os testes serem executados e fechada depois de todos os testes terem sido concluídos.</p>
</div>
<div class="paragraph">
<p>Neste exercício, você moverá o código que cria o contêiner EJB para o método  <code>setUpClass</code> . O método  <code>setUpClass</code>  é anotado com  <code>@BeforeClass</code>  que é usado para indicar um método que será executado primeiro, antes dos outros métodos na classe de teste. Neste exemplo, a instância do contêiner será criada antes do método de teste  <code>testAddNumbers</code>  e o contêiner existirá até que seja encerrado.</p>
</div>
<div class="paragraph">
<p>De forma semelhante, você moverá o código que encerra o contêiner para o método  <code>tearDownClass</code>  que é anotado com  <code>@AfterClass</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione o campo a seguir à classe de teste.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private static EJBContainer container;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Copie o código que cria o contêiner do método de teste  <code>testAddNumbers</code>  para o método  <code>setUpClass</code>  e</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@BeforeClass
public static void setUpClass() *throws Exception* {
    *Map&lt;String, Object&gt; properties = new HashMap&lt;String, Object&gt;();
    properties.put(EJBContainer.MODULES, new File("build/jar"));
    container = EJBContainer.createEJBContainer(properties);
    System.out.println("Opening the container");*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Copie o código que fecha o contêiner do método de teste  <code>testAddNumbers</code>  para o método  <code>tearDownClass</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@AfterClass
public static void tearDownClass() *throws Exception* {
    *container.close();
    System.out.println("Closing the container");*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Remova o código redundante do método  <code>testAddNumbers</code> . Salve as alterações.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A classe de teste deve se parecer com o seguinte.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class MyBeanTest {
    private static EJBContainer container;

    public MyBeanTest() {
    }

    @BeforeClass
    public static void setUpClass() throws Exception {
        Map&lt;String, Object&gt; properties = new HashMap&lt;String, Object&gt;();
        properties.put(EJBContainer.MODULES, new File("build/jar"));
        container = EJBContainer.createEJBContainer(properties);
        System.out.println("Opening the container");
    }

    @AfterClass
    public static void tearDownClass() throws Exception {
        container.close();
        System.out.println("Closing the container");
    }

    @Before
    public void setUp() {
    }

    @After
    public void tearDown() {
    }

    /**
     * Test of addNumbers method, of class MyBean.
     */
    @Test
    public void testAddNumbers() throws Exception {
        System.out.println("addNumbers");
        int numberA = 1;
        int numberB = 2;

        // Create the instance using the container context to look up the bean
        // in the directory that contains the built classes
        MyBean instance = (MyBean) container.getContext().lookup("java:global/classes/MyBean");

        int expResult = 3;

        // Invoke the addNumbers method on the bean instance:
        int result = instance.addNumbers(numberA, numberB);

        assertEquals(expResult, result);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Caso você execute novamente o teste para confirmar se o contêiner é criado e fechado corretamente, verá uma saída semelhante à seguinte na janela Resultados do Teste.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/test-results2a.png" alt="test results2a">
</div>
<div class="title">Figure 4. Janela Resultados do Teste</div>
</div>
<div class="paragraph">
<p>Você pode ver que o método  <code>setUpClass</code>  foi executado antes do teste  <code>addNumbers</code>  e imprimiu "Abrindo o contêiner".</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testando_uma_classe_de_entidade">Testando uma Classe de Entidade</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nesta sessão, você criará uma classe de entidade e unidade de persistência, e modificará o bean de sessão para injetar o gerenciador de entidades e acessar as entidades. Você adicionará um método simples à nova classe de entidade que imprime o número de id da entrada na saída. Em seguida, você adicionará alguns métodos simples ao bean de sessão para criar e verificar entradas no banco de dados.</p>
</div>
<div class="sect2">
<h3 id="_criando_a_classe_de_entidade">Criando a Classe de Entidade</h3>
<div class="paragraph">
<p>Nesta seção, você usará o assistente Nova Classe de Entidade para criar uma classe de entidade e uma unidade de persistência com os detalhes de conexão do banco de dados.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no projeto WebAppJUnit na janela Projetos e selecione Novo &gt; Outro.</p>
</li>
<li>
<p>Selecione a Classe de Entidade na categoria Persistência. Clique em Próximo.</p>
</li>
<li>
<p>Digite <strong>SimpleEntity</strong> como o Nome da Classe.</p>
</li>
<li>
<p>Selecione bean na lista drop-down Pacote.</p>
</li>
<li>
<p>Digite <strong>int</strong> como o Tipo de Chave Primária. Clique em Próximo.</p>
</li>
<li>
<p>Use o Nome e o Provedor da Unidade de Persistência Default.</p>
</li>
<li>
<p>Selecione  <code>jdbc/sample</code>  como a fonte de dados e Soltar e Criar como a estratégia. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/create-entity-wizard.png" alt="create entity wizard">
</div>
<div class="title">Figure 5. Caixa de diálogo Criar Classe de Entidade</div>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, a nova classe de entidade é aberta no editor. Se você expandir o nó Arquivos de Configuração na janela Projetos, verá que o IDE gerou automaticamente o arquivo  <code>persistence.xml</code>  que define as propriedades da unidade de persistência  <code>WebAppJUnitPU</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>No editor, adicione o campo privado a seguir à classe de entidade.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private String name;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no Editor de Código-Fonte e selecione Inserir Código (Alt-Insert; Ctrl-I no Mac) e selecione Getter e Setter para abrir a caixa de diálogo Gerar Getters e Setters.</p>
</li>
<li>
<p>Selecione o campo  <code>name</code>  na caixa de diálogo. Clique em Gerar.</p>
</li>
<li>
<p>Adicione o seguinte método à classe.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public SimpleEntity(int id) {
    this.id = id;
    name = "Entity number " + id + " created at " + new Date();
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use as anotações  <code>@NamedQueries</code>  e  <code>@NamedQuery</code>  para criar uma consulta SQL nomeada.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Entity
*@NamedQueries({@NamedQuery(name = "SimpleEntity.findAll", query = "select e from SimpleEntity e")})*
public class SimpleEntity implements Serializable {</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Crie um construtor default.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Você pode clicar no ícone de sugestão exibido na medianiz, próximo à declaração de classe, se quiser que o IDE gere o construtor para você.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Corrija suas importações para adicionar instruções de importação para  <code>javax.persistence.NamedQueries</code> ,  <code>javax.persistence.NamedQuery</code>  e  <code>java.util.Date</code> . Salve as alterações.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Além do código default gerado, a classe de entidade agora deve ser semelhante a:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package bean;

import java.io.Serializable;
import java.util.Date;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.NamedQueries;
import javax.persistence.NamedQuery;


@Entity
@NamedQueries({@NamedQuery(name = "SimpleEntity.findAll", query = "select e from SimpleEntity e")})
public class SimpleEntity implements Serializable {
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private int id;

    private String name;

    public SimpleEntity() {
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public SimpleEntity(int id) {
        this.id = id;
        name = "Entity number " + id + " created at " + new Date();
    }



    ...

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modificando_o_bean_de_sessão">Modificando o Bean de Sessão</h3>
<div class="paragraph">
<p>Neste exercício, você editará o bean de sessão  <code>MyBean</code>  para adicionar métodos para inserir e recuperar dados para a tabela do banco de dados.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Abra  <code>MyBean.java</code>  no editor.</p>
</li>
<li>
<p>Clique com o botão direito do mouse no editor, selecione Inserir Código (Alt-Insert; Ctrl-I no Mac) e selecione Usar Gerenciador de Entidades no menu pop-up.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você tiver selecionado Usar Gerenciador de Entidades, o IDE terá adicionado o código a seguir à classe para injetar o gerenciador de entidades. Você pode ver que o nome da unidade de persistência foi gerado automaticamente.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@PersistenceContext(unitName="WebAppJUnitPU")
private EntityManager em;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione os seguintes métodos  <code>verify</code>  e  <code>insert</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@PermitAll
public int verify() {
    String result = null;
    Query q = em.createNamedQuery("SimpleEntity.findAll");
    Collection entities = q.getResultList();
    int s = entities.size();
    for (Object o : entities) {
        SimpleEntity se = (SimpleEntity)o;
        System.out.println("Found: " + se.getName());
    }

    return s;
}

@PermitAll
public void insert(int num) {
    for (int i = 1; i &lt;= num; i++) {
        System.out.println("Inserting # " + i);
        SimpleEntity e = new SimpleEntity(i);
        em.persist(e);
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Corrija suas importações para importar o  <code>javax.persistence.Query</code>  e salve as alterações.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_testando_a_classe_de_entidade">Testando a Classe de Entidade</h3>
<div class="paragraph">
<p>Neste exercício, você editará a classe de teste para adicionar um método para testar se a aplicação pode procurar o EJB e se os métodos  <code>insert</code>  e  <code>verify</code>  estão se comportando corretamente.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Inicie o banco de dados JavaDB.</p>
</li>
<li>
<p>Abra a classe de teste  <code>MyBeanTest.java</code>  no editor.</p>
</li>
<li>
<p>Edite a classe de teste para adicionar o seguinte método de teste  <code>testInsert</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Test
public void testInsert() throws Exception {

    // Lookup the EJB
    System.out.println("Looking up EJB...");
    MyBean instance = (MyBean) container.getContext().lookup("java:global/classes/MyBean");

    System.out.println("Inserting entities...");
    instance.insert(5);
    int res = instance.verify();
    System.out.println("JPA call returned: " + res);
    System.out.println("Done calling EJB");

    Assert.assertTrue("Unexpected number of entities", (res == 5));
    System.out.println("..........SUCCESSFULLY finished embedded test");
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na janela Projetos, clique com o botão direito do mouse no nó do projeto e escolha Testar no menu pop-up.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A janela Resultados do teste será aberta e exibirá uma saída semelhante à seguinte.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/test-results2b.png" alt="test results2b">
</div>
<div class="title">Figure 6. A janela Resultados do Teste depois da adição do teste testInsert</div>
</div>
<div class="paragraph">
<p>Você pode ver o andamento dos testes e a ordem na qual eles foram executados nas mensagens impressas que foram adicionadas à classe de teste.</p>
</div>
<div class="paragraph">
<p>Agora que você tem um teste para seu bean de sessão e sabe que a conexão de sua classe de entidade funciona, pode começar a codificar uma interface web para a aplicação.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fazendo_download_do_projeto_da_solução">Fazendo Download do Projeto da Solução</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Você pode fazer o download da solução para este projeto como um projeto das seguintes formas.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Faça download <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FWebAppJUnit.zip">de um arquivo compactado zip do projeto finalizado</a>.</p>
</li>
<li>
<p>Faça o check-out do código-fonte do projeto das Amostras do NetBeans ao executar as etapas a seguir:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Escolha Equipe &gt; Subversion &gt; Efetuar check-out no menu principal.</p>
</li>
<li>
<p>Na caixa de diálogo Check-out, insira o URL de Repositório a seguir:
 <code><a href="https://svn.netbeans.org/svn/samples~samples-source-code" class="bare">https://svn.netbeans.org/svn/samples~samples-source-code</a></code>
Clique em Próximo.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Procurar para abrir a caixa de diálogo Procurar Pastas do Repositório.</p>
</li>
<li>
<p>Expanda o nó raiz e selecione <strong>samples/javaee/WebAppJUnit</strong>. Clique em OK.</p>
</li>
<li>
<p>Especifique a Pasta Local para o códigos-fonte (a pasta local precisa estar vazia).</p>
</li>
<li>
<p>Clique em Finalizar.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, o IDE inicializa a pasta local como um repositório Subversion e verifica os códigos-fonte do projeto.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Abrir Projeto na caixa de diálogo exibida quando o check-out for concluído.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
É necessário um cliente Subversion para verificar os códigos-fonte. Para saber mais sobre a instalação do Subversion, consulte a seção <a href="../ide/subversion.html#settingUp">Configurando o Subversion</a> no <a href="../ide/subversion.html">Guia do Subversion no NetBeans IDE</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Using%20the%20Embedded%20EJB%20Container">Enviar Feedback neste Tutorial</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_consulte_também">Consulte Também</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para obter mais informações sobre o uso do NetBeans IDE para desenvolver aplicações Java EE, consulte os seguintes recursos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javaee-intro.html">Introdução à Tecnologia Java EE</a></p>
</li>
<li>
<p><a href="javaee-gettingstarted.html">Conceitos Básicos sobre Aplicações do Java EE</a></p>
</li>
<li>
<p><a href="../web/quickstart-webapps.html">Introdução ao Desenvolvimento de Aplicações Web</a></p>
</li>
<li>
<p><a href="../../trails/java-ee.html">Trilha de Aprendizado do Java EE e Java Web</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Você pode encontrar mais informações sobre o uso do Enterprise Beans EJB 3.1 no <a href="http://download.oracle.com/javaee/6/tutorial/doc/">Tutorial do Java EE 6</a>.</p>
</div>
<div class="paragraph">
<p>Para enviar comentários e sugestões, obter suporte e se manter informado sobre os mais recentes desenvolvimentos das funcionalidades de desenvolvimento do Java EE do NetBeans IDE, <a href="../../../community/lists/top.html">inscreva-se na lista de correspondência de nbj2ee</a>.</p>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/javaee-entapp-junit_pt_BR.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
