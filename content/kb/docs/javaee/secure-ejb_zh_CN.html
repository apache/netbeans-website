
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>在 Java EE 中构建安全企业 Bean</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="在 Java EE 中构建安全企业 Bean - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, 在 Java EE 中构建安全企业 Bean">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">在 Java EE 中构建安全企业 Bean</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/secure-ejb_zh_CN.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_在应用服务器上创建安全组">在应用服务器上创建安全组</a></li>
<li><a href="#_为远程接口创建_java_类库">为远程接口创建 Java 类库</a></li>
<li><a href="#_创建和保护企业应用程序">创建和保护企业应用程序</a>
<ul class="sectlevel2">
<li><a href="#_创建企业应用程序项目">创建企业应用程序项目</a></li>
<li><a href="#_确保会话_bean_中的方法安全">确保会话 Bean 中的方法安全</a></li>
<li><a href="#_配置部署描述符">配置部署描述符</a></li>
</ul>
</li>
<li><a href="#_创建应用程序客户端">创建应用程序客户端</a></li>
<li><a href="#_运行应用程序">运行应用程序</a></li>
<li><a href="#_另请参见">另请参见</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>通过 NetBeans IDE 中的 Java EE 规范支持，您可以充分利用许多 Java EE 功能来简化应用程序开发。Java EE 5 规范的一个重大改进是采用了标注。使用标注，您可以消除在对应用程序进行编码时所使用的许多模板代码，并最大限度地减少部署应用程序时所需的配置量。</p>
</div>
<div class="paragraph">
<p>通过使用标注而得到极大简化的一个领域是企业 Bean 的开发和配置。使用标注，您可以指定以前在部署描述符文件中所指定的许多配置属性，从而使很多部署描述符文件变得不再必需。尽管应用程序可能仍然需要一些部署描述符文件（如  <code>web.xml</code> ），但 IDE 的多视图部署描述符编辑器大大简化了对这些文件的编辑。</p>
</div>
<div class="paragraph">
<p>通过使用标注，现在构建安全的企业 Bean 要简单得多。您可以使用安全标注直接在源代码中配置授权，而无需在  <code>ejb-jar.xml</code>  部署描述符中配置企业 Bean 安全性。Java EE 5 企业应用程序不需要  <code>ejb-jar.xml</code>  或  <code>application.xml</code> 。</p>
</div>
<div class="paragraph">
<p>有关 Java EE 规范的一些特性的概述，请参见 <a href="javaee-intro.html">Java EE 技术简介</a>。有关标注规范的详细信息，请参见 <a href="http://jcp.org/en/jsr/detail?id=250">JSR 250：Java 平台的常用标注</a>。</p>
</div>
<div class="paragraph">
<p><strong>要学习本教程，您需要具备以下软件和资源。</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">软件或资源</th>
<th class="tableblock halign-left valign-top">要求的版本</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">NetBeans IDE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.2、7.3、7.4、8.0、Java EE 版本</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java 开发工具包 (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">版本 7 或 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GlassFish Server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.1.x、4.x</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>在学习本教程之前，您需要在 IDE 中注册 GlassFish Server 的本地实例。如果您安装了 "Java EE" 版本的 IDE，则应已安装并注册应用服务器。如果在 IDE 中未注册该应用服务器，请选择 "Tools"（工具）&gt; "Servers"（服务器），以在服务器管理器中注册它。您不能将企业应用程序部署到 Tomcat Web 服务器。</p>
</div>
<div class="paragraph">
<p><strong>先决条件</strong></p>
</div>
<div class="paragraph">
<p>本文档假定您具备以下技术的一些基本知识或编程经验：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java 编程</p>
</li>
<li>
<p>NetBeans IDE</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_在应用服务器上创建安全组">在应用服务器上创建安全组</h2>
<div class="sectionbody">
<div class="paragraph">
<p>在本示例中，您仅希望  <code>bank_users</code>  组的用户访问企业 Bean。您将在应用服务器  <code>file</code>  安全领域的  <code>bank_users</code>  组中创建  <code>manager</code>  用户。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>启动应用服务器，方法是：在 "Services"（服务）窗口中右键单击应用服务器的节点，然后选择 "Start"（启动）。</p>
</li>
<li>
<p>右键单击应用服务器节点，然后选择 "View Domain Admin Console"（查看域管理控制台），以便在浏览器中打开 GlassFish Server 管理控制台。</p>
</li>
<li>
<p>展开左导航栏中 "Configurations"（配置）节点下方的 <strong>server-config</strong> 节点。</p>
</li>
<li>
<p>单击 <strong>"Security"（安全性）&gt; "Realms"（领域）&gt; "file"</strong>，以打开 "Edit Realm"（编辑领域）框架。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/console-file-realm.png" alt="console file realm">
</div>
<div class="title">Figure 1. 在应用服务器的管理控制台中选择文件领域节点</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>单击 "Edit Realm"（编辑领域）面板顶部的 "Manage Users"（管理用户）按钮，打开 "File Users"（文件用户）面板。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/console-edit-realm.png" alt="console edit realm" width="Edit Realm"（编辑领域）面板代码"">
</div>
<div class="title">Figure 2. 应用服务器的管理控制台中的 </div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>单击 "File Users"（文件用户）面板中 "File Users"（文件用户）表顶部的 "New"（新建）按钮。</p>
</li>
<li>
<p>在 "New File Realm User"（新建文件领域用户）窗体中输入以下数据。单击 "OK"（确定）。</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">名称</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">值</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">用户 ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">manager</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">组列表</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bank_users</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>该窗体应与下图类似。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/console-new-user.png" alt="console new user" width="New File Realm User"（新建文件领域用户）面板"">
</div>
<div class="title">Figure 3. 应用服务器的管理控制台中的 </div>
</div>
<div class="paragraph">
<p>在单击 "OK"（确定）后，该服务器将创建用户，并打开 "File Users"（文件用户）面板。您将会看到，现在有一个名为  <code>manager</code>  的用户。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/console-file-users.png" alt="console file users" width="File Users"（文件用户）面板"">
</div>
<div class="title">Figure 4. 管理控制台中包含用户列表的 </div>
</div>
<div class="paragraph">
<p>创建用户之后，将创建企业应用程序，以检查该用户是否能够查看数据。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_为远程接口创建_java_类库">为远程接口创建 Java 类库</h2>
<div class="sectionbody">
<div class="paragraph">
<p>在本练习中，将创建一个简单的 Java 类库项目，其中包含会话 Bean 的远程接口。然后，将编译的类库 JAR 添加到 EJB 模块以及用于调用会话 Bean 的应用程序客户端的类路径中。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>选择 "File"（文件）&gt; "New Project"（新建项目），然后在 "Java" 类别中选择 "Java Class Library"（Java 类库）。单击 "Next"（下一步）。</p>
</li>
<li>
<p>键入 SecureRemoteInterface 作为项目名称。</p>
</li>
<li>
<p>指定项目的位置。单击 "Finish"（完成）。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>在下一部分中，将在企业应用程序中创建一个会话 Bean。该会话 Bean 可通过远程接口进行访问。在创建会话 Bean 时，IDE 将自动创建类库中的远程接口，并将类库 JAR 添加到企业应用程序的类路径中。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_创建和保护企业应用程序">创建和保护企业应用程序</h2>
<div class="sectionbody">
<div class="paragraph">
<p>企业应用程序中将包含一个简单的会话 Bean，该会话 Bean 可通过类库项目中的远程接口进行访问。</p>
</div>
<div class="sect2">
<h3 id="_创建企业应用程序项目">创建企业应用程序项目</h3>
<div class="paragraph">
<p>在本练习中，将创建一个包含 EJB 模块的企业应用程序。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>选择 "File"（文件）&gt; "New Project"（新建项目）（Ctrl-Shift-N 组合键；在 Mac 上为 ⌘-Shift-N 组合键），然后从 "Java EE" 类别中选择 "Enterprise Application"（企业应用程序）模板。单击 "Next"（下一步）。</p>
</li>
<li>
<p>键入 <strong>Secure</strong> 作为项目名称，并设置项目位置。</p>
</li>
<li>
<p>取消选中 "Use Dedicated Folder"（使用专用文件夹）选项（如果该选项处于选中状态）。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>在本教程中，我们将项目库复制到一个专门的文件夹中，因为需要与其他用户或项目共享库。</p>
</div>
<div class="paragraph">
<p>单击 "Next"（下一步）。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>将服务器设置为 "GlassFish"，并将 Java EE 版本设置为 "Java EE 6"。</p>
</li>
<li>
<p>选中 "Create EJB Module"（创建 EJB 模块），并取消选中 "Create Web Application Module"（创建 Web 应用程序模块）。单击 "Finish"（完成）。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new-entapp-wizard.png" alt="new entapp wizard" width="New File Realm User"（新建文件领域用户）面板"">
</div>
<div class="title">Figure 5. 应用服务器的管理控制台中的 </div>
</div>
</div>
<div class="sect2">
<h3 id="_确保会话_bean_中的方法安全">确保会话 Bean 中的方法安全</h3>
<div class="paragraph">
<p>在本练习中，将在 EJB 模块项目中创建一个会话 Bean。该会话 Bean 没有任何特殊的功能。它仅仅返回一个余额样例。您将创建一个  <code>getStatus</code>  方法，并通过使用  <code>@RolesAllowed</code>  标注对其进行标注以保护该方法 Bean，然后指定可以访问该方法的安全角色。此安全角色由应用程序使用，它与服务器上的用户和组不同。此后，将在配置部署描述符时将此安全角色映射到用户和组。</p>
</div>
<div class="paragraph">
<p>安全标注可以分别应用于类中的每个方法，也可以应用于整个类。在此简单练习中，将使用  <code>@RolesAllowed</code>  标注方法，但 Java EE 规范还定义了其他可用在企业 Bean 中的安全标注。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在 "Projects"（项目）窗口中，右键单击 EJB 模块的节点 (Secure-ejb)，然后选择 "New"（新建）&gt; "Session Bean"（会话 Bean）。</p>
</li>
<li>
<p>键入 <strong>AccountStatus</strong> 作为 Bean 名称，并键入 <strong>bean</strong> 作为包。</p>
</li>
<li>
<p>选中 "Remote in project"（以远程方式位于项目中）作为接口类型。</p>
</li>
<li>
<p>在下拉列表中选择 "SecureRemoteInterface"。单击 "Finish"（完成）。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new-sessionbean-wizard.png" alt="new sessionbean wizard">
</div>
<div class="title">Figure 6. 新建会话 Bean 向导中选中了远程接口</div>
</div>
<div class="paragraph">
<p>单击 "Finish"（完成），此时 IDE 将创建  <code>AccountStatus</code>  类并在源代码编辑器中打开该文件。</p>
</div>
<div class="paragraph">
<p>IDE 还将在 SecureRemoteInterface 类库项目中为  <code>bean</code>  包中的 Bean 创建  <code>AccountStatusRemote</code>  远程接口，并将 SecureRemoteInterface 类库 JAR 添加到了 EJB 模块项目的类路径中。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/projects-window-bean.png" alt="projects window bean" width="Projects"（项目）窗口"">
</div>
<div class="title">Figure 7. 显示类路径上的会话 Bean 和类库的 </div>
</div>
<div class="paragraph">
<p>如果打开 EJB 模块的 "Properties"（属性）对话框的 "Libraries"（库）类别，则会看到 JAR 已添加到编译时库中。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在源代码编辑器中，将以下字段声明（以粗体显示）添加到  <code>AccountStatus</code>  中：</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class AccountStatus implements AccountStatusRemote {
    *private String amount = "250";*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在源代码编辑器中，右键单击类，并选择 "Insert Code"（插入代码）（Alt-Insert 组合键；在 Mac 上为 Ctrl-I 组合键），然后选择 "Add Business Method"（添加 Business 方法），以打开 "Add Business Method"（添加 Business 方法）对话框。</p>
</li>
<li>
<p>键入 <strong>getStatus</strong> 作为方法名称，并将返回类型设置为  <code>String</code> 。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>IDE 将自动在远程接口中公开此业务方法。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在源代码编辑器中，将以下代码行（以粗体显示）添加到  <code>getStatus</code>  方法中。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public String getStatus() {
*    return "The account contains $" + amount;*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>键入以下内容（以粗体显示）来标注  <code>getStatus</code>  方法。<strong>@RolesAllowed({"USERS"})</strong></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public String getStatus() {</code></pre>
</div>
</div>
<div class="paragraph">
<p>此标注表示只有安全角色为  <code>USERS</code>  的用户才能访问  <code>getStatus</code>  方法。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在编辑器中右键单击并选择 "Fix Imports"（修复导入）（Alt-Shift-I 组合键；在 Mac 中为 ⌘-Shift-I 组合键），然后保存您的更改。确保  <code>javax.annotation.security.RolesAllowed</code>  已添加到该文件中。</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_配置部署描述符">配置部署描述符</h3>
<div class="paragraph">
<p>Java EE 企业应用程序通常不需要部署描述符文件，如  <code>ejb-jar.xml</code> 。如果展开 Secure-ejb 或 Secure 企业应用程序下面的 "Configuration Files"（配置文件）节点，则会看到没有部署描述符。您可以使用标注指定很多已在  <code>ejb-jar.xml</code>  中配置的属性。在本示例中，您通过在会话 Bean 中使用  <code>@RolesAllowed</code>  标注为 EJB 方法指定了安全角色。</p>
</div>
<div class="paragraph">
<p>不过，在为应用程序配置安全性时，仍然需要在部署描述符中指定一些属性。在本示例中，您需要将企业应用程序中使用的安全角色 ( <code>USERS</code> ) 映射到在应用服务器上配置的用户和组。您已在应用服务器上创建了  <code>bank_users</code>  组，现在需要将该组映射到企业应用程序中的安全角色  <code>USERS</code> 。为此，可以编辑企业应用程序的  <code>glassfish-application.xml</code>  部署描述符。</p>
</div>
<div class="paragraph">
<p>因为企业应用程序不需要部署描述符便可运行，所以 IDE 默认情况下不创建部署描述符。因此，首先需要创建部署描述符文件，然后在多视图编辑器中编辑该文件，以配置安全角色映射。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>右键单击 "Secure" 企业应用程序项目，然后选择 "New"（新建）&gt; "Other"（其他），以打开新建文件向导。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>此外，也可以从主菜单中选择 "File"（文件）&gt; "New File"（新建文件），以打开新建文件向导。在这种情况下，请确保在 "Project"（项目）下拉列表中选择了 "Secure" 项目。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>选择 "GlassFish" 类别，然后再选择 "GlassFish Descriptor"（GlassFish 描述符）文件类型。单击 "Next"（下一步）。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new-gf-descriptor.png" alt="new gf descriptor">
</div>
<div class="title">Figure 8. 新建文件向导中的 GlassFish 描述符文件类型</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>接受该向导中的默认值，然后单击 "Finish"（完成）。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>单击 "Finish"（完成），此时 IDE 将创建  <code>glassfish-application.xml</code>  并在多视图编辑器中打开该文件。</p>
</div>
<div class="paragraph">
<p>如果在 "Projects"（项目）窗口中展开 "Secure" 企业应用程序项目节点，则可以看到描述符文件在 "Configuration Files"（配置文件）节点的下方创建。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/glassfish-application-descriptor.png" alt="glassfish application descriptor" width="Security"（安全）标签"">
</div>
<div class="title">Figure 9. 多视图编辑器中的 </div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在多视图编辑器的 "Security"（安全）标签中，单击 "Add Security Role Mapping"（添加安全角色映射），然后在 "Security Role Name"（安全角色名称）中键入 <strong>USERS</strong>。</p>
</li>
<li>
<p>单击 "Add Group"（添加组），然后在对话框的 "Group Name"（组名称）中键入 <strong>bank_users</strong>。单击 "OK"（确定）。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>编辑器现在应如下所示。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/security-tab-descriptor.png" alt="security tab descriptor" width="Security"（安全）标签"">
</div>
<div class="title">Figure 10. 多视图编辑器中的 </div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>保存所做的更改。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>通过单击多视图编辑器中的 "XML" 标签，可以在 XML 视图中查看部署描述符文件。您可以看到该部署描述符文件现在包含以下代码：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;glassfish-application&gt;
  &lt;security-role-mapping&gt;
    &lt;role-name&gt;USERS&lt;/role-name&gt;
    &lt;group-name&gt;bank_users&lt;/group-name&gt;
  &lt;/security-role-mapping&gt;
&lt;/glassfish-application&gt;</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>``getStatus``  方法现在是安全的，只有在服务器上指定的  ``bank_users``  组中的用户才能访问该方法。</pre>
</div>
</div>
<div class="paragraph">
<p>现在，您需要一种安全设置测试方法。最简单的方法是，创建一个基本应用程序客户端，以提示用户输入用户名和口令。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_创建应用程序客户端">创建应用程序客户端</h2>
<div class="sectionbody">
<div class="paragraph">
<p>在本部分中，将创建一个简单的应用程序客户端，以访问  <code>AccountStatus</code>  会话 Bean。您可以在代码中使用  <code>@EJB</code>  标注，以便通过远程接口调用 Bean。IDE 会将包含该接口的类库 JAR 自动添加到应用程序客户端的类路径中。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>选择 "File"（文件）&gt; "New Project"（新建项目），然后在 "Java EE" 类别中选择 "Enterprise Application Client"（企业应用程序客户端）。单击 "Next"（下一步）。</p>
</li>
<li>
<p>键入 SecureAppClient 作为项目名称。单击 "Next"（下一步）。</p>
</li>
<li>
<p>在 "Add to Enterprise Application"（添加到企业应用程序）下拉列表中选择 <strong>&lt;None&gt;</strong>。</p>
</li>
<li>
<p>在 "Server"（服务器）下拉列表中选择 "GlassFish Server"，并选择 "Java EE 6" 或 "Java EE 7" 作为 Java EE 版本。单击 "Finish"（完成）。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>单击 "Finish"（完成），此时将在源代码编辑器中打开  <code>Main.java</code> 。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在源代码编辑器中，右键单击  <code>Main.java</code>  文件，并选择 "Insert Code"（插入代码）（Alt-Insert 组合键；在 Mac 上为 Ctrl-I 组合键），然后选择 "Call Enterprise Bean"（调用企业 Bean）。</p>
</li>
<li>
<p>在 "Call Enterprise Bean"（调用企业 Bean）对话框中，展开 "Secure-ejb" 节点，然后选择 "AccountStatus"。单击 "OK"（确定）。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/call-enterprise-bean.png" alt="call enterprise bean" width="Call Enterprise Bean"（调用企业 Bean）对话框中选中了接口"">
</div>
<div class="title">Figure 11. </div>
</div>
<div class="paragraph">
<p>IDE 将在应用程序客户端中添加以下代码，用于查找会话 Bean。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@EJB
private static AccountStatusRemote accountStatus;</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果在 "Projects"（项目）窗口中展开 "Libraries"（库）节点，则可以看到 IDE 已将 SecureRemoteInterface JAR 添加到了项目类路径中。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>通过添加以下代码来修改  <code>main</code>  方法，然后保存所做的更改。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public static void main(String[] args) {
    *System.out.println(accountStatus.getStatus());*
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>有关应用程序客户端的详细信息，请参见<a href="entappclient.html">在 GlassFish Server 上创建和运行应用程序客户端</a>。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_运行应用程序">运行应用程序</h2>
<div class="sectionbody">
<div class="paragraph">
<p>现在该应用程序已准备就绪。首先，将企业应用程序部署到服务器。部署企业应用程序之后，可以运行应用程序客户端，以测试该企业应用程序中的方法是否安全，以及用户角色映射是否正确。在运行应用程序客户端时，系统将提示您输入  <code>bank_users</code>  组中用户的用户名和口令。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在 "Projects"（项目）窗口中右键单击 "Secure" 企业应用程序项目节点，然后选择 "Deploy"（部署）。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>在单击 "Deploy"（部署）后，IDE 将构建 EAR 文件，启动应用服务器（如果没有运行），并将该 EAR 文件部署到该服务器。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在 "Projects"（项目）窗口中右键单击 "SecureAppClient" 项目节点，然后选择 "Run"（运行）。此时将出现一个对话框，提示您输入用户名和口令。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/login-window.png" alt="login window">
</div>
<div class="title">Figure 12. 提示输入用户名和口令的登录窗口</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在对话框中输入用户名 ( <code>manager</code> ) 和口令 ( <code>password</code> )，然后单击 "OK"（确定）。"Output"（输出）窗口中将显示以下内容：</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">The account contains 250$</code></pre>
</div>
</div>
<div class="paragraph">
<p>这是一个非常基本的示例，用于说明如何使用 Java 标注保护企业 Bean 中的方法。</p>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Building%20Secure%20Enterprise%20Beans">发送有关此教程的反馈意见</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_另请参见">另请参见</h2>
<div class="sectionbody">
<div class="paragraph">
<p>有关使用标注和部署描述符来确保企业 Bean 安全的更多信息，请参见以下资源：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java EE 7 教程的<a href="http://docs.oracle.com/javaee/7/tutorial/doc/partsecurity.htm">安全性</a>部分的<a href="http://docs.oracle.com/javaee/7/tutorial/doc/security-intro003.htm">确保容器的安全</a>和<a href="http://docs.oracle.com/javaee/7/tutorial/doc/security-advanced008.htm">使用部署描述符配置安全性</a>这两章</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>有关使用 NetBeans IDE 开发 Java EE 应用程序的更多信息，请参见以下资源：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javaee-intro.html">Java EE 技术简介</a></p>
</li>
<li>
<p><a href="javaee-gettingstarted.html">Java EE 应用程序入门指南</a></p>
</li>
<li>
<p><a href="../../trails/java-ee.html">Java EE 和 Java Web 学习资源</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>要发送意见和建议、获得支持以及随时了解 NetBeans IDE Java EE 开发功能的最新开发情况，请<a href="../../../community/lists/top.html">加入 nbj2ee 邮件列表</a>。</p>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/secure-ejb_zh_CN.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
