
<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Mavenエンタープライズ・アプリケーションのテスト</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Mavenエンタープライズ・アプリケーションのテスト - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Mavenエンタープライズ・アプリケーションのテスト">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
     <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet"> 
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
</head>


    <body>
        

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


        
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 12.4</h1>
            <p><a class="button success" href="/download/nb124/nb124.html">Find out more</a></p>
        </div>
    </div>
</section>

        <div class='grid-container main-content tutorial'>
            <h1 class="sect0">Mavenエンタープライズ・アプリケーションのテスト</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://issues.apache.org/jira/projects/NETBEANS/issues">open a JIRA issue</a>, 
                     or <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/maven-entapp-testing_ja.asciidoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
            <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_ideでのmavenの使用">IDEでのMavenの使用</a></li>
<li><a href="#_エンタープライズアプリケーションの作成">エンタープライズ・アプリケーションの作成</a>
<ul class="sectlevel2">
<li><a href="#_webプロジェクトの作成">Webプロジェクトの作成</a></li>
<li><a href="#_エンティティクラスの作成">エンティティ・クラスの作成</a></li>
<li><a href="#_セッションbeanの作成">セッションBeanの作成</a></li>
</ul>
</li>
<li><a href="#_セッションbeanテストの作成">セッションBeanテストの作成</a></li>
<li><a href="#_関連項目">関連項目</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>このチュートリアルでは、NetBeans IDEとMaven原型を使用した単純なエンタープライズ・アプリケーションをテストする方法を示します。このチュートリアルでは、エンティティ・クラスとセッションBeanを含むエンタープライズ・アプリケーションを作成します。ウィザードを使用してBeanクラス用の単純なテスト・クラスを作成してから、IDEでそのテストを実行します。このテスト・クラスは、GlassFish埋込みEJBコンテナのインスタンスを作成し、データベースへの接続をテストします。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
GlassFish 3.1.xを使用する場合、<a href="../../73/javaee/maven-entapp-testing.html">組込みGlassFish Server 3.1を使用したMavenエンタープライズ・アプリケーションのテスト</a>を参照してください。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>チュートリアルの課題</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#intro">IDEでのMavenの使用</a></p>
</li>
<li>
<p><a href="#Exercise_1">エンタープライズ・アプリケーションの作成</a></p>
</li>
<li>
<p><a href="#Exercise_1a">Webプロジェクトの作成</a></p>
</li>
<li>
<p><a href="#Exercise_1b">エンティティ・クラスの作成</a></p>
</li>
<li>
<p><a href="#Exercise_1c">セッションBeanの作成</a></p>
</li>
<li>
<p><a href="#Exercise_2">セッションBeanテストの作成</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>このチュートリアルに従うには、次のソフトウェアとリソースが必要です。</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ソフトウェアまたはリソース</th>
<th class="tableblock halign-left valign-top">必須バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">NetBeans IDE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.4、8.0、Java EEバンドル版</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java Development Kit (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">バージョン7または8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GlassFish Server Open Source Edition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.0</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
GlassFish Serverのインストーラは、Java EEバンドル版をダウンロードした場合に含まれています。NetBeans IDEのインストール処理の一部としてGlassFishをインストールおよび登録できます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>前提条件</strong></p>
</div>
<div class="paragraph">
<p>このドキュメントは、次のテクノロジについて基本的な知識またはプログラミング経験を持つ読者を想定して書かれています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Javaプログラミング</p>
</li>
<li>
<p>NetBeans IDE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>このチュートリアルを開始する前に、必要に応じて次のドキュメントをお読みください。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://wiki.netbeans.org/MavenBestPractices">NetBeans IDEでのApache Mavenのベスト・プラクティス</a></p>
</li>
<li>
<p><a href="http://books.sonatype.com/mvnref-book/reference/introduction.html">Chapter 1. Introducing Apache Maven</a> (<a href="http://books.sonatype.com/mvnref-book/reference/index.html">+Maven: The Complete Reference +</a>)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ideでのmavenの使用">IDEでのMavenの使用</h2>
<div class="sectionbody">
<div class="paragraph">
<p>NetBeans IDEには、Mavenのサポートが完全に統合されています。Mavenフレームワークを使用するプロジェクト開発は、Antでのプロジェクト開発とほぼ同じです。ただし、Mavenによるプロジェクトのビルド方法および依存性の処理方法には、いくつかの違いがあります。次のヒントは、Mavenアプリケーションを初めて作成する場合に発生するいくつかの問題を回避するのに役立ちます。</p>
</div>
<div class="paragraph">
<p><strong>Mavenの設定の確認</strong></p>
</div>
<div class="paragraph">
<p>これが初めてのMavenプロジェクトである場合は、「オプション」ウィンドウでMavenの構成設定を確認します。このチュートリアルを完了するには、ローカル・システムにMavenがインストールされている必要があります。MavenはIDEにバンドルされており、IDEをインストールするとインストールされます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>IDEで「オプション」ウィンドウを開きます(「ツール」→「オプション」、Macの場合は「NetBeans」→プリファレンス)。</p>
</li>
<li>
<p>「オプション」ウィンドウで「Java」カテゴリを選択し、「Maven」タブをクリックします。</p>
</li>
<li>
<p>「Mavenのホーム」が指定されていることを確認します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>IDEにバンドルされているMavenバージョンを使用することも、ローカルのMavenインストール(2.0.9以降が必要)の場所を指定することもできます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「OK」をクリックして「オプション」ウィンドウを閉じます。</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Mavenサポートは、IDEでJavaが有効になっている場合に自動的に有効になります。Java EEプラグインが有効になっていない場合は、有効にする必要があります。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Mavenリポジトリの更新</strong></p>
</div>
<div class="paragraph">
<p>ローカルおよびリモートのMavenリポジトリは、コード補完およびプロジェクトのビルド時に使用されます。プロジェクトの開発時に、必要な任意のアーティファクトをすぐに使用できるように、Mavenリモート・リポジトリの索引を更新しておきます。「オプション」ウィンドウの「Maven」タブでは、IDEが更新を確認する頻度を構成できます。「サービス」ウィンドウから、更新の有無を即時確認でき、ローカルおよびリモートのMavenリポジトリを調べることができます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「ウィンドウ」&gt;「サービス」を選択し、「サービス」ウィンドウを開きます。</p>
</li>
<li>
<p>「サービス」ウィンドウで「Mavenリポジトリ」ノードを展開します。</p>
</li>
<li>
<p>リポジトリ・ノードを右クリックし、ポップアップ・メニューで「索引の更新」を選択します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>「索引を更新」をクリックすると、各Mavenリモート・リポジトリの最新の索引の有無が確認され、ダウンロードされます。索引は、リポジトリ内に存在するアーティファクトの現在の状態を示し、アプリケーションで使用できるアーティファクトへの参照を提供するために使用されます。デフォルトでは、アーティファクトが明示的に要求されないかぎり、リポジトリからアーティファクトはダウンロードされません。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
索引のサイズが非常に大きく、すべてを更新するのに時間がかかる可能性があります。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>NetBeans IDEでのMavenの使用に関する詳細は、<a href="https://netbeans.org/kb/docs/java/maven-hib-java-se.html">Hibernateを使用したMaven Swingアプリケーションの作成</a>チュートリアルの<a href="https://netbeans.org/kb/docs/java/maven-hib-java-se.html#02">Mavenの構成</a>の項および<a href="http://wiki.netbeans.org/MavenBestPractices">NetBeans IDEでのApache Mavenのベスト・プラクティス</a>を参照してください。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_エンタープライズアプリケーションの作成">エンタープライズ・アプリケーションの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>この項では、エンティティ・クラスとそのエンティティ・クラスにアクセスするセッションBeanを含む単純なWebアプリケーションを作成します。</p>
</div>
<div class="sect2">
<h3 id="_webプロジェクトの作成">Webプロジェクトの作成</h3>
<div class="paragraph">
<p>この課題では、新規プロジェクト・ウィザードを使用して、Maven原型からJava EE Webアプリケーションを作成します。ウィザードを使用してプロジェクトを作成するときは、ターゲット・サーバーとしてGlassFish Serverを指定します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>メイン・メニューから「ファイル」&gt;「新規プロジェクト」([Ctrl]-[Shift]-[N]、Macの場合は[⌘]-[Shift]-[N])を選択して新規プロジェクト・ウィザードを開きます。</p>
</li>
<li>
<p>「Maven」カテゴリから「Webアプリケーション」を選択します。「次」をクリックします。</p>
</li>
<li>
<p>プロジェクト名を*mavenwebtestapp*にし、プロジェクトの場所を設定します。「次」をクリックします。</p>
</li>
<li>
<p>「サーバー」ドロップダウン・リストで「GlassFish Server」を選択します。</p>
</li>
<li>
<p>「Java EEバージョン」ドロップダウン・リストで「Java EE 6 Web」または「Java EE 7 Web」を選択します。「終了」をクリックします。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>「終了」をクリックすると、IDEによってWebアプリケーションが作成され、プロジェクトが「プロジェクト」ウィンドウで開きます。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-testing-projects.png" alt="maven testing projects">
</div>
<div class="title">Figure 1. 生成されたプロジェクトを示す「プロジェクト」ウィンドウ</div>
</div>
<div class="paragraph">
<p>「プロジェクト」ウィンドウでプロジェクト・ノードを展開すると、 <code>javaee-web-api</code>  JARがプロジェクトの依存性として一覧表示され、JDKがJava依存性として一覧表示されていることがわかります。IDEによってプロジェクトのPOM ( <code>pom.xml</code> )が生成され、そのファイルが「プロジェクト・ファイル」ノードの下に一覧表示されます。</p>
</div>
</div>
<div class="sect2">
<h3 id="_エンティティクラスの作成">エンティティ・クラスの作成</h3>
<div class="paragraph">
<p>この課題では、新規ファイル・ウィザードを使用してエンティティ・クラスを作成します。エンティティ・クラスを作成するときは、ウィザードで <code>jdbc/sample</code> データ・ソースを選択します。サーバーのインストール時に <code>jdbc/sample</code> データ・ソースが登録されたため、新しいデータ・ソースを作成または登録する必要はありません。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
新しいデータソースを作成したり、異なるデータソースを使用する場合は、埋込みコンテナを使用してアプリケーションをテストする前に、そのデータソースをサーバーに登録する必要があります。埋込みコンテナを使用してアプリケーションをテストするときは、GlassFishサーバー・インスタンスにデプロイするときと同じように、データ・ソースがIDEによって自動的には登録されません。
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>プロジェクト・ノードを右クリックし、「新規」&gt;「エンティティ・クラス」を選択します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>または、メイン・メニューから「ファイル」&gt;「新規ファイル」([Ctrl]-[N]、Macの場合は[⌘]-[N])を選択し、「持続性」カテゴリで「エンティティ・クラス」を選択することもできます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「クラス名」に「<strong>MyEntity</strong>」と入力します。</p>
</li>
<li>
<p>「パッケージ」として「 <code>com.mycompany.mavenwebtestapp</code> 」を選択し、「主キー型」を* <code>int</code> *に設定します。</p>
</li>
<li>
<p>「持続性ユニットを作成」が選択されていることを確認します。「次」をクリックします。</p>
</li>
<li>
<p>「データ・ソース」ドロップダウン・リストで「<strong>jdbc/sample</strong>」を選択します。</p>
</li>
<li>
<p>「Java Transaction APIを使用」が選択されていることを確認し、「表生成戦略」として「ドロップして作成」を選択します。「終了」をクリックします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-testing-pu.png" alt="maven testing pu">
</div>
<div class="title">Figure 2. 生成されたプロジェクトを示す「プロジェクト」ウィンドウ</div>
</div>
<div class="paragraph">
<p>「終了」をクリックすると、IDEによってMyEntityクラスが生成され、ソース・エディタでクラスが開かれます。IDEによって、プロジェクト依存性として <code>eclipselink</code> 、 <code>javax.persistence</code> および <code>org.eclipse.persistence.jpa.modelgen.processor</code> アーティファクトが追加されます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ソース・エディタで、クラスにprivateフィールド <code>name</code> を追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private String name;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>エディタ内を右クリックし、「コードを挿入」ポップアップ・メニューで「取得メソッドおよび設定メソッド」を選択して <code>name</code> フィールドの取得メソッドと設定メソッドを生成します。</p>
</li>
<li>
<p>次のコンストラクタを追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public MyEntity(int id) {
    this.id = id;
    name = "Entity number " + id + " created at " + new Date();
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>MyEntity表のすべてのレコードを検索する名前付きSQL問合せを作成するために、以下の <code>@NamedQueries</code> および <code>@NamedQuery</code> 注釈(太字部分)を追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Entity
*@NamedQueries({
    @NamedQuery(name = "MyEntity.findAll", query = "select e from MyEntity e")})*
public class MyEntity implements Serializable {</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>クラス宣言の左マージンにあるヒントをクリックして、「<strong>デフォルト・コンストラクタを作成</strong>」ヒントを選択します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-testing-createconstructor.png" alt="maven testing createconstructor">
</div>
<div class="title">Figure 3. 生成されたプロジェクトを示す「プロジェクト」ウィンドウ</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>インポート文を修正([Ctrl]-[Shift]-[I]、Macの場合は[⌘]-[Shift]-[I])して、 <code>javax.persistence.NamedQuery</code> 、 <code>javax.persistence.NamedQueries</code> および <code>java.util.Date</code> のインポート文を追加します。変更を保存します。</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_セッションbeanの作成">セッションBeanの作成</h3>
<div class="paragraph">
<p>この課題では、ウィザードを使用して <code>MyEntity</code> エンティティ・クラスのセッション・ファサードを作成します。ウィザードを使用してファサードを生成すると、エンティティ・クラスにアクセスするときによく使用される <code>create</code> や <code>find</code> などのいくつかのメソッドを含む抽象ファサードもIDEによって生成されます。次に、ファサードに2つのメソッドを追加します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>プロジェクト・ノードを右クリックし、「新規」&gt;「その他」を選択します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>または、メイン・メニューから「ファイル」&gt;「新規ファイル」([Ctrl]-[N]、Macの場合は[⌘]-[N])を選択して新規ファイル・ウィザードを開きます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「Enterprise JavaBeans」カテゴリで「エンティティ・クラスのセッションBean」を選択します。「次」をクリックします。</p>
</li>
<li>
<p>「利用可能なエンティティ・クラス」のリストから <code>MyEntity</code> クラスを選択し、「追加」をクリックします。「次」をクリックします。</p>
</li>
<li>
<p>ウィザードの「生成されるセッションBean」パネルで、デフォルトのプロパティを使用します。「終了」をクリックします。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>「終了」をクリックすると、IDEによって <code>com.mycompany.mavenwebtestapp</code> パッケージ内に <code>AbstractFacade.java</code> と <code>MyEntityFacade.java</code> が生成され、ソース・エディタでこれらのクラスが開きます。</p>
</div>
<div class="paragraph">
<p>ソース・エディタで、IDEによって <code>EntityManager</code> のコードが生成され、持続性ユニットを指定するために <code>@PersistenceContext</code> 注釈が追加されたことを確認できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Stateless
public class MyEntityFacade extends AbstractFacade&lt;MyEntity&gt; {
    @PersistenceContext(unitName = "com.mycompany_mavenwebtestapp_war_1.0-SNAPSHOTPU")
    private EntityManager em;

    @Override
    protected EntityManager getEntityManager() {
        return em;
    }

    public MyEntityFacade() {
        super(MyEntity.class);
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>MyEntityFacade.java</code> に次のメソッドを追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    @PermitAll
    public int verify() {
        String result = null;
        Query q = em.createNamedQuery("MyEntity.findAll");
        Collection entities = q.getResultList();
        int s = entities.size();
        for (Object o : entities) {
            MyEntity se = (MyEntity) o;
            System.out.println("Found: " + se.getName());
        }

        return s;
    }

    @PermitAll
    public void insert(int num) {
        for (int i = 1; i &lt;= num; i++) {
            System.out.println("Inserting # " + i);
            MyEntity e = new MyEntity(i);
            em.persist(e);
        }
    }</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>インポートを修正して必要なインポート文を追加します。変更を保存します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-testing-fiximports.png" alt="maven testing fiximports">
</div>
<div class="title">Figure 4. 生成されたプロジェクトを示す「プロジェクト」ウィンドウ</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
「すべてのインポートを修正」ダイアログ・ボックスで* <code>javax.persistence.Query</code> *が選択されていることを確認してください。
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_セッションbeanテストの作成">セッションBeanテストの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>この項では、 <code>MyEntityFacade</code> セッション・ファサード用のJUnitテスト・クラスを作成します。IDEによって、ファサード・クラス内の各メソッドおよび抽象ファサード内の各メソッド用のスケルトン・テスト・メソッドが生成されます。抽象ファサード内のメソッド用に生成されたテスト・メソッドに注釈を付けて、IDEとJUnitテスト・ランナーにそれらを無視するように指示します。次に、 <code>MyEntityFacade</code> に追加した <code>verify</code> メソッド用のテスト・メソッドを変更します。</p>
</div>
<div class="paragraph">
<p>生成されたテストで、EJBコンテナのインスタンスを作成するために <code>EJBContainer</code> をコールするコードがIDEによって自動的に追加されることを確認します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「プロジェクト」ウィンドウで「 <code>MyEntityFacade.java</code> 」を右クリックし、「ツール」→「テストを作成」を選択します。</p>
</li>
<li>
<p>「フレームワーク」ドロップダウン・リストからテスト・フレームワークを選択します。</p>
</li>
<li>
<p>「テストを作成」ダイアログ・ボックスのデフォルトのオプションを使用します。「OK」をクリックします。</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
JUnitテストを初めて作成するときは、JUnitフレームワークのバージョンを指定する必要があります。JUnitのバージョンとして「JUnit 4.x」を選択し、「選択」をクリックします。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>デフォルトでは、IDEによって <code>MyEntityFacade</code> および <code>AbstractFacade</code> 内の各メソッド用のテストを含むスケルトン・テスト・クラスが生成されます。IDEによってJUnit 4.10への依存性がPOMに自動的に追加されます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>testVerify</code> を除く各テスト・メソッドに <code>@Ignore</code> 注釈を付けます。テストを実行すると、IDEによって <code>@Ignore</code> 注釈の付いた各テストがスキップされます。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>または、 <code>testVerify</code> 以外のすべてのテスト・メソッドを削除することもできます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>テスト・クラス内の <code>testVerify</code> テスト・メソッドを見つけます。</p>
<div class="literalblock">
<div class="content">
<pre>``EJBContainer`` をコールする行がテストに含まれていることがわかります。</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    @Test
    public void testVerify() throws Exception {
        System.out.println("verify");
        EJBContainer container = javax.ejb.embeddable.EJBContainer.createEJBContainer();
        MyEntityFacade instance = (MyEntityFacade)container.getContext().lookup("java:global/classes/MyEntityFacade");
        int expResult = 0;
        int result = instance.verify();
        assertEquals(expResult, result);
        container.close();
        // TODO review the generated test code and remove the default call to fail.
        fail("The test case is a prototype.");
    }</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>testVerify</code> テスト・メソッドのスケルトンに以下の変更(太字部分)を加えます。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Test
public void testVerify() throws Exception {
    System.out.println("verify");
    EJBContainer container = javax.ejb.embeddable.EJBContainer.createEJBContainer();
    MyEntityFacade instance = (MyEntityFacade)container.getContext().lookup("java:global/classes/MyEntityFacade");
    *System.out.println("Inserting entities...");
    instance.insert(5);*
    int result = instance.verify();
    *System.out.println("JPA call returned: " + result);
    System.out.println("Done calling EJB");
    Assert.assertTrue("Unexpected number of entities", (result == 5));*
    container.close();
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>インポート文を修正して <code>junit.framework.Assert</code> を追加します。変更を保存します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>ここでPOMを変更して、GlassFishサーバーのローカル・インストールにある <code>&lt;glassfish.embedded-static-shell.jar&gt;</code> に対する依存性を追加する必要があります。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>エディタで <code>pom.xml</code> を開き、 <code>&lt;properties&gt;</code> 要素を見つけます。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">    &lt;properties&gt;
        &lt;endorsed.dir&gt;${project.build.directory}/endorsed&lt;/endorsed.dir&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>&lt;properties&gt;</code> 要素を編集して、ローカルGlassFishインストールのJARの場所を指定する <code>&lt;glassfish.embedded-static-shell.jar&gt;</code> 要素(*太字*部分)を追加します。このプロパティをアーティファクトに対する依存性で参照します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">    &lt;properties&gt;
        &lt;endorsed.dir&gt;${project.build.directory}/endorsed&lt;/endorsed.dir&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        *&lt;glassfish.embedded-static-shell.jar&gt;_&lt;INSTALLATION_PATH&gt;_/glassfish-4.0/glassfish/lib/embedded/glassfish-embedded-static-shell.jar&lt;/glassfish.embedded-static-shell.jar&gt;*

    &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code><em>&lt;INSTALLATION_PATH&gt;</em></code> は、ローカルGlassFishインストールの絶対パスです。ローカル・インストールへのパスが変更された場合は、POM内のこの要素を変更する必要があります。
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「プロジェクト」ウィンドウの「依存性」ノードを右クリックし、「依存性の追加」を選択します。</p>
</li>
<li>
<p>「依存性の追加」ダイアログ・ボックスで、「問合せテキスト」フィールドに*「embedded-static-shell」*と入力します。</p>
</li>
<li>
<p>検索結果で4.0 JARを見つけ、「追加」をクリックします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/add-shell-dependency.png" alt="add shell dependency">
</div>
<div class="title">Figure 5. 「テスト結果」ウィンドウ</div>
</div>
<div class="paragraph">
<p>「追加」をクリックすると、IDEによってPOMに依存性が追加されます。</p>
</div>
<div class="paragraph">
<p>ここでPOMを変更して、GlassFishのローカル・インストールをJARのソースとして指定します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>POMで依存性を見つけ、次のように(*太字*部分)、追加した <code>&lt;glassfish.embedded-static-shell.jar&gt;</code> プロパティを参照し、 <code>&lt;scope&gt;</code> を指定するよう要素を変更します。変更を保存します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">        &lt;dependency&gt;
            &lt;groupId&gt;org.glassfish.main.extras&lt;/groupId&gt;
            &lt;artifactId&gt;glassfish-embedded-static-shell&lt;/artifactId&gt;
            &lt;version&gt;4.0&lt;/version&gt;
            *&lt;scope&gt;system&lt;/scope&gt;
            &lt;systemPath&gt;${glassfish.embedded-static-shell.jar}&lt;/systemPath&gt;*
        &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「サービス」ウィンドウで「GlassFish Server」ノードを右クリックし、「起動」を選択します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>GlassFish Serverを起動すると、JavaDBデータベース・サーバーも起動します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「プロジェクト」ウィンドウでプロジェクト・ノードを右クリックし、「テスト」を選択します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>「テスト」を選択すると、IDEによってアプリケーションがビルドされ、ビルド・ライフサイクルのテスト・フェーズが実行されます。この単体テストは、JUnit 4.xテストの実行をサポートするsurefireプラグインを使用して実行されます。surefireプラグインの詳細は、<a href="http://maven.apache.org/plugins/maven-surefire-plugin/">http://maven.apache.org/plugins/maven-surefire-plugin/</a>を参照してください。</p>
</div>
<div class="paragraph">
<p>「テスト結果」ウィンドウにテストの結果が表示されます。「テスト結果」ウィンドウは、メイン・メニューから「ウィンドウ」→「出力」→「テスト結果」を選択して開くことができます。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-test-results.png" alt="maven test results">
</div>
<div class="title">Figure 6. 「テスト結果」ウィンドウ</div>
</div>
<div class="paragraph">
<p>「テスト結果」ウィンドウで、「成功したものを表示」アイコン(<span class="image"><img src="images/test-ok_16.png" alt="test ok 16" title="「成功したものを表示」アイコン"></span>)をクリックして、成功したすべてのテストのリストを表示できます。この例では、9個のテストに成功したことがわかります。「出力」ウィンドウを見ると、1個のテストのみが実行され、8個のテストがスキップされたことを確認できます。スキップされたテストは、「テスト結果」ウィンドウの成功したテストのリストに含まれます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Running com.mycompany.mavenwebtestapp.MyEntityFacadeTest
verify
...
Inserting entities...
Inserting # 1
Inserting # 2
Inserting # 3
Inserting # 4
Inserting # 5
Found: Entity number 2 created at Wed Oct 09 19:06:59 CEST 2013
Found: Entity number 4 created at Wed Oct 09 19:06:59 CEST 2013
Found: Entity number 3 created at Wed Oct 09 19:06:59 CEST 2013
Found: Entity number 1 created at Wed Oct 09 19:06:59 CEST 2013
Found: Entity number 5 created at Wed Oct 09 19:06:59 CEST 2013
JPA call returned: 5
Done calling EJB
...

Results :

Tests run: 9, Failures: 0, Errors: 0, Skipped: 8</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Creating%20an%20Enterprise%20Application%20Using%20Maven">このチュートリアルに関するご意見をお寄せください</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_関連項目">関連項目</h2>
<div class="sectionbody">
<div class="paragraph">
<p>NetBeans IDEを使用したJava EEアプリケーションの開発方法の詳細は、次のリソースを参照してください。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javaee-intro.html">Java EEテクノロジ入門</a></p>
</li>
<li>
<p><a href="javaee-gettingstarted.html">Java EEアプリケーションの開始</a></p>
</li>
<li>
<p><a href="maven-entapp.html">Mavenを使用したエンタープライズ・アプリケーションの作成</a></p>
</li>
<li>
<p><a href="../../trails/java-ee.html">Java EEおよびJava Webの学習</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>エンタープライズBeanの使用方法については、<a href="http://download.oracle.com/javaee/6/tutorial/doc/">Java EE 6チュートリアル</a>を参照してください。</p>
</div>
<div class="paragraph">
<p><a href="../../../community/lists/top.html">nbj2eeメーリング・リストに登録する</a>ことによって、NetBeans IDE Java EE開発機能に関するご意見やご提案を送信したり、サポートを受けたり、最新の開発情報を入手したりできます。</p>
</div>
</div>
</div>
            
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="JIRA" href="https://issues.apache.org/jira/projects/NETBEANS/summary"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/maven-entapp-testing_ja.asciidoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

        </div>
        

<div class='grid-container incubator-area' style='margin-top: 64px'>
    <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/">
                <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
            </a>
        </div>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/events/current-event.html">
               <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
            </a>
        </div>
    </div>
</div>
<footer>
    <div class="grid-container">
        <div class="grid-x grid-padding-x">
            <div class="large-auto cell">
                
                <h1><a href="/about/index.html">About</a></h1>
                <ul>
                    <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
                    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                    <li><a href="https://www.apache.org/security/">Security</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/community/index.html">Community</a></h1>
                <ul>
                    <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
                    <li><a href="/community/committer.html">Becoming a committer</a></li>
                    <li><a href="/community/events.html">NetBeans Events</a></li>
                    <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/participate/index.html">Participate</a></h1>
                <ul>
                    <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
                    <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
                    <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/help/index.html">Get Help</a></h1>
                <ul>
                    <li><a href="/help/index.html#documentation">Documentation</a></li>
                    <li><a href="/wiki/index.asciidoc">Wiki</a></li>
                    <li><a href="/help/index.html#support">Community Support</a></li>
                    <li><a href="/help/commercial-support.html">Commercial Support</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/download/nb110/nb110.html">Download</a></h1>
                <ul>
                    <li><a href="/download/index.html">Releases</a></li>                    
                    <li><a href="/plugins/index.html">Plugins</a></li>
                    <li><a href="/download/index.html#source">Building from source</a></li>
                    <li><a href="/download/index.html#previous">Previous releases</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<div class='footer-disclaimer'>
    <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2020 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
            <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
            <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
        </div>
        
    </div>
</div>



        <script src="/js/vendor/jquery-3.2.1.min.js"></script>
        <script src="/js/vendor/what-input.js"></script>
        <script src="/js/vendor/jquery.colorbox-min.js"></script>
        <script src="/js/vendor/foundation.min.js"></script>
        <script src="/js/netbeans.js"></script>
        <script>
            
            $(function(){ $(document).foundation(); });
        </script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        <script>
         $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
        </script>
        
    </body>
</html>
