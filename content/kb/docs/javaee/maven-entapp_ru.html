
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Создание приложения уровня предприятия с помощью Maven</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Создание приложения уровня предприятия с помощью Maven - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Создание приложения уровня предприятия с помощью Maven">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>

  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">Создание приложения уровня предприятия с помощью Maven</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/maven-entapp_ru.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_использование_maven_в_среде_ide">Использование Maven в среде IDE</a></li>
<li><a href="#_создание_проекта_приложения_уровня_предприятия_maven">Создание проекта приложения уровня предприятия Maven</a></li>
<li><a href="#_написание_кода_проекта_ejb">Написание кода проекта EJB</a>
<ul class="sectlevel2">
<li><a href="#_создание_блока_сохранения_состояния">Создание блока сохранения состояния</a></li>
<li><a href="#_создание_класса_сущности">Создание класса сущности</a></li>
<li><a href="#_создание_управляемого_сообщениями_компонента">Создание управляемого сообщениями компонента</a></li>
<li><a href="#_создание_компонента_сеанса">Создание компонента сеанса</a></li>
</ul>
</li>
<li><a href="#_написание_кода_веб_приложения">Написание кода веб-приложения</a>
<ul class="sectlevel2">
<li><a href="#_создание_сервлета_listnews">Создание сервлета ListNews</a></li>
<li><a href="#_создание_сервлета_postmessage">Создание сервлета PostMessage</a></li>
</ul>
</li>
<li><a href="#_сборка_приложения_с_помощью_maven">Сборка приложения с помощью Maven</a>
<ul class="sectlevel2">
<li><a href="#_работа_с_зависимостями_проекта">Работа с зависимостями проекта</a></li>
<li><a href="#_сборка_проекта_с_зависимостями">Сборка проекта с зависимостями</a></li>
</ul>
</li>
<li><a href="#_развертывание_и_выполнение_приложения">Развертывание и выполнение приложения</a>
<ul class="sectlevel2">
<li><a href="#_развертывание_и_выполнение_приложения_из_среды_ide">Развертывание и выполнение приложения из среды IDE</a></li>
<li><a href="#_развертывание_из_консоли_администратора_glassfish">Развертывание из консоли администратора GlassFish</a></li>
</ul>
</li>
<li><a href="#_загрузка_проекта_решения">Загрузка проекта решения</a></li>
<li><a href="#_дополнительные_сведения">Дополнительные сведения</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial demonstrates how to create a simple enterprise application using IDE NetBeans and Maven archetypes. Также приводится ряд пояснений и советов по созданию и сборке приложений Maven в среде IDE.</p>
</div>
<div class="paragraph">
<p>В этом учебном курсе описывается создание приложения уровня предприятия, которое пакетируется в архивный файл EAR и развертывается на сервере приложений GlassFish Server Open Source Edition 3. Приложение создается с использованием архетипа приложения Maven Enterprise в мастере создания проекта. В приложение входит проект EJB, содержащий класс сущностей с сохранением состояния, компонент, управляемый сообщениями, и фасад сеансного компонента для сущности. В приложение также входит веб-проект, содержащий два сервлета.</p>
</div>
<div class="paragraph">
<p><strong>Упражнения по темам руководства</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#intro">Использование Maven в среде IDE</a></p>
</li>
<li>
<p><a href="#Exercise_1">Создание проекта приложения уровня предприятия Maven</a></p>
</li>
<li>
<p><a href="#Exercise_2">Написание кода модуля EJB</a></p>
</li>
<li>
<p><a href="#Exercise_2a">Создание блока сохранения состояния</a></p>
</li>
<li>
<p><a href="#Exercise_2b">Создание класса сущностей</a></p>
</li>
<li>
<p><a href="#Exercise_2c">Создание управляемого сообщениями компонента</a></p>
</li>
<li>
<p><a href="#Exercise_2d">Создание фасада сеанса</a></p>
</li>
<li>
<p><a href="#Exercise_3">Написание кода веб-модуля</a></p>
</li>
<li>
<p><a href="#Exercise_3a">Создание сервлета ListNews</a></p>
</li>
<li>
<p><a href="#Exercise_3b">Создание сервлета PostMessage</a></p>
</li>
<li>
<p><a href="#Exercise_4">Сборка приложения с помощью Maven</a></p>
</li>
<li>
<p><a href="#Exercise_4a">Работа с зависимостями проекта</a></p>
</li>
<li>
<p><a href="#Exercise_4b">Сборка проекта с зависимостями</a></p>
</li>
<li>
<p><a href="#Exercise_5">Развертывание и выполнение приложения</a></p>
</li>
<li>
<p><a href="#Exercise_5a">Развертывание из среды IDE</a></p>
</li>
<li>
<p><a href="#Exercise_5b">Развертывание из консоли администратора GlassFish</a></p>
</li>
<li>
<p><a href="#Exercise_7">Загрузка проекта решения</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Для работы с этим учебным курсом требуется следующее программное обеспечение и ресурсы.</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Программное обеспечение или материал</th>
<th class="tableblock halign-left valign-top">Требуемая версия</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">IDE NetBeans</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Версия 7.2, 7.3, 7.4, 8.0, Java EE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Комплект для разработчика на языке Java (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">версия 7 или 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GlassFish Server Open Source Edition 3.1.2.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.x</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Предпосылки</strong></p>
</div>
<div class="paragraph">
<p>Предполагается, что читатель обладает базовыми знаниями по следующим технологиям или опытом программирования с их использованием:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Программирование на Java</p>
</li>
<li>
<p>IDE NetBeans</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Перед изучением этого учебного курса можно ознакомиться со следующей документацией:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://wiki.netbeans.org/MavenBestPractices">Испытанные приемы для Apache Maven в IDE NetBeans</a></p>
</li>
<li>
<p><a href="http://books.sonatype.com/mvnref-book/reference/introduction.html">Глава 1. Введение в Apache Maven</a> (фрагмент из книги <a href="http://books.sonatype.com/mvnref-book/reference/index.html">Maven: The Complete Reference</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Можно загрузить <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FMavenEnterpriseApp.zip">готовый проект в виде архива ZIP</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_использование_maven_в_среде_ide">Использование Maven в среде IDE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Support for Maven is fully integrated in IDE NetBeans. Разработка проекта, в котором используется платформа Maven, практически идентична случаю разработки с использованием Ant. Однако в случае Maven имеются некоторые отличия, касающиеся способа сборки проектов и работы с зависимостями. Советы, приведенные ниже, могут помочь избегнуть ряда проблем при первом создании приложения Maven.</p>
</div>
<div class="paragraph">
<p><strong>Проверка параметров Maven</strong></p>
</div>
<div class="paragraph">
<p>Если это ваш первый проект Maven, проверьте параметры настройки Maven в окне "Параметры". Maven включен в комплект IDE и устанавливается при установке среды IDE.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте окно 'Настройки' в IDE (Сервис &gt; Параметры; NetBeans&gt; Предпочтения на Mac).</p>
</li>
<li>
<p>Выберите в окне "Параметры" категорию "Java" и перейдите на вкладку "Maven".</p>
</li>
<li>
<p>Подтвердите указание домашней страницы Maven.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Можно использовать версию Maven, входящую в комплект среды IDE, либо указать местоположение локальной установки Maven (требуется версия 2.0.9 или более поздняя).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Для закрытия окна "Параметры" нажмите кнопку "ОК".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Примечания.</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Поддержка Maven автоматически включается при включении Java в среде IDE. Если нет, необходимо включить подключаемый модуль Java EE.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Обновите репозитории Maven</strong></p>
</div>
<div class="paragraph">
<p>Локальные и удаленные репозитории Maven используются для автозавершения кода, а также при построении проектов. Обновление индексов удаленных репозиториев Maven требуется для обеспечения немедленной доступности всех артефактов, которые могут потребоваться при разработке проекта. Частоту проверки наличия обновлений можно настроить на вкладке "Maven" в окне "Параметры" среды IDE. Вы можете выполнить немедленную проверку обновлений и проверку локальных и удаленных репозиториев Maven в окне 'Службы'.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите меню "Окно" &gt; "Службы". Откроется окно "Службы".</p>
</li>
<li>
<p>Разверните узел 'Репозитории Maven' в окне 'Службы'.</p>
</li>
<li>
<p>Разверните узел репозитория для просмотра артефактов.</p>
</li>
<li>
<p>Щелкните правой кнопкой мыши узел репозитория и выберите во всплывающем меню 'Обновить индекс'.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При нажатии кнопки "Обновить индексы" в среде IDE выполняется проверка и загрузка самого свежего индекса для каждого из настроенных удаленных репозиториев Maven. Индекс представляет текущее состояние артефактов, расположенных в репозитории, и используется для предоставления ссылок на артефакты, доступных для использования в приложении. По умолчанию артефакты не загружаются из репозитория автоматически без явно обозначенной необходимости в них.</p>
</div>
<div class="paragraph">
<p>Для поиска артефактов, щелкните правой кнопкой узел мыши узел 'Репозитории Maven' в окне 'Службы' и выберите 'Найти'.</p>
</div>
<div class="paragraph">
<p><strong>Примечания.</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Размер индексов довольно велик и обновление всех индексов может занять значительное время.</p>
</li>
<li>
<p>Если используется IDE NetBeans 7.1 или более ранняя версия, выберите "Окно &gt; Другие &gt; Обозреватель репозитория Maven" и нажмите "Обновление индексов" ( <span class="image"><img src="images/maven-refreshrepo.png" alt="maven refreshrepo" title="Кнопка 'Обновить индексы'"></span>  ) в верхней части окна "Обзор репозитория Maven".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Дополнительные сведения об использовании Maven в IDE NetBeans см. в разделе <a href="https://netbeans.org/kb/docs/java/maven-hib-java-se.html#02">Настройка Maven</a> в учебном курсе <a href="https://netbeans.org/kb/docs/java/maven-hib-java-se.html">Создание приложения Swing Maven с помощью Hibernate</a>, а также в <a href="http://wiki.netbeans.org/MavenBestPractices">Испытанные приемы для Apache Maven в IDE NetBeans</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_создание_проекта_приложения_уровня_предприятия_maven">Создание проекта приложения уровня предприятия Maven</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Цель данного упражнения заключается в создании проекта приложения уровня предприятия с использованием архетипа приложения Maven Enterprise, входящего в комплект поставки среды IDE. Архетип приложения уровня предприятия также создает проект EJB и проект webapp.</p>
</div>
<div class="paragraph">
<p>IDE включает в себя несколько архетипов Maven в мастере создания проектов, которые позволяют быстро создать типы общих проектов NetBeans, такие как проекты корпоративных приложений (EAR), проектов веб-приложений (WAR) и проектов модулей EJB (JAR). Мастер также позволяет создавать проекты из архетипов, полученных из зарегистрированных удаленных репозиториев.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите 'Файл' &gt; 'Создать проект' (Ctrl-Shift-N; ⌘-Shift-N в Mac) в главном меню.</p>
</li>
<li>
<p>В категории Maven выберите "Приложение Enterprise. Нажмите кнопку "Далее".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-newproject1.png" alt="maven newproject1">
</div>
<div class="title">Figure 1. Тип проекта корпоративного приложения Maven в мастере создания проектов</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Введите <strong>MavenEnterpriseApp</strong> в качестве имени проекта и укажите местоположение проекта.</p>
</li>
<li>
<p>(Необязательно) Измените подробные данные артефакта. Нажмите кнопку "Далее".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-newproject2.png" alt="maven newproject2">
</div>
<div class="title">Figure 2. Сведения о проекте Maven в мастере создания проектов</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В качестве сервера выберите сервер GlassFish.</p>
</li>
<li>
<p>В качестве версии Java EE выберите Java EE 6 или Java EE 7.</p>
</li>
<li>
<p>Установите флажки "Создать модуль EJB" и "Создать модуль веб-приложения". Нажмите кнопку "Завершить".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При нажатии кнопки "Готово" из архетипа приложения Maven Enterprise создаются следующие проекты:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>EJB.</strong> (MavenEnterpriseApp-ejb) Проект EJB обычно содержит исходный код с бизнес-логикой приложения. Проект EJB пакетируется в архив JAR EJB.</p>
</li>
<li>
<p><strong>Webapp.</strong> (MavenEnterpriseApp-web) Проект Webapp обычно содержит уровень представления приложения, такого как страницы JSF и JSP и сервлеты. В проект веб-приложения может также входить исходный код с бизнес-логикой. Проект веб-приложения пакетируется в архив WAR.</p>
</li>
<li>
<p><strong>Сборка.</strong> (MavenEnterpriseApp) Проект Assembly используется для сборки архива EAR из архивов EJB и WAR. Проект сборки не содержит исходных кодов.</p>
</li>
<li>
<p><strong>Enterprise Application.</strong> (MavenEnterpriseApp-ear) Проект Enterprise Application не содержит источников. В проекте приложения уровня предприятия содержится только файл POM ( <code>pom.xml</code> ) с подробными данными о модулях, входящих в приложение уровня предприятия.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-projectswindow2.png" alt="maven projectswindow2">
</div>
<div class="title">Figure 3. В окне 'Проекты' отображаются созданные проекты</div>
</div>
<div class="paragraph">
<p>Если в созданном проекте корпоративного приложения недоступны какие-либо зависимости, этот проект будет помечен значком. Если развернуть узел "Зависимости" для проекта MavenEnterpriseApp-ear, можно проверить, все ли необходимые библиотеки присутствуют в проекте и находятся на пути класса. Проект приложения J2EE имеет зависимости от JAR и WAR, которые будут пакетированы и доступны после сборки проектов EJB и веб-приложения.  <code>MavenEnterpriseApp-ejb</code>  и  <code>MavenEnterpriseApp-web</code>  находятся в списке зависимостей.</p>
</div>
<div class="paragraph">
<p>В ряде случаев в строке статуса будет отображаться значок Maven. Щелкните этот значок, чтобы запустить подготовительную сборку или исправить отсутствующие зависимости.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/priming-build.png" alt="priming build">
</div>
<div class="title">Figure 4. Значок Maven на панели состояния  позволяет запустить подготовительную сборку.</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_написание_кода_проекта_ejb">Написание кода проекта EJB</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Проект EJB содержит бизнес-логику приложения. Для управление транзакциями в этом проекте используется контейнер GlassFish, использующий интерфейс Java Transaction API (JTA). В этом руководстве для класса сущности в модуле EJB будет создан класс сущностей, управляемый сообщениями компонент и фасад сеанса.</p>
</div>
<div class="sect2">
<h3 id="_создание_блока_сохранения_состояния">Создание блока сохранения состояния</h3>
<div class="paragraph">
<p>В этом упражнении в проекте EJB будет создан блок сохранения состояния. В блоке сохранения состояния указываются подробные данные подключения к базе данных и указывается способ управления транзакциями. Для этого приложения в мастере создания блока сохранения состояния указывается JTA, поскольку управление транзакциями должно осуществляться сервером GlassFish.</p>
</div>
<div class="paragraph">
<p>Для создания блока сохранения состояния выполните следующие действия.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Для открытия мастера создания файла щелкните правой кнопкой мыши узел проекта EJB и выберите пункт раскрывающегося меню "Создать &gt; Прочее".</p>
</li>
<li>
<p>Выберите "Блок сохранения состояния" в категории "Сохранение состояния". Нажмите кнопку "Далее".</p>
</li>
<li>
<p>Выберите "EclipseLink" в качестве поставщика сохранения состояния в диалоговом окне мастера создания блока сохранения состояния.</p>
</li>
<li>
<p>Выберите источник данных (например, выберите  <code>jdbc/sample</code> , если необходимо использовать JavaDB).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Источник данных для  <code>jdbc/sample</code>  находится в составе пакета среды IDE при установке среды IDE и сервера приложений GlassFish. Однако можно указать другой источник данных, если это необходимо.</p>
</div>
<div class="paragraph">
<p>Можно сохранить другие параметры по умолчанию (имя блока сохранения состояния, поставщик сохранения состояния EclipseLink).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Убедитесь в том, что установлен флажок "Использовать интерфейсы API Java Translaction", и что для стратегии создания таблиц установлено значение "Создать", т.е. таблицы на основе классов сущностей создаются при развертывании приложения. Нажмите кнопку "Завершить".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-persistenceunit.png" alt="maven persistenceunit">
</div>
<div class="title">Figure 5. Мастер создания блоков сохранения состояния</div>
</div>
<div class="paragraph">
<p>При нажатии кнопки "Готово" в среде IDE создается файл XML  <code>persistence.xml</code> , который открывается в редакторе. В окне 'Проекты' видно, что файл был создан в каталоге  <code>Другие источники &gt; src/main/resources &gt; META-INF</code> . В этом файле содержатся подробные данные о подключении к базе данных и об управлении транзакциями. При переходе на вкладку "Исходный код" в редакторе отобразятся следующие данные блока сохранения состояния.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">...
&lt;persistence-unit name="com.mycompany_MavenEnterpriseApp-ejb_ejb_1.0-SNAPSHOTPU" transaction-type="JTA"&gt;
    &lt;provider&gt;org.eclipse.persistence.jpa.PersistenceProvider&lt;/provider&gt;
    &lt;jta-data-source&gt;jdbc/sample&lt;/jta-data-source&gt;
    &lt;exclude-unlisted-classes&gt;false&lt;/exclude-unlisted-classes&gt;
    &lt;properties&gt;
      &lt;property name="eclipselink.ddl-generation" value="create-tables"/&gt;
    &lt;/properties&gt;
&lt;/persistence-unit&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Нетрудно заметить, что в качестве типа транзакции указано значение  <code>JTA</code> , и что приложением будет использоваться зарегистрированный источник данных  <code>jdbc/sample</code> .</p>
</div>
</div>
<div class="sect2">
<h3 id="_создание_класса_сущности">Создание класса сущности</h3>
<div class="paragraph">
<p>Это упражнение посвящено созданию класса сущности в проекте EJB для представления объектов, состояние которых сохраняется в базе данных. Для создания класса сущности NewsEntity выполните следующие действия.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните правой кнопкой мыши модуль EJB в окне "Проекты" и выберите "Создать &gt; Прочее" для открытия мастера создания файла.</p>
</li>
<li>
<p>Выберите "Класс сущностей" в категории "Сохранение состояния". Нажмите кнопку "Далее".</p>
</li>
<li>
<p>В поле "Имя класса" введите <strong>NewsEntity</strong>.</p>
</li>
<li>
<p>Введите <strong>ejb</strong> в качестве имени пакета и оставьте для параметра "Тип первичного ключа" значение по умолчанию "Long". Нажмите кнопку "Завершить".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При нажатии кнопки "Готово" класс сущности  <code>NewsEntity.java</code>  будет открыт в редакторе исходного кода. В редакторе исходного кода добавьте несколько полей путем выполнения следующих действий.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте к классу следующие объявления полей.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private String title;
private String body;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В редакторе исходного кода щелкните правой кнопкой мыши внутри определения класса и выберите "Вставка кода" (ALT+ISERT; CTRL+I на компьютере Mac) &gt; "Методы получения и установки".</p>
</li>
<li>
<p>В диалоговом окне "Создание методов получения и установки" выберите поля  <code>body</code>  и  <code>title</code> . Нажмите кнопку "Создать".</p>
</li>
<li>
<p>Сохраните изменения, внесенные в класс.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_создание_управляемого_сообщениями_компонента">Создание управляемого сообщениями компонента</h3>
<div class="paragraph">
<p>В этом упражнении в проекте EJB будет создан компонент, управляемый сообщениями. Компонент, управляемый сообщениями, – это компонент EJB, реализующий асинхронный обмен сообщениями. Управляемый сообщениями компонент используется в приложении NewsApp для получения и обработки сообщений, передаваемых в очередь сервлетом в веб-модуле.</p>
</div>
<div class="paragraph">
<p>Для использования компонента, управляемого сообщениями, в приложении необходимо зарегистрировать на сервере ресурсы подключения, используемые компонентом. При развертывании на сервере GlassFish можно создавать ресурсы непосредственно на сервере с помощью консоли администратора или создавать их во время развертывания, указав подробные данные в файле дескриптора  <code>glassfish-resources.xml</code> . При развертывании приложения на сервере сервер регистрируют ресурсы на основе файла дескриптора. При использовании мастера создания файлов в среде IDE для создания управляемого сообщениями компонента среда IDE сформирует элементы в файле дескриптора.</p>
</div>
<div class="paragraph">
<p>В проекте Maven файл  <code>glassfish-resources.xml</code>  расположен в каталоге  <code>src/main/setup</code>  в узле проекта в окне "Файлы".</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните правой кнопкой мыши модуль EJB в окне "Проекты" и выберите "Создать &gt; Прочее" для открытия мастера создания файла.</p>
</li>
<li>
<p>Из категории Enterprise JavaBeans выберите "Управляемый сообщениями компонент". Нажмите кнопку "Далее".</p>
</li>
<li>
<p>В поле "Имя EJB" введите <strong>NewMessage</strong>.</p>
</li>
<li>
<p>В раскрывающемся списке "Пакет" выберите <strong>ejb</strong>.</p>
</li>
<li>
<p>Для открытия диалогового окна "Добавление адресата сообщения" нажмите кнопку "Добавить" рядом с полем "Адресат проекта".</p>
</li>
<li>
<p>В диалоговом окне "Добавление адресата сообщения" введите <strong>jms/NewMessage</strong> и выберите "Очередь" для типа адресата. Нажмите кнопку "ОК".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-messagedestination.png" alt="maven messagedestination">
</div>
<div class="title">Figure 6. Диалоговое окно &quot;Добавление назначения сообщения&quot;.</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Подтвердите, что адресат проекта выбран правильно. Нажмите кнопку "Далее".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-newmdb.png" alt="maven newmdb">
</div>
<div class="title">Figure 7. Мастер создания компонентов, управляемых сообщениями</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В диалоговом окне "Свойства конфигурации активации" оставьте настройки по умолчанию без изменений. Нажмите кнопку "Завершить".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При нажатии кнопки "Готово" автоматически создается класс компонента, к которому добавляются следующие аннотации, идентифицирующие класс как компонент, управляемый сообщениями, а также свойства настройки.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@MessageDriven(mappedName = "jms/NewMessage", activationConfig =  {
        @ActivationConfigProperty(propertyName = "acknowledgeMode", propertyValue = "Auto-acknowledge"),
        @ActivationConfigProperty(propertyName = "destinationType", propertyValue = "javax.jms.Queue")
    })
public class NewMessage implements MessageListener {

    public NewMessage() {
    }

    @Override
    public void onMessage(Message message) {
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Введите в класс ресурс  <code>MessageDrivenContext</code>  посредством добавления к классу следующего аннотированного поля:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class NewMessage implements MessageListener {

*@Resource
private MessageDrivenContext mdc;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Введите в класс диспетчер объектов посредством добавления к классу следующего аннотированного поля (выделено полужирным шрифтом):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class NewMessage implements MessageListener {

@Resource
private MessageDrivenContext mdc;
*@PersistenceContext(unitName="com.mycompany_MavenEnterpriseApp-ejb_ejb_1.0-SNAPSHOTPU")
private EntityManager em;*</code></pre>
</div>
</div>
<div class="paragraph">
<p>Аннотация  <code>@PersistenceContext</code>  указывает контекст путем объявления блока сохранения состояния. Значение  <code>unitName</code>  представляет собой имя блока сохранения состояния.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте следующий метод  <code>save</code>  (выделен полужирным шрифтом).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public NewMessage() {
}

@Override
public void onMessage(Message message) {
}

*private void save(Object object) {
    em.persist(object);
}*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Измените метод  <code>onMessage</code>  путем добавления следующих строк кода (выделены полужирным шрифтом) в тело метода:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public void onMessage(Message message) {
     *ObjectMessage msg = null;
     try {
          if (message instanceof ObjectMessage) {
          msg = (ObjectMessage) message;
              NewsEntity e = (NewsEntity) msg.getObject();
              save(e);
          }
     } catch (JMSException e) {
          e.printStackTrace();
          mdc.setRollbackOnly();
     } catch (Throwable te) {
          te.printStackTrace();
     }*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Исправьте операторы импорта (Ctrl-Shift-I; ⌘-Shift-I в Mac) и сохраните изменения.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
При создании операторов импорта необходимо убедиться, что импортируются библиотеки * <code>jms</code> * и * <code>javax.annotation.Resource</code> *.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Подробные сведения об управляемых сообщениями компонентах приведены в главе <a href="http://download.oracle.com/javaee/6/tutorial/doc/gipko.html">Что такое управляемый сообщениями компонент?</a> в <a href="http://download.oracle.com/javaee/6/tutorial/doc/index.html">руководстве по Java EE 6. Часть I</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_создание_компонента_сеанса">Создание компонента сеанса</h3>
<div class="paragraph">
<p>В этом упражнении будет использоваться мастер создания фасада сеанса для класса сущности NewsEntity. Мастер создаст методы  <code>create</code> ,  <code>edit</code>  и  <code>find</code> , которые будут вызываться из сервлетов в проекте веб-приложения.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните модуль EJB правой кнопкой мыши и выберите команду "Создать" &gt; "Другие".</p>
</li>
<li>
<p>Из категории "Сохранение состояния" выберите "Сеансные компоненты для классов сущностей" и нажмите кнопку "Далее".</p>
</li>
<li>
<p>Из списка доступных классов сущностей выберите <strong>ejb.NewsEntity</strong> и нажмите кнопку "Добавить", чтобы переместить класс на панель "Выбранные классы сущностей". Нажмите кнопку "Далее".</p>
</li>
<li>
<p>В качестве пакета выберите <strong>ejb</strong>. Нажмите кнопку "Завершить".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При нажатии кнопки "Готово" среда IDE создает два класса фасада сеанса:  <code>AbstractFacade.java</code>  и  <code>NewsEntityFacade.java</code> , последний расширяет класс абстрактного фасада. Класс абстрактного фасада определяет несколько методов, которые обычно используются с классами сущностей.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-sessionwizard.png" alt="maven sessionwizard">
</div>
<div class="title">Figure 8. Компоненты Bean сеанса для мастера классов сущностей</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_написание_кода_веб_приложения">Написание кода веб-приложения</h2>
<div class="sectionbody">
<div class="paragraph">
<p>В примере в этом разделе будет создано два сервлета в проекте веб-приложения.</p>
</div>
<div class="sect2">
<h3 id="_создание_сервлета_listnews">Создание сервлета ListNews</h3>
<div class="paragraph">
<p>В этом упражнении будет создан сервлет ListNews, используемый для вывода списка отправленных сообщений. Для ввода в фасад сеанса и доступа к методу  <code>findAll</code>  и получения отправленных сообщений используются аннотации.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните проект веб-модуля правой кнопкой мыши и выберите "Создать" &gt; "Сервлет".</p>
</li>
<li>
<p>В поле "Имя класса" введите <strong>ListNews</strong>.</p>
</li>
<li>
<p>В качестве имени пакета введите <strong>web</strong>. Нажмите кнопку "Завершить".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При нажатии кнопки "Готово" класс  <code>ListNews.java</code>  будет открыт в редакторе исходного кода.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните правой кнопкой мыши в редакторе исходного кода в определении класса и выберите команду "Вставка кода" (ALT+ISERT; CTRL+I на компьютере Mac) &gt; "Вызов компонента EJB".</p>
</li>
<li>
<p>В диалоговом окне "Вызов компонента EJB" разверните узел MavenEnterpriseApp-ejb и выберите NewsEntityFacade. Нажмите кнопку "ОК".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-callbean.png" alt="maven callbean">
</div>
<div class="title">Figure 9. Диалоговое окно 'Вызвать компонент корпоративного уровня'</div>
</div>
<div class="paragraph">
<p>При нажатии кнопки ОК выполняется ввод ресурса EJB в сервлет с использованием аннотации  <code>@EJB</code> .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@WebServlet(name = "ListNews", urlPatterns = {"/ListNews"})
public class ListNews extends HttpServlet {
    @EJB
    private NewsEntityFacade newsEntityFacade;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В методе  <code>processRequest</code>  внесите изменения, добавив следующие строки (выделены полужирным шрифтом) в тело метода:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">out.println("&lt;h1&gt;Servlet ListNews at " + request.getContextPath () + "&lt;/h1&gt;");
*
List news = newsEntityFacade.findAll();
for (Iterator it = news.iterator(); it.hasNext();) {
  NewsEntity elem = (NewsEntity) it.next();
  out.println(" &lt;b&gt;"+elem.getTitle()+" &lt;/b&gt;&lt;br /&gt;");
  out.println(elem.getBody()+"&lt;br /&gt; ");
}
out.println("&lt;a href='PostMessage'&gt;Add new message&lt;/a&gt;");
*
out.println("&lt;/body&gt;");</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Если используется более ранняя версия IDE необходимо удалить комментарии кода.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Исправьте выражения импорта (Ctrl-Shift-I; ⌘-Shift-I в Mac) и сохраните изменения.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При создании операторов импорта может потребоваться импортировать библиотеки  <code>java.util</code> .</p>
</div>
</div>
<div class="sect2">
<h3 id="_создание_сервлета_postmessage">Создание сервлета PostMessage</h3>
<div class="paragraph">
<p>В этом упражнении будет создан сервлет PostMessage, используемый для отправки сообщений. Для добавления созданных ресурсов JMS непосредственно в сервлет используются аннотации с указанием имени переменной и имени, на которое она отображается. Затем необходимо написать код для отправки сообщения JMS и код для формы HTML, предназначенной для добавления сообщения.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните проект веб-модуля правой кнопкой мыши и выберите "Создать" &gt; "Сервлет".</p>
</li>
<li>
<p>В поле "Имя класса" введите <strong>PostMessage</strong>.</p>
</li>
<li>
<p>В качестве имени пакета выберите <strong>web</strong>. Нажмите кнопку "Завершить".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При нажатии кнопки "Готово" в редакторе исходного кода будет открыт класс  <code>PostMessage.java</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Используйте аннотации в редакторе исходного кода для ввода ресурсов  <code>ConnectionFactory</code>  и  <code>Queue</code>  путем добавления следующих объявлений полей.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@WebServlet(name="PostMessage", urlPatterns={"/PostMessage"})
public class PostMessage extends HttpServlet {
   *@Resource(mappedName="jms/NewMessageFactory")
   private  ConnectionFactory connectionFactory;

   @Resource(mappedName="jms/NewMessage")
   private  Queue queue;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Для импорта библиотек * <code>javax.jms</code> * исправьте параметры импорта.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-searchdepend1.png" alt="maven searchdepend1">
</div>
<div class="title">Figure 10. Диалоговое окно 'Исправить все выражения импорта'</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Если IDE не поддерживает  <code>javax.jms</code>  как параметр, можно выполнить поиск в репозиториях правильного артефакта, щелкнув значок рекомендации на поле рядом с  <code>private ConnectionFactory connectionFactory;</code>  и выбрав 'Поиск зависимостей' в репозиториях Maven.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-searchdependencies.png" alt="maven searchdependencies">
</div>
<div class="title">Figure 11. Подсказки в редакторе для поиска в репозиториях зависимостей</div>
</div>
<div class="paragraph">
<p>Для поиска артефакта  <code>javaee-api-6.0</code> , содержащего  <code>ConnectionFactory</code>  можно воспользоваться диалоговым окном "Поиск в репозиториях Maven".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-searchdepend2.png" alt="maven searchdepend2">
</div>
<div class="title">Figure 12. Диалоговое окно 'Поиск в репозиториях Maven'</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте следующие строки, используемые для отправки сообщений JMS, к методу  <code>processRequest</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">response.setContentType("text/html;charset=UTF-8");

*// Add the following code to send the JMS message
String title=request.getParameter("title");
String body=request.getParameter("body");
if ((title!=null) &amp;amp;&amp;amp; (body!=null)) {
    try {
        Connection connection = connectionFactory.createConnection();
        Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
        MessageProducer messageProducer = session.createProducer(queue);

        ObjectMessage message = session.createObjectMessage();
        // here we create NewsEntity, that will be sent in JMS message
        NewsEntity e = new NewsEntity();
        e.setTitle(title);
        e.setBody(body);

        message.setObject(e);
        messageProducer.send(message);
        messageProducer.close();
        connection.close();
        response.sendRedirect("ListNews");

    } catch (JMSException ex) {
        ex.printStackTrace();
    }
}*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте следующие строки, используемые для отправки сообщений (выделены жирным шрифтом) к веб-форме.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">out.println("Servlet PostMessage at " + request.getContextPath() + "&lt;/h1&gt;");

*// The following code adds the form to the web page
out.println("&lt;form&gt;");
out.println("Title: &lt;input type='text' name='title'&gt;&lt;br/&gt;");
out.println("Message: &lt;textarea name='body'&gt;&lt;/textarea&gt;&lt;br/&gt;");
out.println("&lt;input type='submit'&gt;&lt;br/&gt;");
out.println("&lt;/form&gt;");
*
out.println("&lt;/body&gt;");</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Если используется более ранняя версия IDE необходимо удалить комментарии кода.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Исправьте операторы импорта и сохраните измененные данные.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-jms-imports.png" alt="maven jms imports">
</div>
<div class="title">Figure 13. Диалоговое окно 'Исправить все выражения импорта'</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Необходимо выполнить импорт библиотек * <code>javax.jms</code> * для  <code>Connection</code> ,  <code>ConnectionFactory</code> ,  <code>Session</code>  и  <code>Queue</code> .
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_сборка_приложения_с_помощью_maven">Сборка приложения с помощью Maven</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Написание кода завершено, и можно выполнить сборку приложения уровня предприятия с помощью Maven. Этот раздел посвящен сборке и пакетированию проектов в архив EAR. В архив EAR входят архив EJB JAR и архив WAR. После создания архива EAR его можно развернуть на целевом сервере.</p>
</div>
<div class="sect2">
<h3 id="_работа_с_зависимостями_проекта">Работа с зависимостями проекта</h3>
<div class="paragraph">
<p>В этом упражнении вы исследуете POM ( <code>pom.xml</code> ) веб-проекта и измените POM, чтобы избежать включения ненужных артефактов в WAR при пакетировании.  В каждый проект Maven входит файл  <code>pom.xml</code> , содержащий подробные данные о содержимом архивов. Все внешние библиотеки, запрашиваемые проектом, внесены в качестве зависимостей в файл POM. Файл POM можно изменить, указав зависимости, которые необходимо включить или исключить при пакетировании архива.</p>
</div>
<div class="paragraph">
<p>В этом приложении в архив EAR пакетируются архивы JAR EJB и WAR. Обратите внимание на файл  <code>pom.xml</code>  в проекте MavenEnterpriseApp-ear: архивы EJB и WAR объявлены как зависимости.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-earpom.png" alt="maven earpom">
</div>
<div class="title">Figure 14. pom.xml проекта EAR</div>
</div>
<div class="paragraph">
<p>Обратите внимание на файл  <code>pom.xml</code>  в проекте веб-приложения: архив EJB объявлен как зависимость, и для области выбрано значение  <code>указана</code> . В случае когда значение элемента области артефакта  <code>указано</code> , артефакт не будет включен при пакетировании. Архив·EJB·требуется·проектом·веб-приложения·как·зависимость,·однако·для·этого·приложения·не·требуется·включать·архив·EJB·в·WAR·при·пакетировании,·так·как·архив EJB предоставляется для использования в веб-приложении в составе архива EAR.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-webpom.png" alt="maven webpom">
</div>
<div class="title">Figure 15. pom.xml проекта веб-приложения</div>
</div>
<div class="paragraph">
<p>Можно открыть файл  <code>pom.xml</code>  в редакторе и просмотреть визуальное представление зависимостей проекта на вкладке "График". Если используется более ранняя версия IDE, можно щелкнуть открытый в редакторе файл  <code>pom.xml</code>  правой кнопкой мыши и выбрать "Показать график зависимостей". Наведите указатель мыши на артефакт для отображения всплывающей подсказки с подробными данными артефакта.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-webpomgraph.png" alt="maven webpomgraph">
</div>
<div class="title">Figure 16. График зависимостей.</div>
</div>
<div class="paragraph">
<p>Выполните следующие действия для изменения файла POM проекта веб-приложения и добавьте элемент  <code>scope</code>  scope к зависимости в артефакте  <code>javaee-api</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Разверните узел "Файлы проекта" для проекта веб-приложения.</p>
</li>
<li>
<p>Дважды щелкните  <code>pom.xml</code>  для открытия файла в редакторе.</p>
</li>
<li>
<p>Убедитесь, что в артефакте  <code>javaee-api</code>  для параметра  <code>&lt;scope&gt;</code>  задано значение  <code>provided</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Если задано любое другое значение, кроме  <code>provided</code> , необходимо внести следующие изменения в POM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;javax&lt;/groupId&gt;
    &lt;artifactId&gt;javaee-api&lt;/artifactId&gt;
    &lt;version&gt;7.0&lt;/version&gt;
    &lt;type&gt;jar&lt;/type&gt;
    *&lt;scope&gt;provided&lt;/scope&gt;*
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Можно использовать автозавершение кода в редакторе POM, упрощающее правку файла.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-addscope-javaee.png" alt="maven addscope javaee">
</div>
<div class="title">Figure 17. автозавершение кода для элемента области в POM</div>
</div>
<div class="paragraph">
<p>Если в файле POM содержится объявление предоставленной зависимости, этот артефакт не пакетируется Maven при сборке архива WAR.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Сохраните изменения.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_сборка_проекта_с_зависимостями">Сборка проекта с зависимостями</h3>
<div class="paragraph">
<p>Платформа сборки Maven проходит через определенную последовательность этапов, и каждый этап подразумевает выполнение одной или нескольких задач, причем можно настроить использование различных подключаемых модулей Maven. Пункт меню "Сборка вместе с зависимостями" соответствует этапу  <code>install</code>  жизненного цикла сборки Maven, и для него настроено использование подключаемого модуля Reactor. При выборе пункта раскрывающегося меню "Сборка вместе с зависимостями" Maven выполняет сборку приложения и всех необходимых зависимостей, после чего артефакты сборки копируются в локальный репозиторий.</p>
</div>
<div class="paragraph">
<p>Можно настроить привязку целей к операциям в меню "Действия" в диалоговом окне "Свойства" проекта.</p>
</div>
<div class="paragraph">
<p>Для сборки архива EAR выполните следующее действие.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Щелкните правой кнопкой мыши узел проекта MavenEnterpriseApp-ear и выберите команду "Сборка вместе с зависимостями".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>При сборке проекта EAR с использование подключаемого модуля Reactor сборка зависимостей подпроектов выполняется перед сборкой проекта EAR. В окне "Вывод" отображается порядок сборки.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-reactor1.png" alt="maven reactor1">
</div>
<div class="title">Figure 18. В окне &quot;Вывод&quot; отображается порядок сборки Reactor.</div>
</div>
<div class="paragraph">
<p>Результаты сборки также отображаются в окне "Вывод".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-reactor2.png" alt="maven reactor2">
</div>
<div class="title">Figure 19. В окне &quot;Вывод&quot; отображается состояние сборки Reactor</div>
</div>
<div class="paragraph">
<p>После сборки проекта EAR итоговый архив EAR отображается в каталоге  <code>target</code>  в узле проекта EAR в окне "Файлы".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-earfileswindow1.png" alt="maven earfileswindow1">
</div>
<div class="title">Figure 20. Окно 'Файлы', в котором отображается архив EAR</div>
</div>
<div class="paragraph">
<p>Если использовано имя артефакта по умолчанию  <code>com.mycompany</code> , для просмотра артефактов сборки в браузере репозиториев Maven можно развернуть узел  <code>com.mycompany</code>  в локальном репозитории.</p>
</div>
<div class="paragraph">
<p>Подробные сведения о сборке проектов Maven приведены в документе <a href="http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html">Maven - Введение в жизненный цикл сборки</a> по адресу <a href="http://maven.apache.org">maven.apache.org</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_развертывание_и_выполнение_приложения">Развертывание и выполнение приложения</h2>
<div class="sectionbody">
<div class="paragraph">
<p>В этом разделе описываются два метода развертывания архива EAR на сервере. Приложение можно развернуть на сервере GlassFish с помощью действия меню в среде IDE или с помощью средства развертывания в консоли администратора GlassFish.</p>
</div>
<div class="sect2">
<h3 id="_развертывание_и_выполнение_приложения_из_среды_ide">Развертывание и выполнение приложения из среды IDE</h3>
<div class="paragraph">
<p>В этом упражнении мы используем действие "Выполнить" для развертывания архива EAR на сервере GlassFish. После развертывания будет необходимо открыть страницу ListNews приложения в браузере и добавить сообщение.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните правой кнопкой мыши узел проекта EAR в окне "Проекты" и выберите "Выполнение".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При нажатии команды "Выполнение" среда IDE разворачивает архив EAR и создает ресурсы JMS на сервере. Среда IDE откроет установленную по умолчанию начальную страницу приложения (<a href="http://localhost:8080/MavenEnterpriseApp-web/">http://localhost:8080/MavenEnterpriseApp-web/</a>) в браузере.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Для вывода страницы ListNews откройте в браузере следующий адрес URL.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a href="http://localhost:8080/MavenEnterpriseApp-web/ListNews">http://localhost:8080/MavenEnterpriseApp-web/ListNews</a>.</p>
</div>
<div class="paragraph">
<p>При первом выполнении проекта база данных пуста, и сообщения для вывода отсутствуют.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-browser1.png" alt="maven browser1">
</div>
<div class="title">Figure 21. Страница ListNews открыта в браузере</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "Добавить сообщение".</p>
</li>
<li>
<p>Введите сообщение в форму в сервлете PostMessage. Нажмите кнопку "Отправить запрос".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-browser2.png" alt="maven browser2">
</div>
<div class="title">Figure 22. Страница PostMessage открыта в браузере</div>
</div>
<div class="paragraph">
<p>При добавлении сообщения с помощью сервлета PostMessage оно передается на постоянное хранение в управляемый сообщениями компонент. Для просмотра сообщений в базе данных вызывается сервлет ListNews. Список сообщений в базе данных, извлеченных сервлетом ListNews, часто выводится без нового сообщения, поскольку служба передачи сообщений работает асинхронно.</p>
</div>
<div class="paragraph">
<p>В проектах Maven, использующих сервер GlassFish в качестве целевого сервера, функции "Компиляция при сохранении" и "Развертывание при сохранении" включены по умолчанию. Например, при изменении и сохранении сервлета можно перезагрузить сервлет в браузере и просмотреть изменения без повторного развертывания приложения.</p>
</div>
</div>
<div class="sect2">
<h3 id="_развертывание_из_консоли_администратора_glassfish">Развертывание из консоли администратора GlassFish</h3>
<div class="paragraph">
<p>В этом упражнении выполняется развертывание архива EAR с помощью средства "Развернуть" в консоли администратора Glassfish.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Разверните узел "Серверы" в окне "Службы".</p>
</li>
<li>
<p>Запустите сервер приложений GlassFish.</p>
</li>
<li>
<p>Щелкните правой кнопкой мыши узел сервера приложений GlassFish и выберите "Просмотр консоли администратора" для открытия в браузере консоли администратора GlassFish.</p>
</li>
<li>
<p>Щелкните узел "Приложения" на левой панели консоли администратора.</p>
</li>
<li>
<p>Нажмите кнопку "Развернуть" на главной панели консоли администратора.</p>
</li>
<li>
<p>Нажмите кнопку "Обзор" для поиска архива EAR приложения уровня предприятия.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Архив EAR расположен в каталоге  <code>target</code>  внутри каталога приложения уровня предприятия в локальной системе.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "ОК".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При нажатии кнопки "ОК" выполняется развертывание приложения с помощью средства развертывания GlassFish.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
При развертывании приложения с помощью средства развертывания на консоли администрирования GlassFish, также необходимо вручную создать ресурсы, необходимые для приложения, если они не существуют.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_загрузка_проекта_решения">Загрузка проекта решения</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Решение для данного учебного курса в виде проекта можно загрузить несколькими способами.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Загрузите <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FMavenEnterpriseApp.zip">архив завершенного проекта в формате zip</a>.</p>
</li>
<li>
<p>Выполните проверку исходных файлов проекта на выходе из примеров NetBeans, выполнив перечисленные ниже действия.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите в главном меню "Группа &gt; Subversion &gt; Проверить".</p>
</li>
<li>
<p>В диалоговом окне "Проверка" введите следующий URL-адрес репозитория:
 <code><a href="https://svn.netbeans.org/svn/samples~samples-source-code" class="bare">https://svn.netbeans.org/svn/samples~samples-source-code</a></code>
Нажмите кнопку "Далее".</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "Обзор" для открытия диалогового окна "Обзор папок репозитория".</p>
</li>
<li>
<p>Разверните корневой узел и выберите <strong>samples/javaee/MavenEnterpriseApp</strong>. Нажмите кнопку "ОК".</p>
</li>
<li>
<p>Укажите локальную папку для исходных файлов (папка должна быть пустой).</p>
</li>
<li>
<p>Нажмите кнопку "Завершить".</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>После нажатия кнопки "Готово" среда IDE инициализирует локальную папку в качестве репозитория Subversion и выполняет проверку исходных файлов проекта на выходе.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните команду "Открыть проект" в диалоговом окне, которое появится после завершения проверки.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Примечания.</strong> For more about installing Subversion, see the section on <a href="../ide/subversion.html#settingUp">Setting up Subversion</a> in the <a href="../ide/subversion.html">Guide to Subversion in IDE NetBeans</a>.</p>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Creating%20an%20Enterprise%20Application%20Using%20Maven">Отправить отзыв по этому учебному курсу</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_дополнительные_сведения">Дополнительные сведения</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For more information about using IDE NetBeans to develop Java EE applications, see the following resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javaee-intro.html">+Введение в технологию Java EE +</a></p>
</li>
<li>
<p><a href="javaee-gettingstarted.html">Начало работы с приложениями Java EE</a></p>
</li>
<li>
<p><a href="maven-entapp-testing.html">Тестирование приложения Maven уровня предприятия</a></p>
</li>
<li>
<p><a href="../../trails/java-ee.html">Учебная карта по Java EE и Java Web</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Дополнительные сведения по использованию компонентов уровня предприятия приведены в <a href="http://download.oracle.com/javaee/7/tutorial/doc/">учебном курсе по Java EE 7</a>.</p>
</div>
<div class="paragraph">
<p>To send comments and suggestions, get support, and keep informed on the latest developments on the IDE NetBeans Java EE development features, <a href="../../../community/lists/top.html">join the nbj2ee mailing list</a>.</p>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/maven-entapp_ru.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
