
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Aplicando Anotações de Ciclo de Vida e de Beans @Alternative</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aplicando Anotações de Ciclo de Vida e de Beans @Alternative - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Aplicando Anotações de Ciclo de Vida e de Beans @Alternative">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">Aplicando Anotações de Ciclo de Vida e de Beans @Alternative</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/cdi-validate_pt_BR.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_injeção_de_dependência_e_contextos">Injeção de Dependência e Contextos</a></li>
<li><a href="#alternative">Tratando Várias Implantações</a></li>
<li><a href="#lifecycle">Aplicando Anotações de Ciclo de Vida aos Beans Gerenciados</a></li>
<li><a href="#seealso">Consulte Também</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><em>Contribuição de Andy Gibson</em></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_injeção_de_dependência_e_contextos">Injeção de Dependência e Contextos</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="cdi-intro.html">Introdução ao CDI e ao JSF 2.0</a></p>
</li>
<li>
<p><a href="cdi-inject.html">Trabalhando com Injeção e Qualificadores no CDI</a></p>
</li>
<li>
<p><strong>Aplicando Anotações @Alternative Beans e de Ciclo de Vida</strong></p>
<div class="ulist">
<ul>
<li>
<p><a href="#alternative">Tratando Várias Implantações</a></p>
</li>
<li>
<p><a href="#lifecycle">Aplicando Anotações de Ciclo de Vida em Beans gerenciado</a></p>
</li>
<li>
<p><a href="#seealso">Consulte Também</a></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="cdi-events.html">Trabalhando com Eventos no CDI</a></p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>A Injeção de Dependência e Contextos (CDI), especificada por <a href="http://jcp.org/en/jsr/detail?id=299">JSR-299</a>, é parte integrante do Java EE 6 e fornece uma arquitetura que permite aos componentes do Java EE, como os servlets, enterprise beans e JavaBeans, existirem dentro do ciclo de vida de uma aplicação com escopos bem definidos. Além disso, os serviços CDI permitem que os componentes do Java EE, como beans de sessão EJB e beans gerenciados do JavaServer Faces (JSF), sejam injetados e interajam de maneira acoplada flexível, disparando e observando eventos.</p>
</div>
<div class="paragraph">
<p>Este tutorial tem base no post do blog de Andy Gibson, intitulado <a href="http://www.andygibson.net/blog/index.php/2009/12/22/getting-started-with-cdi-part-2-injection/">Introdução ao CDI parte 2: Injeção</a>. Ele demonstra como é possível usufruir da anotação <code>@Alternative</code> para configurar sua aplicação para diferentes implantações e também como utilizar as anotações do ciclo de vida do bean gerenciado, como a <code>@PostConstruct`e a `@PostDestroy</code>, para combinar a injeção CDI com a funcionalidade fornecida pela <a href="http://jcp.org/en/jsr/detail?id=316">Especificação do Bean Gerenciado do Java EE 6</a>.</p>
</div>
<div class="paragraph">
<p>O NetBeans IDE fornece um suporte incorporado para a Injeção de Dependência e Contextos, incluindo a opção de geração do arquivo de configuração de CDI <code>beans.xml</code> durante a criação do projeto, do editor e do suporte de navegação para anotações, assim como vários assistentes para a criação de artefatos CDI comumente utilizados.</p>
</div>
<div class="paragraph">
<p>Para concluir este tutorial, você precisa dos seguintes recursos e softwares.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software ou Recurso</th>
<th class="tableblock halign-left valign-top">Versão Necessária</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">NetBeans IDE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Versão Java EE 7.2, 7.3, 7.4, 8.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK (Java Development Kit)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">versão 7 ou 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://glassfish.dev.java.net/">GlassFish Server</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Source Edition 3.x ou 4.x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FcdiDemo2.zip">cdiDemo2.zip</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">n/d</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>O pacote Java EE do NetBeans inclui também o GlassFish Server Open Source Edition, que é um contêiner compatível com Java EE.</p>
</li>
<li>
<p>É possível fazer download do projeto modelo de solução deste tutorial: <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FcdiDemo3.zip">cdiDemo3.zip</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="alternative">Tratando Várias Implantações</h2>
<div class="sectionbody">
<div class="paragraph">
<p>O CDI oferece o uso da anotação <code>@Aternative</code> que lhe permite encapsular vários beans que coincidem com um ponto de injeção sem erros de ambiguidade. Em outras palavras, é possível aplicar a anotação <code>@Alternative</code> a dois ou mais beans e, em seguida, com base na implantação, especificar o bean que deseja utilizar no arquivo de configuração do CDI <code>beans.xml</code>.</p>
</div>
<div class="paragraph">
<p>Considere o seguinte cenário como demonstração disso. Nós injetamos um <code>ItemValidator</code> na nossa classe <code>ItemProcessor</code> principal. O <code>ItemValidator</code> é implementado pelo <code>DefaultItemValidator</code> e pelo <code>RelaxedItemValidator</code>. Com base nos requisitos de implantação, gostaríamos de utilizar o <code>DefaultItemValidator</code> para a maior parte dos casos, mas também é exigido o <code>RelaxedItemValidator</code> para uma implantação específica. Para resolver isso, anotamos os dois beans e, em seguida, especificamos qual bean utilizar para uma determinada implantação, adicionando uma entrada ao arquivo <code>beans.xml</code> da aplicação.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/cdi-diagram-alternative.png" alt="cdi diagram alternative">
</div>
<div class="title">Figure 1. Use a injeção de CDI para acoplar, livremente, as classes na sua aplicação</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Começando pela extração do projeto inicial modelo a partir do arquivo <code>cdiDemo2.zip</code> (Consulte a <a href="#requiredSoftware">tabela acima, que lista os recursos necessários</a>.) Abra o projeto no IDE escolhendo Arquivo &gt; Abrir Projeto (Ctrl-Shift-O; ⌘-Shift-O no Mac) e, em seguida, selecionando o projeto no seu local no computador.</p>
</li>
<li>
<p>Clique com o botão direito do mouse no nó do projeto na janela Projetos e escolha Propriedades.</p>
</li>
<li>
<p>Selecione a categoria Executar e confirme se a instância do GlassFish está selecionada na lista drop-down Servidor.</p>
</li>
<li>
<p>Crie uma interface <code>ItemValidator</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Clique no botão Novo Arquivo (<span class="image"><img src="images/new-file-btn.png" alt="new file btn"></span>) ou pressione CTRL-N (⌘-N no Mac) para abrir o assistente de Arquivo.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Selecione a categoria Java e, em seguida, selecione Interface Java. Clique em Próximo.</p>
</li>
<li>
<p>Digite <strong>ItemValidator</strong> como o nome da classe e, em seguida, <strong>exercício3</strong> como o pacote.</p>
</li>
<li>
<p>Clique em Finalizar. A nova interface será gerada e aberta no editor.</p>
</li>
<li>
<p>Adicione um método chamado <code>isValid()</code> que utiliza um objeto <code>Item</code> e retorna um valor <code>boolean</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public interface ItemValidator {
    *boolean isValid(Item item);*
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>(Utilize a dica do editor para adicionar a instrução de importação para o <code>exercise2.Item</code>.)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Expanda a classe <code>ItemProcessor</code> para incorporar a nova funcionalidade. Abra o <code>ItemProcessor</code> no editor e faça as seguintes alterações.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Named
@RequestScoped
public class ItemProcessor {

    @Inject @Demo
    private ItemDao itemDao;

    *@Inject
    private ItemValidator itemValidator;*

    public void execute() {
      List&lt;Item&gt;  items = itemDao.fetchItems();
      for (Item item : items) {
          System.out.println(*"Item = " + item + " valid = " + itemValidator.isValid(item)*);
      }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>(Utilize a dica do editor para adicionar a instrução de importação para <code>exercise3.ItemValidator</code>.)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Crie uma implementação do <code>ItemValidator</code> chamado <code>DefaultItemValidator</code> que simplesmente testa o limite com relação ao valor.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Na janela Projetos, clique com o botão direito do mouse no pacote <code>exercise3</code> e selecione Nova &gt; Classe Java. Nomeie a classe como <strong>DefaultItemValidator</strong> e clique em Finalizar.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Faça com que o <code>DefaultItemValidator</code> implemente o <code>ItemValidator</code> e substitua o método <code>isValid()</code> como se segue.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class DefaultItemValidator *implements ItemValidator* {

    *@Override
    public boolean isValid(Item item) {
        return item.getValue() &lt; item.getLimit();
    }*
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>(Utilize a dica do editor para adicionar a instrução de importação para o <code>exercise2.Item</code>.)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique no botão Executar Projeto (<span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span>) na barra de ferramentas principal do IDE. O projeto é compilado e implantado no GlassFish e a página de boas-vindas da aplicação (<code>process.xhtml</code>) será aberta no browser.</p>
</li>
<li>
<p>Clique no botão &#8220;Execute&#8221; que é exibido na página. Volte ao IDE e examine o log do GlassFish Server. O log do servidor é exibido na janela Saída (Ctrl-4; ⌘-4 no Mac) na guia GlassFish. É possível notar que os itens estão sendo validados e que o único item válido listado é o caso em que o valoe é menor que o limite.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">INFO: Item = exercise2.Item@e857ac [Value=34, Limit=7] valid = false
INFO: Item = exercise2.Item@63124f52 [Value=4, Limit=37] valid = true
INFO: Item = exercise2.Item@4715c34e [Value=24, Limit=19] valid = false
INFO: Item = exercise2.Item@65c95a57 [Value=89, Limit=32] valid = false</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/output-window.png" alt="output window">
</div>
<div class="title">Figure 2. Exiba o log do servidor na janela Saída</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Agora, considere o cenário onde temos que implantar em um site diferente, mais flexível, e considere um item como inválido somente se o valor for mais de duas vezes maior que o limite. Pode ser necessário ter um outro bean que implemente a interface <code>ItemValidator</code> para essa lógica.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Crie uma nova implementação do <code>ItemValidator</code> chamada <code>RelaxedItemValidator</code>. Na janela Projetos, clique com o botão direito do mouse no pacote <code>exercise3</code> e selecione Nova &gt; Classe Java. Nomeie a classe <strong>RelaxedItemValidator</strong> e clique em Finalizar.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Faça com que o <code>RelaxedItemValidator</code> implemente o <code>ItemValidator</code> e substitua o método <code>isValid()</code> como se segue.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class RelaxedItemValidator *implements ItemValidator* {

    *@Override
    public boolean isValid(Item item) {
        return item.getValue() &lt; (item.getLimit() * 2);
    }*
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>(Utilize a dica do editor para adicionar a instrução de importação para o <code>exercise2.Item</code>.)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique no botão Executar Projeto (<span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span>) para executar o projeto. Observe que o projeto agora falha na implantação.</p>
</li>
<li>
<p>Examine o log do servidor na janela Saída (Ctrl-4; ⌘-4 no Mac). Você nota uma mensagem de erro relatando um problema de "dependência ambígua". Isso ocorre porque agora temos duas classes implementando a mesma interface.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">org.glassfish.deployment.common.DeploymentException: Injection point has ambiguous dependencies.
Injection point: field exercise2.ItemProcessor.itemValidator;
Qualifiers: [@javax.enterprise.inject.Default()];
Possible dependencies: [exercise3.RelaxedItemValidator, exercise3.DefaultItemValidator]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Weld, a implementação para CDI, não pode determinar se deve utilizar o <code>RelaxedItemValidator</code> ou o <code>DefaultItemValidator</code> para o ponto de injeção fornecido.</p>
</div>
<div class="paragraph">
<p>Como mencionado anteriormente, a única diferença é baseada na implantação. Para a maioria das implantações, preferimos utilizar o validador default, mas para uma implantação, preferimos utilizar a implantação "flexível". O CDI oferece o uso da anotação <code>@Alternative</code> que lhe permite encapsular vários beans que coincidam com um ponto de injeção sem erros de ambiguidade e o bean a ser utilizado, que é definido no arquivo <code>beans.xml</code>. Isso lhe permite implantar as duas implementações no mesmo módulo com a definição <code>beans.xml</code> sendo a única diferença, que pode ser alterada ao longo de implantações diferentes.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione a anotação <code>@Alternative</code> e as instruções de importação correspondentes a <code>RelaxedItemValidator</code> e <code>DefaultItemValidator</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Abra o <code>RelaxedItemValidator</code> no editor e faça as seguintes alterações.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">*import javax.enterprise.inject.Alternative;*
...

*@Alternative*
public class RelaxedItemValidator implements ItemValidator {

    public boolean isValid(Item item) {
        return item.getValue() &lt; (item.getLimit() * 2);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Digite &#8220;@Al&#8221; e, em seguida, pressione Ctrl-Espaço para chamar a funcionalidade autocompletar código. Como somente uma opção é filtrada, a anotação <code>@Alternative</code> é autocompletada e a instrução de importação correspondente para o <code>javax.enterprise.inject.Alternative</code> é adicionada automaticamente à parte superior do arquivo. Normalmente, ao pressionar Ctrl-Espaço nas anotações também é fornecido uma documentação pop-up Javadoc.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/code-completion-alternative.png" alt="code completion alternative">
</div>
<div class="title">Figure 3. Pressione Ctrl-Espaço em anotações para chamar a documentação Javadoc</div>
</div>
<div class="paragraph">
<p>Alterne para <code>DefaultItemValidator</code> (pressione Ctrl-Tab) e faça as alterações a seguir.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">*import javax.enterprise.inject.Alternative;*
...

*@Alternative*
public class DefaultItemValidator implements ItemValidator {

    public boolean isValid(Item item) {
        return item.getValue() &lt; item.getLimit();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se tivéssemos implantado a aplicação, agora obteríamos uma mensagem de erro "dependência não-satisfeita", já que definimos os dois beans coincidentes como alternativos, mas não ativamos nenhum deles no arquivo <code>beans.xml</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Utilize a caixa de diálogo Ir para Arquivo do IDE para abrir rapidamente o arquivo <code>beans.xml</code>. Selecione Navegar &gt; Ir para Arquivo no menu principal do IDE (Alt-Shift-O; Ctrl-Shift-O no Mac) e, em seguida, digite &#8220;beans&#8221;. Clique em OK.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/go-to-file.png" alt="go to file">
</div>
<div class="title">Figure 4. Use a caixa de diálogo Ir para Arquivo para localizar rapidamente um arquivo de projeto</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Faça as seguintes alterações no arquivo <code>bean.xml</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;beans xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/beans_1_0.xsd"&gt;

    *&lt;alternatives&gt;
        &lt;class&gt;exercise3.RelaxedItemValidator&lt;/class&gt;
    &lt;/alternatives&gt;*

&lt;/beans&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Isso informa ao CDI que o <code>RelaxedItemValidator</code> deve ser usado para esta implantação. É possível achar que a anotação <code>@Alternative</code> desativa efetivamente o bean, tornando-o indisponível para injeção, mas permitindo que a implementação seja encapsulada com os outros beans. Adicioná-la como uma alternativa no arquivo <code>beans.xml</code> reabilita efetivamente o bean, tornando-o disponível para injeção. Ao movermos esse tipo de metadados para o arquivo <code>beans.xml</code>, podemos colocar no pacote versões diferentes do arquivo à várias implantações.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique no botão Executar Projeto (<span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span>) para executar o projeto (como alternativa, Pressione F6; fn-F6 no Mac). No browser, clique no botão &#8220;Execute&#8221; exibido na página. Volte ao IDE e examine o log do GlassFish Server exibido na janela Saída (Ctrl-4; ⌘-4 no Mac).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">INFO: Item = exercise2.Item@672f0924 [Value=34, Limit=7] valid = false
INFO: Item = exercise2.Item@41014f68 [Value=4, Limit=37] valid = true
INFO: Item = exercise2.Item@3d04562f [Value=24, Limit=19] valid = true
INFO: Item = exercise2.Item@67b646f4 [Value=89, Limit=32] valid = false</code></pre>
</div>
</div>
<div class="paragraph">
<p>Você pode notar que a implementação <code>RelaxedItemValidator</code> está sendo utilizada como o terceiro item exibido como válido, ao mesmo tempo em que o valor fornecido (<code>24</code>) é maior que o limite informado (<code>19</code>).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lifecycle">Aplicando Anotações de Ciclo de Vida aos Beans Gerenciados</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Neste exercício, será injetado um <code>ItemErrorHandler</code> na <code>ItemProcessor</code> principal. Como o <code>FileErrorReporter</code> é a única implementação da interface <code>ItemErrorHandler</code>, ela será selecionada como a injeção. Para configurar as ações específicas de ciclo de vida para a classe, é necessário utilizar as anotações <code>@PostConstruct</code> e <code>@PreDestroy</code> a partir da especificação do Bean gerenciado (incluídas no <a href="http://jcp.org/en/jsr/detail?id=316">JSR 316: Plataforma Java, Especificação do Enterprise Edition 6</a>).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/cdi-diagram-lifecycle.png" alt="cdi diagram lifecycle">
</div>
<div class="title">Figure 5. Use a injeção de CDI para acoplar, livremente, as classes na sua aplicação</div>
</div>
<div class="paragraph">
<p>Prosseguindo com o exemplo, crie uma interface <code>ItemErrorHandler</code> para tratar itens inválidos ao serem descobertos.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na janela Projetos, clique com o botão direito do mouse no pacote <code>exercise3</code> e selecione Nova &gt; Interface Java.</p>
</li>
<li>
<p>No assistente de Interface Java, digite <strong>ItemErrorHandler</strong> como o nome da classe e, em seguida <strong>exercício3</strong> como o pacote. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A nova interface será gerada e aberta no editor.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione o método chamado <code>handleItem()</code> que utiliza um objeto <code>Item</code> como um argumento.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public interface ItemErrorHandler {
    *void handleItem(Item item);*
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>(Utilize a dica do editor para adicionar a instrução de importação para o <code>exercise2.Item</code>.)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Comece com a implementação do <code>ItemErrorHandler</code> com um handler falso chamado <code>FileErrorReporter</code> que salva os detalhes do item em um arquivo.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Na janela Projetos, clique com o botão direito do mouse no pacote <code>exercise3</code> e selecione Nova &gt; Classe Java. Nomeie a classe <strong>FileErrorReporter</strong> e clique em Finalizar.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Faça com que o <code>FileErrorReporter</code> implemente o <code>ItemErrorHandler</code> e substitua o método <code>handlerItem()</code> como se segue.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class FileErrorReporter *implements ItemErrorHandler* {

    *@Override
    public void handleItem(Item item) {
        System.out.println("Saving " + item + " to file");
    }*
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>(Utilize a dica do editor para adicionar a instrução de importação para o <code>exercise2.Item</code>.)</p>
</div>
<div class="paragraph">
<p>Você deseja abrir o arquivo antes de começar a tratar itens, portanto, deixe-o aberto durante o processo em que o conteúdo é adicionado ao arquivo e, em seguida, feche o arquivo quando processamento tiver sido concluído. Você poderia adicionar manualmente os métodos <code>initProcess()</code> e <code>finishProcess()</code> ao bean de informe de erro, mas então não poderia codificar a interface, já que o chamador precisaria conhecer esses métodos específicos da classe. Você poderia adicionar esses mesmos métodos à interface <code>ItemErrorReporter</code>, mas então seria necessário implementar desnecessariamente tais métodos em cada classe que implemente aquela interface. Em vez disso, é possível utilizar algumas das anotações de ciclo de vida da especificação do Bean Gerenciado (incluídas na <a href="http://jcp.org/en/jsr/detail?id=316">JSR 316: plataforma Java, Especificação do Enterprise Edition 6</a>) para chamar os métodos no bean em alguns pontos no ciclo de vida do bean. Um método anotado <code>@PostConstruct</code> é chamado quando o bean tiver sido construído e qualquer dependência do bean tiver sido injetada. Da mesma forma, um método anotado <code>@PreDestroy</code> é chamado um pouco antes do bean ser descartado pelo contêiner.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione os seguintes métodos <code>init()</code> e <code>release()</code> com as anotações <code>@PostConstruct</code> e <code>@PreDestroy</code> correspondentes.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class FileErrorReporter implements ItemErrorHandler {

    *@PostConstruct
    public void init() {
        System.out.println("Creating file error reporter");
    }

    @PreDestroy
    public void release() {
        System.out.println("Closing file error reporter");
    }*

    @Override
    public void handleItem(Item item) {
        System.out.println("Saving " + item + " to file");
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Corrigir importações. Clique com o botão direito do mouse no editor e selecione Corrigir importações ou pressione Ctrl-Shift-I (⌘-Shift-I no Mac). Instruções de importação para <code>javax.annotation.PostConstruct</code> e <code>javax.annotation.PreDestroy</code> serão adicionadas à parte superior do arquivo.</p>
</li>
<li>
<p>Finalmente, adicione o novo bean <code>ItemErrorHandler</code> ao <code>ItemProcessor</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Named
@RequestScoped
public class ItemProcessor {

    @Inject @Demo
    private ItemDao itemDao;

    @Inject
    private ItemValidator itemValidator;

    *@Inject
    private ItemErrorHandler itemErrorHandler;*

    public void execute() {
        List&lt;Item&gt;  items = itemDao.fetchItems();
        for (Item item : items) {
            *if (!itemValidator.isValid(item)) {
                itemErrorHandler.handleItem(item);
            }*
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>(Utilize a dica do editor para adicionar a instrução de importação para o <code>exercise3.ItemErrorHandler</code>.)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique no botão Executar Projeto (<span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span>) para executar o projeto (como alternativa, Pressione F6; fn-F6 no Mac). No browser, clique no botão &#8220;Execute&#8221; exibido na página. Volte ao IDE e examine o log do GlassFish Server exibido na janela Saída (Ctrl-4; ⌘-4 no Mac).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">INFO: Creating file error reporter
INFO: Saving exercise2.Item@6257d812 [Value=34, Limit=7] to file
INFO: Saving exercise2.Item@752ab82e [Value=89, Limit=32] to file
INFO: Closing file error reporter</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Using%20CDI%20Injection%20to%20Perform%20Custom%20Validation">Enviar Feedback neste Tutorial</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="seealso">Consulte Também</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Diferentes implantações de aplicações podem utilizar regras diversas para tratar itens inválidos, tal como a rejeição de um item, o envio de notificações aos indivíduos, a sinalização desses itens, ou simplesmente a listagem deles em um arquivo de saída. Além disso, é possível fazer uma combinação dessas regras (ex., rejeitar um pedido, enviar um e-mail a um representante de vendas e listar o pedido em um arquivo). Uma maneira excelente de tratar esse tipo de problema multifacetado é utilizando <em>eventos</em>. Os eventos CDI são o assunto do artigo final desta série:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="cdi-events.html">Trabalhando com Eventos no CDI</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Para obter mais informações sobre o CDI e o Java EE, consulte os recursos a seguir.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="cdi-intro.html">Introdução à Injeção de Dependência e Contextos e JSF 2.0</a></p>
</li>
<li>
<p><a href="cdi-inject.html">Trabalhando com Injeção e Qualificadores no CDI</a></p>
</li>
<li>
<p><a href="javaee-gettingstarted.html">Conceitos Básicos sobre Aplicações do Java EE</a></p>
</li>
<li>
<p><a href="http://blogs.oracle.com/enterprisetechtips/entry/using_cdi_and_dependency_injection">Dica Técnica do Enterprise: Utilizando Injeção de Dependência e de CDI para Java em uma Aplicação JSF 2.0</a></p>
</li>
<li>
<p><a href="http://download.oracle.com/javaee/6/tutorial/doc/gjbnr.html">O Tutorial do Java EE 6, Parte V: Injeção de Dependência e Contextos para a Plataforma Java EE</a></p>
</li>
<li>
<p><a href="http://jcp.org/en/jsr/detail?id=299">JSR 299: Especificação para Injeção de Dependência e Contextos</a></p>
</li>
<li>
<p><a href="http://jcp.org/en/jsr/detail?id=316">JSR 316: Plataforma Java, Especificação do Enterprise Edition 6</a></p>
</li>
</ul>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/cdi-validate_pt_BR.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
