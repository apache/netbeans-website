
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Criando uma Aplicação Corporativa com o Maven</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Criando uma Aplicação Corporativa com o Maven - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Criando uma Aplicação Corporativa com o Maven">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">Criando uma Aplicação Corporativa com o Maven</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/maven-entapp_pt_BR.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_utilizando_o_maven_no_ide">Utilizando o Maven no IDE</a></li>
<li><a href="#_criando_o_projeto_de_aplicação_corporativa_maven">Criando o Projeto de Aplicação Corporativa Maven</a></li>
<li><a href="#_codificando_o_projeto_ejb">Codificando o Projeto EJB</a>
<ul class="sectlevel2">
<li><a href="#_criando_a_unidade_de_persistência">Criando a Unidade de Persistência</a></li>
<li><a href="#_criando_a_classe_de_entidade">Criando a Classe de Entidade</a></li>
<li><a href="#_criando_o_bean_baseado_em_mensagens">Criando o Bean Baseado em Mensagens</a></li>
<li><a href="#_criando_o_bean_de_sessão">Criando o Bean de Sessão</a></li>
</ul>
</li>
<li><a href="#_codificando_a_aplicação_web">Codificando a Aplicação Web</a>
<ul class="sectlevel2">
<li><a href="#_criando_o_servlet_listnews">Criando o Servlet ListNews</a></li>
<li><a href="#_criando_o_servlet_postmessage">Criando o Servlet PostMessage</a></li>
</ul>
</li>
<li><a href="#_construindo_a_aplicação_com_maven">Construindo a Aplicação com Maven</a>
<ul class="sectlevel2">
<li><a href="#_trabalhando_com_dependências_do_projeto">Trabalhando com Dependências do Projeto</a></li>
<li><a href="#_construindo_com_dependências">Construindo com Dependências</a></li>
</ul>
</li>
<li><a href="#_implantando_e_executando_a_aplicação">Implantando e Executando a Aplicação</a>
<ul class="sectlevel2">
<li><a href="#_implantando_e_executando_a_aplicação_a_partir_do_ide">Implantando e Executando a Aplicação a partir do IDE</a></li>
<li><a href="#_implantando_da_console_admin_do_glassfish">Implantando da Console Admin do GlassFish</a></li>
</ul>
</li>
<li><a href="#_fazendo_download_do_projeto_da_solução">Fazendo Download do Projeto da Solução</a></li>
<li><a href="#_consulte_também">Consulte Também</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Este tutorial demonstra como criar uma aplicação simples do enterprise utilizando arquétipos Maven e NetBeans IDE. O tutorial fornece também algumas explicações e dicas sobre o uso do IDE para criar e construir aplicações Maven.</p>
</div>
<div class="paragraph">
<p>Neste tutorial, você criará uma aplicação corporativa que é encapsulada como um arquivo compactado EAR e implantado no GlassFish Server Open Source Edition 3. Você cria a aplicação utilizando o arquétipo da Aplicação Corporativa Maven no assistente Novo Projeto. A aplicação contém um projeto EJB que contém uma classe de entidade persistente, um bean baseado em mensagens e uma fachada de bean de sessão para a entidade. A aplicação também contém um projeto web que contém dois servlets.</p>
</div>
<div class="paragraph">
<p><strong>Exercícios do Tutorial</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#intro">Utilizando o Maven no IDE</a></p>
</li>
<li>
<p><a href="#Exercise_1">Criando o Projeto de Aplicação Corporativa Maven</a></p>
</li>
<li>
<p><a href="#Exercise_2">Codificando o Módulo EJB</a></p>
</li>
<li>
<p><a href="#Exercise_2a">Criando a Unidade de Persistência</a></p>
</li>
<li>
<p><a href="#Exercise_2b">Criando a Classe de Entidade</a></p>
</li>
<li>
<p><a href="#Exercise_2c">Criando o Bean Baseado em Mensagens</a></p>
</li>
<li>
<p><a href="#Exercise_2d">Criando a Fachada da Sessão</a></p>
</li>
<li>
<p><a href="#Exercise_3">Codificando o Módulo Web</a></p>
</li>
<li>
<p><a href="#Exercise_3a">Criando o Servlet ListNews</a></p>
</li>
<li>
<p><a href="#Exercise_3b">Criando o Servlet PostMessage</a></p>
</li>
<li>
<p><a href="#Exercise_4">Construindo a Aplicação com Maven</a></p>
</li>
<li>
<p><a href="#Exercise_4a">Trabalhando com Dependências do Projeto</a></p>
</li>
<li>
<p><a href="#Exercise_4b">Construindo com Dependências</a></p>
</li>
<li>
<p><a href="#Exercise_5">Implantando e Executando a Aplicação</a></p>
</li>
<li>
<p><a href="#Exercise_5a">Implantando a Partir do IDE</a></p>
</li>
<li>
<p><a href="#Exercise_5b">Implantando na Console Admin do GlassFish Server</a></p>
</li>
<li>
<p><a href="#Exercise_7">Fazendo Download do Projeto da Solução</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Para seguir este tutorial, são necessários os recursos e o software a seguir.</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software ou Recurso</th>
<th class="tableblock halign-left valign-top">Versão Necessária</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">NetBeans IDE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Versão Java EE 7.2, 7.3, 7.4, 8.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK (Java Development Kit)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">versão 7 ou 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GlassFish Server Open Source Edition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.x</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Pré-requisitos</strong></p>
</div>
<div class="paragraph">
<p>Este tutorial pressupõe que você tenha algum conhecimento básico das tecnologias a seguir, ou alguma experiência de programação com elas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Programação em Java</p>
</li>
<li>
<p>NetBeans IDE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Antes de começar este tutorial, talvez você queira se familiarizar com a documentação a seguir.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://wiki.netbeans.org/MavenBestPractices">Melhores Práticas para o Apache Maven no NetBeans IDE</a></p>
</li>
<li>
<p><a href="http://books.sonatype.com/mvnref-book/reference/introduction.html">Capítulo 1. Introdução ao Apache Maven</a> (do <a href="http://books.sonatype.com/mvnref-book/reference/index.html">+Maven: A Referência Completa +</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Você pode fazer download <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FMavenEnterpriseApp.zip">de um arquivo compactado zip do projeto finalizado</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_utilizando_o_maven_no_ide">Utilizando o Maven no IDE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>O suporte ao Maven está totalmente integrado no NetBeans IDE. Desenvolver um projeto que utiliza o framework do Maven é quase igual a desenvolver um projeto no Ant. No entanto, há algumas diferenças relacionadas ao modo como o Maven constrói os projetos e trabalha com as dependências. As dicas a seguir podem ajudá-lo a evitar alguns problemas caso esteja criando uma aplicação Maven pela primeira vez.</p>
</div>
<div class="paragraph">
<p><strong>Verifique as definições do Maven</strong></p>
</div>
<div class="paragraph">
<p>Se este for seu primeiro Projeto Maven, pode ser necessário verificar as definições da configuração do Maven na janela Opções. O Maven está incorporado ao IDE e é instalado quando você instala o IDE.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Abra a janela Opções no IDE (Ferramentas &gt; Opções; NetBeans &gt; Preferências no Mac).</p>
</li>
<li>
<p>Selecione a categoria Java na janela Opções e clique na guia Maven.</p>
</li>
<li>
<p>Confirme se um Início do Maven está especificado.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Você pode usar a versão do Maven incorporada no IDE ou especificar a localização de uma instalação local do Maven (requer versão 2.0.9 ou posterior).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em OK para fechar a janela Opções.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
O suporte a Maven será automaticamente ativado quando o Java estiver ativado no IDE. Você precisará ativar o plug-in Java EE, se não estiver ativado.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Atualizar seus repositórios Maven</strong></p>
</div>
<div class="paragraph">
<p>Os repositórios remotos e locais do Maven são utilizados para a funcionalidade autocompletar código e para construir projetos. É necessário atualizar os índices dos repositórios remotos do Maven para garantir que os artefatos necessários estejam prontamente disponíveis no momento de desenvolver o projeto. Você pode configurar com que frequência o IDE verifica as atualizações na guia Maven da janela Opções. Você também pode executar uma verificação imediata das atualizações e explorar os repositórios remotos e locais do Maven na janela Serviço.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Escolha Janela &gt; Serviços para abrir a janela Serviços.</p>
</li>
<li>
<p>Expanda o nó Repositórios do Maven na janela Serviços.</p>
</li>
<li>
<p>Expanda um nó de repositório para exibir os artefatos.</p>
</li>
<li>
<p>Clique com o botão direito do mouse no repositório e escolha Atualizar Índice no menu pop-up.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clica em Atualizar Índices, o IDE verifica e faz o download do índice mais recente de cada um dos repositórios remotos do Maven. Um índice representa o estado atual dos artefatos localizados no repositório e é utilizado para proporcionar referências aos artefatos que estão disponíveis na aplicação. Por default, o IDE não faz download de um artefato de um repositório até que o artefato seja explicitamente necessário.</p>
</div>
<div class="paragraph">
<p>Você pode procurar um artefato clicando com o botão direito no nó Repositórios Maven na janela Serviços e escolhendo Localizar.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Os índices são muito grandes e pode levar algum tempo para atualizar todos eles.</p>
</li>
<li>
<p>Se você estiver usando o NetBeans IDE 7.1 ou uma versão mais recente, deverá escolher Janela &gt; Outro &gt; Browser do Repositório Maven e clicar em Atualizar Índices ( <span class="image"><img src="images/maven-refreshrepo.png" alt="maven refreshrepo" title="Botão Atualizar Índices"></span>  ) na parte superior da janela Browser do Repositório Maven.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Para obter mais detalhes sobre o uso do Maven no NetBeans IDE, consulte a seção <a href="https://netbeans.org/kb/docs/java/maven-hib-java-se.html#02">Configurando o Maven</a> no tutorial <a href="https://netbeans.org/kb/docs/java/maven-hib-java-se.html">Criando uma Aplicação Maven Swing Utilizando Hibernação</a> e também <a href="http://wiki.netbeans.org/MavenBestPractices">Melhores Práticas para o Apache Maven no NetBeans IDE</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_criando_o_projeto_de_aplicação_corporativa_maven">Criando o Projeto de Aplicação Corporativa Maven</h2>
<div class="sectionbody">
<div class="paragraph">
<p>O objetivo deste exercício é criar um projeto de aplicação corporativa utilizando o arquétipo de Aplicação Corporativa Maven incluído com o IDE. O arquétipo de aplicação corporativa também criará um projeto EJB e um projeto webapp.</p>
</div>
<div class="paragraph">
<p>O IDE inclui vários arquétipos Maven no assistente Novo Projeto para ajudá-lo a criar rapidamente tipos de projetos NetBeans comuns, como projetos de aplicações do enterprise (EAR), projetos de aplicações web (WAR) e projetos de módulo EJB (JAR). O assistente também permite criar projetos dos arquétipos em repositórios remotos registrados.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Selecione Arquivo &gt; Novo Projeto (Ctrl-Shift-N; ⌘-Shift-N no Mac) no menu principal.</p>
</li>
<li>
<p>Selecione Aplicação Corporativa na categoria Maven. Clique em Próximo.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-newproject1.png" alt="maven newproject1">
</div>
<div class="title">Figure 1. Tipo do projeto Aplicação Corporativa Maven no assistente Novo Projeto</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Digite <strong>MavenEnterpriseApp</strong> como nome do projeto e defina a Localização do Projeto.</p>
</li>
<li>
<p>(Opcional) Modifique os detalhes do artefato. Clique em Próximo.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-newproject2.png" alt="maven newproject2">
</div>
<div class="title">Figure 2. Detalhes do Projeto Maven no assistente Novo Projeto</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Selecione GlassFish Server como o Servidor.</p>
</li>
<li>
<p>Defina a versão do Java EE como Java EE 6 ou Java EE 7.</p>
</li>
<li>
<p>Selecione Criar Módulo EJB e Criar Módulo da Aplicação Web. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, o IDE cria os projetos a seguir a partir do arquétipo de Aplicação Corporativa Maven.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>EJB.</strong> (MavenEnterpriseApp-ejb) O projeto EJB geralmente contém o código-fonte com a lógica de negócio da aplicação. O projeto EJB é encapsulado como um arquivo compactado EJB JAR.</p>
</li>
<li>
<p><strong>Webapp.</strong> (MavenEnterpriseApp-web) O projeto Webapp geralmente contém a camada de apresentação da aplicação, como páginas e servlets JSF e JSP. O projeto Webapp também pode conter código-fonte com lógica de negócios. O projeto Webapp é encapsulado como um arquivo compactado WAR.</p>
</li>
<li>
<p><strong>Montagem.</strong> (MavenEnterpriseApp) O projeto Montagem é usado para montar um arquivo compactado EAR a partir dos arquivos compactados EJB e WAR. O projeto Montagem não contém nenhum código-fonte.</p>
</li>
<li>
<p><strong>Aplicação Corporativa.</strong> (MavenEnterpriseApp-ear) O projeto de Aplicação Corporativa não contém um código-fonte. A Aplicação Corporativa contém apenas um arquivo POM ( <code>pom.xml</code> ) com detalhes sobre os módulos contidos na aplicação corporativa.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-projectswindow2.png" alt="maven projectswindow2">
</div>
<div class="title">Figure 3. Janela Projetos que mostra projetos gerados</div>
</div>
<div class="paragraph">
<p>Depois de criar o projeto de aplicação corporativa, o projeto da aplicação corporativa é marcado porque algumas dependências não estão disponíveis. Se você expandir o nó Dependências do projeto MavenEnterpriseApp-ear, poderá observar se quaisquer bibliotecas obrigatórias estão faltando ou as que não estão no classpath. O projeto da aplicação corporativa tem dependências em JAR e WAR, que serão encapsuladas e estarão disponíveis depois que os projetos EJB e web forem compilados. Observe que  <code>MavenEnterpriseApp-ejb</code>  e  <code>MavenEnterpriseApp-web</code>  são listados como dependências.</p>
</div>
<div class="paragraph">
<p>Em alguns casos você verá um ícone Marven na barra de status que você poderá clicar para executar uma construção primária e resolver dependências ausentes.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/priming-build.png" alt="priming build">
</div>
<div class="title">Figure 4. O ícone do Maven na barra de status permite executar uma construção primária</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_codificando_o_projeto_ejb">Codificando o Projeto EJB</h2>
<div class="sectionbody">
<div class="paragraph">
<p>O projeto EJB contém a lógica de negócio da aplicação. Nesta aplicação, o contêiner GlassFish gerenciará as transações utilizando a API de Transação Java (JTA). Neste tutorial, você criará uma classe de entidade, um bean baseado em mensagens e uma fachada de sessão para a classe de entidade no projeto EJB.</p>
</div>
<div class="sect2">
<h3 id="_criando_a_unidade_de_persistência">Criando a Unidade de Persistência</h3>
<div class="paragraph">
<p>Neste exercício, você cria uma unidade de persistência no projeto EJB. A unidade de persistência especifica os detalhes da conexão do banco de dados e como as transações são gerenciadas. Para esta aplicação, você especificará a JTA no assistente Nova Unidade de Persistência, já que deseja que o GlassFish Server gerencie as transações.</p>
</div>
<div class="paragraph">
<p>Para criar a unidade de persistência, execute as seguintes etapas.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no nó do projeto EJB e selecione Novo &gt; Outro no menu pop-up para abrir o assistente Novo Arquivo.</p>
</li>
<li>
<p>Selecione Unidade de Persistência na categoria Persistência. Clique em Próximo.</p>
</li>
<li>
<p>Selecione EclipseLink como o Provedor de Persistência na caixa de diálogo Nova Unidade de Persistência.</p>
</li>
<li>
<p>Selecione uma fonte de dados (por exemplo, selecione  <code>jdbc/sample</code>  se desejar utilizar o JavaDB).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A fonte de dados  <code>jdbc/sample</code>  é incluída com o IDE ao instalá-lo e ao GlassFish Server, mas você pode especificar uma fonte de dados diferente, se quiser utilizar um outro banco de dados.</p>
</div>
<div class="paragraph">
<p>Você pode manter as outras opções default (nome da unidade de persistência, provedor da persistência EclipseLink).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Certifique-se de que a opção Utilizar APIs de Transação Java esteja selecionada e de que Estratégia de Geração de Tabela esteja definida como Criar, para que as tabelas baseadas nas classes de entidade sejam criadas quando a aplicação for implantada. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-persistenceunit.png" alt="maven persistenceunit">
</div>
<div class="title">Figure 5. Assistente Nova Unidade de Persistência</div>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, o IDE cria o arquivo XML  <code>persistence.xml</code>  e o abre no editor. Na janela Projetos, você pode observar que o arquivo foi criado no diretório  <code>Outher Sources &gt; src/main/resources &gt; META-INF</code> . O arquivo contém detalhes sobre a conexão ao banco de dados e como as transações são gerenciadas. Se clicar na guia Código-fonte no editor, você poderá ver os seguintes detalhes sobre a unidade de persistência.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">...
&lt;persistence-unit name="com.mycompany_MavenEnterpriseApp-ejb_ejb_1.0-SNAPSHOTPU" transaction-type="JTA"&gt;
    &lt;provider&gt;org.eclipse.persistence.jpa.PersistenceProvider&lt;/provider&gt;
    &lt;jta-data-source&gt;jdbc/sample&lt;/jta-data-source&gt;
    &lt;exclude-unlisted-classes&gt;false&lt;/exclude-unlisted-classes&gt;
    &lt;properties&gt;
      &lt;property name="eclipselink.ddl-generation" value="create-tables"/&gt;
    &lt;/properties&gt;
&lt;/persistence-unit&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Você pode observar que a  <code>JTA</code>  está especificada como o tipo de transação e que a aplicação utilizará a fonte de dados registrada  <code>jdbc/sample</code> .</p>
</div>
</div>
<div class="sect2">
<h3 id="_criando_a_classe_de_entidade">Criando a Classe de Entidade</h3>
<div class="paragraph">
<p>Neste exercício, você criará uma classe de entidade no projeto EJB para representar os objetos que serão persistidos no banco de dados. Para criar a classe de entidade NewsEntity, execute as seguintes etapas.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no módulo EJB na janela Projetos e selecione Novo &gt; Outro para abrir o assistente Novo arquivo.</p>
</li>
<li>
<p>Selecione Classe de Entidade na categoria Persistência. Clique em Próximo.</p>
</li>
<li>
<p>Digite <strong>NewsEntity</strong> para Nome da Classe.</p>
</li>
<li>
<p>Digite <strong>ejb</strong> como o Pacote e deixe Tipo de Chave Primária como Longa. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, a classe de entidade  <code>NewsEntity.java</code>  se abrirá no Editor de Código-Fonte. No Editor de Código-Fonte, adicione alguns campos executando as seguintes etapas.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione as seguintes declarações de campo à classe.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private String title;
private String body;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no Editor de Código-Fonte entre a definição da classe e selecione Inserir Código (Alt-Insert; Ctrl-I no Mac) &gt; Getter e Setter.</p>
</li>
<li>
<p>Na caixa de diálogo Gerar Getters e Setters, selecione os campos  <code>body</code>  e  <code>title</code> . Clique em Gerar.</p>
</li>
<li>
<p>Salve as alterações feitas na classe.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_criando_o_bean_baseado_em_mensagens">Criando o Bean Baseado em Mensagens</h3>
<div class="paragraph">
<p>Neste exercício, você criará um bean baseado em mensagens no projeto EJB. Um bean baseado em mensagens é um enterprise bean que permite a troca assíncrona de mensagens. A aplicação NewsApp utiliza um bean baseado em mensagens para receber e processar mensagens enviadas à fila por um servlet no módulo Web.</p>
</div>
<div class="paragraph">
<p>Para utilizar um bean baseado em mensagens em uma aplicação, os recursos de conector utilizados pelo bean precisam estar registrados no servidor. Enquanto estiver implantando no GlassFish Server, você poderá criar os recursos diretamente no servidor por meio da Console Admin ou poderá criá-los na implantação especificando os detalhes no arquivo descritor  <code>glassfish-resources.xml</code> . Quando a aplicação é implantada no servidor, o servidor registra os recursos com base no arquivo descritor. Quando você usa o assistente Novo Arquivo no IDE para criar um bean baseado em mensagens, o IDE gerará os elementos no arquivo descritor para você.</p>
</div>
<div class="paragraph">
<p>Em um projeto Maven, o arquivo  <code>glassfish-resources.xml</code>  está localizado no diretório  <code>src/main/setup</code>  no nó do projeto na janela Arquivos.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no módulo EJB na janela Projetos e selecione Novo &gt; Outro para abrir o assistente Novo arquivo.</p>
</li>
<li>
<p>Na categoria Enterprise JavaBeans, selecione Bean Baseado em Mensagens. Clique em Próximo.</p>
</li>
<li>
<p>Digite <strong>NewMessage</strong> para Nome EJB.</p>
</li>
<li>
<p>Selecione <strong>ejb</strong> na lista drop-down Pacote.</p>
</li>
<li>
<p>Clique no botão Adicionar ao lado do campo Destino do Projeto para abrir a caixa de diálogo Adicionar Destino da Mensagem.</p>
</li>
<li>
<p>Na caixa de diálogo Adicionar Destino da Mensagem, digite <strong>jms/NewMessage</strong> e selecione Fila como o tipo de destino. Clique em OK.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-messagedestination.png" alt="maven messagedestination">
</div>
<div class="title">Figure 6. Caixa de Diálogo Adicionar Destino da Mensagem</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Confirme se o destino do projeto está correto. Clique em Próximo.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-newmdb.png" alt="maven newmdb">
</div>
<div class="title">Figure 7. Assistente Novo Bean Baseado em Mensagens</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Aceite as definições default nas Propriedades de Configuração de Ativação. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, o IDE gera a classe do bean e adiciona as anotações seguintes que identificam a classe como um bean baseado em mensagens e as propriedades de configuração.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@MessageDriven(mappedName = "jms/NewMessage", activationConfig =  {
        @ActivationConfigProperty(propertyName = "acknowledgeMode", propertyValue = "Auto-acknowledge"),
        @ActivationConfigProperty(propertyName = "destinationType", propertyValue = "javax.jms.Queue")
    })
public class NewMessage implements MessageListener {

    public NewMessage() {
    }

    @Override
    public void onMessage(Message message) {
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Injete o recurso  <code>MessageDrivenContext</code>  na classe, adicionando o seguinte campo anotado à classe.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class NewMessage implements MessageListener {

*@Resource
private MessageDrivenContext mdc;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Introduza o gerenciador de entidade na classe, adicionando o seguinte campo anotado (em negrito).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class NewMessage implements MessageListener {

@Resource
private MessageDrivenContext mdc;
*@PersistenceContext(unitName="com.mycompany_MavenEnterpriseApp-ejb_ejb_1.0-SNAPSHOTPU")
private EntityManager em;*</code></pre>
</div>
</div>
<div class="paragraph">
<p>A anotação  <code>@PersistenceContext</code>  especifica o contexto declarando a unidade de persistência. O valor de  <code>unitName</code>  é o nome da unidade de persistência.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione o seguinte método  <code>save</code>  (em negrito).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public NewMessage() {
}

@Override
public void onMessage(Message message) {
}

*private void save(Object object) {
    em.persist(object);
}*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Modifique o método  <code>onMessage</code> , adicionando o seguinte (em negrito) ao corpo:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public void onMessage(Message message) {
     *ObjectMessage msg = null;
     try {
          if (message instanceof ObjectMessage) {
          msg = (ObjectMessage) message;
              NewsEntity e = (NewsEntity) msg.getObject();
              save(e);
          }
     } catch (JMSException e) {
          e.printStackTrace();
          mdc.setRollbackOnly();
     } catch (Throwable te) {
          te.printStackTrace();
     }*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Corrija as instruções de importação (Ctrl-Shift-I; ⌘-Shift-I no Mac) e salve as alterações.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
quando geramos as instruções de importação, queremos garantir a importação das bibliotecas  <code>jms</code> * e * <code>javax.annotation.Resource</code> *.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Para obter mais detalhes sobre beans baseados em mensagens, consulte o capítulo <a href="http://download.oracle.com/javaee/6/tutorial/doc/gipko.html">O que é um Bean Baseado em Mensagem?</a> no <a href="http://download.oracle.com/javaee/6/tutorial/doc/index.html">Tutorial do Java EE 6 , Parte I</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_criando_o_bean_de_sessão">Criando o Bean de Sessão</h3>
<div class="paragraph">
<p>Neste exercício, você utilizará o assistente para criar uma fachada de bean de sessão para a classe de entidade NewsEntity. O assistente gerará alguns métodos  <code>criar</code> ,  <code>editar</code>  e  <code>localizar</code>  que podem ser acessados nos servlets no projeto webapp.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no módulo EJB e escolha Novo &gt; Outro.</p>
</li>
<li>
<p>Na categoria Persistência, selecione Beans de Sessão para Classes de Entidade e clique em Próximo.</p>
</li>
<li>
<p>Selecione <strong>ejb.NewsEntity</strong> na lista de classes de entidades disponíveis e clique em Adicionar para mover a classe para o painel Classes de Entidades Selecionadas. Clique em Próximo.</p>
</li>
<li>
<p>Insira <strong>ejb</strong> como Pacote. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, o IDE gera duas classes de fachada de sessão:  <code>AbstractFacade.java</code>  e  <code>NewsEntityFacade.java</code>  que estende a classe de fachada abstrata. A classe de fachada abstrata define vários métodos que são comumente utilizados com classes de entidade.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-sessionwizard.png" alt="maven sessionwizard">
</div>
<div class="title">Figure 8. Assistente Beans de Sessão para Classes de Entidade</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_codificando_a_aplicação_web">Codificando a Aplicação Web</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nesta seção, você criará dois servlets no projeto webapp.</p>
</div>
<div class="sect2">
<h3 id="_criando_o_servlet_listnews">Criando o Servlet ListNews</h3>
<div class="paragraph">
<p>Neste exercício, você criará o servlet ListNews que será utilizado para exibir uma lista de mensagens postadas. As anotações serão utilizadas para injetar a fachada de sessão, acessar o método  <code>findAll</code>  e recuperar as mensagens postadas.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse em um projeto de módulo web e selecione Novo &gt; Servlet.</p>
</li>
<li>
<p>Digite <strong>ListNews</strong> para o Nome da Classe.</p>
</li>
<li>
<p>Digite <strong>web</strong> para o Nome do Pacote. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clicar em Finalizar, a classe  <code>ListNews.java</code>  irá se abrir no Editor de Código-Fonte.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no Editor de Código-Fonte entre a definição de classes e selecione Inserir Código (Alt-Insert; Ctrl-I no Mac) &gt; Chamar Enterprise Bean.</p>
</li>
<li>
<p>Na caixa de diálogo Chamar Enterprise Bean, expanda o nó MavenEnterpriseApp-ejb e selecione NewEntityFacade. Clique em OK.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-callbean.png" alt="maven callbean">
</div>
<div class="title">Figure 9. Caixa de diálogo Chamar Enterprise Bean</div>
</div>
<div class="paragraph">
<p>Quando você clica em OK, o recurso EJB é injetado no servlet utilizando a anotação  <code>@EJB</code> .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@WebServlet(name = "ListNews", urlPatterns = {"/ListNews"})
public class ListNews extends HttpServlet {
    @EJB
    private NewsEntityFacade newsEntityFacade;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>No método  <code>processRequest</code> , modifique o método adicionando as seguintes linhas (em negrito) ao corpo do método:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">out.println("&lt;h1&gt;Servlet ListNews at " + request.getContextPath () + "&lt;/h1&gt;");
*
List news = newsEntityFacade.findAll();
for (Iterator it = news.iterator(); it.hasNext();) {
  NewsEntity elem = (NewsEntity) it.next();
  out.println(" &lt;b&gt;"+elem.getTitle()+" &lt;/b&gt;&lt;br /&gt;");
  out.println(elem.getBody()+"&lt;br /&gt; ");
}
out.println("&lt;a href='PostMessage'&gt;Add new message&lt;/a&gt;");
*
out.println("&lt;/body&gt;");</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Pode ser necessário cancelar o comentário do código, se estiver utilizando uma versão anterior do IDE.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Corrija as importações (Ctrl-Shift-I; ⌘-Shift-I no Mac) e salve as alterações.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ao gerar as instruções de importação, você deseja importar as bibliotecas  <code>java.util</code> .</p>
</div>
</div>
<div class="sect2">
<h3 id="_criando_o_servlet_postmessage">Criando o Servlet PostMessage</h3>
<div class="paragraph">
<p>Neste exercício, você criará o servlet PostMessage que será utilizado para postar mensagens. Você usará anotações para injetar os recursos JMS que criou diretamente no servlet, especificando o nome da variável e o nome para o qual é mapeado. Em seguida, você adicionará o código para enviar a mensagem JMS e o código para o form HTML para adicionar uma mensagem.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse em um projeto de módulo web e selecione Novo &gt; Servlet.</p>
</li>
<li>
<p>Digite <strong>PostMessage</strong> para Nome da Classe.</p>
</li>
<li>
<p>Selecione <strong>web</strong> como o nome do Pacote. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clicar em Finalizar, a classe  <code>PostMessage.java</code>  será aberta no Editor de Código-Fonte.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>No Editor de Código-Fonte, utilize anotações para injetar os recursos  <code>ConnectionFactory</code>  e  <code>Queue</code> , adicionando as seguintes declarações de campo.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@WebServlet(name="PostMessage", urlPatterns={"/PostMessage"})
public class PostMessage extends HttpServlet {
   *@Resource(mappedName="jms/NewMessageFactory")
   private  ConnectionFactory connectionFactory;

   @Resource(mappedName="jms/NewMessage")
   private  Queue queue;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Corrija as importações para importar as bibliotecas * <code>javax.jms</code> *.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-searchdepend1.png" alt="maven searchdepend1">
</div>
<div class="title">Figure 10. Caixa de diálogo Corrigir Todas as Importações</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Se o IDE não oferecer  <code>javax.jms</code>  como uma opção, você poderá procurar nos repositórios pelo artefato correto clicando no ícone de sugestão na margem ao lado de  <code>private ConnectionFactory connectionFactory;</code>  e selecionando Pesquisar Dependência em Repositórios Maven.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-searchdependencies.png" alt="maven searchdependencies">
</div>
<div class="title">Figure 11. Dica no editor para procurar dependências nos repositórios</div>
</div>
<div class="paragraph">
<p>Você pode utilizar a caixa de diálogo Pesquisar nos Repositórios Maven para localizar o artefato  <code>javaee-api-6.0</code>  que contém  <code>ConnectionFactory</code> .</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-searchdepend2.png" alt="maven searchdepend2">
</div>
<div class="title">Figure 12. Caixa de diálogo Pesquisar nos Repositórios Maven</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione o código a seguir para enviar as mensagens JMS ao método  <code>processRequest</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">response.setContentType("text/html;charset=UTF-8");

*// Add the following code to send the JMS message
String title=request.getParameter("title");
String body=request.getParameter("body");
if ((title!=null) &amp;amp;&amp;amp; (body!=null)) {
    try {
        Connection connection = connectionFactory.createConnection();
        Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
        MessageProducer messageProducer = session.createProducer(queue);

        ObjectMessage message = session.createObjectMessage();
        // here we create NewsEntity, that will be sent in JMS message
        NewsEntity e = new NewsEntity();
        e.setTitle(title);
        e.setBody(body);

        message.setObject(e);
        messageProducer.send(message);
        messageProducer.close();
        connection.close();
        response.sendRedirect("ListNews");

    } catch (JMSException ex) {
        ex.printStackTrace();
    }
}*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione o código a seguir (em negrito) ao web form para adicionar uma mensagem.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">out.println("Servlet PostMessage at " + request.getContextPath() + "&lt;/h1&gt;");

*// The following code adds the form to the web page
out.println("&lt;form&gt;");
out.println("Title: &lt;input type='text' name='title'&gt;&lt;br/&gt;");
out.println("Message: &lt;textarea name='body'&gt;&lt;/textarea&gt;&lt;br/&gt;");
out.println("&lt;input type='submit'&gt;&lt;br/&gt;");
out.println("&lt;/form&gt;");
*
out.println("&lt;/body&gt;");</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Pode ser necessário cancelar o comentário do código, se estiver utilizando uma versão anterior do IDE.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Corrija as importações e salve as alterações.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-jms-imports.png" alt="maven jms imports">
</div>
<div class="title">Figure 13. Caixa de diálogo Corrigir Todas as Importações</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Você deseja importar as bibliotecas * <code>javax.jms</code> * para  <code>Connection</code> ,  <code>ConnectionFactory</code> ,  <code>Session</code>  e  <code>Queue</code> .
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_construindo_a_aplicação_com_maven">Construindo a Aplicação com Maven</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Agora que finalizou a codificação da aplicação, você poderá utilizar o Maven para construir a aplicação corporativa. Nesta seção, você construirá e encapsulará os projetos em um arquivo compactado EAR. O archive EAR conterá um archive EJB JAR e um arquivo compactado WAR. Depois de criar o arquivo compactado EAR, você pode implantá-lo no servidor de destino.</p>
</div>
<div class="sect2">
<h3 id="_trabalhando_com_dependências_do_projeto">Trabalhando com Dependências do Projeto</h3>
<div class="paragraph">
<p>Neste exercício, você examinará o POM  <code>pom.xml</code>  do projeto web e modificará o POM para impedir que sejam incluídos artefatos desnecessários no WAR durante o encapsulamento.  Cada projeto Maven contém um arquivo  <code>pom.xml</code>  que contém os detalhes sobre o conteúdo dos arquivos compactados. Todas as bibliotecas externas necessárias para o projeto estão listadas como dependências no POM. Você pode modificar o POM para especificar as dependências que precisam estar incluídas ou deveria ser excluídas durante o encapsula mento do arquivo compactado.</p>
</div>
<div class="paragraph">
<p>Nesta aplicação, os arquivos compactados EJB JAR e WAR serão encapsulados em um arquivo compactado EAR. Se olhar para o  <code>pom.xml</code>  do projeto MavenEnterpriseApp-ear, poderá notar que o EJB e o WAR estão declarados como dependências.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-earpom.png" alt="maven earpom">
</div>
<div class="title">Figure 14. pom.xml do projeto EAR</div>
</div>
<div class="paragraph">
<p>Se olhar o  <code>pom.xml</code>  do projeto web do editor, você poderá notar que o arquivo compactado EJB está declarado como uma dependência e o escopo está especificado como  <code>fornecido</code> . Quando o valor do elemento do escopo de um artefato é  <code>fornecido</code> , o artefato não será incluído durante o encapsulamento. O projeto web precisa do archive EJB como uma dependência, mas nesta aplicação você não deseja incluir o arquivo compactado EJB no WAR durante o encapsulamento porque o arquivo compactado EJB estará disponível e será fornecido como parte do arquivo compactado EAR.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-webpom.png" alt="maven webpom">
</div>
<div class="title">Figure 15. pom.xml do projeto Web App</div>
</div>
<div class="paragraph">
<p>Você pode abrir  <code>pom.xml</code>  no editor e clicar na guia Gráfico para ver uma representação visual das dependências do projeto. Se estiver usando uma versão mais antiga do IDE, você pode clicar com o botão direito do mouse no  <code>pom.xml </code>  no editor e escolher Mostrar Gráfico de Dependência. Você pode colocar o cursor sobre um artefato para exibir uma dica de ferramenta com os detalhes do artefato.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-webpomgraph.png" alt="maven webpomgraph">
</div>
<div class="title">Figure 16. Gráfico de dependências</div>
</div>
<div class="paragraph">
<p>Execute as etapas a seguir para modificar o POM do projeto web para adicionar um elemento  <code>escopo</code>  à dependência no artefato  <code>javaee-api</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Expanda o nó Arquivos do Projeto no projeto web.</p>
</li>
<li>
<p>Clique duas vezes em  <code>pom.xml</code>  para abrir o arquivo no editor.</p>
</li>
<li>
<p>Confirme se  <code>provided</code>  está definido como valor do  <code>&lt;escopo&gt;</code>  do artefato  <code>javaee-api</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Se o valor não for  <code>provided</code> , edite o POM para fazer as seguintes alterações:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;javax&lt;/groupId&gt;
    &lt;artifactId&gt;javaee-api&lt;/artifactId&gt;
    &lt;version&gt;7.0&lt;/version&gt;
    &lt;type&gt;jar&lt;/type&gt;
    *&lt;scope&gt;provided&lt;/scope&gt;*
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Você pode utilizar a funcionalidade autocompletar código no editor POM para ajudá-lo a editar o arquivo.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-addscope-javaee.png" alt="maven addscope javaee">
</div>
<div class="title">Figure 17. função autocompletar código para elemento de escopo no POM</div>
</div>
<div class="paragraph">
<p>Quando você declarar que a dependência é fornecida, o Maven não encapsulará o artefato ao construir o arquivo compactado WAR.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Salve as alterações.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_construindo_com_dependências">Construindo com Dependências</h3>
<div class="paragraph">
<p>O framework de construção Maven percorre uma sequência específica de fases, e cada fase compreende uma ou mais metas e pode ser configurada para utilizar vários plug-ins Maven. O item de menu Construir com Dependências é mapeado para a fase  <code>instalar</code>  do ciclo de vida de construção do Maven e é configurado para utilizar o plug-in Reactor. Quando você seleciona Construir com Dependências no menu pop-up, o Maven constrói a aplicação e as dependências necessárias e copia os artefatos de construção no repositório local.</p>
</div>
<div class="paragraph">
<p>É possível modificar como as fases e as metas do Maven são mapeados para as ações do menu no painel Ações da caixa de diálogo Propriedades do projeto.</p>
</div>
<div class="paragraph">
<p>Para construir o arquivo compactado EAR, execute as etapas a seguir.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Clique com o botão direito do mouse no nó do projeto MavenEnterpriseApp-ear e selecione Construir com Dependências.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Quando você constrói o projeto EAR utilizando o plug-in Reactor, os subprojetos que são dependências do projeto EAR são construídos antes da construção do projeto EAR. A janela de Saída exibe a ordem de construção.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-reactor1.png" alt="maven reactor1">
</div>
<div class="title">Figure 18. Janela de Saída que mostra a ordem de construção do Reator</div>
</div>
<div class="paragraph">
<p>Os resultados da construção também são exibidos na janela de Saída.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-reactor2.png" alt="maven reactor2">
</div>
<div class="title">Figure 19. Janela de Saída que mostra o status de construção do Reator</div>
</div>
<div class="paragraph">
<p>Após a construção do projeto EAR, você pode ver o arquivo compactado EAR final dentro do diretório  <code>target</code>  no nó do projeto EAR na janela Arquivos.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-earfileswindow1.png" alt="maven earfileswindow1">
</div>
<div class="title">Figure 20. Janela Arquivos que mostra o arquivo compactado EAR</div>
</div>
<div class="paragraph">
<p>Se o nome de artefato default  <code>com.mycompany</code>  tiver sido utilizado, você poderá utilizar o Browser do Repositório Maven para exibir os artefatos de construção expandindo  <code>com.mycompany</code>  no Repositório Local.</p>
</div>
<div class="paragraph">
<p>Para obter mais detalhes sobre a construção de projetos Maven, consulte <a href="http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html">Maven: Introdução ao Ciclo de vida de Construção</a> em <a href="http://maven.apache.org">maven.apache.org</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implantando_e_executando_a_aplicação">Implantando e Executando a Aplicação</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Esta seção descreve dois métodos para a implantação do arquivo compactado EAR no servidor. Você pode implantar a aplicação no GlassFish Server utilizando uma ação do menu no IDE ou a ferramenta Implantar na Console de Admin do GlassFish.</p>
</div>
<div class="sect2">
<h3 id="_implantando_e_executando_a_aplicação_a_partir_do_ide">Implantando e Executando a Aplicação a partir do IDE</h3>
<div class="paragraph">
<p>Neste exercício, você usará a ação Executar para implantar o arquivo compactado EAR no GlassFish Server. Após a implantação da aplicação, você abrirá a página ListNews da aplicação no browser e adicionará uma mensagem.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no nó do projeto EAR na janela Projetos e selecione Executar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clicar em Executar, o IDE implantará o arquivo compactado EAR e criará os recursos JMS no servidor. O IDE abrirá página default de índice do projeto (<a href="http://localhost:8080/MavenEnterpriseApp-web/">http://localhost:8080/MavenEnterpriseApp-web/</a>) no browser.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Abra o browser no URL a seguir para exibir a página ListNews.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a href="http://localhost:8080/MavenEnterpriseApp-web/ListNews">http://localhost:8080/MavenEnterpriseApp-web/ListNews</a>.</p>
</div>
<div class="paragraph">
<p>Quando você executa o projeto pela primeira vez, o banco de dados está vazio e não há mensagens a serem exibidas.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-browser1.png" alt="maven browser1">
</div>
<div class="title">Figure 21. A página ListNews será aberta no browser</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Adicionar nova mensagem.</p>
</li>
<li>
<p>Digite uma mensagem no form no servlet PostMessage. Clique em Submeter Consulta.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-browser2.png" alt="maven browser2">
</div>
<div class="title">Figure 22. A página PostMessage será aberta no browser</div>
</div>
<div class="paragraph">
<p>Quando você adiciona uma mensagem com o servlet PostMessage, a mensagem é enviada para o bean baseado em mensagens para gravação no armazenamento persistente e o servlet ListNews é chamado para exibir as mensagens no banco de dados. A lista de mensagens no banco de dados recuperada pela ListNews, em geral, ainda não contém a nova mensagem, porque o serviço de mensagem é assíncrono.</p>
</div>
<div class="paragraph">
<p>Compilar no Salvamento e Implantar no Salvamento são ativados por default nos projetos Maven que especificam o GlassFish Server como o servidor de destino. Por exemplo, se você modificar o salvamento de um servlet, poderá recarregá-lo no browser e exibir as alterações sem ter que realizar reimplantação da aplicação.</p>
</div>
</div>
<div class="sect2">
<h3 id="_implantando_da_console_admin_do_glassfish">Implantando da Console Admin do GlassFish</h3>
<div class="paragraph">
<p>Neste exercício, você implantará o arquivo compactado EAR utilizando a ferramenta Implantar na Console Admin do GlassFish.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Expanda o nó Servidores na janela Serviços.</p>
</li>
<li>
<p>Inicie o GlassFish Server.</p>
</li>
<li>
<p>Clique com o botão direito do mouse no nó GlassFish Server e selecione Exibir Console Admin para abrir a Console Admin do GlassFish no browser.</p>
</li>
<li>
<p>Clique no nó Aplicações no painel esquerdo da Console Admin.</p>
</li>
<li>
<p>Clique no botão Implantar no painel principal da Console Admin.</p>
</li>
<li>
<p>Clique em Procurar para localizar o arquivo compactado EAR da aplicação corporativa.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>O arquivo compactado EAR está localizado no diretório  <code>target</code>  dentro do diretório da aplicação corporativa no sistema local.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em OK.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clica em OK, a ferramenta de implantação do GlassFish implanta a aplicação.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Se você implantar a aplicação utilizando a ferramenta de implantação na Console Admin do GlassFish, também precisará criar manualmente os recursos necessários pela aplicação, se eles ainda não existirem.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fazendo_download_do_projeto_da_solução">Fazendo Download do Projeto da Solução</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Você pode fazer o download da solução para este projeto como um projeto das seguintes formas.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Faça download <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FMavenEnterpriseApp.zip">de um arquivo compactado zip do projeto finalizado</a>.</p>
</li>
<li>
<p>Faça o check-out do código-fonte do projeto das Amostras do NetBeans ao executar as etapas a seguir:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Escolha Equipe &gt; Subversion &gt; Efetuar check-out no menu principal.</p>
</li>
<li>
<p>Na caixa de diálogo Check-out, insira o URL de Repositório a seguir:
 <code><a href="https://svn.netbeans.org/svn/samples~samples-source-code" class="bare">https://svn.netbeans.org/svn/samples~samples-source-code</a></code>
Clique em Próximo.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Procurar para abrir a caixa de diálogo Procurar nas Pastas do Repositório:</p>
</li>
<li>
<p>Expanda o nó raiz e selecione <strong>samples/javaee/MavenEnterpriseApp</strong>. Clique em OK.</p>
</li>
<li>
<p>Especifique a Pasta Local para o códigos-fonte (a pasta local precisa estar vazia).</p>
</li>
<li>
<p>Clique em Finalizar.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, o IDE inicializa a pasta local como um repositório Subversion e verifica os códigos-fonte do projeto.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Abrir Projeto na caixa de diálogo exibida quando o check-out for concluído.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Para saber mais sobre a instalação do Subversion, consulte a seção <a href="../ide/subversion.html#settingUp">Configurando o Subversion</a> no <a href="../ide/subversion.html">Guia do Subversion no NetBeans IDE</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Creating%20an%20Enterprise%20Application%20Using%20Maven">Enviar Feedback neste Tutorial</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_consulte_também">Consulte Também</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para obter mais informações sobre o uso do NetBeans IDE para desenvolver aplicações Java EE, consulte os seguintes recursos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javaee-intro.html">Introdução à Tecnologia Java EE</a></p>
</li>
<li>
<p><a href="javaee-gettingstarted.html">Conceitos Básicos sobre Aplicações do Java EE</a></p>
</li>
<li>
<p><a href="maven-entapp-testing.html">Testando uma Aplicação Corporativa Maven</a></p>
</li>
<li>
<p><a href="../../trails/java-ee.html">Trilha de Aprendizado do Java EE e Java Web</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Para obter mais informações sobre o uso de Enterprise Beans, consulte o <a href="http://download.oracle.com/javaee/7/tutorial/doc/">Tutorial do Java EE 7</a>.</p>
</div>
<div class="paragraph">
<p>Para enviar comentários e sugestões, obter suporte e se manter informado sobre os mais recentes desenvolvimentos das funcionalidades de desenvolvimento do Java EE do NetBeans IDE, <a href="../../../community/lists/top.html">inscreva-se na lista de correspondência de nbj2ee</a>.</p>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/maven-entapp_pt_BR.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
