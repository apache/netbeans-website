
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>The NetBeans E-commerce Tutorial - Integrating Transactional Business Logic</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The NetBeans E-commerce Tutorial - Integrating Transactional Business Logic - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, The NetBeans E-commerce Tutorial - Integrating Transactional Business Logic">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>

  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 19</h1>
            <p><a class="button success" href="/download/nb19/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">The NetBeans E-commerce Tutorial - Integrating Transactional Business Logic</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/ecommerce/transaction.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_tutorial_contents">Tutorial Contents</a></li>
<li><a href="#overview">Overview of the Transaction</a></li>
<li><a href="#projSnapshot">Examining the Project Snapshot</a></li>
<li><a href="#orderManager">Creating the OrderManager EJB</a></li>
<li><a href="#requestParam">Handling Request Parameters</a></li>
<li><a href="#placeOrder">Implementing placeOrder and Helper Methods</a>
<ul class="sectlevel2">
<li><a href="#_addcustomer">addCustomer</a></li>
</ul>
</li>
<li><a href="#entityManager">Utilizing JPA&#8217;s EntityManager</a>
<ul class="sectlevel2">
<li><a href="#_addcustomer_2">addCustomer</a></li>
<li><a href="#_addorder_2">addOrder</a></li>
<li><a href="#_addordereditems_2">addOrderedItems</a></li>
</ul>
</li>
<li><a href="#persistenceContext">Synchronizing the Persistence Context with the Database</a></li>
<li><a href="#transaction">Setting up the Transaction Programmatically</a>
<ul class="sectlevel2">
<li><a href="#_netbeans_support_for_code_templates">NetBeans Support for Code Templates</a></li>
</ul>
</li>
<li><a href="#validate">Validating and Converting User Input</a>
<ul class="sectlevel2">
<li><a href="#client">Client-Side Validation</a></li>
<li><a href="#server">Server-Side Validation</a></li>
<li><a href="#data">Data Conversion</a></li>
</ul>
</li>
<li><a href="#seeAlso">See Also</a>
<ul class="sectlevel2">
<li><a href="#_netbeans_resources">NetBeans Resources</a></li>
<li><a href="#_external_resources">External Resources</a></li>
</ul>
</li>
<li><a href="#_references">References</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="_tutorial_contents">Tutorial Contents</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="intro.html">Introduction</a></p>
</li>
<li>
<p><a href="design.html">Designing the Application</a></p>
</li>
<li>
<p><a href="setup-dev-environ.html">Setting up the Development Environment</a></p>
</li>
<li>
<p><a href="data-model.html">Designing the Data Model</a></p>
</li>
<li>
<p><a href="page-views-controller.html">Preparing the Page Views and Controller Servlet</a></p>
</li>
<li>
<p><a href="connect-db.html">Connecting the Application to the Database</a></p>
</li>
<li>
<p><a href="entity-session.html">Adding Entity Classes and Session Beans</a></p>
</li>
<li>
<p><a href="manage-sessions.html">Managing Sessions</a></p>
</li>
<li>
<p><strong>Integrating Transactional Business Logic</strong></p>
<div class="ulist">
<ul>
<li>
<p><a href="#overview">Overview of the Transaction</a></p>
</li>
<li>
<p><a href="#projSnapshot">Examining the Project Snapshot</a></p>
</li>
<li>
<p><a href="#orderManager">Creating the <code>OrderManager</code> EJB</a></p>
</li>
<li>
<p><a href="#requestParam">Handling Request Parameters</a></p>
</li>
<li>
<p><a href="#placeOrder">Implementing <code>placeOrder</code> and Helper Methods</a></p>
</li>
<li>
<p><a href="#entityManager">Utilizing JPA&#8217;s EntityManager</a></p>
</li>
<li>
<p><a href="#persistenceContext">Synchronizing the Persistence Context with the Database</a></p>
</li>
<li>
<p><a href="#transaction">Setting up the Transaction Programmatically</a></p>
</li>
<li>
<p><a href="#validate">Validating and Converting User Input</a></p>
</li>
<li>
<p><a href="#seeAlso">See Also</a></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p><a href="language.html">Adding Language Support</a></p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p><a href="security.html">Securing the Application</a></p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="12">
<li>
<p><a href="test-profile.html">Testing and Profiling</a></p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="13">
<li>
<p><a href="conclusion.html">Conclusion</a></p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/netbeans-stamp-68-69.png" alt="netbeans stamp 68 69">
</div>
<div class="title">Figure 1. Content on this page applies to NetBeans IDE, versions 6.8 and 6.9</div>
</div>
<div class="paragraph">
<p>The purpose of this tutorial unit is to demonstrate how you can use the object-relational mapping (ORM) capabilities provided by EJB and JPA technologies to gather data from a web request and write to a back-end database. Of particular interest is EJB&#8217;s support for <em>container-managed</em> transactions (refer to the <a href="entity-session.html#gf-java-ee-container">GlassFish v3 Java EE Container diagram</a>). By applying several non-intrusive annotations, you can transform your EJB class into a transaction manager, thereby ensuring the integrity of the data contained in the database. In other words, the transaction manager handles multiple write actions to the database as a single unit of work. It ensures that the work-unit is performed either in its entirety or, if failure occurs at some point during the process, any changes made are rolled back to the database&#8217;s pre-transaction state.</p>
</div>
<div class="paragraph">
<p>Within the context of the <code>AffableBean</code> application, this tutorial unit focuses on processing a customer order when data from the checkout form is received. You create an <code>OrderManager</code> EJB to process the checkout form data along with the session <code>cart</code> object. The <code>OrderManager</code> performs a transaction that involves multiple write actions to the <code>affablebean</code> database. If any of the actions fails, the transaction is rolled back.</p>
</div>
<div class="paragraph">
<p>You can view a live demo of the application that you build in this tutorial: <a href="http://services.netbeans.org/AffableBean/">NetBeans E-commerce Tutorial Demo Application</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software or Resource</th>
<th class="tableblock halign-left valign-top">Version Required</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../../../download/index.html">NetBeans IDE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java bundle, 6.8 or 6.9</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java Development Kit (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version 6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#glassFish">GlassFish server</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v3 or Open Source Edition 3.0.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://dev.mysql.com/downloads/mysql/">MySQL database server</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version 5.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252FAffableBean_snapshot7.zip">AffableBean project</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">snapshot 7</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Notes:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The NetBeans IDE requires the Java Development Kit (JDK) to run properly. If you do not have any of the resources listed above, the JDK should be the first item that you download and install.</p>
</li>
<li>
<p>The NetBeans IDE Java Bundle includes Java Web and EE technologies, which are required for the application you build in this tutorial.</p>
</li>
<li>
<p>The NetBeans IDE Java Bundle also includes the GlassFish server, which you require for this tutorial. You could <a href="http://glassfish.dev.java.net/public/downloadsindex.html">download the GlassFish server independently</a>, but the version provided with the NetBeans download has the added benefit of being automatically registered with the IDE.</p>
</li>
<li>
<p>You can follow this tutorial unit without having completed previous units. To do so, see the <a href="setup.html">setup instructions</a>, which describe how to prepare the database and establish connectivity between the IDE, GlassFish, and MySQL.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview">Overview of the Transaction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to process the data from the checkout form as well as the items contained in the customer&#8217;s shopping cart, you create an <code>OrderManager</code> EJB. The <code>OrderManager</code> uses the provided data and performs the following write actions to the database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A new <code>Customer</code> record is added.</p>
</li>
<li>
<p>A new <code>CustomerOrder</code> record is added.</p>
</li>
<li>
<p>New <code>OrderedProduct</code> records are added, according to the items contained in the <code>ShoppingCart</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We&#8217;ll implement this by creating a <code>placeOrder</code> method which performs the three write actions by sequentially calling private helper methods, <code>addCustomer</code>, <code>addOrder</code>, and <code>addOrderedItems</code>. We&#8217;ll also implement the three helper methods in the class. To leverage EJB&#8217;s container-managed transaction service, we only require two annotations. These are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://java.sun.com/javaee/6/docs/api/javax/ejb/TransactionManagement.html">`@TransactionManagement`</a><code>(`<a href="http://java.sun.com/javaee/6/docs/api/javax/ejb/TransactionManagementType.html">+`TransactionManagementType</code>+</a>.<code><em>CONTAINER</em>)</code>: Used to specify that any transactions occurring in the class are container-managed.</p>
</li>
<li>
<p><a href="http://java.sun.com/javaee/6/docs/api/javax/ejb/TransactionAttribute.html">`@TransactionAttribute`</a><code>(`<a href="http://java.sun.com/javaee/6/docs/api/javax/ejb/TransactionAttributeType.html">+`TransactionAttributeType</code>+</a>.<code><em>REQUIRED</em>)</code>: Used on the method that invokes the transaction to specify that a new transaction should be created (if one does not already exist).</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/transaction-diagram.png" alt="transaction diagram">
</div>
<div class="title">Figure 2. Several write actions are performed within a single transaction</div>
</div>
<div class="paragraph">
<p>Because we are implementing the transaction within a larger context, we&#8217;ll approach this exercise by dividing it into several easily-digestible tasks.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#projSnapshot">Examining the Project Snapshot</a></p>
</li>
<li>
<p><a href="#orderManager">Creating the OrderManager EJB</a></p>
</li>
<li>
<p><a href="#requestParam">Handling Request Parameters</a></p>
</li>
<li>
<p><a href="#placeOrder">Implementing <code>placeOrder</code> and Helper Methods</a></p>
</li>
<li>
<p><a href="#entityManager">Utilizing JPA&#8217;s EntityManager</a></p>
</li>
<li>
<p><a href="#persistenceContext">Synchronizing the Persistence Context with the Database</a></p>
</li>
<li>
<p><a href="#transaction">Setting up the Transaction Programmatically</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="projSnapshot">Examining the Project Snapshot</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Begin by examining the project snapshot associated with this tutorial unit.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252FAffableBean_snapshot7.zip">project snapshot</a> for this tutorial unit in the IDE. Click the Open Project ( <span class="image"><img src="images/open-project-btn.png" alt="open project btn"></span> ) button and use the wizard to navigate to the location on your computer where you downloaded the project. If you are proceeding from the <a href="manage-sessions.html">previous tutorial unit</a>, note that this project snapshot is identical to the state of the project after completing the previous unit, but with the following exceptions:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>confirmation.jsp</code> page is fully implemented.</p>
</li>
<li>
<p>The <code>affablebean.css</code> stylesheet includes rules specific to the <code>confirmation.jsp</code> page implementation.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Run the project ( <span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span> ) to ensure that it is properly configured with your database and application server.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you receive an error when running the project, revisit the <a href="setup.html">setup instructions</a>, which describe how to prepare the database and establish connectivity between the IDE, GlassFish, and MySQL.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Test the application&#8217;s functionality in your browser. In particular, step through the entire <a href="design.html#business">business process flow</a>. When you click the submit an order from the checkout page, the confirmation page currently displays as follows:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/confirmation-page-start.png" alt="confirmation page start">
</div>
<div class="title">Figure 3. Confirmation page displays without any data relating to the processed order</div>
</div>
<div class="paragraph">
<p>No data related to the order is displayed on the confirmation page. In fact, in its current state the application doesn&#8217;t do anything with the data from the checkout form. By the end of this tutorial unit, the application will gather customer data and use it to process an order. In its final state, the application will display a summary of the processed order on the confirmation page, remove the user&#8217;s <code>ShoppingCart</code> and terminate the user session. (<a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252FAffableBean_snapshot8.zip">Snapshot 8</a> completes the request-response cycle when a checkout form is submitted.)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="orderManager">Creating the OrderManager EJB</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the New File ( <span class="image"><img src="images/new-file-btn.png" alt="new file btn"></span> ) button in the IDE&#8217;s toolbar. (Alternatively, press Ctrl-N; ⌘-N on Mac.) In the New File wizard, select the Java EE category, then select Session Bean.</p>
</li>
<li>
<p>Click Next. Name the EJB &#8216;OrderManager&#8217;, place the EJB in the <code>session</code> package, and accept other default settings. (Create a stateless session bean, and do not have the wizard generate an interface for the bean.)</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ejb-wizard.png" alt="ejb wizard">
</div>
<div class="title">Figure 4. Create a stateless EJB session bean using the Session Bean wizard</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click Finish. The new <code>OrderManager</code> class is generated and opens in the editor.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="requestParam">Handling Request Parameters</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the project&#8217;s <code>ControllerServlet</code>. (Either select it from the Projects window, or press Alt-Shift-O (Ctrl-Shift-O on Mac) and use the Go to File dialog.)</p>
</li>
<li>
<p>Locate the area in the <code>doPost</code> method where the <code>/purchase</code> request will be implemented (line 190).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Press Ctrl-G to use the Go To Line dialog.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/go-to-line.png" alt="go to line">
</div>
<div class="title">Figure 5. Use the Go to Line dialog to quickly navigate to a specific line</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Implement code that extracts the parameters from a submitted checkout form. Locate the <code>TODO: Implement purchase action</code> comment, delete it, and add the following:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">// if purchase action is called
} else if (userPath.equals("/purchase")) {

    *if (cart != null) {

        // extract user data from request
        String name = request.getParameter("name");
        String email = request.getParameter("email");
        String phone = request.getParameter("phone");
        String address = request.getParameter("address");
        String cityRegion = request.getParameter("cityRegion");
        String ccNumber = request.getParameter("creditcard");
    }*

    userPath = "/confirmation";
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="placeOrder">Implementing placeOrder and Helper Methods</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <code>ControllerServlet</code>, add a reference to the <code>OrderManager</code> EJB. Scroll to the top of the class and add a reference beneath the session facade EJBs that are already listed.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class ControllerServlet extends HttpServlet {

    private String userPath;
    private String surcharge;
    private ShoppingCart cart;

    @EJB
    private CategoryFacade categoryFacade;
    @EJB
    private ProductFacade productFacade;
    *@EJB
    private OrderManager orderManager;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Press Ctrl-Shift-I (⌘:-Shift-I on Mac) to allow the editor to add an import statement for <code>session.OrderManager</code>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Use the extracted parameters, as well as the session <code>cart</code> object, as arguments for the <code>OrderManager.placeOrder</code> method. Add the following code:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">// if purchase action is called
} else if (userPath.equals("/purchase")) {

    if (cart != null) {

        // extract user data from request
        String name = request.getParameter("name");
        String email = request.getParameter("email");
        String phone = request.getParameter("phone");
        String address = request.getParameter("address");
        String cityRegion = request.getParameter("cityRegion");
        String ccNumber = request.getParameter("creditcard");

        *int orderId = orderManager.placeOrder(name, email, phone, address, cityRegion, ccNumber, cart);*
    }

    userPath = "/confirmation";
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that we haven&#8217;t created the <code>placeOrder</code> method yet. This is why the editor flags an error. You can use the tip that displays in the left margin, which allows you to generate the method signature in the appropriate class.</p>
</div>
<div class="openblock feature">
<div class="content">
<div class="imageblock left">
<div class="content">
<a class="image" href="images/tool-tip-create-method.png"><img src="images/tool-tip-create-method.png" alt="tool tip create method"></a>
</div>
</div>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click the tip. The IDE generates the <code>placeOrder</code> method in the <code>OrderManager</code> class.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Stateless
public class OrderManager {

    *public int placeOrder(String name, String email, String phone, String address, String cityRegion, String ccNumber, ShoppingCart cart) {
        throw new UnsupportedOperationException("Not yet implemented");
    }*

    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The import statement for <code>cart.ShoppingCart</code> is also automatically inserted at the top of the file.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>In the new <code>placeOrder</code> method, use the method arguments to make calls to the (yet nonexistent) helper methods. Enter the following:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public int placeOrder(String name, String email, String phone, String address, String cityRegion, String ccNumber, ShoppingCart cart) {

    *Customer customer = addCustomer(name, email, phone, address, cityRegion, ccNumber);
    CustomerOrder order = addOrder(customer, cart);
    addOrderedItems(order, cart);*
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that we need to follow a particular order due to database constraints. For example, a <code>Customer</code> record needs to be created before the <code>CustomerOrder</code> record, since the <code>CustomerOrder</code> requires a reference to a <code>Customer</code>. Likewise, the <code>OrderedItem</code> records require a reference to an existing <code>CustomerOrder</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Press Ctrl-Shift-I (⌘:-Shift-I on Mac) to fix imports. Import statements for <code>entity.Customer</code> and <code>entity.CustomerOrder</code> are automatically added to the top of the file.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Use the editor hints to have the IDE generate method signatures for <code>addCustomer</code>, <code>addOrder</code>, and <code>addOrderedItems</code>. After utilizing the three hints, the <code>OrderManager</code> class looks as follows.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Stateless
public class OrderManager {

    public int placeOrder(String name, String email, String phone, String address, String cityRegion, String ccNumber, ShoppingCart cart) {

        Customer customer = addCustomer(name, email, phone, address, cityRegion, ccNumber);
        CustomerOrder order = addOrder(customer, cart);
        addOrderedItems(order, cart);
    }

    *private Customer addCustomer(String name, String email, String phone, String address, String cityRegion, String ccNumber) {
        throw new UnsupportedOperationException("Not yet implemented");
    }

    private CustomerOrder addOrder(Customer customer, ShoppingCart cart) {
        throw new UnsupportedOperationException("Not yet implemented");
    }

    private void addOrderedItems(CustomerOrder order, ShoppingCart cart) {
        throw new UnsupportedOperationException("Not yet implemented");
    }*

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that an error is still flagged in the editor, due to the fact that the method is currently lacking a return statement. The <code>placeOrder</code> signature indicates that the method returns an <code>int</code>. As will later be demonstrated, the method returns the order ID if it has been successfully processed, otherwise <code>0</code> is returned.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Enter the following return statement.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public int placeOrder(String name, String email, String phone, String address, String cityRegion, String ccNumber, ShoppingCart cart) {

    Customer customer = addCustomer(name, email, phone, address, cityRegion, ccNumber);
    CustomerOrder order = addOrder(customer, cart);
    addOrderedItems(order, cart);
    *return order.getId();*
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this stage, all errors in the <code>OrderManager</code> class are resolved.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Begin implementing the three helper methods. For now, simply add code that applies each method&#8217;s input parameters to create new entity objects.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_addcustomer">addCustomer</h3>
<div class="paragraph">
<p>Create a new <code>Customer</code> object and return the object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private Customer addCustomer(String name, String email, String phone, String address, String cityRegion, String ccNumber) {

    *Customer customer = new Customer();
    customer.setName(name);
    customer.setEmail(email);
    customer.setPhone(phone);
    customer.setAddress(address);
    customer.setCityRegion(cityRegion);
    customer.setCcNumber(ccNumber);

    return customer;*
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_addorder">addOrder</h4>
<div class="paragraph">
<p>Create a new <code>CustomerOrder</code> object and return the object. Use the <code>java.util.Random</code> class to generate a random confirmation number.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private CustomerOrder addOrder(Customer customer, ShoppingCart cart) {

    *// set up customer order
    CustomerOrder order = new CustomerOrder();
    order.setCustomer(customer);
    order.setAmount(BigDecimal.valueOf(cart.getTotal()));

    // create confirmation number
    Random random = new Random();
    int i = random.nextInt(999999999);
    order.setConfirmationNumber(i);

    return order;*
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_addordereditems">addOrderedItems</h4>
<div class="paragraph">
<p>Iterate through the <code>ShoppingCart</code> and create <code>OrderedProduct`s. In order to create an `OrderedProduct</code>, you can use the <code>OrderedProductPK</code> entity class. The instantiated <code>OrderedProductPK</code> can be passed to the <code>OrderedProduct</code> constructor, as demonstrated below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private void addOrderedItems(CustomerOrder order, ShoppingCart cart) {

    *List&lt;ShoppingCartItem&gt; items = cart.getItems();

    // iterate through shopping cart and create OrderedProducts
    for (ShoppingCartItem scItem : items) {

        int productId = scItem.getProduct().getId();

        // set up primary key object
        OrderedProductPK orderedProductPK = new OrderedProductPK();
        orderedProductPK.setCustomerOrderId(order.getId());
        orderedProductPK.setProductId(productId);

        // create ordered item using PK object
        OrderedProduct orderedItem = new OrderedProduct(orderedProductPK);

        // set quantity
        orderedItem.setQuantity(scItem.getQuantity());
    }*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>Press Ctrl-Shift-I (⌘-Shift-I on Mac) to fix imports. A dialog opens to display all classes that will be imported. Note that the dialog correctly guesses for <code>java.util.List</code>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/fix-all-imports.png" alt="fix all imports">
</div>
<div class="title">Figure 6. Press Ctrl-Shift-I to fix imports in a file</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p>Click OK. All necessary import statements are added, and the class becomes free of any compiler errors.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="entityManager">Utilizing JPA&#8217;s EntityManager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As was mentioned in <a href="entity-session.html">Adding Entity Classes and Session Beans</a>, the <code>EntityManager</code> API is included in JPA, and is responsible for performing persistence operations on the database. In the <code>AffableBean</code> project, all of the EJBs employ the <code>EntityManager</code>. To demonstrate, open any of the session facade beans in the editor and note that the class uses the <code>@PersistenceContext</code> annotation to express a dependency on a container-managed <code>EntityManager</code> and its associated persistence context (<code>AffableBeanPU</code>, as specified in the <code>persistence.xml</code> file). For example, the <code>ProductFacade</code> bean looks as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Stateless
public class ProductFacade extends AbstractFacade&lt;Product&gt; {
    *@PersistenceContext(unitName = "AffableBeanPU")
    private EntityManager em;*

    protected EntityManager getEntityManager() {
        return em;
    }

    ...

    // manually created
    public List&lt;Product&gt; findForCategory(Category category) {
        return em.createQuery("SELECT p FROM Product p WHERE p.category = :category").
               setParameter("category", category).getResultList();
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To be able to write to the database, the <code>OrderManager</code> EJB must take similar measures. With an <code>EntityManager</code> instance, we can then modify the helper methods (<code>addCustomer</code>, <code>addOrder</code>, <code>addOrderedItems</code>) so that the entity objects they create are written to the database.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In <code>OrderManager</code>, apply the <code>@PersistenceContext</code> annotation to express a dependency on a container-managed <code>EntityManager</code> and the <code>AffableBeanPU</code> persistence context. Also declare an <code>EntityManager</code> instance.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Stateless
public class OrderManager {

    *@PersistenceContext(unitName = "AffableBeanPU")
    private EntityManager em;*

    ...
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Press Ctrl-Shift-I (⌘:-Shift-I on Mac) to fix imports. Import statements for <code>javax.persistence.EntityManager</code> and <code>javax.persistence.PersistenceContext</code> are added to the top of the class.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Use the <code>EntityManager</code> to mark entity objects to be written to the database. This is accomplished using the <code>persist</code> method in the <code>EntityManager</code> API. Make the following modifications to the helper methods.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_addcustomer_2">addCustomer</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private Customer addCustomer(String name, String email, String phone, String address, String cityRegion, String ccNumber) {

    Customer customer = new Customer();
    customer.setName(name);
    customer.setEmail(email);
    customer.setPhone(phone);
    customer.setAddress(address);
    customer.setCityRegion(cityRegion);
    customer.setCcNumber(ccNumber);

    *em.persist(customer);*
    return customer;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_addorder_2">addOrder</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private CustomerOrder addOrder(Customer customer, ShoppingCart cart) {

    // set up customer order
    CustomerOrder order = new CustomerOrder();
    order.setCustomer(customer);
    order.setAmount(BigDecimal.valueOf(cart.getTotal()));

    // create confirmation number
    Random random = new Random();
    int i = random.nextInt(999999999);
    order.setConfirmationNumber(i);

    *em.persist(order);*
    return order;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_addordereditems_2">addOrderedItems</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private void addOrderedItems(CustomerOrder order, ShoppingCart cart) {

    List&lt;ShoppingCartItem&gt; items = cart.getItems();

    // iterate through shopping cart and create OrderedProducts
    for (ShoppingCartItem scItem : items) {

        int productId = scItem.getProduct().getId();

        // set up primary key object
        OrderedProductPK orderedProductPK = new OrderedProductPK();
        orderedProductPK.setCustomerOrderId(order.getId());
        orderedProductPK.setProductId(productId);

        // create ordered item using PK object
        OrderedProduct orderedItem = new OrderedProduct(orderedProductPK);

        // set quantity
        orderedItem.setQuantity(String.valueOf(scItem.getQuantity()));

        *em.persist(orderedItem);*
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>EntityManager&#8217;s `persist</code> method does not immediately write the targeted object to the database. To describe this more accurately, the <code>persist</code> method places the object in the <em>persistence context</em>. This means that the <code>EntityManager</code> takes on the responsibility of ensuring that the entity object is synchronized with the database. Think of the persistence context as an intermediate state used by the <code>EntityManager</code> to pass entities between the object realm and the relational realm (hence the term 'object-relational mapping').</p>
</div>
<div class="paragraph">
<p>What is the scope of the persistence context? If you open the IDE&#8217;s Javadoc Index Search (Shift-F1; Shift-fn-F1 on Mac) and examine the Javadoc documentation for the <a href="http://java.sun.com/javaee/6/docs/api/javax/persistence/PersistenceContext.html">`@PersistenceContext`</a> annotation, you&#8217;ll note that the <code>type</code> element is used to "specif[y] whether a transaction-scoped persistence context or an extended persistence context is to be used." A <em>transaction-scoped</em> persistence context is created at the start of a transaction, and terminated when the transaction ends. An <em>extended</em> persistence context applies to stateful session beans only, and spans multiple transactions. The Javadoc documentation also informs us that <code>javax.persistence.PersistenceContextType.TRANSACTION</code> is the default value for the <code>type</code> element. Therefore, although we didn&#8217;t specify that the <code>EntityManager</code> place objects in a transaction-scoped persistence context, this is in fact how a container-managed <code>EntityManager</code> behaves by default.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="persistenceContext">Synchronizing the Persistence Context with the Database</h2>
<div class="sectionbody">
<div class="paragraph">
<p>At this stage you might assume that, transaction or no transaction, the <code>OrderManager</code> is now able to successfully write entity objects to the database. Run the project and see how customer orders are currently being processed.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Press F6 (fn-F6 on Mac) to run the project.</p>
</li>
<li>
<p>Step through the <a href="design.html#business">business process flow</a>. When you arrive at the checkout page, be sure to enter data that you know will not cause SQL errors to occur when the write actions are performed. (Validation is discussed in a later tutorial unit.) For example, enter the following into the checkout form:</p>
<div class="ulist">
<ul>
<li>
<p><strong>name:</strong> <code>Hugo Reyes</code></p>
</li>
<li>
<p><strong>email:</strong> <code>hurley@mrcluck.com</code></p>
</li>
<li>
<p><strong>phone:</strong> <code>606252924</code></p>
</li>
<li>
<p><strong>address:</strong> <code>Karlova 33</code></p>
</li>
<li>
<p><strong>prague:</strong> <code>1</code></p>
</li>
<li>
<p><strong>credit card number:</strong> <code>1111222233334444</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the coming steps, you are going to examine the server log in the IDE&#8217;s Output window. Before submitting the checkout form, open the Output window and clear the server log. You can accomplish this by right-clicking in the server log and choosing Clear (Ctrl-L; ⌘-L on Mac).</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click the 'submit purchase' button. The server responds with an HTTP status 500 message.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gf-error-report.png" alt="gf error report">
</div>
<div class="title">Figure 7. Server responds with an HTTP status 500 message</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Switch to the IDE and examine the server log. The server log is located in the Output window (Ctrl-4; ⌘-4 on Mac) under the GlassFish server tab. You come across the following text.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">WARNING: A system exception occurred during an invocation on EJB OrderManager method
public int session.OrderManager.placeOrder(java.lang.String,java.lang.String,java.lang.String,java.lang.String,java.lang.String,java.lang.String,cart.ShoppingCart)
javax.ejb.EJBException
...
Caused by: java.lang.NullPointerException
        [.underline]#at session.OrderManager.addOrderedItems(OrderManager.java:75)#
        [.underline]#at session.OrderManager.placeOrder(OrderManager.java:33)#</code></pre>
</div>
</div>
<div class="paragraph">
<p>Maximize the Output window by pressing Shift-Esc.</p>
</div>
<div class="paragraph">
<p>The underlines displayed in the server log form links allowing you to navigate directly to the lines in your source files where errors are occurring.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Click the link to <code>session.OrderManager.addOrderedItems</code>. The editor displays the line that is causing the exception.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/null-pointer-exception.png" alt="null pointer exception">
</div>
<div class="title">Figure 8. Click links in server output window to navigate directly to offending lines in source files</div>
</div>
<div class="paragraph">
<p>To understand why <code>order.getId</code> method returns <code>null</code>, consider what the code is actually trying to accomplish. The <code>getId</code> method attempts to get the ID of an order which is currently in the process of being created. Since the ID is an auto-incrementing primary key, the database automatically generates the value only when the record is added. One way to overcome this is to manually synchronize the persistence context with the database. This can be accomplished using the `EntityManager&#8217;s <a href="http://java.sun.com/javaee/6/docs/api/javax/persistence/EntityManager.html#flush%28%29">`flush`</a> method.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>In the <code>addOrderedItems</code> method, add a call to flush the persistence context to the database.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private void addOrderedItems(CustomerOrder order, ShoppingCart cart) {

    *em.flush();*

    List&lt;ShoppingCartItem&gt; items = cart.getItems();

    // iterate through shopping cart and create OrderedProducts
    for (ShoppingCartItem scItem : items) {

        int productId = scItem.getProduct().getId();

        // set up primary key object
        OrderedProductPK orderedProductPK = new OrderedProductPK();
        orderedProductPK.setCustomerOrderId(order.getId());
        orderedProductPK.setProductId(productId);

        // create ordered item using PK object
        OrderedProduct orderedItem = new OrderedProduct(orderedProductPK);

        // set quantity
        orderedItem.setQuantity(String.valueOf(scItem.getQuantity()));

        em.persist(orderedItem);
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Rerun the project and step through the business process flow. This time, when you submit the checkout form the confirmation page displays.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>To confirm that the details have been recorded in the database, open the IDE&#8217;s Services window (Ctrl-5; ⌘-5 on Mac). Locate the <code>affablebean</code> connection node. If the node appears broken ( <span class="image"><img src="images/connection-broken.png" alt="connection broken"></span> ), right-click the node and choose Connect.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Drill into the connection and locate the <code>affablebean</code> database&#8217;s <code>customer</code> table. Right-click the table and choose View Data. A graphical display of the <code>customer</code> table appears in the editor. The customer details that you added in the checkout form display as a record in the table.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/customer-record.png" alt="customer record">
</div>
<div class="title">Figure 9. View Data menu option performs a 'select *' query on the selected table</div>
</div>
<div class="paragraph">
<p>In this manner, you can also examine the <code>customer_order</code> and <code>ordered_product</code> tables to determine whether data has been recorded.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="transaction">Setting up the Transaction Programmatically</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A transaction&#8217;s primary function is to ensure that all operations are performed successfully, and if not, then none of the individual operations are performed.<sup><a href="#footnote1">[1]</a></sup> The following steps demonstrate how to ensure that the write operations performed in the <code>placeOrder</code> method are treated as a single transaction.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Refer to the <a href="#transactionDiagram">transaction diagram</a> above. Add the two transaction-related annotations to the <code>OrderManager</code> EJB.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Stateless
*@TransactionManagement(TransactionManagementType.CONTAINER)*
public class OrderManager {

    @PersistenceContext(unitName = "AffableBeanPU")
    private EntityManager em;

    *@TransactionAttribute(TransactionAttributeType.REQUIRED)*
    public int placeOrder(String name, String email, String phone, String address, String cityRegion, String ccNumber, ShoppingCart cart) {

        try {
            ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@TransactionManagement</code> annotation is used to specify that any transactions occurring in the <code>OrderManager</code> EJB are container-managed. The <code>@TransactionAttribute</code> annotation placed on the <code>placeOrder</code> method specifies that any operations occurring in the method must be treated as part of a transaction.</p>
</div>
<div class="paragraph">
<p>According to the <a href="http://jcp.org/aboutJava/communityprocess/final/jsr318/index.html">EJB Specification</a>, container-managed transactions are enabled by default for session beans. Furthermore, if you examine the Javadoc for both of the above annotations, you will rightly point out that <code>CONTAINER</code> is the default <code>TransactionManagementType</code>, and <code>REQUIRED</code> is the default <code>TransactionAttributeType</code>. In other words, neither of the two annotations is required for your code to run properly. However, it is often helpful to explicitly include default settings in your sources to improve readability.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Currently, the <code>placeOrder</code> method returns the ID of the processed order. In the event that the transaction fails and the order isn&#8217;t processed, have the method return &#8216;0&#8217;. Use a <code>try-catch</code> expression.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@TransactionAttribute(TransactionAttributeType.REQUIRED)
public int placeOrder(String name, String email, String phone, String address, String cityRegion, String ccNumber, ShoppingCart cart) {

    *try {*
        Customer customer = addCustomer(name, email, phone, address, cityRegion, ccNumber);
        CustomerOrder order = addOrder(customer, cart);
        addOrderedItems(order, cart);
        return order.getId();
    *} catch (Exception e) {
        return 0;
    }*</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_netbeans_support_for_code_templates">NetBeans Support for Code Templates</h3>
<div class="paragraph">
<p>When you work in the editor, take advantage of the IDE&#8217;s support for code templates. Becoming proficient in using code templates ultimately enables you to work more efficiently and reliably.</p>
</div>
<div class="paragraph">
<p>For example, in the above step you can apply the <code>trycatch</code> template by typing in &#8216;trycatch&#8217; then pressing Tab. The template is added to your file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@TransactionAttribute(TransactionAttributeType.REQUIRED)
public int placeOrder(String name, String email, String phone, String address, String cityRegion, String ccNumber, ShoppingCart cart) {

    *try {

    } catch (Exception e) {
    }*
    Customer customer = addCustomer(name, email, phone, address, cityRegion, ccNumber);
    CustomerOrder order = addOrder(customer, cart);
    addOrderedItems(order, cart);
    return order.getId();</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can then move the four existing lines into the <code>try</code> clause by highlighting the lines, then holding Alt-Shift (Ctrl-Shift on Mac) and pressing the up arrow key. When you are finished, press F while holding Alt-Shift (Ctrl-Shift on Mac) to format the code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@TransactionAttribute(TransactionAttributeType.REQUIRED)
public int placeOrder(String name, String email, String phone, String address, String cityRegion, String ccNumber, ShoppingCart cart) {

    try {
        *Customer customer = addCustomer(name, email, phone, address, cityRegion, ccNumber);
        CustomerOrder order = addOrder(customer, cart);
        addOrderedItems(order, cart);
        return order.getId();*
    } catch (Exception e) {
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to view and edit existing code templates, and add new templates in the IDE. Choose Tools &gt; Options (NetBeans &gt; Preferences on Mac) to open the Options window. Select Editor &gt; Code Templates.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/code-templates.png" alt="code templates">
</div>
<div class="title">Figure 10. View default code templates and define new templates in the Options window</div>
</div>
<div class="paragraph">
<p>If you&#8217;d like to see more templates, consult the Keyboard Shortcuts Card. The Keyboard Shortcuts Card provides a list of commonly-used code templates and keyboard shortcuts. Choose Help &gt; Keyboard Shortcuts Card from the main menu.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Add the following code. Explanation follows.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@PersistenceContext(unitName = "AffableBeanPU")
private EntityManager em;
*@Resource
private SessionContext context;*

@TransactionAttribute(TransactionAttributeType.REQUIRED)
public int placeOrder(String name, String email, String phone, String address, String cityRegion, String ccNumber, ShoppingCart cart) {

    try {
        Customer customer = addCustomer(name, email, phone, address, cityRegion, ccNumber);
        CustomerOrder order = addOrder(customer, cart);
        addOrderedItems(order, cart);
        return order.getId();
    } catch (Exception e) {
        *context.setRollbackOnly();*
        return 0;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Unfortunately, placing the three methods in the <code>try</code> clause means that if one of them fails during runtime, the engine immediately jumps to the <code>catch</code> clause, thus skipping any rollback operations that would normally follow.</p>
</div>
<div class="paragraph">
<p>You can test this by commenting out the <code>em.flush()</code> line you previously added. This way, you know that the first two methods (<code>addCustomer</code> and <code>addOrder</code>) process successfully, but the third method (<code>addOrderedItems</code>) fails. Run the project and submit the checkout form in the browser. Since the transaction doesn&#8217;t roll back, the customer and order records are written to the database, but any ordered items are not. This leads to a situation where the database is corrupt.</p>
</div>
<div class="paragraph">
<p>To overcome this, you explicitly set the transaction for rollback in the <code>catch</code> clause. The above <code>@Resource</code> annotation is applied to grab an instance of the EJB&#8217;s current <code>SessionContext</code>. The transaction is marked for rollback using the <code>setRollbackOnly</code> method.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Run the project and step through the business process flow. When you submit an order, return to the IDE and examine the server log. You&#8217;ll see output similar to the following:</p>
</li>
</ol>
</div>
<div class="openblock">
<div class="content">
<div class="imageblock left">
<div class="content">
<a class="image" href="images/transaction-output.png"><img src="images/transaction-output.png" alt="transaction output"></a>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Press Shift-Esc on the Output window to maximize it.</p>
</div>
<div class="paragraph">
<p>As shown in the above image, the green text indicates output from EclipseLink. Recall how in <a href="entity-session.html">Adding Entity Classes and Session Beans</a> you set EclipseLink&#8217;s logging level to <code>FINEST</code> in the persistence unit. Being able to examine this output is key to understanding how the persistence provider interacts with the database and is a great help when you need to debug your project.</p>
</div>
<div class="paragraph">
<p>You&#8217;ve now successfully integrated the transaction into the <code>AffableBean</code> project. You can <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252FAffableBean_snapshot8.zip">download snapshot 8</a> to examine code that completes the request-response cycle when a checkout form is submitted. The snapshot implements a <code>getOrderDetails</code> method in the <code>OrderManager</code>, which gathers all details pertaining to the placed order. If the transaction succeeds, the <code>ControllerServlet</code> places order details in the request scope, destroys the user&#8217;s <code>cart</code> object, terminates the session, and forwards the request to the confirmation view. If the transaction fails, the <code>ControllerServlet</code> flags an error and forwards the response to the checkout view, enabling the user to attempt a resubmit.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/checkout-page.png" alt="checkout page">
</div>
<div class="title">Figure 11. Upon transaction failure, the checkout page redisplays with error message</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="validate">Validating and Converting User Input</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Also included in <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252FAffableBean_snapshot8.zip">snapshot 8</a> are implementations for client and server-side validation for the checkout form. Form validation is the process of checking that a form has been filled in correctly before it is processed. This not only aids users by providing meaningful feedback for fields with invalid entries, but it also serves to thwart any malicious attempts to submit content that could adversely affect processing or storage.</p>
</div>
<div class="paragraph">
<p>There are two primary methods for validating forms: server-side (in our case, using Java), and client-side (using JavaScript). Both methods are usually essential for providing a pleasant user experience, as well as robust security for your application. Client-side validation is useful for offering immediate feedback to the user without the need to initiate a round-trip between the browser and server. As such, it can stem network traffic and decrease the server load. Modern forms of client-side validation are often implemented to provide immediate, "as-you-type", field-specific feedback to the user. Client-side JavaScript is run on the browser, and browsers generally allow JavaScript to be disabled. For this reason alone, your application cannot rely on client-side validation as the sole means of guarding against malformed or nefarious input. Server-side validation checks should therefore be performed when form data reaches the server. Data is extracted from the request and checked prior to being processed and/or stored. If a validation error is detected, the server responds by returning the form to the user with an appropriate message. If all data passes validation, data is converted to a different format if required.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#client">Client-Side Validation</a></p>
</li>
<li>
<p><a href="#server">Server-Side Validation</a></p>
</li>
<li>
<p><a href="#data">Data Conversion</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="client">Client-Side Validation</h3>
<div class="paragraph">
<p>For the <code>AffableBean</code> application, client-side validation is provided by a popular <a href="http://plugins.jquery.com/project/validate">jQuery plugin</a>. jQuery is a cross-browser JavaScript library designed to simplify client-side scripting of HTML.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/client-side-validation.png" alt="client side validation">
</div>
<div class="title">Figure 12. Field validation messages appear upon clicking 'submit purchase'</div>
</div>
<div class="paragraph">
<p><a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252FAffableBean_snapshot8.zip">Snapshot 8</a> includes a <code>js</code> folder that contains the jQuery core library (<code>jquery-1.4.2.js</code>) as well as the script for the validation plugin (<code>jquery.validate.js</code>). The core library is referenced in the application <code>header.jspf</code> file, while the validation plugin script is referenced directly in <code>checkout.jsp</code> since it is only required by that file. Within <code>checkout.jsp</code>, the plugin is customized to suit the checkout form based on <a href="http://docs.jquery.com/Plugins/Validation/validate#toptions">available documentation</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;script type="text/javascript"&gt;

    $(document).ready(function(){
        $("#checkoutForm").validate({
            rules: {
                name: "required",
                email: {
                    required: true,
                    email: true
                },
                phone: {
                    required: true,
                    number: true,
                    minlength: 9
                },
                address: {
                    required: true
                },
                creditcard: {
                    required: true,
                    creditcard: true
                }
            }
        });
    });
&lt;/script&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The IDE provides support for jQuery by enabling you to invoke code completion and documentation in the editor when pressing Ctrl-Space.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jquery-editor-support.png" alt="jquery editor support">
</div>
<div class="title">Figure 13. Press Ctrl-Space on JavaScript code to invoke jQuery documentation</div>
</div>
<div class="paragraph">
<p>When you code in JavaScript, the IDE lets you specify which browsers your application is targeting. Open the Options window (Choose Tools &gt; Options; NetBeans &gt; Preferences on Mac), select Miscellaneous, then select the JavaScript tab.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/javascript-window.png" alt="javascript window">
</div>
<div class="title">Figure 14. Specify targetted browsers for your application in the Options window</div>
</div>
<div class="paragraph">
<p>If the function you are calling documentation on does not support all of your targeted browsers, the documentation popup flags a warning. For example in the image below, Internet Explorer version 5.5 has been included in the application&#8217;s targeted browsers.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ie-55.png" alt="ie 55">
</div>
<div class="title">Figure 15. Documentation popup warns of method calls to non-compatible browser versions</div>
</div>
</div>
<div class="sect2">
<h3 id="server">Server-Side Validation</h3>
<div class="paragraph">
<p>The purpose of server-side validation is to ensure that each piece of data is in a format that is ready for further processing or is acceptable for storage. By "format", we mean both the data type as well as the size of the piece of data. The generated JPA entity classes are guaranteed to map their properties to the appropriate data types of the corresponding database table columns. When relying on these entity classes, we need to not only make sure that user data can be applied to create (or update) entity classes, but that the size of the data is appropriate for the data types of the database columns.</p>
</div>
<div class="paragraph">
<p>To illustrate an example, consider the checkout form&#8217;s credit card number field. Client-side validation checks that the entered data does not include letters.<sup><a href="#footnote2">[2]</a></sup> Because the <code>maxlength</code> attribute in the HTML markup is set to <code>19</code>, users cannot enter more than 19 characters into this field. Server-side validation also places a limit at 19 characters. Keep in mind that the data type of the <code>cc_number</code> column in the database&#8217;s <code>customer</code> table is: <code>VARCHAR(19)</code> (Refer to step 3 of <a href="data-model.html#addProperties">Designing the Data Model: Adding Entity Properties</a>.) Now, consider what would happen if the data type of the <code>cc_number</code> column is set to <code>VARCHAR(16)</code>, and a user enters a number that is 19 characters long. When the checkout form is submitted, the <code>creditcard</code> parameter is extracted from the request and converted into a <code>String</code> so that it becomes the <code>ccNumber</code> property in a newly created <code>Customer</code> object. Because 16 is the maximum number of characters the database column will hold, the database server will either truncate the number to 16 characters or produce a <code>MysqlDataTruncation</code> error, depending on the SQL mode set for the server. (For more information on the <code>VARCHAR</code> data type, see <a href="http://dev.mysql.com/doc/refman/5.1/en/char.html">10.4.1. The CHAR and VARCHAR Types</a>.) In this manner, by not having client and server-side validation properly handle the size (i.e., length) of the data received for a credit card number, we risk a failed attempt at placing an order, or perhaps even worse, a truncated credit card number, which obviously won&#8217;t allow payment.</p>
</div>
<div class="paragraph">
<p>Server-side validation in the <code>AffableBean</code> project is implemented by means of a <code>Validator</code> class. The <code>ControllerServlet</code> creates a <code>Validator</code> object and calls its <code>validateForm</code> method on the user data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">// validate user data
boolean validationErrorFlag = false;
validationErrorFlag = validator.validateForm(name, email, phone, address, cityRegion, ccNumber, request);

// if validation error found, return user to checkout
if (validationErrorFlag == true) {
    request.setAttribute("validationErrorFlag", validationErrorFlag);
    userPath = "/checkout";

    // otherwise, save order to database
} else {

    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a validation error is found (i.e., if <code>validateForm</code> returns <code>true</code>), a flag is raised in the form of a request-scoped attribute, and the server sends the checkout page back to the client. When the flag is detected in <code>checkout.jsp</code>, a new table row is created to display error messages at the top of the table.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;form id="checkoutForm" action="&lt;c:url value='purchase'/&gt;" method="post"&gt;
    &lt;table id="checkoutTable"&gt;
      &lt;c:if test="${!empty validationErrorFlag}"&gt;
        &lt;tr&gt;
            &lt;td colspan="2" style="text-align:left"&gt;
                &lt;span class="error smallText"&gt;Please provide valid entries for the following field(s):

                  &lt;c:if test="${!empty nameError}"&gt;
                    &lt;br&gt;&lt;span class="indent"&gt;&lt;strong&gt;name&lt;/strong&gt; (e.g., Bilbo Baggins)&lt;/span&gt;
                  &lt;/c:if&gt;
                  &lt;c:if test="${!empty emailError}"&gt;
                    &lt;br&gt;&lt;span class="indent"&gt;&lt;strong&gt;email&lt;/strong&gt; (e.g., b.baggins@hobbit.com)&lt;/span&gt;
                  &lt;/c:if&gt;
                  &lt;c:if test="${!empty phoneError}"&gt;
                    &lt;br&gt;&lt;span class="indent"&gt;&lt;strong&gt;phone&lt;/strong&gt; (e.g., 222333444)&lt;/span&gt;
                  &lt;/c:if&gt;
                  &lt;c:if test="${!empty addressError}"&gt;
                    &lt;br&gt;&lt;span class="indent"&gt;&lt;strong&gt;address&lt;/strong&gt; (e.g., Korunní 56)&lt;/span&gt;
                  &lt;/c:if&gt;
                  &lt;c:if test="${!empty cityRegionError}"&gt;
                    &lt;br&gt;&lt;span class="indent"&gt;&lt;strong&gt;city region&lt;/strong&gt; (e.g., 2)&lt;/span&gt;
                  &lt;/c:if&gt;
                  &lt;c:if test="${!empty ccNumberError}"&gt;
                    &lt;br&gt;&lt;span class="indent"&gt;&lt;strong&gt;credit card&lt;/strong&gt; (e.g., 1111222233334444)&lt;/span&gt;
                  &lt;/c:if&gt;

                &lt;/span&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/c:if&gt;

      ...
    &lt;/table&gt;
&lt;/form&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can test server-side validation by temporarily disabling JavaScript in your browser.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/server-side-validation.png" alt="server side validation">
</div>
<div class="title">Figure 16. Temporarily disable JavaScript in your browser to test server-side validation</div>
</div>
<div class="paragraph">
<p>The provided implementation of server-side validation here serves merely to demonstrate how server-side validation can be set up in your project. The actual validation logic contained in the <code>Validator</code> class does not perform anything beyond the most basic of checks and should certainly not be used in a production environment!</p>
</div>
</div>
<div class="sect2">
<h3 id="data">Data Conversion</h3>
<div class="paragraph">
<p>Sometimes, after data has passed validation, you may need to convert it into a different format. For example, this might apply to dates when users are allowed to enter them manually, or numbers that have been received as <code>String</code> objects but require calculation. This important step is referred to as server-side <em>data conversion</em>.</p>
</div>
<div class="paragraph">
<p>Although not implemented in the <code>AffableBean</code> application, consider again the checkout form&#8217;s credit card number field. Both client and server-side validation allows for different formats for numbers. For example, validation will accept the following number:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">1111222233334444</code></pre>
</div>
</div>
<div class="paragraph">
<p>Validation will also accept the same number in the following format.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">1111-2222-3333-4444</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because of the ambiguous nature in which this piece of user data is acquired, it might be necessary to remove any hyphens (&#8216;-&#8217;) or other non-numeric characters prior to processing payment. This step would likely occur before the data is placed in storage.</p>
</div>
<div class="paragraph">
<p><a href="../../../../community/mailing-lists.html">Send Feedback on This Tutorial</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="seeAlso">See Also</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_netbeans_resources">NetBeans Resources</h3>
<div class="ulist">
<ul>
<li>
<p><a href="../javaee-intro.html">Introduction to Java EE Technology</a></p>
</li>
<li>
<p><a href="../javaee-gettingstarted.html">Getting Started with Java EE Applications</a></p>
</li>
<li>
<p><a href="https://netbeans.org/projects/www/downloads/download/shortcuts.pdf">Keyboard Shortcuts &amp;amp; Code Templates Card</a></p>
</li>
<li>
<p><a href="../../java-ee.html">Java EE &amp;amp; Java Web Learning Trail</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_external_resources">External Resources</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://jcp.org/aboutJava/communityprocess/final/jsr318/index.html">JSR 318: EJB 3.1 Final Release</a> [Specification Download]</p>
</li>
<li>
<p><a href="http://download.oracle.com/docs/cd/E17410_01/javaee/6/tutorial/doc/bncih.html">Java EE 6 Tutorial: Transactions</a></p>
</li>
<li>
<p><a href="http://www.manning.com/panda/">EJB 3 in Action</a> [Book]</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Database_transaction">Database Transaction</a> [Wikipedia]</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Ejb">Enterprise JavaBean</a> [Wikipedia]</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/ACID">ACID</a> [Wikipedia]</p>
</li>
<li>
<p><a href="http://jquery.com/">jQuery</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Jquery">jQuery</a> [Wikipedia]</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references">References</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#1">^</a> This <em>all or nothing</em> concept can be further extrapolated into the four defining characteristics of transactions: <em>atomicity</em>, <em>consistency</em>, <em>isolation</em>, and <em>durability</em> (ACID). For more information, see: <a href="https://en.wikipedia.org/wiki/ACID">ACID</a> [Wikipedia].</p>
</li>
<li>
<p><a href="#2">^</a> Actually, for credit card number entries, validation typically ensures that the entered string conforms to the Luhn algorithm, which is a simple method of differentiating between valid numbers and a collection of random digits. This applies to the <a href="http://plugins.jquery.com/project/validate">jQuery validation plugin</a> as well. For more information, see <a href="https://en.wikipedia.org/wiki/Luhn_algorithm">Luhn algorithm</a> [Wikipedia].</p>
</li>
</ol>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/ecommerce/transaction.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
