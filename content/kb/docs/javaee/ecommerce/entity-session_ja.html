
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>NetBeans Eコマースのチュートリアル - エンティティ・クラスおよびセッションBeanの追加</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NetBeans Eコマースのチュートリアル - エンティティ・クラスおよびセッションBeanの追加 - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, NetBeans Eコマースのチュートリアル - エンティティ・クラスおよびセッションBeanの追加">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">NetBeans Eコマースのチュートリアル - エンティティ・クラスおよびセッションBeanの追加</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/ecommerce/entity-session_ja.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#whatEJB">EJBおよびJPAテクノロジとは</a>
<ul class="sectlevel2">
<li><a href="#ejb">エンタープライズJavaBeans</a></li>
<li><a href="#jpa">Java Persistence</a></li>
</ul>
</li>
<li><a href="#whatSession">セッションBeanとは</a></li>
<li><a href="#specification">仕様および実装について</a></li>
<li><a href="#addEntity">エンティティ・クラスの追加</a></li>
<li><a href="#addSession">セッションBeanの追加</a></li>
<li><a href="#access">EJBによるデータへのアクセス</a>
<ul class="sectlevel2">
<li><a href="#index">インデックス・ページ</a></li>
<li><a href="#category">カテゴリ・ページ</a></li>
</ul>
</li>
<li><a href="#seeAlso">関連項目</a>
<ul class="sectlevel2">
<li><a href="#_netbeansリソース">NetBeansリソース</a></li>
<li><a href="#_ejbリソース">EJBリソース</a></li>
<li><a href="#_jpaリソース">JPAリソース</a></li>
<li><a href="#_glassfishリソース">GlassFishリソース</a></li>
<li><a href="#_技術記事">技術記事</a></li>
<li><a href="#_書籍">書籍</a></li>
</ul>
</li>
<li><a href="#_参考資料">参考資料</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="intro.html">概要</a></p>
</li>
<li>
<p><a href="design.html">アプリケーションの設計</a></p>
</li>
<li>
<p><a href="setup-dev-environ.html">開発環境の設定</a></p>
</li>
<li>
<p><a href="data-model.html">データ・モデルの設計</a></p>
</li>
<li>
<p><a href="page-views-controller.html">ページ・ビューおよびコントローラ・サーブレットの準備</a></p>
</li>
<li>
<p><a href="connect-db.html">データベースへのアプリケーションの接続</a></p>
</li>
<li>
<p><strong>エンティティ・クラスおよびセッションBeanの追加</strong></p>
</li>
<li>
<p><a href="manage-sessions.html">セッションの管理</a></p>
</li>
<li>
<p><a href="transaction.html">トランザクション・ビジネス・ロジックの統合</a></p>
</li>
<li>
<p><a href="language.html">言語サポートの追加</a></p>
</li>
<li>
<p><a href="security.html">アプリケーションの保護</a></p>
</li>
<li>
<p><a href="test-profile.html">テストとプロファイリング</a></p>
</li>
<li>
<p><a href="conclusion.html">まとめ</a></p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../images_www/articles/68/netbeans-stamp-68-69.png" alt="netbeans stamp 68 69">
</div>
<div class="title">Figure 1. このページの内容は、NetBeans IDEバージョン6.8および6.9に適用されます</div>
</div>
<div class="paragraph">
<p>このチュートリアル・ユニットでは、EJB (<a href="http://java.sun.com/products/ejb/">Enterprise JavaBeans</a>)およびJPA (<a href="http://java.sun.com/javaee/technologies/persistence.jsp">Java Persistence</a>)テクノロジを紹介します。この中で、Java EE開発に不可欠な2つのIDEのウィザードを使用します。これらを次に示します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>データベースからのエンティティ・クラス・ウィザード:</strong> 選択したデータベースの表ごとに、名前付き問合せ注釈、各列を表すフィールド、および外部キーを表す関係を備えたJava Persistence APIエンティティ・クラスを作成します。</p>
</li>
<li>
<p><strong>エンティティ・クラスのセッションBean・ウィザード:</strong> エンティティ・クラスごとに、基本的なアクセス・メソッドを備えたEJBセッション・ファサードを作成します。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>これらの2つのウィザードは、アプリケーションのモデルをすばやく設定するための効率的な方法を提供します。ビルドしているアプリケーションの<a href="design.html#mvcDiagram">MVC図</a>をもう一度参照してください。MVCの構成内で、EJBセッションBeanおよびJPAエンティティ・クラスが対応する場所を確認できます。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mvc-diagram.png" alt="mvc diagram">
</div>
<div class="title">Figure 2. AffableBeanアプリケーションのMVC図</div>
</div>
<div class="paragraph">
<p>このユニットでは、エンティティ・クラスを作成して、Java上で`affablebean`データベースを表します。各エンティティ・クラスがデータベースの表を表す一方で、エンティティ・クラスのインスタンスは、データベースに保存(つまり_持続_)可能なレコードに対応します。アプリケーションのビジネス・ロジックはセッションBeanによってカプセル化され、(ここで示すように)エンティティへのCRUD (Create-Read-Update-Delete)アクセスを可能にする_ファサード_・クラスとして使用したり、アプリケーション固有のアクションを実装するコードを含めたりできます。(この例は、<a href="transaction.html">ユニット9: トランザクション・ビジネス・ロジックの統合</a>に記載)。</p>
</div>
<div class="paragraph">
<p>このチュートリアルでビルドするアプリケーションのライブ・デモを、<a href="http://dot.netbeans.org:8080/AffableBean/">NetBeans Eコマースのチュートリアルのデモ・アプリケーション</a>で表示できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ソフトウェアまたはリソース</th>
<th class="tableblock halign-left valign-top">必須バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">NetBeans IDE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Javaバンドル版、6.8または6.9</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java Development Kit (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">バージョン6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#glassFish">GlassFishサーバー</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v3またはOpen Source Edition 3.0.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://dev.mysql.com/downloads/mysql/">MySQLデータベース・サーバー</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">バージョン5.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252FAffableBean_snapshot3.zip">AffableBeanプロジェクト</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">スナップショット3</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>*注意: *</p>
</div>
<div class="ulist">
<ul>
<li>
<p>NetBeans IDEが正常に動作するには、JDK (Java Development Kit)が必要です。上記に一覧表示されているいずれのリソースもインストールされていない場合は、最初にJDKをダウンロードしてインストールするようにしてください。</p>
</li>
<li>
<p>NetBeans IDEのJavaバンドル版には、このチュートリアルでビルドするアプリケーションに必要なJava WebおよびEEテクノロジが含まれています。</p>
</li>
<li>
<p>NetBeans IDEのJavaバンドル版には、このチュートリアルに必要なGlassFishサーバーも含まれています。<a href="https://glassfish.dev.java.net/public/downloadsindex.html">GlassFishサーバーを別個にダウンロードする</a>こともできますが、NetBeansダウンロードに付属するバージョンを使用すると、IDEに自動的に登録されるので便利です。</p>
</li>
<li>
<p>このチュートリアル・ユニットは、以前のユニットを完了させていなくても進めることができます。そのために、データベースの準備や、IDE、GlassFishおよびMySQL間の接続の確立について説明した<a href="setup.html">設定手順</a>を参照してください。</p>
</li>
<li>
<p>`AffableBean`プロジェクトの<a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252FAffableBean_snapshot4.zip">スナップショット4</a>をダウンロードでき、これはNetBeans IDE 6.9を使用してこのユニットを完了させた後の状態のプロジェクトに対応しています。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="whatEJB">EJBおよびJPAテクノロジとは</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このチュートリアルで今まで開発してきたプロジェクトは、Apache Tomcatなどのサーブレット・コンテナを使用して、Webブラウザで実行できました。結局のところ、ここまではJSTLおよびサーブレット・テクノロジを利用したのみで、JDBCを使用して直接データベースに接続しています。実際、アプリケーションのすべての側面(スレッドの安全性、トランザクション、セキュリティなど)のために手動でコーディングしながら、これらのテクノロジのみを使用してアプリケーションの開発を続けることも理論的には可能です。しかし、エンタープライズBeanとJPAエンティティ・クラスを使用すると、すでに十分に試行された信頼できるソリューションを使用しながら、アプリケーションのビジネス・ロジックに集中できるようになります。後続の各項ではこの2つのテクノロジを紹介し、EE開発でこれらが担う役割を説明します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#ejb">エンタープライズJavaBeans</a></p>
</li>
<li>
<p><a href="#jpa">Java Persistence</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="ejb">エンタープライズJavaBeans</h3>
<div class="paragraph">
<p><a href="http://java.sun.com/products/ejb/">EJB製品の公式ページ</a>では、エンタープライズJavaBeansテクノロジを「分散型の、トランザクション可能な、セキュリティ保護された、可搬性があるアプリケーションの開発をすばやく簡単に行うことができるサーバー側コンポーネント・アーキテクチャ」と説明しています。EJB (エンタープライズBean)をプロジェクトに適用しても、このテクノロジが提供するサービスは開発者にとって透過的なままであり、EJBを使用しない場合に必要になる、大量のボイラープレート・コードを追加する退屈で間違えやすい作業を取り除くことができます。EE開発の経験が少ない場合、作成するJava WebアプリケーションでのEJBの必要性を疑問に思うかもしれません。Debu Panda氏、Reza Rahman氏およびDerek Lane氏による『<a href="http://www.manning.com/panda/">EJB 3 In Action</a>』の本では、EJBテクノロジの役割を次のようにうまく言い換えています。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>_中規模の、比較的単純なWebアプリケーションの開発のためにEJBを使用することは大げさであると多くの人が考えていますが、これは大きな誤りです。家を建設するとき、すべてを一から造るわけではありません。かわりに資材を買ったり、必要に応じて請負業者のサービスを申し込んだりもします。同様に、エンタープライズ・アプリケーションを一からビルドすることはあまり現実的ではありません。ほとんどのサーバー側アプリケーションには、変動するビジネス・ロジック、アプリケーション状態の管理、リレーショナル・データベースに対する情報の格納および取得、トランザクションの管理、セキュリティの実装、非同期処理の実行、システムの統合など、多くの共通点があります。</p>
</div>
<div class="paragraph">
<p>フレームワークとして、EJBコンテナはこの種の共通の機能をすぐに使用できるサービスとして提供しており、EJBコンポーネントが車輪を再発明することなくアプリケーション内でこれらのサービスを使用できるようになっています。たとえば、Webアプリケーションでクレジット・カード・モジュールをビルドするときに、トランザクションやセキュリティ・アクセス制御の管理のために複雑で間違えやすい大量のコードを書いているとします。これは、EJBコンテナが提供する宣言型のトランザクションやセキュリティ・サービスを使用すれば避けられるはずです。EJBコンポーネントがEJBコンテナへデプロイされると、これらのサービスの他にも数々のサービスを使用できるようになります。これにより、高品質で豊富な機能を持つアプリケーションが、想像を大きく上回るほどの速さで書けるようになります。_<sup><a href="#footnote1">[1]</a></sup></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>EJBは、プロジェクトに組み込まれたコンポーネントまたはJavaクラスと考えることも、多数のエンタープライズ関連のサービスを提供する_フレームワーク_と考えることもできます。このチュートリアルで利用するサービスのいくつかについては、『<a href="http://www.manning.com/panda/">EJB 3 In Action</a>』で次のように説明されています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>プール:</strong> EJBプラットフォームは、EJBコンポーネントごとに、クライアントで共有されるコンポーネント・インスタンスのプールを作成します。どの時点でも、プールされた各インスタンスを使用できるのは単一のクライアントのみです。インスタンスがクライアントへのサービスを終了すると、再生用にガベージ・コレクタによって破棄されるのではなく、再利用のためにプールに返されます。</p>
</li>
<li>
<p><strong>スレッドの安全性:</strong> EJBは、完全に見えない方法で、すべてのコンポーネントをスレッド・セーフおよび高性能にします。これは、シングル・スレッドのデスクトップ・アプリケーションのようにサーバー・コンポーネントを記述できることを意味します。コンポーネント自体がどれほど複雑であっても、EJBによって確実にスレッド・セーフになります。</p>
</li>
<li>
<p><strong>トランザクション:</strong> EJBは宣言型のトランザクション管理をサポートします。宣言型のトランザクション管理では、コードのかわりに単純な構成を使用してコンポーネントにトランザクション可能な動作を追加できます。実質的に、どのようなコンポーネント・メソッドもトランザクション可能として指定できます。メソッドが正常に完了すると、EJBはトランザクションを確定して、メソッドによるデータの変更を永続的なものにします。それ以外の場合は、トランザクションがロール・バックされます。コンテナ管理対象EJBトランザクションについては、ユニット9の<a href="transaction.html">トランザクション・ビジネス・ロジックの統合</a>で説明します。</p>
</li>
<li>
<p>*セキュリティ: *EJBは、JAAS (Java Authentication and Authorization Service) APIとの統合をサポートしているため、アプリケーションをセキュリティ・コードで複雑にするかわりに、セキュリティを完全に外部に切り離して単純な構成でアプリケーションをセキュリティ保護できます。<sup><a href="#footnote2">[2]</a></sup>ユニット11の<a href="security.html#secureEJB">アプリケーションの保護</a>では、EJBの&lt;a href="http://download.oracle.com/javaee/6/api/javax/annotation/security/RolesAllowed.html" target="_blank"`@RolesAllowed`注釈を示します。</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="jpa">Java Persistence</h3>
<div class="paragraph">
<p>Javaエンタープライズの文脈での「<em>持続性</em>」とは、Javaオブジェクトに含まれるデータを自動的にリレーショナル・データベースに格納する動作を指します。JPA (<a href="http://java.sun.com/javaee/technologies/persistence.jsp">Java Persistence API</a>)は、開発者にとって透過的な方法で、アプリケーションがJavaオブジェクトとリレーショナル・データベース間でデータを管理できるようにするORM (Object-Relational Mapping: オブジェクト関係マッピング)テクノロジです。これは、データ・モデルをミラー化する一連のJavaクラス(<em>エンティティ</em>)を作成および構成することで、JPAをプロジェクトに適用できることを意味します。そうすると、アプリケーションがデータベースに直接アクセスしているようにこれらのエンティティにアクセスできます。</p>
</div>
<div class="paragraph">
<p>プロジェクトでJPAを使用すると、次のような様々なメリットがあります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JPAには、静的および動的な問合せのための、固有の充実したSQLのような問合せ言語があります。JPQL (Java Persistence Query Language)を使用することで、アプリケーションが異なるデータベース・ベンダー間の可搬性を維持できます。</p>
</li>
<li>
<p>低レベル、冗長、そして間違えやすいJDBC/SQLコードを書く作業を避けることができます。</p>
</li>
<li>
<p>JPAは、データのキャッシュおよびパフォーマンスの最適化のサービスを透過的に提供します。</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="whatSession">セッションBeanとは</h2>
<div class="sectionbody">
<div class="paragraph">
<p>エンタープライズ・セッションBeanは、特定のビジネス操作を実行するためにクライアントによって呼び出されます。「<em>セッション</em>」という名前には、Beanインスタンスが「仕事の単位」の期間使用できるという意味が含まれています。<a href="http://jcp.org/aboutJava/communityprocess/final/jsr318/index.html">EJB 3.1仕様</a>では、一般的なセッション・オブジェクトを、次のような特長を持つものとして説明しています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>単一のクライアントのかわりに実行</p>
</li>
<li>
<p>トランザクション対応可能</p>
</li>
<li>
<p>配下のデータベースの共有データを更新</p>
</li>
<li>
<p>データベースの共有データを直接示すわけではないが、アクセスおよび更新ができる</p>
</li>
<li>
<p>比較的存在期間が短い</p>
</li>
<li>
<p>EJBコンテナがクラッシュすると除去される。処理を続けるには、クライアントは新しいセッション・オブジェクトを再確立する必要があります。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>EJBは、<em>ステートフル</em>、_ステートレス_および_シングルトン_の3タイプのセッションBeanを提供します。次の説明は、<a href="http://download.oracle.com/docs/cd/E17410_01/javaee/6/tutorial/doc/index.html">Java EE 6チュートリアル</a>の内容を元にしたものです。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ステートフル:</strong> Beanの状態は、複数のメソッド・コールにわたって維持されます。「状態」とは、そのインスタンス変数の値を示します。クライアントがBeanと対話するため、この状態はよく「<em>対話形式の</em>」状態と呼ばれます。</p>
</li>
<li>
<p><strong>ステートレス:</strong> ステートレスBeanは、単一のメソッド・コールで発生する可能性のある操作に使用されます。メソッドが処理を終了すると、クライアント固有のBeanの状態は保持されません。したがって、ステートレス・セッションBeanは、クライアントと対話形式の状態を維持しません。</p>
</li>
<li>
<p><strong>シングルトン:</strong> シングルトン・セッションBeanは、アプリケーションごとに1度インスタンス化され、アプリケーションのライフサイクルの間存在します。シングルトン・セッションBeanは、単一のエンタープライズBeanインスタンスがクライアント間で共有され、並行してアクセスされる場合用に設計されています。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>EJBセッションBeanの詳細は、<a href="http://download.oracle.com/docs/cd/E17410_01/javaee/6/tutorial/doc/gipjg.html">Java EE 6チュートリアル: セッションBeanとは</a>を参照してください。</p>
</div>
<div class="paragraph">
<p>このチュートリアルのEコマース・アプリケーション開発で使用するのは、ステートレス・セッションBeanのみです。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="specification">仕様および実装について</h2>
<div class="sectionbody">
<div class="paragraph">
<p>EJBおよびJPAテクノロジは、次の仕様によって定義されています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://jcp.org/en/jsr/summary?id=317">JSR 317: Java Persistence 2.0</a></p>
</li>
<li>
<p><a href="http://jcp.org/en/jsr/summary?id=318">JSR 318: Enterprise JavaBeans 3.1</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>これらの仕様はテクノロジを定義しています。しかし、テクノロジをプロジェクトに適用するには、仕様の_実装_を使用する必要があります。仕様が確定すると、テクノロジの無償の実装であるリファレンス実装が含まれます。この概念がわかりにくい場合は、次のような例で考えてください。音楽作品(つまり、ページ上の音符)とは、1つの曲のことです。演奏者は、その曲を学んで演奏を録音するときに、曲の_解釈_を提供します。このように、音楽作品は技術仕様に対応し、演奏者の録音は仕様の実装に対応します。</p>
</div>
<div class="paragraph">
<p>Java技術仕様と、その正式な標準化定義については、<a href="intro.html#jcp">Javaコミュニティ・プロセスとは</a>を参照してください。</p>
</div>
<div class="paragraph">
<p>EJBおよびJPA仕様の最終リリースのダウンロード・ページを調べると、次のリファレンス実装へのリンクが見つかります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JPA:</strong> <a href="http://www.eclipse.org/eclipselink/downloads/ri.php">http://www.eclipse.org/eclipselink/downloads/ri.php</a></p>
</li>
<li>
<p><strong>EJB:</strong> <a href="http://glassfish.dev.java.net/downloads/ri">http://glassfish.dev.java.net/downloads/ri</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>JPA仕様の実装は_持続性プロバイダ_と呼ばれており、JPA 2.0仕様のリファレンス実装として選択された持続性プロバイダは<a href="http://www.eclipse.org/eclipselink/">EclipseLink</a>です。</p>
</div>
<div class="paragraph">
<p>EJBリファレンス実装のリンクを調べると、EJBの実装のみでなく、<a href="https://glassfish.dev.java.net/">プロジェクトGlassFish</a>が提供するすべてのリファレンス実装が一覧表示されたページに移動します。この理由は、プロジェクトGlassFishがJava EE 6プラットフォーム仕様(<a href="http://jcp.org/en/jsr/summary?id=316">JSR 316</a>)のリファレンス実装を形成しているためです。このチュートリアルでEコマース・プロジェクトをビルドするのに使用するGlassFish v3アプリケーション・サーバー(Open Source Edition)には、プロジェクトGlassFishの元で開発されたすべてのテクノロジのリファレンス実装が含まれています。このことから、これはJava EE 6_コンテナ_と呼ばれています。</p>
</div>
<div class="paragraph">
<p>Java EEコンテナには、Web (サーブレット)コンテナ、EJBコンテナおよび持続性プロバイダの3つの必須コンポーネントが含まれています。Eコマース・アプリケーションのデプロイメント・シナリオを次の図に示しています。このユニットで作成するエンティティ・クラスは、持続性プロバイダによって管理されます。このユニットで作成するセッションBeanは、EJBコンテナによって管理されます。ビューは、Webコンテナによって管理されるJSPページでレンダリングされます。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/java-ee-container.png" alt="java ee container">
</div>
<div class="title">Figure 3. GlassFish v3には、Webコンテナ、EJBコンテナおよびEclipseLink (持続性プロバイダ)がJava EEコンテナとして格納される</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="addEntity">エンティティ・クラスの追加</h2>
<div class="sectionbody">
<div class="paragraph">
<p>まず、IDEのデータベースからのエンティティ・クラス・ウィザードを使用して、`affablebean`スキーマに基づくエンティティ・クラスを生成します。このウィザードは、配下の持続性プロバイダに依存してこの作業を行います。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>IDEで<a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252FAffableBean_snapshot3.zip">プロジェクト・スナップショット</a>を開きます。IDEで、[Ctrl]-[Shift]-[O] (Macの場合は[⌘]-[Shift]-[O])を押し、ダウンロードしたファイルを解凍したコンピュータ上の場所に移動します。</p>
</li>
<li>
<p>[Ctrl]-[N] (Macの場合は[⌘]-[N])を押して、ファイル・ウィザードを開きます。</p>
</li>
<li>
<p>「持続性」カテゴリから「データベースからのエンティティ・クラス」を選択します。「次」をクリックします。</p>
</li>
<li>
<p>ステップ2の「データベース表」で、「データ・ソース」ドロップダウン・リストから「<code>jdbc/affablebean</code>」を選択します。ドロップダウン・リストは、アプリケーション・サーバーに登録されたデータ・ソースによって生成されます。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>`jdbc/affablebean`データ・ソースを選択すると、IDEによってデータベースがスキャンされ、「使用可能な表」ペインにデータベースの表が一覧表示されます。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/entity-from-database.png" alt="entity from database">
</div>
<div class="title">Figure 4. 使用可能なデータ・ソースの選択し、IDEでデータベースの表を読み取らせる</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>「すべてを追加」ボタンをクリックしてから「次」クリックします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>データベースからのエンティティ・クラス・ウィザードのステップ3は、NetBeans IDE 6.8と6.9で少し異なります。使用するIDEのバージョンに応じて、以下の手順を実行します。</p>
<div class="ulist">
<ul>
<li>
<p><a href="#68">NetBeans IDE 6.8</a></p>
</li>
<li>
<p><a href="#69">NetBeans IDE 6.9</a></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>[[68]]
==== NetBeans IDE 6.8</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/entity-classes-68.png" alt="entity classes 68">
</div>
<div class="title">Figure 5. NetBeans 6.8 - データベースからのエンティティ・クラス・ウィザード、ステップ3: エンティティ・クラス</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「パッケージ」フィールドに「<strong>entity</strong>」と入力します。ウィザードの完了時に、エンティティ・クラスの新しいパッケージが作成されます。</p>
</li>
<li>
<p>「持続性ユニットを作成」ボタンをクリックします。「持続性ユニットを作成」ダイアログが開きます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/create-pu.png" alt="create pu">
</div>
<div class="title">Figure 6. 「持続性ユニットを作成」ダイアログを使用したpersistence.xmlファイルの生成</div>
</div>
<div class="paragraph">
<p>_持続性ユニット_とは、アプリケーション内に存在するエンティティ・クラスのコレクションのことです。上のダイアログで、持続性プロバイダが持続性ユニットの構成設定を指定するために使用する`persistence.xml`ファイルが生成されます。このプロジェクトに関連付けられたサーバーには、「EclipseLink (JPA 2.0)」がデフォルトで選択されています。「表生成の方針」は「<code>なし</code>」のままにします。これにより、持続性プロバイダがデータベースに影響しないようになります。(たとえば、持続性プロバイダに、データベースを削除してから既存のエンティティ・クラスに基づいてデータベースを再作成させる場合は、方針を「<code>ドロップして作成</code>」に設定します。この場合、このアクションはプロジェクトがデプロイされるたびに行われます。)</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>「作成」をクリックします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>ステップ3の「エンティティ・クラス」に戻ると、エンティティのクラス名がデータベースの表に基づいたものになっています。たとえば、`CustomerOrder`エンティティは`customer_order`データベース表にマップされています。また、「持続フィールド用のNamedQuery注釈を生成」オプションがデフォルトで選択されています。このチュートリアルの後半で、様々な名前付き問合せを使用します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>下の<a href="#step7">ステップ7</a>に進みます。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>[[69]]
==== NetBeans IDE 6.9</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/entity-classes-69.png" alt="entity classes 69">
</div>
<div class="title">Figure 7. NetBeans 6.9 - データベースからのエンティティ・クラス・ウィザード、ステップ3: エンティティ・クラス</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「パッケージ」フィールドに「<strong>entity</strong>」と入力します。ウィザードの完了時に、エンティティ・クラスの新しいパッケージが作成されます。</p>
</li>
<li>
<p>次の点に注意してください。</p>
<div class="ulist">
<ul>
<li>
<p>エンティティのクラス名は、データベース表に基づきます。たとえば、`CustomerOrder`エンティティは`customer_order`データベース表にマップされます。</p>
</li>
<li>
<p>「持続フィールド用のNamedQuery注釈を生成」オプションはデフォルトで選択されています。このチュートリアルの後半で、様々な名前付き問合せを使用します。</p>
</li>
<li>
<p>「持続性ユニットを作成」オプションはデフォルトで選択されています。_持続性ユニット_は、アプリケーション内に存在するエンティティ・クラスのコレクションです。持続性ユニットは、持続性プロバイダが読み取る`persistence.xml`構成ファイルで定義されます。したがって、このオプションを有効にすることは、ウィザードによって`persistence.xml`ファイルが生成されてデフォルト設定が割り当てられることにもなります。</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>「終了」をクリックします。JPAエンティティ・クラスが`affablebean`データベース表に基づいて生成されます。「プロジェクト」ウィンドウで新しく作成された`entity`パッケージを展開すると、エンティティ・クラスを調べることができます。また、「構成ファイル」ノードの下には新しい持続性ユニットがあります。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/entity-classes.png" alt="entity classes">
</div>
<div class="title">Figure 8. 「プロジェクト」ウィンドウでの新しいエンティティ・クラスの表示</div>
</div>
<div class="paragraph">
<p>ウィザードによって、追加のエンティティ・クラス`OrderedProductPK`が生成されています。データ・モデルの`ordered_product`表は、<code>customer_order`および`product`の両方の表の主キーで構成される複合主キーを使用することを思い出してください。(<a href="data-model.html#manyToMany">+データ・モデルの設計 - 多対多の関係の作成+</a>を参照。)このため、持続性プロバイダは複合キーのための別個のエンティティ・クラスを作成して、`OrderedProduct`エンティティに_埋込みます_。`OrderedProduct`をエディタで開くと、これを調べることができます。JPAは、組込み可能なクラスが複合主キーであることを示すために、</code>@EmbeddedId`注釈を使用します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class OrderedProduct implements Serializable {
    private static final long serialVersionUID = 1L;
    *@EmbeddedId*
    protected OrderedProductPK orderedProductPK;</code></pre>
</div>
</div>
<div class="paragraph">
<p>`@EmbeddedId`注釈で[Ctrl]-[Space]を押してAPIドキュメントを呼び出します。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/embedded-id.png" alt="embedded id">
</div>
<div class="title">Figure 9. [Ctrl]-[Space]の押下によるAPIドキュメントの呼出し</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>エディタで持続性ユニット(<code>persistence.xml</code>)を開きます。IDEには「XML」ビューに加え、持続性ユニットのための「デザイン」ビューも用意されています。「デザイン」ビューは、プロジェクトの持続性プロバイダの管理構成を変更するための便利な方法を提供します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/persistence-unit.png" alt="persistence unit">
</div>
<div class="title">Figure 10. AffableBeanPU持続性ユニットの「デザイン」ビュー</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>`AffableBeanPU`持続ユニットの最上部にある「XML」タブをクリックして、「XML」ビューを開きます。ファイルに次のプロパティを追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;persistence-unit name="AffableBeanPU" transaction-type="JTA"&gt;
  &lt;jta-data-source&gt;jdbc/affablebean&lt;/jta-data-source&gt;
  *&lt;properties&gt;
    &lt;property name="eclipselink.logging.level" value="FINEST"/&gt;
  &lt;/properties&gt;*
&lt;/persistence-unit&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>アプリケーションを実行したときに持続性プロバイダによって生成される出力がすべて表示されるように、ロギング・レベルのプロパティを`FINEST`に設定しました。これによって、持続性プロバイダがデータベースで使用しているSQLが確認できるようになり、どのようなデバッグが必要になったとしても、デバッグが容易になります。</p>
</div>
<div class="paragraph">
<p>ロギングの説明およびすべてのロギング値の一覧については、公式のEclipseLinkドキュメント(<a href="http://wiki.eclipse.org/EclipseLink/Examples/JPA/Logging">ロギングの構成方法</a>)を参照してください。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="addSession">セッションBeanの追加</h2>
<div class="sectionbody">
<div class="paragraph">
<p>この項では、IDEのエンティティ・クラスのセッションBean・ウィザードを使用して、作成したばかりのエンティティ・クラスごとにEJB_セッション・ファサード_を生成します。各セッションBeanには、それぞれのエンティティ・クラスのための基本的なアクセス・メソッドが含まれます。</p>
</div>
<div class="paragraph">
<p>_セッション・ファサード_とは、<a href="http://java.sun.com/blueprints/enterprise/index.html">エンタープライズ・ブループリント・プログラム</a>で公表されているデザイン・パターンです。<a href="http://java.sun.com/blueprints/corej2eepatterns/Patterns/SessionFacade.html">コアJ2EEパターン・カタログ</a>に記載されているように、これは多層アプリケーション環境で起こる次のような共通する問題の解決を図るものです。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>密結合による、クライアントとビジネス・オブジェクト間の直接の依存性</p>
</li>
<li>
<p>クライアントとサーバー間の過多のメソッド呼出しによる、ネットワーク・パフォーマンスの問題</p>
</li>
<li>
<p>クライアント・アクセス方針が一貫しないことによる、ビジネス・オブジェクトの誤用</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>セッション・ファサードは、配下のビジネス・オブジェクトの相互作用を抽象化して、必要な機能のみを使用できるようにするサービス・レイヤーを提供します。これにより、参加者間の複雑な相互作用がクライアントに表示されなくなります。このようにして、セッションBean (セッション・ファサードを表します)はビジネス・オブジェクト間の関係を管理します。また、セッションBeanは、ワークフローの必要に応じて参加者を作成、配置、変更および削除することで、参加者のライフサイクルも管理します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>[Ctrl]-[N] (Macの場合は[⌘]-[N])を押して、ファイル・ウィザードを開きます。</p>
</li>
<li>
<p>「持続性」カテゴリを選択してから「エンティティ・クラスのセッションBean」を選択します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/session-beans-for-entity-classes.png" alt="session beans for entity classes">
</div>
<div class="title">Figure 11. 「エンティティ・クラスのセッションBean」を選択し、持続性モデルのセッション・ファサードを生成する</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>「次」をクリックします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>ステップ2の「エンティティ・クラス」では、左側の「利用可能なエンティティ・クラス」の下に、プロジェクトに含まれているすべてのエンティティ・クラスが一覧表示されています。「すべてを追加」をクリックします。すべてのエンティティ・クラスが、右側の「選択されているエンティティ・クラス」の下に移動します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>「次」をクリックします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>ステップ3の「生成されるセッションBean」で、「パッケージ」フィールドに「<strong>session</strong>」と入力します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/generated-session-beans.png" alt="generated session beans">
</div>
<div class="title">Figure 12. 新しいセッションBeanの場所およびインタフェース作成の有無の指定</div>
</div>
<div class="paragraph">
<p><strong>注意:</strong> このウィザードを使用して、セッションBeanのローカルおよびリモート・インタフェースを生成できます。セッションBeanをインタフェースとしてプログラミングするメリットはありますが(たとえば、ビジネス・オブジェクトの相互作用をインタフェースの後ろに隠すと、クライアントをビジネス・ロジックからさらに切り離すことができます。これにより、必要に応じてアプリケーション用にインタフェースの複数の実装をコーディングできるようになります)、これについてはこのチュートリアルでは扱いません。3.1より前のバージョンのEJBでは、セッションBeanごとにインタフェースを実装する_必要があります_。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>「終了」をクリックします。IDEによって、プロジェクトに含まれるエンティティ・クラスごとにセッションBeanが生成されます。「プロジェクト」ウィンドウで、新しい`session`パッケージを展開してセッションBeanを調べます。</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">NetBeans 6.8</th>
<th class="tableblock halign-left valign-top">NetBeans 6.9</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/projects-window-session-beans.png" alt="projects window session beans" title="「プロジェクト」ウィンドウでの新しいセッションBeanの調査"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/projects-window-session-beans-69.png" alt="projects window session beans 69" title="「プロジェクト」ウィンドウでの新しいセッションBeanの調査"></span></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>*注意: *上記のように、NetBeans IDE 6.9では、エンティティ・クラスのセッションBean・ウィザードがファサード・クラスを生成するようにわずかな改善が提供されます。つまり、すべてのクラスに共通するボイラープレート・コードが`AbstractFacade`という名前の抽象クラスに取り出されます。バージョン6.9を使用している場合は、生成されたいずれかのファサード・クラス(`AbstractFacade`を除く)を開いてください。そのクラスが`AbstractFacade`を継承していることがわかります。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>エディタでセッション・ファサード(たとえば、<code>ProductFacade</code>)を開きます。生成されたすべてのセッション・ファサードは、<a href="http://download.oracle.com/javaee/6/api/javax/persistence/PersistenceContext.html">`@PersistenceContext`</a>注釈を使用して<a href="http://java.sun.com/javaee/6/docs/api/javax/persistence/EntityManager.html">`EntityManager`</a>をインスタンス化します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@PersistenceContext(unitName = "AffableBeanPU")
private EntityManager em;</code></pre>
</div>
</div>
<div class="paragraph">
<p>`@PersistenceContext`注釈は、コンテナ管理対象`EntityManager`をクラスに注入するために使用されます。つまり、必要に応じてGlassFishのEJBコンテナを利用して`EntityManager`を開いたり閉じたりします。`unitName`要素には、アプリケーションの`persistence.xml`ファイルで定義されている`AffableBeanPU`持続性ユニットを指定します。</p>
</div>
<div class="paragraph">
<p>`EntityManager`はJava Persistence APIの重要なコンポーネントであり、データベースで持続性アクションを実行する役割を果たします。『<a href="http://www.manning.com/panda/">EJB 3 In Action</a>』の本では、`EntityManager`を次のように説明しています。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><em>JPA`EntityManager`インタフェースは、実際に持続性サービスを提供することでエンティティを管理します。エンティティは、JPAプロバイダに自身がデータベースにどのようにマップされているかを伝えますが、自身は持続しません。`EntityManager`インタフェースは、エンティティのORMメタデータを読み取って、持続性操作を実行します。</em></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>アプリケーションに、JPAエンティティ・クラスの形式で`affablebean`データベースの持続性モデルが含まれるようになりました。また、エンティティ・クラスにアクセスするために使用できるエンタープライズBeanで構成されるセッション・ファサードも含まれています。次の項では、セッションBeanおよびエンティティ・クラスを使用してデータベースにアクセスする方法を示します。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="access">EJBによるデータへのアクセス</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="connect-db.html">前のチュートリアル・ユニット</a>で、アプリケーションからデータベースにアクセスする方法を学習しました。この方法では、GlassFishにデータ・ソースを構成し、アプリケーションのデプロイメント・ディスクリプタにリソース参照を追加してから、アプリケーションのJSPページでJSTLの`&lt;sql&gt;`タグを使用することで、データベースにアクセスしました。データベースのデータを含むプロトタイプをすばやく設定できるため、これは重要な手法です。しかし、この手法では維持管理や拡大縮小が難しくなるため、中規模から大規模のアプリケーションや、複数開発者のチームによって管理されるアプリケーションに使用することは現実的ではありません。その上、多層にわたるアプリケーションを開発している場合や、MVCパターンに従っている場合、データにアクセスするコードをフロント・エンドに保持することは望ましくありません。エンタープライズBeanと持続性モデルを使用すると、プレゼンテーション・コンポーネントとモデル・コンポーネントを効果的に切り離して、MVCパターンにより準拠できるようになります。</p>
</div>
<div class="paragraph">
<p>次の手順では、`AffableBean`プロジェクトでセッションおよびエンティティBeanの使用を開始するための方法を示します。以前にインデックス・ページおよびカテゴリ・ページのために設定したJSTLデータ・アクセス・ロジックは除去することになります。かわりに、セッションBeanによって提供されるデータ・アクセス・メソッドを利用して、スコープ指定された変数にデータを格納し、フロント・エンドのページ・ビューからデータを取り出せるようにします。まずインデックス・ページに取り組んでから、より複雑なカテゴリ・ページに進みます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#index">インデックス・ページ</a></p>
</li>
<li>
<p><a href="#category">カテゴリ・ページ</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="index">インデックス・ページ</h3>
<div class="paragraph">
<p>インデックス・ページには、4つの製品カテゴリのデータが必要です。現時点の設定では、インデックス・ページがリクエストされるたびに、JSTLの`&lt;sql&gt;`タグがカテゴリの詳細をデータベースに問い合せます。この情報はほとんど変更されないため、パフォーマンスの観点からすると、アプリケーションがデプロイされた後に問合せを1回のみ実行して、アプリケーション・スコープ指定された属性にデータを格納する方が効果的です。このコードを`ControllerServlet`の`init`メソッドに追加することで、これを実現できます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「プロジェクト」ウィンドウで、「ソース・パッケージ」&gt;「<code>controller</code>」&gt;「<code>ControllerServlet</code>」ノードをダブルクリックしてエディタで開きます。</p>
</li>
<li>
<p><code>CategoryFacade`のインスタンスを宣言して、</code>@EJB`注釈をインスタンスに適用します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class ControllerServlet extends HttpServlet {

    *@EJB
    private CategoryFacade categoryFacade;*

    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>`@EJB`注釈は、`CategoryFacade`という名前のEJBで`categoryFacade`変数をインスタンス化するようにEJBコンテナに指示します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>IDEのヒントを使用して、次のインポート文を追加します。</p>
<div class="ulist">
<ul>
<li>
<p><code>javax.ejb.EJB</code></p>
</li>
<li>
<p><code>session.CategoryFacade</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>[Ctrl]-[Shift]-[I] (Macの場合は[⌘]-[Shift]-[I])を押すと、必要なインポートが自動的にクラスに追加されます。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>以下の`init`メソッドをクラスに追加します。Webコンテナは、その`init`メソッドをコールしてサーブレットを初期化します。これは、サーブレットがロードされてからサービス・リクエストを開始するまでの間に1回のみ発生します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class ControllerServlet extends HttpServlet {

    @EJB
    private CategoryFacade categoryFacade;

    *public void init() throws ServletException {

        // store category list in servlet context
        getServletContext().setAttribute("categories", categoryFacade.findAll());
    }*

    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>ここで、<code>Category`のすべてのレコードをデータベースに問い合せる、ファサード・クラスの`findAll`メソッドを適用します。その後、結果として得られた`Category`オブジェクトの`List`を、「`categories</code>」の文字列で参照できる属性として設定します。`ServletContext`に参照を置くと、その参照はアプリケーション全体のスコープで存在することになります。</p>
</div>
<div class="paragraph">
<p>`findAll`メソッドのメソッド署名をすばやく判定するには、[Ctrl]キー(Macの場合は[⌘])を押しながらカーソルをメソッドの上に移動します。(以下のイメージは、NetBeans IDE 6.8を使用して表示されるポップアップを示しています。)</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/method-signature.png" alt="method signature">
</div>
<div class="title">Figure 13. [Ctrl]キーを押しながらカーソルをメソッド上に移動して署名を表示する</div>
</div>
<div class="paragraph">
<p>ハイパーリンクをクリックすると、メソッドに直接移動できます。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>IDEのヒントを使用して、`@Overrides`注釈を追加します。`init`メソッドは、`HttpServlet`のスーパー・クラスである`GenericServlet`によって定義されます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/override.png" alt="override">
</div>
<div class="title">Figure 14. IDEのヒントを使用した、メソッドへの@Overrides注釈の追加</div>
</div>
<div class="paragraph">
<p>注釈を追加することは必須ではありませんが、これを行うと次のようないくつかの利点が得られます。
* 本当にオーバーライドするつもりのメソッドをオーバーライドしているかどうかを確認するためのコンパイラ・チェックを使用できるようになります。
* ソース・コードのメソッドがオーバーライドされている状態が明確になるため、読みやすさが向上します。</p>
</div>
<div class="paragraph">
<p>注釈の詳細は、<a href="http://download.oracle.com/javase/tutorial/java/javaOO/annotations.html">Javaチュートリアル: 注釈</a>を参照してください。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>これで、カテゴリの一覧を含むアプリケーション・スコープ指定された属性を設定したので、新しく作成した属性にアクセスするようにインデックス・ページを変更します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>「プロジェクト」ウィンドウで「Webページ」&gt;「<code>index.jsp</code>」ノードをダブルクリックして、このファイルをエディタで開きます。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>ファイルの最上部に一覧表示されている`&lt;sql:query&gt;`文をコメントアウト(または削除)します。エディタでコードをコメントアウトするには、コードを強調表示してから[Ctrl]-[/](Macの場合は[⌘]-[/])を押します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/commented-out.png" alt="commented out">
</div>
<div class="title">Figure 15. エディタでの[Ctrl]-[/]の押下によるコード・スニペットのコメントアウト</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>`&lt;c:forEach&gt;`の開始タグを変更して、この`items`属性が、新しいアプリケーション・スコープ指定された`categories`属性を参照するようにします。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;c:forEach var="category" items="*${categories}*"&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>プロジェクトのWebデプロイメント・ディスクリプタを開きます。[Alt]-[Shift]-[O] (Macの場合は[Ctrl]-[Shift]-[O])を押して、「ファイルに移動」ダイアログで「<code>web</code>」と入力してから「OK」をクリックします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/go-to-file.png" alt="go to file">
</div>
<div class="title">Figure 16. 「ファイルに移動」ダイアログを使用した、エディタへのファイルの速やかな表示</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p><code>&lt;resource-ref&gt;`エントリをコメントアウト(または削除)します。このエントリは、サーバーに登録されたデータ・ソースを</code>&lt;sql&gt;`タグで識別するために必要でした。現時点では、JPAに依存してデータベースにアクセスしており、持続性ユニットに`jdbc/affablebean`データ・ソースがすでに指定されています。(上記の<a href="#pu">プロジェクトの持続性ユニットの「デザイン」ビュー</a>を参照。)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>`&lt;resource-ref&gt;`エントリ全体を強調表示してから[Ctrl]-[/](Macの場合は[⌘]-[/])を押します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">*&lt;!-- *&lt;resource-ref&gt;
         &lt;description&gt;Connects to database for AffableBean application&lt;/description&gt;
         &lt;res-ref-name&gt;jdbc/affablebean&lt;/res-ref-name&gt;
         &lt;res-type&gt;javax.sql.ConnectionPoolDataSource&lt;/res-type&gt;
         &lt;res-auth&gt;Container&lt;/res-auth&gt;
         &lt;res-sharing-scope&gt;Shareable&lt;/res-sharing-scope&gt;
     &lt;/resource-ref&gt; *--&gt;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p>プロジェクトを実行します。「プロジェクトの実行」(<span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span>)ボタンをクリックします。プロジェクトのインデックス・ページがブラウザで開き、4つのすべてのカテゴリ名およびイメージが表示されるのが確認できます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/index-page.png" alt="index page">
</div>
<div class="title">Figure 17. インデックス・ページにカテゴリの詳細を取得できることの確認</div>
</div>
</div>
<div class="sect2">
<h3 id="category">カテゴリ・ページ</h3>
<div class="paragraph">
<p><a href="design.html#category">カテゴリ・ページ</a>が正しくレンダリングされるには、次の3つのデータが必要です。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>カテゴリ・データ:</strong> 左の列のカテゴリ・ボタン用</p>
</li>
<li>
<p><strong>選択されたカテゴリ:</strong> 選択されたカテゴリは左の列で強調表示され、選択されたカテゴリの名前は製品の表の上に表示される</p>
</li>
<li>
<p><strong>選択されたカテゴリの製品データ:</strong> 製品の表に表示された製品用</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>3つのデータを1つずつ処理していきましょう。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#categoryData">カテゴリ・データ</a></p>
</li>
<li>
<p><a href="#selectedCategoryData">選択されたカテゴリ</a></p>
</li>
<li>
<p><a href="#productData">選択されたカテゴリの製品データ</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="categoryData">カテゴリ・データ</h4>
<div class="paragraph">
<p>インデックス・ページのために作成した、アプリケーション・スコープ指定された`categories`属性をカテゴリ・データ用に再利用します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>エディタで`category.jsp`を開き、ファイルの最上部に一覧表示されているJSTLの`&lt;sql&gt;`文を([Ctrl]-[/]、Macの場合は[⌘]-[/]で)コメントアウトします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/comment-out-sql.png" alt="comment out sql">
</div>
<div class="title">Figure 18. カテゴリ・ページでのJSTLの&lt;sql&gt;文のコメントアウト</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>`&lt;c:forEach&gt;`の開始タグを変更して、この`items`属性が、アプリケーション・スコープ指定された`categories`属性を参照するようにします。(上記で`index.jsp`に対して実行した手順と同じです。)</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;c:forEach var="category" items="*${categories}*"&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>プロジェクトを実行して、カテゴリ・ページの現在の状態を調べます。「プロジェクトの実行」(<span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span>)ボタンをクリックします。プロジェクトのインデックス・ページがブラウザで開いたら、4つのカテゴリのいずれかをクリックします。左の列にカテゴリ・ボタンが表示され、想定したとおりに機能します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/category-page-left-column.png" alt="category page left column">
</div>
<div class="title">Figure 19. 左の列にカテゴリのボタンが表示され、想定したとおりに機能する</div>
</div>
</div>
<div class="sect3">
<h4 id="selectedCategoryData">選択されたカテゴリ</h4>
<div class="paragraph">
<p>選択されたカテゴリを取得するために、カテゴリIDとリクエスト問合せ文字列が一致する`Category`を見つけるためにすでに作成してある`categoryFacade`を使用できます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>エディタで`ControllerServlet`を開きます。(すでに開いている場合は、[Ctrl]-[Tab]を押してポップアップ・リストから選択します。)</p>
</li>
<li>
<p>選択されたカテゴリを取得する機能の実装を開始します。`TODO: Implement category request`というコメントを見つけ、それを削除して以下の(<strong>太字の</strong>)コードを追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">// if category page is requested
if (userPath.equals("/category")) {

    *// get categoryId from request
    String categoryId = request.getQueryString();

    if (categoryId != null) {

    }*

// if cart page is requested
} else if (userPath.equals("/viewCart")) {</code></pre>
</div>
</div>
<div class="paragraph">
<p>リクエストで`getQueryString()`をコールすることで、リクエストされたカテゴリIDを取得します。</p>
</div>
<div class="paragraph">
<p><strong>注意:</strong> 左の列のカテゴリ・ボタン内で選択されたカテゴリを判定するためのロジックは、EL式を使用する`category.jsp`ですでに実装されています。これは、サーブレットで`getQueryString()`をコールすることに相当します。このEL式は`pageContext.request.queryString`です。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>`if`文の中に、次のコード行を追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">// get categoryId from request
String categoryId = request.getQueryString();

if (categoryId != null) {

    *// get selected category
    selectedCategory = categoryFacade.find(Short.parseShort(categoryId));*
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>`CategoryFacade`の`find`メソッドを使用して、リクエストされたカテゴリIDに基づく`Category`オブジェクトを取得します。`categoryId`を、`Category`エンティティ・クラスの`id`フィールドに使用される型である`Short`にキャストする必要があります。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>左マージンにあるバッジ(<span class="image"><img src="images/editor-badge.png" alt="editor badge"></span>)をクリックしてエディタのヒントを使用し、`selectedCategory`を`doGet`メソッド内のローカル変数として宣言します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/local-variable.png" alt="local variable">
</div>
<div class="title">Figure 20. エディタのヒントを使用してローカル変数を宣言する</div>
</div>
<div class="paragraph">
<p>`selectedCategory`はこのクラスにまだインポートされていない`Category`型であるため、IDEは`entity.Category`のインポート文をファイルの先頭に自動的に追加します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>取得した`Category`オブジェクトをリクエスト・スコープに置くために次の行を追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">// get categoryId from request
String categoryId = request.getQueryString();

if (categoryId != null) {

    // get selected category
    selectedCategory = categoryFacade.find(Short.parseShort(categoryId));

    *// place selected category in request scope
    request.setAttribute("selectedCategory", selectedCategory);*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>エディタで`category.jsp`に切り替えます。([Ctrl]-[Tab]を押してポップアップ・リストから選択します。)</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>`&lt;p id="categoryTitle"&gt;`を検索して、次のように変更します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;p id="categoryTitle"&gt;
    &lt;span style="background-color: #f5eabe; padding: 7px;"&gt;*${selectedCategory.name}*&lt;/span&gt;
&lt;/p&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>現時点で、<code>ControllerServlet`からリクエスト・スコープに置いたばかりの`selectedCategory`属性を使用しています。EL式の中で「</code>.name`」を使用すると、指定された`Category`オブジェクトで`getName`メソッドがコールされます。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>ブラウザに戻ってカテゴリ・ページをリフレッシュします。選択されたカテゴリの名前がページに表示されるようになっています。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/category-page-selected-category.png" alt="category page selected category">
</div>
<div class="title">Figure 21. 選択されたカテゴリの名前がカテゴリ・ページに表示される</div>
</div>
</div>
<div class="sect3">
<h4 id="productData">選択されたカテゴリの製品データ</h4>
<div class="paragraph">
<p>選択されたカテゴリのすべての製品を取得するために、`Category`エンティティの`getProductCollection()`を使用します。まず、`selectedCategory`上でこのメソッドをコールして、`selectedCategory`に関連付けられたすべての`Product`のコレクションを取得します。次に製品のコレクションをリクエスト・スコープ内の属性として格納し、最後にスコープ指定された属性を`category.jsp`ページ・ビューから参照します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>`ControllerServlet`では、カテゴリ・リクエストを管理する以下の文をコードに追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">// if category page is requested
if (userPath.equals("/category")) {

    // get categoryId from request
    String categoryId = request.getQueryString();

    if (categoryId != null) {

        // get selected category
        selectedCategory = categoryFacade.find(Short.parseShort(categoryId));

        // place selected category in request scope
        request.setAttribute("selectedCategory", selectedCategory);

        *// get all products for selected category
        categoryProducts = selectedCategory.getProductCollection();*
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>ここで`getProductCollection()`をコールして、`selectedCategory`に関連付けられたすべての`Product`のコレクションを取得できます。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>エディタのヒントを使用して、`categoryProducts`を`doGet`メソッドのローカル変数として定義します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/local-variable2.png" alt="local variable2">
</div>
<div class="title">Figure 22. エディタのヒントを使用してローカル変数を宣言する</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>リクエスト・スコープに`Product`のコレクションを置いて、アプリケーションのフロント・エンドから取得できるようにします。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">// if category page is requested
if (userPath.equals("/category")) {

    // get categoryId from request
    String categoryId = request.getQueryString();

    if (categoryId != null) {

        // get selected category
        selectedCategory = categoryFacade.find(Short.parseShort(categoryId));

        // place selected category in request scope
        request.setAttribute("selectedCategory", selectedCategory);

        // get all products for selected category
        categoryProducts = selectedCategory.getProductCollection();

        *// place category products in request scope
        request.setAttribute("categoryProducts", categoryProducts);
    }*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>エディタで`category.jsp`ファイルを開き、製品の表を次のように変更します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;table id="productTable"&gt;

    &lt;c:forEach var="product" items="*${categoryProducts}*" varStatus="iter"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>`&lt;c:forEach&gt;`タグは`categoryProducts`のコレクションを参照するようになりました。`c:forEach`ループはコレクションに含まれる各`Product`オブジェクトに対して繰り返され、それに応じてデータを抽出するようになりました。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>[F6] (Macの場合は[fn]-[F6])を押してプロジェクトを実行します。ブラウザでカテゴリ・ページに移動すると、各カテゴリですべての製品が表示されるようになっています。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/category-page-product-table.png" alt="category page product table">
</div>
<div class="title">Figure 23. 製品の表に指定のカテゴリの製品が表示される</div>
</div>
<div class="paragraph">
<p>このチュートリアル・ユニットでは、JPAおよびEJBテクノロジを簡単に紹介しました。また、Java仕様の役割について、およびそのリファレンス実装をGlassFishアプリケーション・サーバーが使用する方法についても説明しました。その後、プロジェクト・データベースのJava実装を提供する一連のJPAエンティティ・クラスを作成する方法を示しました。さらに、<em>セッション・ファサード</em>・パターンに従って、エンティティ・クラス上に存在し、それらへの便利なアクセスを可能にする一連のEJBセッションBeanを作成する方法を示しました。最後に、`AffableBean`プロジェクトを変更して、インデックス・ページおよびカテゴリ・ページで必要なデータベースへのアクセスに、新しいセッションBeanおよびエンティティを利用するようにしました。</p>
</div>
<div class="paragraph">
<p>`AffableBean`プロジェクトの<a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252FAffableBean_snapshot4.zip">スナップショット4</a>をダウンロードでき、これはNetBeans IDE 6.9を使用してこのユニットを完了させた後の状態のプロジェクトに対応しています。</p>
</div>
<div class="paragraph">
<p>次のユニットでは、セッション管理について学習し、ユーザーがサイトの中でクリックして実行したアクションをアプリケーションに覚えさせる方法について学習します。これは、Eコマース・アプリケーションでショッピング・カート機構を実装するためのキー・ポイントです。</p>
</div>
<div class="paragraph">
<p>link:/about/contact_form.html?to=3&amp;subject=Feedback: NetBeans E-commerce Tutorial - Adding Entity Classes and Session Beans[ご意見をお寄せください]</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="seeAlso">関連項目</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_netbeansリソース">NetBeansリソース</h3>
<div class="ulist">
<ul>
<li>
<p><a href="../../../trails/java-ee.html">Java EEおよびJava Webの学習</a></p>
</li>
<li>
<p><a href="../javaee-intro.html">Java EEテクノロジ入門</a></p>
</li>
<li>
<p><a href="../javaee-gettingstarted.html">Java EE 6アプリケーションの開始</a></p>
</li>
<li>
<p><a href="../secure-ejb.html">Java EEでのセキュリティ保護されたエンタープライズBeansのビルド</a></p>
</li>
<li>
<p><a href="../javaee-entapp-ejb.html">EJB 3.1を使用したエンタープライズ・アプリケーションの作成</a></p>
</li>
<li>
<p><a href="../jpa-eclipselink-screencast.html">EclipseLinkでJPAサポートを使用する</a> [スクリーンキャスト]</p>
</li>
<li>
<p><a href="../../screencasts.html">NetBeans IDE 6.xのビデオ・チュートリアルとデモ</a></p>
</li>
<li>
<p><a href="http://refcardz.dzone.com/refcardz/netbeans-java-editor-68">NetBeans Javaエディタ6.8リファレンス・カード</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_ejbリソース">EJBリソース</h3>
<div class="ulist">
<ul>
<li>
<p><strong>製品ページ:</strong> <a href="http://java.sun.com/products/ejb/">エンタープライズJavaBeansテクノロジ</a></p>
</li>
<li>
<p>*仕様のダウンロード:*<a href="http://jcp.org/aboutJava/communityprocess/final/jsr318/index.html">+ JSR 318: EJB 3.1最終リリース+</a></p>
</li>
<li>
<p><strong>リファレンス実装:</strong> <a href="http://glassfish.dev.java.net/downloads/ri">http://glassfish.dev.java.net/downloads/ri</a></p>
</li>
<li>
<p><strong>公式フォーラム:</strong> <a href="http://forums.sun.com/forum.jspa?forumID=13">エンタープライズ・テクノロジ - エンタープライズJavaBeans</a></p>
</li>
<li>
<p><strong>Java EE 6チュートリアル:</strong> <a href="http://download.oracle.com/docs/cd/E17410_01/javaee/6/tutorial/doc/bnblr.html">パートIV - エンタープライズBean</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_jpaリソース">JPAリソース</h3>
<div class="ulist">
<ul>
<li>
<p><strong>製品ページ:</strong> <a href="http://java.sun.com/javaee/technologies/persistence.jsp">Java Persistence API</a></p>
</li>
<li>
<p><strong>仕様のダウンロード:</strong> <a href="http://jcp.org/aboutJava/communityprocess/final/jsr317/index.html">JSR 317: Java Persistence 2.0最終リリース</a></p>
</li>
<li>
<p><strong>リファレンス実装:</strong> <a href="http://www.eclipse.org/eclipselink/downloads/ri.php">http://www.eclipse.org/eclipselink/downloads/ri.php</a></p>
</li>
<li>
<p><strong>Java EE 6チュートリアル:</strong> <a href="http://download.oracle.com/docs/cd/E17410_01/javaee/6/tutorial/doc/bnbpy.html">パートVI - 持続性</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_glassfishリソース">GlassFishリソース</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://glassfish.dev.java.net/docs/index.html">GlassFish v3ドキュメント</a></p>
</li>
<li>
<p><a href="http://www.sun.com/offers/details/GlassFish_Tomcat.html">Tomcatユーザー向けGlassFishの学習</a></p>
</li>
<li>
<p><a href="https://glassfish.dev.java.net/javaee5/persistence/persistence-example.html">GlassFishプロジェクト - Java Persistenceの例</a></p>
</li>
<li>
<p><a href="http://docs.sun.com/app/docs/doc/820-7759">Your First Cup: Java EE Platformの紹介</a></p>
</li>
<li>
<p><a href="https://glassfish.dev.java.net/downloads/ri/">リファレンス実装のダウンロード</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_技術記事">技術記事</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.theserverside.com/news/1363656/New-Features-in-EJB-31">EJB 3.1の新機能</a></p>
</li>
<li>
<p><a href="http://www.ibm.com/developerworks/java/library/j-ejb1008.html">EJBのベスト・プラクティス: エンティティBeanの保護</a></p>
</li>
<li>
<p><a href="http://java.sun.com/blueprints/corej2eepatterns/Patterns/SessionFacade.html">コアJ2EEパターン - セッション・ファサード</a></p>
</li>
<li>
<p><a href="http://www.ibm.com/developerworks/websphere/library/techarticles/0106_brown/sessionfacades.html">セッション・ファサードのルールおよびパターン</a></p>
</li>
<li>
<p><a href="http://www.oracle.com/technology/sample_code/tech/java/j2ee/designpattern/businesstier/sessionfacade/readme.html">デザイン・パターン・サンプル・アプリケーション - セッション・ファサード</a></p>
</li>
<li>
<p><a href="http://www.ibm.com/developerworks/websphere/library/bestpractices/using_httpservlet_method.html">ベスト・プラクティス: HttpServlet `init`メソッドの使用</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_書籍">書籍</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.amazon.com/Beginning-Java-EE-GlassFish-Second/dp/143022889X/ref=dp_ob_title_bk">Beginning Java EE 6 with GlassFish 3</a></p>
</li>
<li>
<p><a href="http://www.amazon.com/Java-EE-GlassFish-Application-Server/dp/1849510369/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1281888153&amp;sr=1-1">Java EE 6 with GlassFish 3 Application Server</a></p>
</li>
<li>
<p><a href="http://www.apress.com/book/view/1590598954">Pro NetBeans IDE 6 Rich Client Platform Edition</a></p>
</li>
<li>
<p><a href="http://www.amazon.com/Real-World-Patterns-Rethinking-Practices/dp/0557078326/ref=pd_sim_b_4">Real World Java EE Patterns Rethinking Best Practices</a></p>
</li>
<li>
<p><a href="http://www.amazon.com/Patterns-Enterprise-Application-Architecture-Martin/dp/0321127420/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1281985949&amp;sr=1-1">Patterns of Enterprise Application Architecture</a></p>
</li>
<li>
<p><a href="http://www.amazon.com/Domain-Driven-Design-Tackling-Complexity-Software/dp/0321125215/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1281985959&amp;sr=1-1">Domain-Driven Design: Tackling Complexity in the Heart of Software</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_参考資料">参考資料</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#1">^</a>出典: 『<a href="http://www.manning.com/panda/">EJB 3 In Action</a>』の第1章、1.1.2項: EJB as a framework</p>
</li>
<li>
<p><a href="#2">^</a>他にもEJBによって提供される多くのサービスがあります。より総合的な一覧については、『<a href="http://www.manning.com/panda/">EJB 3 In Action</a>』の第1章、1.3.3項: Gaining functionality with EJB servicesを参照してください。</p>
</li>
</ol>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/ecommerce/entity-session_ja.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
