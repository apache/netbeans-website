
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>NetBeans Ｅコマース チュートリアル－データベースへのアプリケーションの接続</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NetBeans Ｅコマース チュートリアル－データベースへのアプリケーションの接続 - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, NetBeans Ｅコマース チュートリアル－データベースへのアプリケーションの接続">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">NetBeans Ｅコマース チュートリアル－データベースへのアプリケーションの接続</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/ecommerce/connect-db_ja.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#sampleData">データベースへサンプルデータを追加する</a>
<ul class="sectlevel2">
<li><a href="#category">カテゴリテーブル category table</a></li>
<li><a href="#product">製品テーブル product table</a></li>
<li><a href="#_データベーステーブルのnetbeans_gui_サポート">データベーステーブルのNetBeans GUI サポート</a></li>
</ul>
</li>
<li><a href="#createConnPoolDataSource">コネクションプールとデータソースを作成する</a></li>
<li><a href="#testConnPoolDataSource">コネクションプールとデータソースのテスト</a>
<ul class="sectlevel2">
<li><a href="#ping">コネクションプールへ ping する</a></li>
<li><a href="#resourceReference">データソースへのリソース参照を作成する</a></li>
<li><a href="#query">JSPページからデータベースへのクエリ</a></li>
</ul>
</li>
<li><a href="#param">コンテキストパラメータの設定</a></li>
<li><a href="#jstl">JSTLで作業する</a>
<ul class="sectlevel2">
<li><a href="#indexJSTL">index page インデックスページ</a></li>
<li><a href="#categoryJSTL">カテゴリページ</a></li>
<li><a href="#_ideのデバッガを使用して暗黙オブジェクトの値を調べる">IDEのデバッガを使用して、暗黙オブジェクトの値を調べる</a></li>
</ul>
</li>
<li><a href="#troubleshoot">トラブルシューティング</a></li>
<li><a href="#seeAlso">関連項目</a>
<ul class="sectlevel2">
<li><a href="#_netbeans_リソース">NetBeans リソース</a></li>
<li><a href="#_mysql_リソース">MySQL リソース</a></li>
<li><a href="#_jsp_el_リソース">JSP ＆ EL リソース</a></li>
<li><a href="#_jstl_リソース">JSTL リソース</a></li>
<li><a href="#_技術記事とリファレンスカード">技術記事とリファレンスカード</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>この単元は、データベースとアプリケーション間の通信について説明しています。あなたはデータベースにサンプルデータを追加し、IDE の SQL エディタによって提供されるいくつかの機能を調べることから始めます。あなたは GlassFish サーバーにデータソースとコネクションプールを設定し、簡単な JSP ページを作成してデータベースに単純なクエリを発行してデータソースをテストします。</p>
</div>
<div class="paragraph">
<p>この単元はまた、アプリケーションが Web 表示用の画像を取得して表示する方法と、コンテキストパラメータを設定して Web ページからその値を取得する方法に取り組みます。データソースが正しく動作していると確信している場合は、JSTL <code>core</code> と <code>sql</code> タグライブラリを適用して、<a href="design.html#index">index</a> ページと<a href="design.html#category">category</a> ページでカテゴリと製品画像を取得して表示します。</p>
</div>
<div class="paragraph">
<p>あなたはこの単元で構築するアプリケーションのライブデモを見ることができます： <a href="http://services.netbeans.org/AffableBean/">NetBeans E コマース チュートリアル－アプリケーションのデモ</a>。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ソフトウェアまたはリソース</th>
<th class="tableblock halign-left valign-top">必須バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">NetBeans IDE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java バンドル版, 6.8 または 6.9</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java Development Kit (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">バージョン 6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://dev.mysql.com/downloads/mysql/">MySQL データベースサーバー</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">バージョン 5.x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GlassFish サーバー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v3 または Open Source Edition 3.0.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252FAffableBean_snapshot2.zip">AffableBean プロジェクト</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">スナップショット 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252Fimg.zip">サイト イメージ</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">n/a</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>メモ：</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>NetBeans IDE を正常に実行するには Java 開発キット（ JDK ）が必要です。上記のリソースの何も持っていない場合は、まず最初に JDK をダウンロードしインストールする必要があります。</p>
</li>
<li>
<p>NetBeans IDE Java バンドル版には、Java Web と JAVA EE 技術が入っており、このチュートリアルで構築するアプリケーションに必要です。</p>
</li>
<li>
<p>また、NetBeans IDE Java バンドル版にはこのチュートリアルで必要な GlassFish サーバーが入っています。あなたは、<a href="http://glassfish.dev.java.net/public/downloadsindex.html">個別に GlassFish サーバーをダウンロード</a>できますが、NetBeans ダウンロードで提供するバージョンはそれを自動的に IDE に登録してくれる利点があります。</p>
</li>
<li>
<p>あなたは前の単元を完了することなく、このチュートリアルの単元を理解することができます。次の3つの手順で行います：</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>*MySQL データベースサーバをセットアップします。*<a href="setup-dev-environ.html#communicate">データベースサーバーと接続する</a>に書いてある手順に従います。下記にアウトラインを示します。</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>*データベースサーバーに affablebean スキーマを作成します。 *</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252Faffablebean_schema_creation.sql">affablebean_schema_creation.sql</a> をクリックして、そのファイル全部をコピーします。（ Ctrl-C、⌘-C Macで）。</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>IDE の SQL エディタを開きます。サービスウィンドウ（Ctrl-5、⌘-5 Macの場合）で、<code>affablebean</code> データベース接続( <span class="image"><img src="images/db-connection-node.png" alt="db connection node"></span> )ノードを右クリックし「 Execute Command コマンドの実行」を選択します。 IDE の SQL エディタが開きます。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>エディターの中で affablebean.sql ファイルの内容を全部貼付け（ Ctrl+V。⌘-V Macの場合）します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>エディタのツールバーの「 Run SQL (Sqlを実行)」( <span class="image"><img src="images/run-sql-btn.png" alt="run sql btn"></span> ) ボタンを押します。スクリプトが MySQL サーバ上で実行されます。affablebean データベース テーブルが生成されます。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>IDE で <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252FAffableBean_snapshot2.zip">プロジェクトのスナップショット</a>を開きます。IDE で、Ctrl-Shift-O、(⌘-Shift-O on Mac) を押して、ダウンロードしたファイルを解凍した場所をコンピュータに指示します。</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sampleData">データベースへサンプルデータを追加する</h2>
<div class="sectionbody">
<div class="paragraph">
<p>サンプルデータを <code>category</code> と <code>product</code> テーブルに追加することから始めます。あなたがこれを行うには、IDE の SQL エディタで、ネイティブ SQL を使用して直接データベースと対話することができます。また IDE の SQL サポートには、追加、削除、変更、およびテーブルのレコード削除ができる GUI エディタがあります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#category">カテゴリテーブル category table</a></p>
</li>
<li>
<p><a href="#product">製品テーブル product table</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="category">カテゴリテーブル category table</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>サービスウィンドウ（Ctrl-5、⌘-5 Macの場合）で、カテゴリ テーブル ( <span class="image"><img src="images/db-table-node.png" alt="db table node"></span> )ノードを右クリックし、「 View Data(データ表示)」を選択します。SQL エディタが開き、下の領域内に <code>category</code> テーブルが GUI 表現で表示されます。テーブルが空で、データはまだ追加されていないことに注意してください。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/category-table-empty.png" alt="category table empty">
</div>
<div class="title">Figure 1. Use the SQL editor to view table data in the IDE</div>
</div>
<div class="paragraph">
<p>また、GUI 表現で生成され使用されるネイティブ SQL クエリはエディタの上部領域に表示されることに気づいて下さい： [ <code>select * from category</code> ]（カテゴリから＊（すべて）選択）。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>「&#8216;select * from category&#8217;」を削除し、次の SQL 文を入力してください：</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">INSERT INTO `category` (`name`) VALUES ('dairy'),('meats'),('bakery'),('fruit &amp;amp; veg');</code></pre>
</div>
</div>
<div class="paragraph">
<p>この文は、4つの新しいレコードを挿入します。それぞれは [ <code>name</code> ] 列に一意のエントリを持っています。スキーマを作成するとき、<code>id</code> 列は、AUTO_INCREMENT に設定されているので、あなたが値を設定することを心配する必要はありません。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>エディタのツールバーの「 Run SQL (sqlの実行)」( <span class="image"><img src="images/run-sql-btn.png" alt="run sql btn"></span> ) ボタンを押します。SQL ステートメントが実行されます。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>データが追加されていることを確認するには、再度「<code>select * from category</code>」クエリを実行します。これを行うには、[ SQL History (SQL履歴)]ウィンドウが使用できます。エディタのツールバーの[ SQL History]( <span class="image"><img src="images/sql-history-btn.png" alt="sql history btn"></span> ) ボタンをクリックして、「<code>select * from category</code>」エントリーをダブルクリックします。[ SQL History ]ウィンドウには、最近のIDEで実行されたすべてのSQLステートメントが表示されています。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>上記の手順を実行する方法を確認するために、下記のスクリーンキャストを見てください。IDE のコード補完や提案機能のうまい使い方も確認してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="product">製品テーブル product table</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>product</code> テーブル ( <span class="image"><img src="images/db-table-node.png" alt="db table node"></span> )ノードで右クリックし、「Execute Command」(コマンド実行)」を選択します。「サービス」ウィンドウで「Execute Command」メニューのオプションを選択し IDE の SQL エディタを開きます。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>エディタで、次の <code>INSERT</code> 文をコピーして貼り付けします。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">--
-- Sample data for table `product`
--

INSERT INTO `product` (`name`, price, description, category_id) VALUES ('milk', 1.70, 'semi skimmed (1L)', 1);
INSERT INTO `product` (`name`, price, description, category_id) VALUES ('cheese', 2.39, 'mild cheddar (330g)', 1);
INSERT INTO `product` (`name`, price, description, category_id) VALUES ('butter', 1.09, 'unsalted (250g)', 1);
INSERT INTO `product` (`name`, price, description, category_id) VALUES ('free range eggs', 1.76, 'medium-sized (6 eggs)', 1);

INSERT INTO `product` (`name`, price, description, category_id) VALUES ('organic meat patties', 2.29, 'rolled in fresh herbs&lt;br&gt;2 patties (250g)', 2);
INSERT INTO `product` (`name`, price, description, category_id) VALUES ('parma ham', 3.49, 'matured, organic (70g)', 2);
INSERT INTO `product` (`name`, price, description, category_id) VALUES ('chicken leg', 2.59, 'free range (250g)', 2);
INSERT INTO `product` (`name`, price, description, category_id) VALUES ('sausages', 3.55, 'reduced fat, pork&lt;br&gt;3 sausages (350g)', 2);

INSERT INTO `product` (`name`, price, description, category_id) VALUES ('sunflower seed loaf', 1.89, '600g', 3);
INSERT INTO `product` (`name`, price, description, category_id) VALUES ('sesame seed bagel', 1.19, '4 bagels', 3);
INSERT INTO `product` (`name`, price, description, category_id) VALUES ('pumpkin seed bun', 1.15, '4 buns', 3);
INSERT INTO `product` (`name`, price, description, category_id) VALUES ('chocolate cookies', 2.39, 'contain peanuts&lt;br&gt;(3 cookies)', 3);

INSERT INTO `product` (`name`, price, description, category_id) VALUES ('corn on the cob', 1.59, '2 pieces', 4);
INSERT INTO `product` (`name`, price, description, category_id) VALUES ('red currants', 2.49, '150g', 4);
INSERT INTO `product` (`name`, price, description, category_id) VALUES ('broccoli', 1.29, '500g', 4);
INSERT INTO `product` (`name`, price, description, category_id) VALUES ('seedless watermelon', 1.49, '250g', 4);</code></pre>
</div>
</div>
<div class="paragraph">
<p>上記のコードを調べて、次の点に注意してください：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252Faffablebean_schema_creation.sql">`affablebean` スキーマ生成スクリプト</a> を調べてください。注意してください。<code>product</code> テーブルには、non-nullable（nullを許容しない、null非許容）で自動的にインクリメントされる主キーが含まれています。テーブルに新しいレコードを挿入するたびに（そして、明示的に主キーの値を設定しないでも）、SQLエンジンは主キーを設定します。また、注意してください。<code>product</code> テーブルの <code>last_update</code> 列には、デフォルト値として <code>CURRENT_TIMESTAMP</code> が適用されています。 SQL エンジンは、したがって、レコードが作成された時の「現在の日付と時刻」をこのフィールドに入れます。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>この別の方法では、もしあなたが <code>INSERT</code> 文を作る必要があり、その insert がどの列に影響を与えるかが分からない場合、あなたはすべての列を知る必要があります。この例では、デフォルトで指定された値をもつフィールドはSQLエンジンが自動処理するので、あなたは <code>NULL</code> を入力できます。たとえば、次のステートメントは、上記のコードの最初の行と同じ結果を引き出します：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">INSERT INTO `product` VALUES (NULL, 'milk', 1.70, 'semi skimmed (1L)', NULL, 1);</code></pre>
</div>
</div>
<div class="paragraph">
<p>ステートメントを実行した後、そのレコードに自動的にインクリメントされた主キーが入っているのが見えるでしょう。<code>last_update</code> 列には、現在の日付と時刻が入っています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>最後の列、「 <code>category_id</code> 」は、<code>category</code> テーブルの <code>id</code> 列の中の値と一致する必要があります 。あなたは既に <code>category</code> テーブルに４つのレコードを追加しているので、あなたが挿入しようとしている <code>product</code> レコードは、これらの4つのレコードの一つを参照します。あなたが <code>product</code> レコードを挿入しようとするとまだ存在しない <code>category_id</code> を参照するので、外部キー制約により失敗します。</p>
</li>
</ul>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Run SQL ( <span class="image"><img src="images/run-sql-btn.png" alt="run sql btn"></span> )ボタンをエディタのツールバーで押します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>注：</strong> 出力ウィンドウ（Ctrl-4; ⌘-4 Macの場合）のViewに、、実行結果の入ったログファイルが表示されます。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p><code>product</code> テーブル( <span class="image"><img src="images/db-table-node.png" alt="db table node"></span> )ノードを右クリックし、[ View Data データ表示] を選択します。あなたは16個の新しいレコードがテーブルに記載されているのを見ることができます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/product-table.png" alt="product table">
</div>
<div class="title">Figure 2. Choose View Data from a table node&#8217;s right-click menu to verify sample data</div>
</div>
</div>
<div class="sect2">
<h3 id="_データベーステーブルのnetbeans_gui_サポート">データベーステーブルのNetBeans GUI サポート</h3>
<div class="paragraph">
<p>[サービス]ウィンドウで、テーブル( <span class="image"><img src="images/db-table-node.png" alt="db table node"></span> )ノードを右クリックし、「 View Data データ表示」を選択すると、IDE が、テーブルとそれに含まれるデータをの視覚表現します。（上記のイメージに表示されています）。また、追加、変更、およびテーブルデータの削除に、この GUI サポートを使用することができます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>新しいレコードの追加：</strong> 新しいレコードを追加するには、「Insert Record」(レコードを挿入) ( <span class="image"><img src="images/insert-record-btn.png" alt="insert record btn"></span> )ボタンをクリックします。「Insert Record」ダイアログウィンドウが表示されま、新しいレコードを入力できるようになります。[OK]をクリックした時、新しいデータがデータベースにコミットされ、テーブルの GUI 表示が自動的に更新されます。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ダイアログウィンドウ内の [Show SQL] ボタンをクリックして、その操作を始める時に適用されるSQL文を見ることができます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Modify records(レコードの変更)：</strong> あなたが既存のレコードを変更することができます。テーブルのセルを直接ダブルクリックし、フィールドのエントリを編集します。変更されたエントリは、green text(緑色文字） で表示されます。データ編集を完了するときに、[Commit Record(コミットレコード)]( <span class="image"><img src="images/commit-record-btn.png" alt="commit record btn"></span> )ボタンをクリックして、実際のデータベースへの変更をコミットします。（同様に、 [Cancel Edits(編集キャンセル)]( <span class="image"><img src="images/cancel-edits-btn.png" alt="cancel edits btn"></span> )ボタンはあなたがすでに行った編集をキャンセルします）。</p>
</li>
<li>
<p><strong>個々のレコード削除：</strong> テーブルの行をクリックして、 [Delete Selected Record (選択したレコード削除)]( <span class="image"><img src="images/delete-selected-record-btn.png" alt="delete selected record btn"></span> )ボタンを押します。また、選択した行をクリックしながらCtrlキー（⌘ Macの場合）を同時に押して複数の行を選び、削除することができます。</p>
</li>
<li>
<p><strong>レコードをすべて削除：</strong> テーブル内のすべてのレコードを削除することを、テーブルを <em>truncating</em>(切り捨て) すると呼びます。[Truncate Table] ( <span class="image"><img src="images/truncate-table-btn.png" alt="truncate table btn"></span> )ボタンをクリックして、表示されたテーブルの全レコードを削除します。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>表示されたデータが実際のデータベースと再び同期することが必要な場合、「Refresh Records」(レコード更新)( <span class="image"><img src="images/refresh-records-btn.png" alt="refresh records btn"></span> )ボタンをクリックすればできます。上記に記述された機能の多くは、GUI エディタの右クリックメニューからアクセスすることができます。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="createConnPoolDataSource">コネクションプールとデータソースを作成する</h2>
<div class="sectionbody">
<div class="paragraph">
<p>この時点から以降は、MySQL データベースと GlassFish サーバーに配置された affablebean アプリケーション間の接続を確立していきます。この接続は Java Database Connectivity (<a href="http://java.sun.com/products/jdbc/overview.html">JDBC</a>) API で可能になっています。 JDBC API は、JDK に含まれている統合ライブラリです（チュートリアル <a href="intro.html#platform">Introduction</a> に表示されているコンポーネント図を振り返り参照してください）。このチュートリアルでは、直接 JDBC プログラムを触りませんが、我々が構築しているアプリケーションでは、SQL と Java 言語の間で通信が必要となるときはいつでもこの JDBC API を利用しています。たとえば、あなたは GlassFish サーバーに <em>connection pool</em> を作成することから始めます。サーバが直接 MySQL データベースと通信するために <a href="http://www.mysql.com/downloads/connector/j/">Connector/J</a> JDBC ドライバーが必要になります。ドライバーは jdbc 呼び出しを MySQL 固有のプロトコルに直接変換します。この単元の後半で、JSTL <a href="http://download.oracle.com/docs/cd/E17802_01/products/products/jsp/jstl/1.1/docs/tlddocs/sql/query.html">`&lt;sql:query&gt;`</a> タグを <code>affablebean</code> データベースの照会に利用するとき、そのタグは JDBC <a href="http://download-llnw.oracle.com/javase/6/docs/api/java/sql/Statement.html">`Statement`</a> に変換されます。</p>
</div>
<div class="paragraph">
<p>connection pool (コネクションプール)には、特定のデータベースで再利用可能な接続がグループ化されて入っています。新しい物理的な接続をそれぞれ作成するのには時間がかかるので、パフォーマンス向上のために、サーバーは利用可能な接続を一つにプールして保持します。アプリケーションが接続を要求したときはプールから接続を一つ取得します。アプリケーションが接続を閉じると接続はプールに返されます。コネクションプールは物理的なデータベース接続を作成する JDBC ドライバを使用します。</p>
</div>
<div class="paragraph">
<p>アプリケーションが <code>affablebean</code> データベースへアクセスできるようにするために、コネクションプールとコネクションプールを使うデータソースを作成する必要があります。NetBeans GlassFish JDBC リソースウイザードを使用します。</p>
</div>
<div class="paragraph">
<p><strong>注：</strong> また、GlassFish 管理コンソールを使用して、GlassFishサーバーに直接コネクションプールとデータソースを作成することができます。しかし、この方法でこれらのリソースを作成するときは、あなたはデータベース接続の詳細（つまり、ユーザー名、パスワード、および URL ）を手で入力する必要があります。 NetBeans のウィザードを使用すると、既存のデータベース接続から、直接すべての接続の詳細を抽出してくれるという利点があります。そうすれば、潜在的な接続の問題を排除できます。</p>
</div>
<div class="paragraph">
<p>IDE からコンソールにアクセスするには、[サービス]ウィンドウで、Servers ＞ GlassFish ノードで右クリックし、[ View Admin Console ]を選択します。デフォルトのユーザ名/パスワードは： <code>admin/adminadmin</code> です。コネクションプールとデータソースを設定するには、GlassFish 管理コンソールを使用して、<a href="setup.html">+NetBeans Eコマース チュートリアルセットアップ手順 +</a>の３－１５に従います。セットアップ手順については、後の単元で説明します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>IDEのツールバーの [New File 新規ファイル]( <span class="image"><img src="images/new-file-btn.png" alt="new file btn"></span> )ボタンを押します。 （または、 Ctrl-N、 ⌘-N Mac）。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p><strong>GlassFish</strong> カテゴリを選択し、<strong>JDBC Resource</strong> を選択、[次へ] をクリック。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>JDBC リソースウィザードのステップ２で、<code>Create New JDBC Connection Pool</code> ( JDBCコネクションプール の新規作成）オプションを選択します。その際に３つの新しい手順がウィザードに追加され、コネクションプールの設定ができるようになります。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>データソース設定の詳細を入力します：</p>
<div class="ulist">
<ul>
<li>
<p><strong>JNDI Name:</strong> <code>jdbc/affablebean</code>
[tips]#慣例で JNDI 名は、 &#8216;jdbc/&#8217; 文字列で始まります。 #</p>
</li>
<li>
<p><strong>Object Type:</strong> <code>user</code></p>
</li>
<li>
<p><strong>Enabled:</strong> <code>true</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jdbc-resource-gen-attributes.png" alt="jdbc resource gen attributes">
</div>
<div class="title">Figure 3. Create a new connection pool and data source using the JDBC Resource wizard</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>「次へ」をクリック。ステップ３、Additional Properties (追加のプロパティ)で、データソースのために追加の構成情報を指定する必要は全くありません。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>「次へ」をクリック。ステップ4、Choose Database Connection（データベース接続の選択）で、JDBCコネクションプール名に、<code>AffableBeanPool</code> を入力します。また、 <code>Extract from Existing Connection</code>（既存の接続から抽出）オプションが選択されていること、<code>jdbc:mysql://localhost:3306/affablebean</code> 接続がリストにあることを確認します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>次へをクリック。ステップ５、Add Connection Pool Properties（コネクションプールのプロパティを追加する）で、以下の詳細を指定します：</p>
<div class="ulist">
<ul>
<li>
<p><strong>Datasource Classname:</strong> <code>com.mysql.jdbc.jdbc2.optional.MysqlDataSource</code></p>
</li>
<li>
<p><strong>Resource Type:</strong> <code>javax.sql.ConnectionPoolDataSource</code></p>
</li>
<li>
<p><strong>Description:</strong> <em>(Optional)</em> <code>Connects to the affablebean database</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>またウイザードが既存の接続からプロパティを抽出し表示することに注意してください。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jdbc-resource-conn-pool.png" alt="jdbc resource conn pool">
</div>
<div class="title">Figure 4. Create a new connection pool and data source using the JDBC Resource wizard</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>[ Finish ]をクリックします。ウィザードは、プロジェクト用に`sun-resources.xml` ファイルを生成します。ファイルにはGlassFish上にコネクションプールとデータソースを設定するために必要な全ての情報が入っています。 <code>sun-resources.xml</code> ファイルは、GlassFishアプリケーションサーバーに固有のデプロイメント記述子です。プロジェクトがデプロイされると、サーバーは`sun-resources.xml`に含まれているすべての構成データを読込み、それに沿ってコネクションプールとデータソースをセットアップします。いったんコネクションプールとデータソースがサーバー上に存在すれば、あなたのプロジェクトは、もはや`sun-resources.xml`を必要としません。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>プロジェクトウィンドウ（Ctrl - 1; ⌘-1 Macの場合）で、Server Resources(サーバーリソース)ノードを展開し、<code>sun-resources.xml</code> ファイルをダブルクリックしてエディタに開きます。ここでは、 XML構成がコネクションプールとデータソースをセットアップするのに必要とされたことを理解してください。（以下のコードは読みやすさのためにフォーマットされています。）</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;resources&gt;
  &lt;jdbc-resource enabled="true"
                 jndi-name="jdbc/affablebean"
                 object-type="user"
                 pool-name="AffableBeanPool"&gt;
  &lt;/jdbc-resource&gt;

  &lt;jdbc-connection-pool allow-non-component-callers="false"
                        associate-with-thread="false"
                        connection-creation-retry-attempts="0"
                        connection-creation-retry-interval-in-seconds="10"
                        connection-leak-reclaim="false"
                        connection-leak-timeout-in-seconds="0"
                        connection-validation-method="auto-commit"
                        datasource-classname="com.mysql.jdbc.jdbc2.optional.MysqlDataSource"
                        fail-all-connections="false"
                        idle-timeout-in-seconds="300"
                        is-connection-validation-required="false"
                        is-isolation-level-guaranteed="true"
                        lazy-connection-association="false"
                        lazy-connection-enlistment="false"
                        match-connections="false"
                        max-connection-usage-count="0"
                        max-pool-size="32"
                        max-wait-time-in-millis="60000"
                        name="AffableBeanPool"
                        non-transactional-connections="false"
                        pool-resize-quantity="2"
                        res-type="javax.sql.ConnectionPoolDataSource"
                        statement-timeout-in-seconds="-1"
                        steady-pool-size="8"
                        validate-atmost-once-period-in-seconds="0"
                        wrap-jdbc-objects="false"&gt;

    &lt;description&gt;Connects to the affablebean database&lt;/description&gt;
    &lt;property name="URL" value="jdbc:mysql://localhost:3306/affablebean"/&gt;
    &lt;property name="User" value="root"/&gt;
    &lt;property name="Password" value="nbuser"/&gt;
  &lt;/jdbc-connection-pool&gt;
&lt;/resources&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>プロジェクトウィンドウ（Ctrl-1; ⌘-1 Macの場合）で、<code>AffableBean</code> プロジェクトノードを右クリック し、「Deploy」(配置)を選択します。 GlassFish サーバーは、<code>sun-resources.xml</code> ファイルの設定データを読み取り、<code>AffableBeanPool</code> コネクションプールと <code>jdbc/affablebean</code> データソースを生成します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p>[Services サービス]ウィンドウで、Servers &gt; GlassFish &gt; Resources &gt; JDBC ノードを展開します。 <code>jdbc/affablebean</code> データソースが JDBC リソースの下にリストされており、また、<code>AffableBeanPool</code> コネクションプールが Connection Pools の下にリストされているのを見つけることができます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gf-server-jdbc-resources.png" alt="gf server jdbc resources">
</div>
<div class="title">Figure 5. View data sources and connection pools registered on the server</div>
</div>
<div class="paragraph">
<p>データソースとコネクションプールのノードを右クリックして表示し、そのプロパティに変更を加えます。データソースとサーバーに登録された任意のコネクションプールを関連付けることができます。あなたは、コネクションプールのプロパティの値を編集することができます、そして、データソースとコネクションプールの両方をサーバーから登録を取り消すことができます。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testConnPoolDataSource">コネクションプールとデータソースのテスト</h2>
<div class="sectionbody">
<div class="paragraph">
<p>GlassFish サーバーが MySQL データベースに正常に接続できることを確認することから始めます。GlassFish 管理コンソールで <code>AffableBeanPool</code> コネクションプールに ping を実行してデータベースに接続できることを確認できます 。</p>
</div>
<div class="paragraph">
<p>次に、サーバー上に作成したデータソースへの参照をプロジェクトに追加することから進めます。これを行うには、<code>&lt;resource-ref&gt;</code> エントリーをアプリケーションの <code>web.xml</code> のデプロイメント記述子の中に成します。</p>
</div>
<div class="paragraph">
<p>最後に、JSTLの <code>&lt;sql&gt;</code> タグライブラリのために IDE エディタ サポートを使って、データベースを照会するJSPページを作成し、Web ページ上のテーブル内のデータを出力する JSP ページを作成します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#ping">コネクションプールへ ping する</a></p>
</li>
<li>
<p><a href="#resourceReference">データソースへのリソース参照を作成する</a></p>
</li>
<li>
<p><a href="#query">JSP ページからデータベースへ照会する</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="ping">コネクションプールへ ping する</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>GlassFish サーバーが既に実行中か確認します。サービスウィンドウ（Ctrl-5、⌘-5 Macの場合）でサーバーノードを展開します。GlassFish アイコン ( <span class="image"><img src="images/gf-server-running-node.png" alt="gf server running node"></span> )の横にある小さな緑色の矢印に注意してください。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>（サーバーが未実行の場合、サーバーノードを右クリックして、[ Start (開始)]を選択します。 ）</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>サーバーノードを右クリックし、[ View Admin Console()管理コンソールの表示 ] を選択します。 GlassFish の管理コンソールがブラウザに開きます。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>管理コンソールにログインします。デフォルトのユーザ名/パスワードは： <code>admin/adminadmin</code>。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>左側のコンソールツリーで、 リソース &gt; JDBC &gt; コネクションプールノードを展開し、 <code>AffableBeanPool</code> をクリックします。メインウィンドウに、選択したコネクションプール用の [ Edit Connection Pool ]インターフェイスが表示されます。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>ping ボタンをクリックします。 ping が成功した場合、 GlassFish サーバーは MySQL サーバ上の <code>affablebean</code> データベースへの接続ができています。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ping-succeeded.png" alt="ping succeeded">
</div>
<div class="title">Figure 6. Ping the connection pool to determine whether it has a physical connection to the database</div>
</div>
<div class="paragraph">
<p>（もしpingに失敗するときは、 <a href="#troubleshoot">トラブルシューティング</a>を参照してください。後の章にあります。）</p>
</div>
</div>
<div class="sect2">
<h3 id="resourceReference">データソースへのリソース参照を作成する</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>プロジェクトウィンドウで、Configuration Files (設定ファイル)フォルダを展開し、<code>web.xml</code> をダブルクリックします。IDE のメインウィンドウでそのファイル用のグラフィカルなインターフェイスが表示されます。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>エディタの上部にある [References参照]タブをクリックします。Resource References (リソースの参照)見出しを展開して、[ Add ] をクリックします。[ Add Resource Reference(リソースリファレンスの追加)]ダイアログが開きます。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>ダイアログに以下の情報を入力してください：</p>
<div class="ulist">
<ul>
<li>
<p><strong>Resource Name:</strong> <code>jdbc/affablebean</code></p>
</li>
<li>
<p><strong>Resource Type:</strong> <code>javax.sql.ConnectionPoolDataSource</code></p>
</li>
<li>
<p><strong>Authentication:</strong> <code>Container</code></p>
</li>
<li>
<p><strong>Sharing Scope:</strong> <code>Shareable</code></p>
</li>
<li>
<p><strong>Description:</strong> <em>(Optional)</em> <code>Connects to database for AffableBean application</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/add-resource-ref-dialog.png" alt="add resource ref dialog">
</div>
<div class="title">Figure 7. Specify resource properties in the Add Resource Reference dialog</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>[OK] をクリックします。新しいリソースが Resource References (リソース参照) 見出しの下に追加されます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/resource-reference.png" alt="resource reference">
</div>
<div class="title">Figure 8. Create a reference to the data source for the application</div>
</div>
<div class="paragraph">
<p>ここで、エディタの上部に並んでいる [XML]タブをクリックし、そのリソースが <code>web.xml</code> ファイルに追加されていることを確認します。<code>&lt;resource-ref&gt;</code> タグが入っていることに注意します。：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;resource-ref&gt;
    &lt;description&gt;Connects to database for AffableBean application&lt;/description&gt;
    &lt;res-ref-name&gt;jdbc/affablebean&lt;/res-ref-name&gt;
    &lt;res-type&gt;javax.sql.ConnectionPoolDataSource&lt;/res-type&gt;
    &lt;res-auth&gt;Container&lt;/res-auth&gt;
    &lt;res-sharing-scope&gt;Shareable&lt;/res-sharing-scope&gt;
&lt;/resource-ref&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="query">JSPページからデータベースへのクエリ</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>新しいJSPページを作成しデータソースをテストします。 [New File (新規ファイル)] ( <span class="image"><img src="images/new-file-btn.png" alt="new file btn"></span> )ボタンを押します。 （または、 Ctrl-n、 ⌘-N Mac ）。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>、Web カテゴリーを選択し、JSP ファイルタイプを選択し、 [Next 次へ]クリックします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>[ファイル名] に、「 <code>testDataSource</code> 」、[フォルダ] フィールドに「 <code>test</code> 」と入力します 。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new-jsp-wzd.png" alt="new jsp wzd">
</div>
<div class="title">Figure 9. Enter details to name and place a new JSP page into the project</div>
</div>
<div class="paragraph">
<p>プロジェクトの Web ページには、まだ <code>test</code> という名前のフォルダがありません （つまり、<code>web</code> フォルダ内に）。[Folder フォルダ]フィールドに [ <code>test</code> ] と入力すると、IDE はウィザードを完了する時に、そのフォルダを作成します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>[ Finish ] をクリックします。 IDE が新しい <code>testDataSource.jsp</code> ファイルを生成し、プロジェクト内の新しい <code>test</code> フォルダにそれを配置します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>エディタで、新しい <code>testDataSource.jsp</code> ファイルの中の <code>&lt;h1&gt;</code> タグを含む行の末尾にカーソルを置きます ( 17行 ） 。Return キーを押し、次に Ctrl-Space しコード補完を呼び出します。オプションの一覧から「 DB Report 」を選択します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/db-report.png" alt="db report">
</div>
<div class="title">Figure 10. Press Ctrl-Space in editor to invoke code suggestions</div>
</div>
<div class="paragraph">
<p>行番号が表示されない場合は、エディタの左余白を右クリックし「 Show Line Numbers (行番号表示)」を選択します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>「 Insert DB Report（DBレポートの挿入）」ダイアログボックスで、データソースを指定し、実行しようとする SQL クエリを変更します。：</p>
<div class="ulist">
<ul>
<li>
<p><strong>Data Source:</strong> <code>jdbc/affablebean</code></p>
</li>
<li>
<p><strong>Query Statement:</strong> <code>SELECT * FROM category, product WHERE category.id = product.category_id</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/insert-db-report.png" alt="insert db report">
</div>
<div class="title">Figure 11. Specify the data source and SQL query to be executed</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>「OK」をクリックします。ダイアログは <code>taglib</code> ディレクティブ(指令)を JSTL/core と <code>sql</code> ライブラリの両方のファイルの先頭に追加します：</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%&gt;
&lt;%@taglib prefix="sql" uri="http://java.sun.com/jsp/jstl/sql"%&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>ダイアログは、HTML テーブルにクエリの結果を表示するテンプレートコードを生成します：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;sql:query var="result" dataSource="jdbc/affablebean"&gt;
    SELECT * FROM category, product
    WHERE category.id = product.category_id
&lt;/sql:query&gt;

&lt;table border="1"&gt;
    &lt;!-- column headers --&gt;
    &lt;tr&gt;
        &lt;c:forEach var="columnName" items="${result.columnNames}"&gt;
            &lt;th&gt;&lt;c:out value="${columnName}"/&gt;&lt;/th&gt;
        &lt;/c:forEach&gt;
    &lt;/tr&gt;
    &lt;!-- column data --&gt;
    &lt;c:forEach var="row" items="${result.rowsByIndex}"&gt;
        &lt;tr&gt;
            &lt;c:forEach var="column" items="${row}"&gt;
                &lt;td&gt;&lt;c:out value="${column}"/&gt;&lt;/td&gt;
            &lt;/c:forEach&gt;
        &lt;/tr&gt;
    &lt;/c:forEach&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>ブラウザでファイルを実行する前に、あなたはNetBeans GlassFish サポートの JDBC ドライバの展開オプションを有効にしていることを確認します。 [ツール] &gt;[サーバー] を選び、サービスウィンドウを開きます。左側の列で、あなたが配置している GlassFish サーバーを選択します。メインの列で、「 Enable JDBC Driver Deployment 」オプションが選択されて、いることを確認し、[Close 閉じる]をクリックします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/servers-window.png" alt="servers window">
</div>
<div class="title">Figure 12. Ensure that the Enable JDBC Driver Deployment option is selected</div>
</div>
<div class="paragraph">
<p>データベースに接続する Java アプリケーションでは、サーバーは JDBC ドライバ を必要とし、それによりSQL と Java 言語間の通信ブリッジを作成します。 MySQL の場合は、[ <a href="http://www.mysql.com/downloads/connector/j/">Connector/J</a> J という JDBC ドライバを使用します。通常、ドライバ JAR ファイルをサーバーの <code>lib</code> ディレクトリに手動で配置する必要があります。 [Enable JDBC Driver Deployment ](JDBC ドライバの配置を有効にする)オプションを選択すると、サーバーはドライバが必要どうかをチェックします。もし必要なら IDE はドライバをサーバーに配置します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>エディタで右クリックし、[ Run File (ファイル実行)] (Shift-F6; fn-Shift-F6 on Mac) を選択します。 <code>testDataSource.jsp</code> ファイルがサーブレットにコンパイルされ、サーバーに配置されブラウザで実行されます。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>出力ウィンドウを開きます（ Ctrl-4、 ⌘ -4 Macの場合）。[ AffableBean(run) ]タブをクリック。「ドライバ JARファイル (<code>mysql-connector-java-5.1.6-bin.jar</code>) が配置されました。」という出力が表示されます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/output-window-mysql-driver.png" alt="output window mysql driver">
</div>
<div class="title">Figure 13. When JDBC Driver Deployment is enabled, the IDE deploys the MySQL driver to GlassFish when required</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p>ブラウザで testDataSource.jsp を調べます。あなたは、HTMLテーブル一覧のデータに`category` と <code>product</code> テーブルが含まれているのを確認します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/test-data-source.png" alt="test data source">
</div>
<div class="title">Figure 14. The JSP page contains data extracted from the 'affablebean' database</div>
</div>
<div class="paragraph">
<p>（サーバーエラーが発生する場合は、 トラブルシューティングの提案を参照してください。 後の章。）</p>
</div>
<div class="paragraph">
<p>この段階で、我々はサーバー上にデータソースとコネクションプールをセットアップする作業をしました。そして、アプリケーションが <code>affablebean</code> データベースのデータにアクセスできることを実証しました。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="param">コンテキストパラメータの設定</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このセクションでは、アプリケーションのコンテキストパラメータを設定する方法を示し、JSP ページからパラメータ値にアクセスする方法を示します。アプリケーション所有者が必要なソースコードまで立ち入って変更することなく、特定の設定を変更できるようにしたい場合があります。コンテキストパラメータは、あなたがアプリケーション全体のパラメータ値へアクセスできるようにし、必要に応じて一つの場所からパラメータ値を変更できる便利な手段を提供しています。</p>
</div>
<div class="paragraph">
<p>コンテキストパラメータのセットアップは、2つの手順で行うことができます：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ウェブデプロイメント記述子の中にパラメータ名をリスト（一覧を作成）する</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p><code>initParam</code> オブジェクトを使い、JSPページ内のパラメータを呼び出す</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>JSP 式言語（EL）は <em>implicit objects</em>(暗黙オブジェクト)を定義します。<code>initParam</code> はその例です。JSP ページで作業するときはドット表記を使用して暗黙オブジェクトを利用できます。そして、EL デリミタ ( <code>${&#8230;&#8203;}</code> )の中に式を配置することができます。たとえば、<code>myParam</code> という名前の初期化パラメータがある場合、JSPページから <code>${initParam.myParam}</code> 式でアクセスすることができます。</p>
</div>
<div class="paragraph">
<p>JSP 式の言語と暗黙オブジェクトの詳細については、 これを参照してください：Java EE 5 チュートリアル：<a href="http://download.oracle.com/docs/cd/E17477_01/javaee/5/tutorial/doc/bnahq.html">JavaServer Pages テクノロジ ＞ Unified Expression Language (統一式言語)</a>。</p>
</div>
<div class="paragraph">
<p>デモに従って、<code>AffableBean</code> プロジェクトで使う画像をカテゴリと製品画像へ渡すためのコンテキストパラメータを作成します 。初めにプロジェクトに用意された画像リソースを追加します。次に上記の２つの手順を実行します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252Fimg.zip">web サイトサンプル画像</a>をダウンロード、コンピュータ上にファイルを解凍します。解凍されたファイルは、 AffableBean アプリケーションで必要なすべての画像リソースが入った <code>img</code> フォルダです。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p><code>img</code> フォルダーを <code>AffableBean</code> プロジェクトの中にインポートします。<code>img</code> フォルダーをコピーし（ Ctrl - C、 Mac上で ⌘ - C）、その後、IDE のプロジェクトウィンドウで、プロジェクト Webページのノードに貼り付けします（ Ctrl + V。 ⌘ - V Macの場合）。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/projects-win-img-folder.png" alt="projects win img folder">
</div>
<div class="title">Figure 15. Import the 'img' folder into the AffableBean project</div>
</div>
<div class="paragraph">
<p><code>categories</code> と <code>products</code> フォルダには、<a href="design.html#index">index</a> と <a href="design.html#category">category</a> ページで表示される画像が入っています。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>プロジェクトのWebデプロイメント記述子を開きます。プロジェクトウィンドウで、Configuration Files(構成ファイル) ノードを展開し、 <code>web.xml</code> をダブルクリックします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>[General 全般]タブをクリックして、コンテキストパラメータを展開し、[Add追加]ボタンをクリックします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>[ Add Context Parameter (コンテキストパラメータの追加)]ダイアログで、以下の情報を入力してください：</p>
<div class="ulist">
<ul>
<li>
<p><strong>Parameter Name(パラメータ名):</strong> <code>productImagePath</code></p>
</li>
<li>
<p><strong>Parameter Value:(パラメータ値)</strong> <code>img/products/</code></p>
</li>
<li>
<p><strong>Description(概要):</strong> <em>(Optional)</em> <code>The relative path to product images(製品イメージへの相対パス)</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/add-context-param-dialog.png" alt="add context param dialog">
</div>
<div class="title">Figure 16. Add initialization parameters using the Add Context Parameter dialog</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>[ OK ]をクリックします</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>[ Add ]ボタンをもう一度クリックして、次の詳細を入力してください：</p>
<div class="ulist">
<ul>
<li>
<p><strong>Parameter Name:</strong> <code>categoryImagePath</code></p>
</li>
<li>
<p><strong>Parameter Value:</strong> <code>img/categories/</code></p>
</li>
<li>
<p><strong>Description:</strong> <em>(Optional)</em> <code>The relative path to category images</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>OKをクリックします。 2つのコンテキストパラメータがリストされます：</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/context-parameters.png" alt="context parameters">
</div>
<div class="title">Figure 17. Context parameters display in the web.xml interface</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>[XML]タブをクリックして、デプロイメント記述子に追加されているXMLコンテンツを表示します。次の <code>&lt;context-param&gt;</code> エントリが追加されました：</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;context-param&gt;
    &lt;description&gt;The relative path to product images&lt;/description&gt;
    &lt;param-name&gt;productImagePath&lt;/param-name&gt;
    &lt;param-value&gt;img/products/&lt;/param-value&gt;
&lt;/context-param&gt;
&lt;context-param&gt;
    &lt;description&gt;The relative path to category images&lt;/description&gt;
    &lt;param-name&gt;categoryImagePath&lt;/param-name&gt;
    &lt;param-value&gt;img/categories/&lt;/param-value&gt;
&lt;/context-param&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>コンテキストパラメータの値が web ページにアクセス可能かどうかをテストするために、エディタで任意のプロジェクトの Web ページを開き、<code>initParam</code> の暗黙的なオブジェクトを使い、EL式(expressions)を入力してください。たとえば、<code>index.jsp</code> を開き、以下を入力してください（新しいコードは太字で示します）：</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;div id="indexLeftColumn"&gt;
    &lt;div id="welcomeText"&gt;
        &lt;p&gt;[ welcome text ]&lt;/p&gt;

        *&lt;!-- test to access context parameters --&gt;
        categoryImagePath: ${initParam.categoryImagePath}
        productImagePath: ${initParam.productImagePath}*
    &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p>プロジェクトを実行します。[ Run Project (プロジェクトを実行)] ( <span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span> )ボタンをクリックします。プロジェクトのインデックスページがブラウザに表示されます。そして、ページに表示された`categoryImagePath` と <code>productImagePath</code> コンテキストパラメータの値を見てください。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/context-params-browser.png" alt="context params browser">
</div>
<div class="title">Figure 18. Use 'initParam' with JSP EL delimiters to display context parameter values</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jstl">JSTLで作業する</h2>
<div class="sectionbody">
<div class="paragraph">
<p>これまでのところ、この単元であなたは <code>affablebean</code> データベースのデータにアクセスする方法、プロジェクトに画像リソースを追加し、いくつかのコンテキストパラメータを設定することを実施しました。この最後の章では、あなたは、アプリケーションに製品やカテゴリの画像をプラグインしてこれらの成果物をまとめます。それを効果的に行うには、あなたは JavaServer Pages 標準タグライブラリ（JSTL）を利用して始める必要があります。</p>
</div>
<div class="paragraph">
<p>JSTL の JAR ファイル (<code>jstl-impl.jar</code>)を既に存在するプロジェクトのクラスパスに追加することについて心配する必要はありません。<code>AffableBean</code> プロジェクトを作成し、開発サーバとしてGlassFishを選択してある場合は、サーバーのライブラリは自動的にプロジェクトのクラスパスに追加されています。あなたはプロジェクトウィンドウでこれを確認することができます。 <code>AffableBean</code> プロジェクトのライブラリ &gt; GlassFish サーバ３ ノードを展開して、サーバーが提供するすべてのライブラリを表示します。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gf-libraries.png" alt="gf libraries">
</div>
<div class="title">Figure 19. GlassFish libraries are available to your project</div>
</div>
<div class="paragraph">
<p><code>jstl-impl.jar</code> ファイルは、JSTLバージョン 1.2 の GlassFish の実装です。</p>
</div>
<div class="paragraph">
<p>また、個別に GlassFish JSTL の JAR ファイルを次からダウンロードすることができます： <a href="http://jstl.dev.java.net/download.html">http://jstl.dev.java.net/download.html</a></p>
</div>
<div class="paragraph">
<p>involving JSTL（JSTLを含むこと）に着手する前に、 1つの実装の詳細をまず明確にする必要があります。<code>categories</code> と <code>products</code> フォルダに含まれているファイルを調べます。そして、提供された画像ファイルの名前がカテゴリの名前と一致し、データベースに見つかった製品のエントリと一致していることに注意します。これにより、我々がデータベースのデータを利用してページ内に画像ファイルを動的に呼び出すことができます。例えば、ウェブページが broccoli(ブロッコリー)の製品エントリの画像にアクセスする必要がある場合、次の文を使用してこれを行うことができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">${initParam.productImagePath}broccoli.png</code></pre>
</div>
</div>
<div class="paragraph">
<p>JSTL の <code><a href="http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/c/forEach.html">+forEach+</a></code> ループの実装後には、ハードコードされた製品名を、データベースから抽出した製品名の EL 式に動的に置き換えることができるようになり、それをページに挿入します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">${initParam.productImagePath}${product.name}.png</code></pre>
</div>
</div>
<div class="paragraph">
<p>カテゴリの画像をインデックスページに統合することから始めます。そのカテゴリページで作業するときには、選択したカテゴリに付随するデータは動的に処理されます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#indexJSTL">index page</a></p>
</li>
<li>
<p><a href="#categoryJSTL">category page</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="indexJSTL">index page インデックスページ</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>プロジェクトウインドウで、<code>index.jsp</code> ノードをダブルクリックし、index.jsp をエディターに開きます。（すでに開いている場合は、Ctrl-Tab を押しエディターにそれを選びます）。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>ファイルの先頭で、最初の <code>&lt;div&gt;</code> タグの前で、カーソルを空白行に置き、 「<code>db</code>」 を入力し、Ctrl-Space を押します。コード補完ポップアップウインドウが表示されるので、[ DB Query ] を選択します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/db-query.png" alt="db query">
</div>
<div class="title">Figure 20. Type 'db', then press Ctrl-Space to invoke code completion suggestions</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>[Insert DB Query(DBクエリー挿入)]ダイアログの中で、以下の詳細を入力します。：</p>
<div class="ulist">
<ul>
<li>
<p><strong>Variable Name:</strong> <code>categories</code></p>
</li>
<li>
<p><strong>Scope:</strong> <code>page</code></p>
</li>
<li>
<p><strong>Data Source:</strong> <code>jdbc/affablebean</code></p>
</li>
<li>
<p><strong>Query Statement:</strong> <code>SELECT * FROM category</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/insert-db-query.png" alt="insert db query">
</div>
<div class="title">Figure 21. Specify query details to create an SQL query using JSTL &lt;sql:query&gt; tags</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>[ OK ]をクリックします。ダイアログは JSTL <code>&lt;sql:query&gt;</code> タグを使い SQL クエリを生成します。また、注意する必要があります。 そのディレクティブ(指示)が必要とした参照はページの先頭に自動的に挿入されています。（変更箇所は太字で表示されています。 ）</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">*&lt;%@taglib prefix="sql" uri="http://java.sun.com/jsp/jstl/sql"%&gt;*
&lt;%--
    Document   : index
    Created on : Sep 5, 2009, 4:32:42 PM
    Author     : nbuser
--%&gt;

*&lt;sql:query var="categories" dataSource="jdbc/affablebean"&gt;
    SELECT * FROM category
&lt;/sql:query&gt;*

            &lt;div id="indexLeftColumn"&gt;
                &lt;div id="welcomeText"&gt;
                    &lt;p&gt;[ welcome text ]&lt;/p&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>SQLクエリは <code>categories</code> 変数に格納された結果セットを作成します。あなたは、EL構文（すなわち <code>${categories}</code> ) を使用して結果セットにアクセスできます（下記参照）。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>[ <code>&lt;div id="indexRightColumn"&gt;</code> ] の末尾にカーソルを置き( 22行目)、return キーを押し、[ <code>jstl</code> ]と入力して、Ctrl - Spaceを押し、「 JSTL For Each 」を選択します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jstl-for-each.png" alt="jstl for each">
</div>
<div class="title">Figure 22. Type 'jstl', then press Ctrl-Space to invoke code completion suggestions</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>［ Insert JSTL For Each ］ダイアログで、次の詳細を入力してください：</p>
<div class="ulist">
<ul>
<li>
<p><strong>Collection:</strong> <code>${categories.rows}</code></p>
</li>
<li>
<p><strong>Current Item of the Iteration:</strong> <code>category</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/insert-jstl-for-each.png" alt="insert jstl for each">
</div>
<div class="title">Figure 23. Specify details to create a 'for each' loop using JSTL &lt;c:forEach&gt; tags</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>[ OK ] をクリックします。ダイアログは <code>&lt;c:forEach&gt;</code> タグを使い、<code>forEach</code> ループ用の構文をセットアップします。また、注意する必要があります。<code>core</code> <code>taglib</code> ディレクティブ（指令）へ必要とされる参照が、自動的にページの先頭に挿入されています。（変更箇所は太字で表示されます。）</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">*&lt;%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%&gt;*
&lt;%@taglib prefix="sql" uri="http://java.sun.com/jsp/jstl/sql"%&gt;

    ...

    &lt;div id="indexRightColumn"&gt;
        *&lt;c:forEach var="category" items="categories.rows"&gt;
        &lt;/c:forEach&gt;*
        &lt;div class="categoryBox"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>「 <code>rows</code> 」が生成されたコード中の何を参照しているかわからない場合は、 <code>categories</code> 変数が結果セットを表していることを思い出してください。具体的には、 <code>categories</code> は <code><a href="http://java.sun.com/products/jsp/jstl/1.1/docs/api/javax/servlet/jsp/jstl/sql/Result.html">+javax.servlet.jsp.jstl.sql.Result+</a></code> インターフェイスを実装したオブジェクトを参照しています。このオブジェクトは、行、列名にアクセスするためのプロパティと、クエリの結果セットのサイズを提供しています。上記の例のようにドット表記法を使用する時、「 <code>categories.rows</code> 」は Java で「<code>categories.getRows()</code> 」に変換されます</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p><code>&lt;c:forEach&gt;</code> タグをページの中に統合します。<code>&lt;div class="categoryBox"&gt;</code> タグを <code>forEach</code> ループの中にネストすることができます。そうして、HTMLマークアップが4つのカテゴリそれぞれに生成されます。EL構文を使用して、<code>category</code> テーブルの <code>id</code> と、4つのレコードそれぞれの <code>name</code> 列の値を抽出します。<code>forEach</code> ループ外に存在する他の`&lt;div class="categoryBox"&gt;` タグを確実に削除してください。完了したときの完全な <code>index.jsp</code> ファイルは 次のようになります。（<code>&lt;c:forEach&gt;</code> タグと内容は太字で表示されています。）</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%&gt;
&lt;%@taglib prefix="sql" uri="http://java.sun.com/jsp/jstl/sql"%&gt;
&lt;%--
    Document   : index
    Created on : Sep 5, 2009, 4:32:42 PM
    Author     : nbuser
--%&gt;

&lt;sql:query var="categories" dataSource="jdbc/affablebean"&gt;
    SELECT * FROM category
&lt;/sql:query&gt;

            &lt;div id="indexLeftColumn"&gt;
                &lt;div id="welcomeText"&gt;
                    &lt;p&gt;[ welcome text ]&lt;/p&gt;

                    &lt;!-- test to access context parameters --&gt;
                    categoryImagePath: ${initParam.categoryImagePath}
                    productImagePath: ${initParam.productImagePath}
                &lt;/div&gt;
            &lt;/div&gt;

            *&lt;div id="indexRightColumn"&gt;
                &lt;c:forEach var="category" items="${categories.rows}"&gt;
                    &lt;div class="categoryBox"&gt;
                        &lt;a href="category?${category.id}"&gt;

                            &lt;span class="categoryLabelText"&gt;${category.name}&lt;/span&gt;

                            &lt;img src="${initParam.categoryImagePath}${category.name}.jpg"
                                 alt="${category.name}"&gt;
                        &lt;/a&gt;
                    &lt;/div&gt;
                &lt;/c:forEach&gt;
            &lt;/div&gt;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>[ Run Project(プロジェクトを実行)] ( <span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span> )ボタンをクリックします。プロジェクトのインデックスページがブラウザで開きます。あなたは4つのカテゴリの名前と画像を確認して下さい。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/index-category-images.png" alt="index category images">
</div>
<div class="title">Figure 24. 'for each' loop extracts details from the database and utilizes them in the page</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>ブラウザで4つのイメージのいずれかをクリックします。カテゴリページが表示されます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/category-page.png" alt="category page">
</div>
<div class="title">Figure 25. Category images from index page link to category page</div>
</div>
<div class="paragraph">
<p>インデックスとカテゴリのページ間でどのようにリンクが行われるかを理解するには、 <code>forEach</code> ループ内にある HTML アンカータグを再度見直します：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;a href="category?${category.id}"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>ユーザーが&#8217;ブラウザのイメージリンクをクリックする時、<code>category</code> へのリクエストがサーバー上のアプリケーションのコンテキストルートへ送信されます。あなたの開発環境で、URLは：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">http://localhost:8080/AffableBean/category</code></pre>
</div>
</div>
<div class="paragraph">
<p>以下のように説明することができます：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="http://localhost:8080" class="bare">http://localhost:8080</a></code>：コンピュータ上のGlassFishサーバーのデフォルトの場所</p>
</li>
<li>
<p><code>/AffableBean</code>：配置されたアプリケーションのコンテキストルート</p>
</li>
<li>
<p><code>/category</code>: リクエストへのパス</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="page-views-controller.html#controller">ページビューとコントローラサーブレットの準備</a>の中を思い出して下さい。あなたは <code>/category</code> に対するリクエストを <code>ControllerServlet</code> へマッピングしました。現在、<code>ControllerServlet</code> は内部的にリクエストを <code>/WEB-INF/view/category.jsp</code> へ転送します。それが、イメージリンクをクリックするとカテゴリページが表示される理由です。</p>
</div>
<div class="paragraph">
<p>あなたはプロジェクトウィンドウの[ Configuration Files(構成ファイル)]のノードを展開してアプリケーションのコンテキストルートを確認することができます。 <code>sun-web.xml</code> ファイルを開きます。<code>sun-web.xml</code> ファイルは、GlassFishに固有のデプロイメント記述子です。</p>
</div>
<div class="paragraph">
<p>また、注意して下さい。疑問符 (<code>?</code>) と category ID がリクエストURLに追加されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;a href="category*?${category.id}*"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>これは <em>query string</em>(クエリ文字列)でできています。次の章でデモするとおり、あなたは、`(pageContext.request.queryString}`を利用してリクエストからクエリ文字列の値を抽出することができます。次に、クエリ文字列からのカテゴリIDを使い、どのカテゴリーの詳細をレスポンスに入れる必要があるか決定します。</p>
</div>
</div>
<div class="sect2">
<h3 id="categoryJSTL">カテゴリページ</h3>
<div class="paragraph">
<p>カテゴリページの３つの外観を動的に処理する必要があります。左の列は選択されたカテゴリを表示し、テーブル見出しには選択されたカテゴリの名前を表示し、テーブルには選択されたカテゴリに属する製品の詳細情報リストを表示する必要があります。そのために、 JSTL を使用してこれらの外観を実装するために、以下の単純な２ステップのパターンを使うことができます：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>JSTL <code>sql</code> タグライブラリーを使いデータベースからデータを取得します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>JSTL <code>core</code> ライブラリーと ＥＬ構文を使い、データを表示します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>各3つのタスクに個別に取り組む</p>
</div>
<div class="sect3">
<h4 id="_左の列に選択されたカテゴリを表示する">左の列に選択されたカテゴリを表示する</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>プロジェクトウィンドウで、<code>category.jsp</code> ノードをダブルクリックし エディタでそれを開きます。（既に、開いている場合エディタでそれを選択するために Ctrl - Tab を押します。）</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>ファイルの先頭に次のSQLクエリを追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;sql:query var="categories" dataSource="jdbc/affablebean"&gt;
    SELECT * FROM category
&lt;/sql:query&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#categoryIndex">上記で述べたように</a>、 [ Insert DB Query(挿入DBのクエリ)] ダイアログボックスを使用するか、または、入力中にCtrl - Space キーを押してエディタのコード提案と補完機能を使用します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p><code>&lt;div id="categoryLeftColumn"&gt;</code> タグの間で、既存の静的なプレースホルダのコンテンツを、次の`&lt;c:forEach&gt;` ループに置き換えます。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;div id="categoryLeftColumn"&gt;

    *&lt;c:forEach var="category" items="${categories.rows}"&gt;

        &lt;c:choose&gt;
            &lt;c:when test="${category.id == pageContext.request.queryString}"&gt;
                &lt;div class="categoryButton" id="selectedCategory"&gt;
                    &lt;span class="categoryText"&gt;
                        ${category.name}
                    &lt;/span&gt;
                &lt;/div&gt;
            &lt;/c:when&gt;
            &lt;c:otherwise&gt;
                &lt;a href="category?${category.id}" class="categoryButton"&gt;
                    &lt;div class="categoryText"&gt;
                        ${category.name}
                    &lt;/div&gt;
                &lt;/a&gt;
            &lt;/c:otherwise&gt;
        &lt;/c:choose&gt;

    &lt;/c:forEach&gt;*

&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>上記のスニペットでは、&#8216;pageContext.request.queryString&#8217; を使用してリクエストのクエリ文字列にアクセスします。 [ <code>pageContext</code> ] は別の<a href="http://download.oracle.com/docs/cd/E17477_01/javaee/5/tutorial/doc/bnahq.html#bnaij">暗黙オブジェクト</a> で、JSP 式言語で定義されています。EL 式は <code><a href="http://java.sun.com/webservices/docs/1.6/api/javax/servlet/jsp/PageContext.html">+PageContext+</a></code> を使用して、現在のリクエスト（ <code><a href="http://java.sun.com/webservices/docs/1.6/api/javax/servlet/HttpServletRequest.html">+HttpServletRequest+</a></code> オブジェクト）にアクセスします。<code>HttpServletRequest</code> から、<code>getQueryString()</code> メソッドが呼び出され、リクエストのクエリ文字列の値を取得します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>JSTL <code>core</code> と <code>sql</code> <code>taglib</code> ディレクティブをページの先頭へ確実に追加してください 。（これはエディタのコード提案と補完機能を使用した時には自動的に行われます。）</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%&gt;
&lt;%@taglib prefix="sql" uri="http://java.sun.com/jsp/jstl/sql"%&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>プロジェクトを実行します。ブラウザで、カテゴリページへ行き、左の列のカテゴリボタンをクリックします。クリックするたびに、ページが更新され、選択されたカテゴリをハイライトします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/category-page-bakery.png" alt="category page bakery">
</div>
<div class="title">Figure 26. Select categories by clicking category buttons in the left column</div>
</div>
<div class="paragraph">
<p>また、注意して下さい。選択されたカテゴリの ID はページの URL に表示されます。（上の画像では、bakery(パン)のカテゴリが選択され、ブラウザのナビゲーションツールバーのURLに ’`3&#8217; が追加されています。 ）</p>
</div>
<div class="paragraph">
<p>あなたのサーブレットコンテナ（すなわち、 GlassFish は）は、JSP ページをサーブレットに変換します。変換はプロジェクトの一部としてプロジェクトを実行する前に行われます。あなたは JSP ページ用に生成されたサーブレットを表示することができます。プロジェクトウィンドウでページのノードを右クリックし、「 View Servlet (サーブレットを見る)」を選びます。もちろん、最初にプロジェクトを実行する必要があります。そうしてサーブレットが生成されます。例として、 <code>index.jsp</code> ファイルを取り上げます。あなたが View Servlet (サーブレットを見る)を選択したとき、IDE は生成されたサーブレット、つまり <code>index_jsp.java</code> の読み取り専用コピーをエディターに表示します。 サーブレットはサーバー上のここにあります：</p>
</div>
<div class="paragraph">
<p><code><em>&lt;gf-install-dir&gt;</em>/glassfish/domains/domain1/generated/jsp/AffableBean/org/apache/jsp/index_jsp.java</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ideのデバッガを使用して暗黙オブジェクトの値を調べる">IDEのデバッガを使用して、暗黙オブジェクトの値を調べる</h3>
<div class="paragraph">
<p>あなたは、暗黙的なオブジェクトの値を調べるために IDE Java デバッガを使用することができます。これを行うには、JSP ページの JSP や JSTL 構文のある行にブレークポイントを設定しデバッガを実行ます。デバッガがブレークポイントで中断した時に、変数ウィンドウ（ウィンドウ &gt; デバッグ &gt; 変数）を開いて、現在のアプリケーションで保持されている値を検査することができます。</p>
</div>
<div class="paragraph">
<p>例として、あなたの <code>category.jsp</code> の現在の実装を取り上げます。次の手順を実行します：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>それを含む行にブレークポイントを設定する：</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;c:when test="${category.id == pageContext.request.queryString}"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>（ブレークポイントを設定するために、行の左マージンをクリックします。ブレークポイント ( <span class="image"><img src="images/breakpoint-icon.png" alt="breakpoint icon"></span> ) アイコンが表示されます。 ）</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>IDEのメインツールバーで、 [Debug Project デバッグプロジェクト] ( <span class="image"><img src="images/debug-project-btn.png" alt="debug project btn"></span> )ボタンをクリックします。デバッグセッションがプロジェクトに対してアクティブ化され、アプリケーションのインデックスページがブラウザに開きます。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>インデックスページで bakery (パン)のカテゴリをクリックします。（あなたは、bakery (パン)のカテゴリIDが ’<code>3</code>’ であることを知っています）。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>IDE に戻り、デバッガがブレークポイントの行で中断していることに注意します。中断している時、マージンはブレークポイント ( <span class="image"><img src="images/debugger-suspended-icon.png" alt="debugger suspended icon"></span> ) で緑色の多印を表示しています。そして、その行は緑の背景で表示されています。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>変数ウインドウを開いて（Ctrl-Shift-1）、暗黙オブジェクト Implicit Objects &gt; pageContext &gt; request &gt; queryString ノードを展開します。変数の値を調べ、変数の値が ' <code>3</code> ' でそれはあなたが選択した category ID に対応していることに注意します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Finish Debugger Session (デバッガセッションを終了する)] ( <span class="image"><img src="images/finish-debugger-session-btn.png" alt="finish debugger session btn"></span> )ボタンを押して、デバッガセッションを狩猟します。</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_製品テーブルの上にある見出しを表示する">製品テーブルの上にある見出しを表示する</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ファイルの先頭で、あなたがまさにインプリメントしたクエリーの下に、以下の SQL クエリーを追加します。（新しいクエリは太字で表示されています。）</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;sql:query var="categories" dataSource="jdbc/affablebean"&gt;
    SELECT * FROM category
&lt;/sql:query&gt;

*&lt;sql:query var="selectedCategory" dataSource="jdbc/affablebean"&gt;
    SELECT name FROM category WHERE id = ?
    &lt;sql:param value="${pageContext.request.queryString}"/&gt;
&lt;/sql:query&gt;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>JSPのEL構文を使用してクエリからカテゴリ名を抽出し、それをページに表示します。<code>&lt;p id="categoryTitle"&gt;</code> 要素に以下のように変更します。（太字で表示されています。）</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;p id="categoryTitle"&gt;*${selectedCategory.rows[0].name}*&lt;/p&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>[ <code>selectedCategory</code> ] クエリの結果には、1つのアイテムだけが入っています。（つまり、 ユーザはただ一つのカテゴリを選択できます）。「 <code>selectedCategory*.rows[0]<strong></code> 」を使い、結果セットの最初の行を取り出すことができます。例えば、ユーザーが「 'meats(肉)'」カテゴリを選択した場合、返される式は「&#8216;{name=meats}&#8217;」になります。その後はカテゴリ名 「 <code>${selectedCategory.rows[0]</strong>.name*}</code> 」でアクセスできます。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>ファイルに加えた変更を保存します（ Ctrl - S 、 ⌘ - S Mac）。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>ブラウザに戻り、カテゴリページを更新します。今選択したカテゴリの名前が製品テーブルの上に表示されます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/category-page-bakery-title.png" alt="category page bakery title">
</div>
<div class="title">Figure 27. The name of the selected category dynamically displays above the product table</div>
</div>
<div class="paragraph">
<p>*注： * これと前の手順で示したように、あなたは明示的に再コンパイル、配置する必要はありません。あなたはコードベースを変更するたびにプロジェクトを実行します。 IDE は「 a Deploy on Save(保存と配置）」機能を提供しています。この機能は Java Webプロジェクトではデフォルトで有効になっています。この機能が有効になっているか確認するには、プロジェクトウィンドウで、プロジェクトノードを右クリックし、[プロパティ]を選択します。プロジェクトプロパティ ウィンドウで、 [Run category]をクリックし、[ 'Deploy on Save'] オプションを調べます。</p>
</div>
</div>
<div class="sect3">
<h4 id="_テーブル内で製品の詳細を表示する">テーブル内で製品の詳細を表示する</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>あなたが前に実装したクエリーの下で、そのファイルの先頭に次のSQLクエリを追加します。（新しいクエリは太字で表示されています。）</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;sql:query var="categories" dataSource="jdbc/affablebean"&gt;
    SELECT * FROM category
&lt;/sql:query&gt;

&lt;sql:query var="selectedCategory" dataSource="jdbc/affablebean"&gt;
    SELECT name FROM category WHERE id = ?
    &lt;sql:param value="${pageContext.request.queryString}"/&gt;
&lt;/sql:query&gt;

*&lt;sql:query var="categoryProducts" dataSource="jdbc/affablebean"&gt;
    SELECT * FROM product WHERE category_id = ?
    &lt;sql:param value="${pageContext.request.queryString}"/&gt;
&lt;/sql:query&gt;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p><code>&lt;table id="productTable"&gt;</code> タグの間で、既存の静的テーブルの行のプレースホルダ (<code>&lt;tr&gt;</code> タグ) を以下の`&lt;c:forEach&gt;` ループに置き換えます。（変更は太字で表示されています。）</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;table id="productTable"&gt;

    *&lt;c:forEach var="product" items="${categoryProducts.rows}" varStatus="iter"&gt;

        &lt;tr class="${((iter.index % 2) == 0) ? 'lightBlue' : 'white'}"&gt;
            &lt;td&gt;
                &lt;img src="${initParam.productImagePath}${product.name}.png"
                    alt="image of ${product.name}"&gt;
            &lt;/td&gt;
            &lt;td&gt;
                ${product.name}
                &lt;br&gt;
                &lt;span class="smallText"&gt;${product.description}&lt;/span&gt;
            &lt;/td&gt;
            &lt;td&gt;
                &amp;amp;euro; ${product.price} / unit
            &lt;/td&gt;
            &lt;td&gt;
                &lt;form action="addToCart" method="post"&gt;
                    &lt;input type="hidden"
                           name="productId"
                           value="${product.id}"&gt;
                    &lt;input type="submit"
                           value="add to cart"&gt;
                &lt;/form&gt;
            &lt;/td&gt;
        &lt;/tr&gt;

    &lt;/c:forEach&gt;*

&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>注。上記のスニペットの EL 式はテーブルの行の背景色を決定するために使用されます：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">class="${((iter.index % 2) == 0) ? 'lightBlue' : 'white'}"</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><a href="http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/c/forEach.html">+&lt;c:forEach&gt;+</a></code> タグの API ドキュメントには、「<code>varStatus</code> 属性は <code><a href="http://java.sun.com/products/jsp/jstl/1.1/docs/api/javax/servlet/jsp/jstl/core/LoopTagStatus.html">+LoopTagStatus+</a></code> インターフェイスを実装するオブジェクトを表す。」と書かれています。したがって、<code>iter.index</code> は現在の一連のイテレーション（繰り返し）のインデックスを取得します。継続式で、 <code>(iter.index % 2) == 0)</code> は、 <code>iter.index</code> を`2` で割った時の余りを評価し、結果に基づいたブール値（True, False)を返します。最後に、 ELの条件演算子 (<code>? :</code>) は、もし true の場合、返される値を「 &#8216;lightBlue&#8217; 」に設定するために使用されます。それ以外の場合は「 &#8216;white&#8217;」に設定します。</p>
</div>
<div class="paragraph">
<p>JSP 式言語の演算子の説明については、 Java EE 5のチュートリアル： <a href="http://download.oracle.com/docs/cd/E17477_01/javaee/5/tutorial/doc/bnahq.html#bnaik">JavaServer Pages Technology &gt; Unified Expression Language &gt; Operators</a> を見てください。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>ファイルに加えた変更を保存します。（ Ctrl - S、 ⌘ - S Mac）</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>ブラウザに戻り、カテゴリページを更新します。製品の詳細が選択したカテゴリのテーブルに表示されます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/category-page-bakery-product-table.png" alt="category page bakery product table">
</div>
<div class="title">Figure 28. Product details are dynamically displayed for the selected category</div>
</div>
<div class="paragraph">
<p>あなたは今、このチュートリアルの単元を完了したところです。その中で、以下のことを調査しました。サーバー上にコネクションプールとデータソースを設定して、アプリケーションとデータベースを接続する方法、そしてアプリケーションからデータソースを参照しました。また、いくつかのコンテキストパラメータを作成し、どのように JSP ページからそれらにアクセスするかを学びました。最後に、アプリケーションの Web ページに JSTL タグを実装しました。それにより、データベースのデータを動的に取得し表示できました。</p>
</div>
<div class="paragraph">
<p>もしあなたがあなたの作業とプロジェクトのソリューションを比較したい場合、あなたはダウンロードして調べることができます。<a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fecommerce%252FAffableBean_snapshot3.zip">+ AffableBean_snapshot3.zip+</a>。
プロジェクトの完成版には、提供された画像をすべて適切に表示する HTML マークアップとスタイルシートの機能強化が含まれています。それはまた、ウェルカムページのテキストとそのページフッターに基本的な実装を提供しています。</p>
</div>
<div class="paragraph">
<p>link:/about/contact_form.html?to=3&amp;subject=Feedback: NetBeans E-commerce Tutorial - Connecting the Application to the Database[ご意見をお寄せ下さい]</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="troubleshoot">トラブルシューティング</h2>
<div class="sectionbody">
<div class="paragraph">
<p>あなたが問題を抱えている場合、以下のトラブルシューティングのヒントを見てください。引き続き問題を持っているか、または建設的なフィードバックを提供したい場合は、「フィードバックを送る」リンクを使用します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>次の例外が発生： You receive the following exception:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">org.apache.jasper.JasperException: PWC6188: The absolute uri: http://java.sun.com/jsp/jstl/core cannot be resolved in either web.xml or the jar files deployed with this application</code></pre>
</div>
</div>
<div class="paragraph">
<p>これは NetBeans6.9 IDE の<a href="https://netbeans.org/bugzilla/show_bug.cgi?id=188406">既知の問題</a>。プロジェクトを展開し、ブラウザにそのURLを入力してファイルにアクセスしてください。たとえば、ブラウザで <code>testDataSource.jsp</code> を表示しようとしている場合 、 ブラウザのURLフィールドに直接「 &#8216;<a href="http://localhost:8080/AffableBean/test/testDataSource.jsp&#8217;」を入力してください。それ以外の場合は、IDE" class="bare">http://localhost:8080/AffableBean/test/testDataSource.jsp&#8217;」を入力してください。それ以外の場合は、IDE</a> JSTL 1.1 ライブラリをプロジェクトに追加します。プロジェクトウィンドウで、ライブラリのノードを右クリックし、[ Add Library (ライブラリを追加) ] を選択し、[ JSTL 1.1 ] を選択します。詳細については以下を参照してください： <a href="http://forums.netbeans.org/topic28571.html">http://forums.netbeans.org/topic28571.html</a>。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>次の例外が発生： You receive the following exception:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">javax.servlet.ServletException: javax.servlet.jsp.JspException: Unable to get connection, DataSource invalid: "java.sql.SQLException: Error in allocating a connection. Cause: Class name is wrong or classpath is not set for : com.mysql.jdbc.jdbc2.optional.MysqlDataSource"</code></pre>
</div>
</div>
<div class="paragraph">
<p>これは、 MySQL ドライバをドメイン <code>lib</code> フォルダに追加していない場合に発生することがあります。（追加後、サーバーが実行中の場合、再起動が必要なことに注意。）</p>
</div>
<div class="ulist">
<ul>
<li>
<p>次の例外が発生： You receive the following exception:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">javax.servlet.ServletException: javax.servlet.jsp.JspException: Unable to get connection, DataSource invalid: "java.sql.SQLException: No suitable driver found for jdbc/affablebean"</code></pre>
</div>
</div>
<div class="paragraph">
<p>これは、<code>jdbc/affablebean</code> リソース参照が <code>web.xml</code> のデプロイメント記述子に追加されていないときに発生します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>次の例外が発生： You receive the following exception:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">javax.servlet.ServletException: javax.servlet.jsp.JspException: Unable to get connection, DataSource invalid: "java.sql.SQLException: Error in allocating a connection. Cause: Connection could not be allocated because: Access denied for user 'root'@'localhost' (using password: YES)"</code></pre>
</div>
</div>
<div class="paragraph">
<p>これは、間違ったユーザ名/パスワードの組み合わせの時に発生します。MySQLサーバに接続するために使用するユーザー名とパスワードが <code>sun-resources.xml</code> ファイルのコネクションプールに正しく設定されているか確認して下さい。また、ユーザ名とパスワードが GlassFish 管理コンソールのコネクションプールに正しく設定されているかチェックしてください。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="seeAlso">関連項目</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_netbeans_リソース">NetBeans リソース</h3>
<div class="ulist">
<ul>
<li>
<p><a href="../../ide/mysql_ja.html">MySQL データベースへの接続</a></p>
</li>
<li>
<p><a href="../../web/quickstart-webapps_ja.html">Web アプリケーション開発入門</a></p>
</li>
<li>
<p><a href="../../web/mysql-webapp_ja.html">MySQL データベースを使用した単純な Web アプリケーションの作成</a></p>
</li>
<li>
<p><a href="../../ide/database-improvements-screencast.html">スクリーンキャスト：NetBeans 6.5 用のデータベースサポートの改善</a></p>
</li>
<li>
<p><a href="http://refcardz.dzone.com/refcardz/netbeans-java-editor-68">NetBeans Java エディタ 6.8 リファレンスカード</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_mysql_リソース">MySQL リソース</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://dev.mysql.com/librarian/">MySQL コミュニティ ライブラリー</a></p>
</li>
<li>
<p><a href="http://dev.mysql.com/doc/refman/5.1/en/">MySQL 5.1 リファレンスマニュアル</a></p>
</li>
<li>
<p><a href="http://www.mysql.com/why-mysql/java/#howtos">MySQL と Java</a></p>
</li>
<li>
<p><a href="http://forums.mysql.com/">+ MySQL フォーラム+</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_jsp_el_リソース">JSP ＆ EL リソース</h3>
<div class="ulist">
<ul>
<li>
<p><strong>製品ページ：</strong> <a href="http://java.sun.com/products/jsp/">+JavaServer Pages テクノロジー +</a></p>
</li>
<li>
<p><strong>仕様のダウンロード：</strong> <a href="http://jcp.org/aboutJava/communityprocess/mrel/jsr245/index.html">JSR 245: JSP と EL 2.2 メンテナンスリリース</a></p>
</li>
<li>
<p><strong>APIのドキュメント：</strong> <a href="http://java.sun.com/products/jsp/2.1/docs/jsp-2_1-pfd2/index.html">JavaServer Pages 2.1 API ドキュメント</a></p>
</li>
<li>
<p>Java EE 5 チュートリアル -第5章：JavaServer Pagesテクノロジー <strong>ドキュメント サポート：</strong> <a href="http://download.oracle.com/docs/cd/E17477_01/javaee/5/tutorial/doc/bnagx.html">Java EE 5 チュートリアル - 第5章: JavaServer Pages テクノロジー</a></p>
</li>
<li>
<p><strong>シンタックスリファレンス：</strong> <a href="http://java.sun.com/products/jsp/syntax/2.0/syntaxref20.html">JavaServer Pages 2.0 構文のリファレンス</a></p>
</li>
<li>
<p><strong>公式フォーラム：</strong> <a href="http://forums.sun.com/forum.jspa?forumID=45">Web 層 API - JavaServer Pages (JSP) と JSTL</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_jstl_リソース">JSTL リソース</h3>
<div class="ulist">
<ul>
<li>
<p>JavaServer Pages 標準タグライブラリ <strong>製品ページ：</strong> <a href="http://java.sun.com/products/jsp/jstl/">JavaServer Pages 標準タグ ライブラリー</a></p>
</li>
<li>
<p><strong>仕様のダウンロード:</strong> <a href="http://jcp.org/aboutJava/communityprocess/final/jsr052/index2.html">+JSR 52: JSTL 1.2 メンテナンスリリース +</a></p>
</li>
<li>
<p><strong>実装のダウンロード：</strong> <a href="http://jstl.dev.java.net/download.html">GlassFish JSTL プロジェクトダウンロード</a></p>
</li>
<li>
<p><strong>タグライブラリ ドキュメント:</strong> <a href="http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/index.html">JSTL 1.1 タグ リファレンス</a></p>
</li>
<li>
<p><strong>API ドキュメント:</strong> <a href="http://java.sun.com/products/jsp/jstl/1.1/docs/api/index.html">JSTL 1.1 API リファレンス</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_技術記事とリファレンスカード">技術記事とリファレンスカード</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://java.sun.com/developer/technicalArticles/javaserverpages/JSP20/">JavaServer Pages 2.0で Web アプリケーションの開発 Developing Web Applications With JavaServer Pages 2.0</a></p>
</li>
<li>
<p><a href="http://java.sun.com/developer/technicalArticles/J2EE/jsp_21/">Java EE 5 で ウェブ層へ行く：JSP 2.1 新機能の概要 Web Tier to Go With Java EE 5: Summary of New Features in JSP 2.1 Technology</a></p>
</li>
<li>
<p><a href="http://java.sun.com/products/jsp/reference/techart/unifiedEL.html">統一式言語 Unified Expression Language</a></p>
</li>
<li>
<p><a href="http://today.java.net/pub/a/today/2003/10/07/jstl1.html">実用的なJSTL、第1回 Practical JSTL, Part 1</a></p>
</li>
<li>
<p><a href="http://java.sun.com/products/jsp/syntax/2.0/card20.pdf">JavaServer Pages v2.0 の構文カード JavaServer Pages v2.0 Syntax Card</a></p>
</li>
<li>
<p><a href="http://refcardz.dzone.com/refcardz/essential-jsp-expression">エッセンシャル JSP 式言語のリファレンスカード Essential JSP Expression Language Reference Card</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/ecommerce/connect-db_ja.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
