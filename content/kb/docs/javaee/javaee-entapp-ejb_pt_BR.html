
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Criando uma Aplicação Corporativa com o EJB 3.1</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Criando uma Aplicação Corporativa com o EJB 3.1 - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Criando uma Aplicação Corporativa com o EJB 3.1">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>

  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 19</h1>
            <p><a class="button success" href="/download/nb19/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">Criando uma Aplicação Corporativa com o EJB 3.1</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/javaee-entapp-ejb_pt_BR.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_sobre_a_aplicação_corporativa_newsapp">Sobre a Aplicação Corporativa NewsApp</a></li>
<li><a href="#_criando_o_projeto_da_aplicação_corporativa">Criando o Projeto da Aplicação Corporativa</a></li>
<li><a href="#_codificando_o_módulo_ejb">Codificando o Módulo EJB</a>
<ul class="sectlevel2">
<li><a href="#_criando_a_classe_de_entidade">Criando a Classe de Entidade</a></li>
<li><a href="#_criando_o_bean_baseado_em_mensagens">Criando o Bean Baseado em Mensagens</a></li>
<li><a href="#_criando_a_fachada_da_sessão">Criando a Fachada da Sessão</a></li>
</ul>
</li>
<li><a href="#_codificando_o_módulo_web">Codificando o Módulo Web</a>
<ul class="sectlevel2">
<li><a href="#_criando_o_bean_de_sessão_único">Criando o Bean de Sessão Único</a></li>
<li><a href="#_criando_o_servlet_listnews">Criando o Servlet  <code>ListNews</code></a></li>
<li><a href="#_criando_o_servlet_postmessage">Criando o Servlet  <code>PostMessage</code></a></li>
</ul>
</li>
<li><a href="#_executando_o_projeto">Executando o Projeto</a></li>
<li><a href="#_fazendo_download_do_projeto_da_solução">Fazendo Download do Projeto da Solução</a></li>
<li><a href="#_solução_de_problemas">Solução de Problemas</a>
<ul class="sectlevel2">
<li><a href="#_problema_com_os_recursos_jms">Problema com os Recursos JMS</a></li>
</ul>
</li>
<li><a href="#_consulte_também">Consulte Também</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Este tutorial apresenta os conceitos básicos de desenvolvimento de uma aplicação corporativa Java EE 6 e demonstra algumas das funcionalidades da tecnologia EJB 3.1 que foram introduzidos como parte da especificação Java EE 6. Neste tutorial, você criará uma aplicação corporativa que permite a um usuário publicar uma mensagem e recuperá-la de um banco de dados.</p>
</div>
<div class="paragraph">
<p>A aplicação contém um módulo EJB e um módulo web. O módulo EJB contém uma classe de entidade, uma fachada de sessão para a classe de entidade e um bean baseado em mensagens. O módulo web contém servlets para exibir e publicar mensagens, além de um bean de sessão simples que soma o número de usuários na sessão.</p>
</div>
<div class="paragraph">
<p>Antes de começar este tutorial, pode ser necessário se familiarizar com o seguinte documento.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javaee-gettingstarted.html">Conceitos Básicos sobre Aplicações do Java EE</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Exercícios do Tutorial</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#intro">Sobre a Aplicação Corporativa NewsApp</a></p>
</li>
<li>
<p><a href="#Exercise_1">Criando o Projeto de Aplicação Corporativa</a></p>
</li>
<li>
<p><a href="#Exercise_2">Codificando o Módulo EJB</a></p>
</li>
<li>
<p><a href="#Exercise_2a">Criando a Classe de Entidade</a></p>
</li>
<li>
<p><a href="#Exercise_2b">Criando o Bean Baseado em Mensagens</a></p>
</li>
<li>
<p><a href="#Exercise_2c">Criando a Fachada da Sessão</a></p>
</li>
<li>
<p><a href="#Exercise_3">Codificando o Módulo Web</a></p>
</li>
<li>
<p><a href="#Exercise_3a">Criando o Bean de Sessão Simples</a></p>
</li>
<li>
<p><a href="#Exercise_3b">Criando o Servlet ListNews</a></p>
</li>
<li>
<p><a href="#Exercise_3c">Criando o Servlet PostMessage</a></p>
</li>
<li>
<p><a href="#Exercise_4">Executando o Projeto</a></p>
</li>
<li>
<p><a href="#Exercise_5">Fazendo Download do Projeto da Solução</a></p>
</li>
<li>
<p><a href="#Exercise_6">Solução de Problemas</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Para seguir este tutorial, são necessários os recursos e o software a seguir.</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software ou Recurso</th>
<th class="tableblock halign-left valign-top">Versão Necessária</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">NetBeans IDE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Versão Java EE 7.2, 7.3, 7.4, 8.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK (Java Development Kit)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">versão 7 ou 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GlassFish Server Open Source Edition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.x, 4.x</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Pré-requisitos</strong></p>
</div>
<div class="paragraph">
<p>Este tutorial pressupõe que você tenha algum conhecimento básico das tecnologias a seguir, ou alguma experiência de programação com elas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Programação em Java</p>
</li>
<li>
<p>NetBeans IDE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Você pode fazer download <a href="https://netbeans.org/projects/samples/downloads/download/Samples/JavaEE/NewsAppEE6.zip">de um arquivo compactado zip do projeto finalizado</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sobre_a_aplicação_corporativa_newsapp">Sobre a Aplicação Corporativa NewsApp</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Neste tutorial, você criará um exemplo simples de uma aplicação corporativa Java EE 6 com várias camadas denominado NewsApp. A aplicação NewsApp usa algumas das funcionalidades apresentadas na especificação Java EE 6.</p>
</div>
<div class="paragraph">
<p>A estrutura da aplicação NewsApp corresponde, geralmente, às seguintes camadas.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Camada Web.</strong> A Camada Web contém a lógica de apresentação da aplicação e é executada no servidor Java EE. Na aplicação NewsApp, a camada Web é representada pelo módulo web e contém servlets que acessam a lógica de negócios no módulo EJB.</p>
</li>
<li>
<p><strong>Camada de Negócios.</strong> Aplicações de Camadas de Negócios também são executadas em servidores Java EE e contêm a lógica de negócios da aplicação. Na aplicação NewsApp, a Camada de Negócios é representada pelo módulo EJB. O módulo EJB contém o código que trata as solicitações dos clientes da Camada Web, além de gerenciar transações e como os objetos serão persistidos no banco de dados.</p>
</li>
<li>
<p><strong>Camada EIS.</strong> A Camada EIS é a camada de armazenamento persistente da aplicação. Na Aplicação NewsApp, esta camada é representada pelo banco de dados no qual as mensagens estão armazenadas.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Quando você constrói uma aplicação corporativa no IDE, os módulos EJB e aplicação Web são encapsulados em um arquivo compactado EAR que é, em seguida, implantado no servidor. A aplicação será, em seguida, normalmente acessada da <strong>Camada do Cliente.</strong> A Camada do Cliente é o ambiente em que o cliente é executado e é normalmente um browser web no sistema local do usuário.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
No exemplo deste tutorial, você usará uma única máquina para hospedar o servidor Java EE, o banco de dados e visualizar as páginas web. Em aplicações do enterprise grandes, as diferentes camadas estão, em geral, distribuídas em várias máquinas. As aplicações de Camada Web e Camada de Negócios são geralmente implantadas nos servidores Java EE que estão hospedados em diferentes máquinas.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Para obter mais detalhes sobre a estrutura de aplicações do enterprise Java EE, consulte o capítulo sobre <a href="http://download.oracle.com/javaee/6/tutorial/doc/bnaay.html">Aplicações Distribuídas em Várias camadas</a> no <a href="http://download.oracle.com/javaee/6/tutorial/doc/">Tutorial do Java EE 6, Parte I</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_criando_o_projeto_da_aplicação_corporativa">Criando o Projeto da Aplicação Corporativa</h2>
<div class="sectionbody">
<div class="paragraph">
<p>O objetivo deste exercício é criar o novo projeto da aplicação corporativa NewsApp. Você usará o assistente Novo Projeto para criar uma aplicação corporativa que contenha um módulo EJB e um módulo web.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Selecione Arquivo &gt; Novo Projeto (Ctrl-Shift-N; ⌘-Shift-N no Mac) no menu principal.</p>
</li>
<li>
<p>Selecione Aplicação Corporativa na categoria Java EE e clique em Próximo.</p>
</li>
<li>
<p>Nomeie o projeto de <strong>NewsApp</strong> e defina a localização do projeto.</p>
</li>
<li>
<p>Desmarque a opção Usar Pasta Dedicada, se ela estiver selecionada.
(Para este tutorial, não há motivo para copiar as bibliotecas de projeto em uma pasta dedicada, pois você não precisará compartilhar bibliotecas com outros usuários ou projetos).
Clique em Próximo.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Defina o servidor como GlassFish Server e defina a versão do Java EE para Java EE 6 ou Java EE 7.</p>
</li>
<li>
<p>Selecione Criar Módulo EJB e Criar Módulo de Aplicação Web. Clique em Finalizar.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new-entapp-wizard.png" alt="new entapp wizard">
</div>
<div class="title">Figure 1. Assistente Novo Projeto</div>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, o IDE cria três projetos: NewsApp, NewsApp-ejb e NewsApp-war. Se expandir o nó NewsApp na janela Projetos, você poderá ver que o projeto da aplicação corporativa não contém nenhum código-fonte. Todos os códigos-fonte estarão contidos nos dois módulos que o assistente criou e que estão listados no nó Módulos Java EE.</p>
</div>
<div class="paragraph">
<p>O projeto de aplicação corporativa só contém detalhes de configuração e encapsulamento sobre a aplicação. Quando você cria e executa uma aplicação corporativa, o IDE cria um archive EAR e implanta o EAR no servidor. Em alguns casos, o projeto de aplicação corporativa conterá os arquivos do descritor de implantação com informações adicionais, mas esses arquivos não serão necessários durante a criação de uma aplicação corporativa Java EE que seja implantado no GlassFish Server.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ejb-projectswindow.png" alt="ejb projectswindow">
</div>
<div class="title">Figure 2. Janela Projetos mostrando a estrutura da aplicação</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_codificando_o_módulo_ejb">Codificando o Módulo EJB</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Neste exercício, você criará uma classe de entidade, um bean de sessão baseado em mensagens e uma fachada de sessão no módulo EJB. Você também criará uma unidade de persistência para fornecer ao contêiner informações sobre a fonte de dados e como as entidades são gerenciadas, bem como os recursos Java Message Service (JMS) que são usados pelo bean baseado em mensagens.</p>
</div>
<div class="sect2">
<h3 id="_criando_a_classe_de_entidade">Criando a Classe de Entidade</h3>
<div class="paragraph">
<p>Neste exercício, você criará a classe de entidade  <code>NewsEntity</code> . Uma classe de entidade é uma classe Java simples que geralmente representa uma tabela em um banco de dados. Quando você cria a classe de entidade, o IDE adiciona a anotação  <code>@Entity</code>  para definir a classe como uma classe de entidade. Depois de criar a classe, você criará campos na classe para representar os dados que deseja incluir na tabela.</p>
</div>
<div class="paragraph">
<p>Cada classe de entidade deve ter uma chave primária. Quando você cria a classe de entidade, o IDE adiciona a anotação  <code>@Id</code>  para declarar o campo a ser usado como chave primária. O IDE também adiciona a anotação  <code>@GeneratedValue</code>  e especifica a estratégia de geração de chave para o Id primário.</p>
</div>
<div class="paragraph">
<p>Para criar a classe  <code>NewsEntity</code> , execute as seguintes etapas.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no módulo EJB na janela Projetos e selecione Novo &gt; Outro para abrir o assistente Novo arquivo.</p>
</li>
<li>
<p>Na categoria Persistência, selecione Classe de Entidade e clique em Próximo.</p>
</li>
<li>
<p>Digite <strong>NewsEntity</strong> para Nome da Classe.</p>
</li>
<li>
<p>Digite <strong>ejb</strong> para o Pacote.</p>
</li>
<li>
<p>Deixe Tipo de Chave Primária como  <code>Longo</code>  no assistente Nova Classe de Entidade.</p>
</li>
<li>
<p>Selecione Criar Unidade de Persistência. Clique em Próximo.</p>
</li>
<li>
<p>Preserve o Nome default da Unidade de Persistência.</p>
</li>
<li>
<p>Para o Provedor de Persistência, selecione  <code>EclipseLink (JPA2.0)(default)</code> .</p>
</li>
<li>
<p>Para Fonte de Dados, selecione uma fonte de dados (por exemplo, selecione  <code>jdbc/sample</code>  se quiser usar JavaDB).</p>
</li>
<li>
<p>Confirme que a unidade de persistência está utilizando a Java Transaction API e que Estratégia de Geração de Tabela está definida como Criar, de forma que as tabelas com base nas suas classes de entidade serão criadas quando a aplicação for implantada.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new-pu-wizard.png" alt="new pu wizard">
</div>
<div class="title">Figure 3. Provedor e painel de Banco de Dados</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, o IDE cria  <code>persistence.xml</code>  e a classe de entidade  <code>NewsEntity.java</code> . O IDE abre  <code>NewsEntity.java</code>  no Editor de Código-Fonte.</p>
</div>
<div class="paragraph">
<p>No Editor de Código-Fonte, execute as etapas a seguir.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione as seguintes declarações de campo à classe:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private String title;
private String body;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no Editor de Código-Fonte e selecione Inserir Código (Alt-Insert; Ctrl-I no Mac) e selecione Getter e Setter para abrir a caixa de diálogo Gerar Getters e Setters.</p>
</li>
<li>
<p>Selecione os campos  <code>body</code>  e  <code>title</code>  na caixa de diálogo. Clique em Gerar.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ejb-gettersetter.png" alt="ejb gettersetter">
</div>
<div class="title">Figure 4. Caixa de diálogo Gerar Getters e Setters</div>
</div>
<div class="paragraph">
<p>Quando você clica em Gerar, o IDE adiciona os métodos getter e setter nos campos.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Salve as alterações em  <code>NewsEntity.java</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Você pode fechar  <code>NewsEntity.java</code> .</p>
</div>
<div class="paragraph">
<p>Para saber mais sobre classes de entidade, consulte o capítulo <a href="http://java.sun.com/javaee/6/docs/tutorial/doc/bnbpz.html">Introdução à Java Persistence API</a> no <a href="http://download.oracle.com/javaee/6/tutorial/doc/">Tutorial do Java EE 6 , Parte I</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_criando_o_bean_baseado_em_mensagens">Criando o Bean Baseado em Mensagens</h3>
<div class="paragraph">
<p>Neste exercício, você usará um assistente para criar o bean baseado em mensagens no módulo EJB. O assistente também o ajudará a criar os recursos JMS necessários. O bean baseado em mensagens recebe e processa mensagens enviadas para a fila por um servlet no módulo Web.</p>
</div>
<div class="paragraph">
<p>Para criar o bean baseado em mensagens, execute as seguintes etapas:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no módulo EJB na janela Projetos e selecione Novo &gt; Outro para abrir o assistente Novo arquivo.</p>
</li>
<li>
<p>Na categoria Enterprise JavaBens, selecione o tipo de arquivo Bean Baseado em Mensagens. Clique em Próximo.</p>
</li>
<li>
<p>Digite <strong>NewMessage</strong> para Nome EJB.</p>
</li>
<li>
<p>Selecione  <code>ejb</code>  na lista drop-down Pacote.</p>
</li>
<li>
<p>Clique no botão Adicionar ao lado do campo Destino do Projeto para abrir a caixa de diálogo Adicionar Destino da Mensagem.</p>
</li>
<li>
<p>Na caixa de diálogo Adicionar Destino da Mensagem, digite <strong>jms/NewMessage</strong> e selecione Fila como o tipo de destino. Clique em OK.</p>
</li>
<li>
<p>Confirme se o destino do projeto está correto. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ejb-newmessage.png" alt="ejb newmessage">
</div>
<div class="title">Figure 5. Assistente Novo Bean Baseado em Mensagens</div>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, a classe  <code>NewMessage.java</code>  do bean será aberta no Editor de Código-Fonte. Você pode ver que o IDE adicionou a anotação  <code>@MessageDriven</code>  e as propriedades de configuração à classe.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@MessageDriven(mappedName = "jms/NewMessage", activationConfig =  {
        @ActivationConfigProperty(propertyName = "acknowledgeMode", propertyValue = "Auto-acknowledge"),
        @ActivationConfigProperty(propertyName = "destinationType", propertyValue = "javax.jms.Queue")
    })
public class NewMessage implements MessageListener {</code></pre>
</div>
</div>
<div class="paragraph">
<p>A anotação  <code>@MessageDriven</code>  informa ao contêiner que o componente é um bean baseado em mensagens e especifica o recurso JMS usado pelo bean. Quando o IDE gera a classe, o Nome Mapeado do recurso ( <code>jms/NewMessage</code> ) é derivado do nome da classe ( <code>NewMessage.java</code> ). O recurso JMS é mapeado para o nome JNDI do destino do qual o bean recebe mensagens. O assistente Novo Bean Baseado em Mensagens também adiciona as informações dos recursos JMS ao  <code>glassfish-resources.xml</code> . Não é necessário configurar os descritores de implantação para especificar os recursos JMS. Se usar a ação Executar no IDE para implantar a aplicação no GlassFish, os recursos JMS serão criados no servidor na implantação.</p>
</div>
<div class="paragraph">
<p>As especificações do EJB permitem que você use anotações para introduzir recursos diretamente em uma classe. Agora você usará anotações para introduzir o recurso  <code>MessageDrivenContext</code>  em sua classe e, em seguida, injetar o recurso  <code>PersistenceContext</code> , que será usado pela EntityManager API para gerenciar as instâncias de entidade persistentes. Você adicionará as anotações à classe no Editor de Código-Fonte.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Injetamos o recurso  <code>MessageDrivenContext</code>  na classe adicionando o seguinte campo anotado (em negrito) à classe:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class NewMessage implements MessageListener {

*@Resource
private MessageDrivenContext mdc;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Introduza o gerenciador de entidades na classe clicando com o botão direito do mouse no código e selecionando Inserir Código (Alt-Insert; Ctrl-I no Mac), e selecionando Usar Gerenciador de Entidades no menu pop-up. O IDE adiciona a seguinte anotação  <code>@PersistenceContext</code>  ao seu código-fonte.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@PersistenceContext(unitName = "NewsApp-ejbPU")
private EntityManager em;</code></pre>
</div>
</div>
<div class="paragraph">
<p>O IDE também gera o seguinte método  <code>persist</code> .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public void persist(Object object) {
    em.persist(object);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Modifique o método  <code>persist</code>  para alterar o nome para  <code>save</code> . O método deve ter uma aparência semelhante a esta:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public void *save*(Object object) {
    em.persist(object);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Modifique o método  <code>onMessage</code>  adicionando o seguinte código (em negrito) ao corpo do método.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public void onMessage(Message message) {
    *ObjectMessage msg = null;
    try {
        if (message instanceof ObjectMessage) {
            msg = (ObjectMessage) message;
            NewsEntity e = (NewsEntity) msg.getObject();
            save(e);
        }
    } catch (JMSException e) {
        e.printStackTrace();
        mdc.setRollbackOnly();
    } catch (Throwable te) {
        te.printStackTrace();
    }*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no editor e escolha Corrigir Importações (Alt-Shift-I; ⌘-Shift-I no Mac) para gerar quaisquer instruções de importação necessárias. Salve as alterações.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Quando geramos as instruções de importação, queremos *garantir a importação das bibliotecas  <code>javax.jms</code> e  <code>javax.annotation.Resource</code> *.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Para obter mais detalhes sobre beans baseados em mensagens, consulte o capítulo <a href="http://java.sun.com/javaee/6/docs/tutorial/doc/gipko.html">O que é um Bean Baseado em Mensagem?</a> no <a href="http://download.oracle.com/javaee/6/tutorial/doc/">Tutorial do Java EE 6 , Parte I</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_criando_a_fachada_da_sessão">Criando a Fachada da Sessão</h3>
<div class="paragraph">
<p>Neste exercício, você criará uma fachada de sessão para a classe de entidade NewsEntity. A especificação EJB 3.0 simplificou a criação de beans de sessão reduzindo a quantidade de códigos necessários e permitindo o uso de anotações para declarar uma classe como um Bean de sessão. A especificação EJB 3.1 simplifica ainda mais os requisitos dos beans de sessão, ao tornar opcionais as interfaces de negócios. Os beans de sessão podem ser acessados por clientes locais por meio de uma interface local ou de uma view sem interface. Neste tutorial, você não criará uma interface para o bean. Os servlets da aplicação web acessarão o bean usando uma view sem interface.</p>
</div>
<div class="paragraph">
<p>Para criar a fachada de sessão, execute as seguintes etapas:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no módulo EJB e escolha Novo &gt; Outro.</p>
</li>
<li>
<p>Na categoria Persistência, selecione Beans de Sessão em Classes de Entidade. Clique em Próximo.</p>
</li>
<li>
<p>Selecione  <code>ejb.NewsEntity</code>  na lista de classes de entidades disponíveis e clique em Adicionar para mover a classe para o painel Classes de Entidades Selecionadas. Clique em Próximo.</p>
</li>
<li>
<p>Verifique se o Pacote está definido como  <code>ejb</code> . Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ejb-sessionforentity.png" alt="ejb sessionforentity">
</div>
<div class="title">Figure 6. Assistente Novo Bean Baseado em Mensagens</div>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, o IDE gera a classe de fachada da sessão  <code>NewsEntityFacade.java</code>  e  <code>AbstractFacade.java</code> , e abre os arquivos no editor. Como podemos ver no código gerado, a anotação  <code>@Stateless</code>  é usada para declarar a classe  <code>NewsEntityFacade.java</code>  como um componente de bean de sessão sem estado. O IDE também adiciona a anotação  <code>PersistenceContext</code>  para injetar o recurso diretamente no componente do bean de sessão.  <code>NewsEntityFacade.java</code>  estende  <code>AbstractFacade.java</code> , que contém a lógica de negócio e gerencia a transação.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Interfaces remotas ainda são necessárias, se os beans forem ser acessados por clientes remotos.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Para obter mais informações sobre beans de sessão, consulte o capítulo <a href="http://java.sun.com/javaee/6/docs/tutorial/doc/gipjg.html">O que é um Bean de Sessão?</a> no <a href="http://download.oracle.com/javaee/6/tutorial/doc/">Tutorial do Java EE 6, Parte I</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_codificando_o_módulo_web">Codificando o Módulo Web</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nesta seção, você criará dois servlets no módulo Web. O servlet ListNews recupera as mensagens do banco de dados usando a fachada de entidade no módulo EJB. O servlet PostMessage é usado para enviar mensagens JMS.</p>
</div>
<div class="paragraph">
<p>Nesta seção, você criará também um bean de sessão simples no módulo web que contará o número de usuários que estão atualmente na sessão. A especificação EJB 3.1 permite criar enterprise beans em aplicações Web. Antes do EJB 3.1, todos os enterprise beans tinham que estar em módulos EJB.</p>
</div>
<div class="sect2">
<h3 id="_criando_o_bean_de_sessão_único">Criando o Bean de Sessão Único</h3>
<div class="paragraph">
<p>A especificação EJB 3.1 introduz a anotação  <code>@Singleton</code>  que permite criar facilmente beans de sessão únicos. O EJB 3.1 também define anotações adicionais para a configuração de propriedades de beans de sessão únicos como quando o bean é instanciado.</p>
</div>
<div class="paragraph">
<p>Depois que o bean de sessão único é instanciado, ele existirá durante o ciclo de vida da aplicação. Como o seu próprio nome diz, pode haver somente uma única instância de um bean de sessão único na aplicação. Como os beans de sessão sem estado, os beans de sessão únicos podem ter vários clientes.</p>
</div>
<div class="paragraph">
<p>Para criar o bean da sessão único, execute as seguintes etapas.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no módulo Web e selecione Novo &gt; Outro para abrir o assistente Novo Arquivo.</p>
</li>
<li>
<p>Selecione o Bean de Sessão na categoria Enterprise JavaBeans. Clique em Próximo.</p>
</li>
<li>
<p>Digite <strong>SessionManagerBean</strong> para Nome EJB.</p>
</li>
<li>
<p>Digite <strong>ejb</strong> para o nome do Pacote.</p>
</li>
<li>
<p>Selecione Único. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ejb-newsingleton.png" alt="ejb newsingleton">
</div>
<div class="title">Figure 7. Criando um bean de sessão único no assistente Novo Bean de Sessão</div>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, o IDE gera a classe do bean de sessão único e abre a classe no Editor. Você pode ver que o IDE adicionou a anotação  <code>@Singleton</code>  à classe para declarar um bean de sessão único. O assistente também anotou a classe com  <code>@LocalBean</code> .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Singleton
@LocalBean
public class SessionManagerBean {

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Anote a classe com  <code>@WebListener</code>  e implemente  <code>HttpSessionListener</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Singleton
@LocalBean
*@WebListener*
public class SessionManagerBean *implements HttpSessionListener*{

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A anotação  <code>@WebListener</code>  é parte da API do Servlet 3.0 e permite implementar um listener diretamente no seu código.</p>
</div>
<div class="paragraph">
<p>Quando você implementa  <code>HttpSessionListener</code> , o IDE exibe uma advertência na margem.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique no emblema de advertência na margem esquerda e selecione "Implementar todos os métodos abstratos".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ejb-implementabstract.png" alt="ejb implementabstract">
</div>
<div class="title">Figure 8. Dica do editor para implementar métodos abstratos</div>
</div>
<div class="paragraph">
<p>O IDE adiciona os métodos  <code>sessionCreated</code>  e  <code>sessionDestroyed</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione o campo estático  <code>counter</code>  e defina o valor inicial como  <code>0</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@LocalBean
@WebListener
public class SessionManagerBean implements HttpSessionListener{
    *private static int counter = 0;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Modifique os corpos gerados dos métodos  <code>sessionCreated</code>  e  <code>sessionDestroyed</code>  para aumentar o valor de um campo quando uma nova sessão for iniciada e para diminuir o valor quando uma sessão for finalizada. O valor será armazenado no campo  <code>counter</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public void sessionCreated(HttpSessionEvent se) {
    *counter++;*
}

public void sessionDestroyed(HttpSessionEvent se) {
    *counter--;*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione o método a seguir, que retorna o valor atual de  <code>counter</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public int getActiveSessionsCount() {
        return counter;
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Você chamará este método de um servlet para exibir o número atual de usuários/sessões abertas.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Salve as alterações.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>O código para o bean de sessão deve ter agora a seguinte aparência.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Singleton
@LocalBean
@WebListener
public class SessionManagerBean implements HttpSessionListener {
    private static int counter = 0;

    public void sessionCreated(HttpSessionEvent se) {
        counter++;
    }

    public void sessionDestroyed(HttpSessionEvent se) {
        counter--;
    }

    public int getActiveSessionsCount() {
        return counter;
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para obter mais detalhes sobre beans de sessão únicos, consulte o capítulo <a href="http://java.sun.com/javaee/6/docs/tutorial/doc/gipjg.html">O que é um Bean de Sessão?</a> no <a href="http://download.oracle.com/javaee/6/tutorial/doc/">Tutorial do Java EE 6 , Parte I</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_criando_o_servlet_listnews">Criando o Servlet  <code>ListNews</code></h3>
<div class="paragraph">
<p>Neste exercício, você criará um servlet simples para exibir as mensagens armazenadas. Você usará anotações para chamar o Enterprise Bean NewsEntityFacade do servlet.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse em um projeto de módulo web e selecione Novo &gt; Servlet.</p>
</li>
<li>
<p>Digite <strong>ListNews</strong> para o Nome da Classe.</p>
</li>
<li>
<p>Insira <strong>web</strong> como o nome do Pacote. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clicar em Finalizar, a classe  <code>ListNews.java</code>  irá se abrir no Editor de Código-Fonte. No editor de código-fonte, execute as etapas a seguir.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no editor de código-fonte, selecione Inserir Código (Alt-Insert; Ctrl-I no Mac) e selecione Chamar Enterprise Bean.</p>
</li>
<li>
<p>Na caixa de diálogo Chamar Enterprise Bean, expanda o nó NewsApp-ejb e selecione NewEntityFacade. Clique em OK.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>O IDE adiciona a anotação  <code>@EJB</code>  para injetar o enterprise bean.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use a caixa de diálogo Chamar Enterprise Bean novamente para injetar SessionManagerBean no nó NewsApp-war.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Você verá no seu código as seguintes anotações que injetam os dois enterprise beans.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@WebServlet(name = "ListNews", urlPatterns = {"/ListNews"})
public class ListNews extends HttpServlet {

    @EJB
    private SessionManagerBean sessionManagerBean;
    @EJB
    private NewsEntityFacade newsEntityFacade;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Você também pode ver que a anotação  <code>@WebServlet</code>  é usada para declarar a classe um servlet e especificar o nome do servlet. A anotação  <code>@WebServlet</code>  faz parte da API do Servlet 3.0 introduzida na especificação Java EE 6. Você pode identificar os servlets usando a anotação, em vez de no descritor de implantação  <code>web.xml</code> . A aplicação NewsApp não contém  <code>web.xml</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>No método  <code>processRequest</code> , adicione o seguinte código (em negrito) para retornar a sessão atual ou criar uma nova sessão.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">protected void processRequest(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
        *request.getSession(true);*
        response.setContentType("text/html;charset=UTF-8");</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione o seguinte código (em negrito) ao método  <code>processRequest</code>  para imprimir as mensagens e adicionar um link ao servlet PostMessage. (Remova os comentários do código no método, se necessário.)</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">out.println("&lt;h1&gt;Servlet ListNews at " + request.getContextPath () + "&lt;/h1&gt;");

*List news = newsEntityFacade.findAll();
for (Iterator it = news.iterator(); it.hasNext();) {
    NewsEntity elem = (NewsEntity) it.next();
    out.println(" &lt;b&gt;"+elem.getTitle()+" &lt;/b&gt;&lt;br /&gt;");
    out.println(elem.getBody()+"&lt;br /&gt; ");
}
out.println("&lt;a href='PostMessage'&gt;Add new message&lt;/a&gt;");*

out.println("&lt;/body&gt;");</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione o código seguinte (em negrito) para recuperar e imprimir o número de usuários/sessões abertas.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">out.println("&lt;a href='PostMessage'&gt;Add new message&lt;/a&gt;");

*out.println("&lt;br&gt;&lt;br&gt;");
out.println(sessionManagerBean.getActiveSessionsCount() + " user(s) reading the news.");*

out.println("&lt;/body&gt;");</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Pressione Ctrl-Shift-I para gerar as instruções de importação necessárias para a classe. Ao gerar as instruções de importação, você deseja *importar as bibliotecas  <code>java.util</code> *.</p>
</li>
<li>
<p>Salve as alterações feitas no arquivo.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_criando_o_servlet_postmessage">Criando o Servlet  <code>PostMessage</code></h3>
<div class="paragraph">
<p>Neste exercício, você criará o servlet  <code>PostMessage</code>  que será usado para enviar mensagens. Você usará anotações para injetar os recursos JMS que criou diretamente no servlet, especificando o nome da variável e o nome para o qual é mapeado. Em seguida, você adicionará o código para enviar a mensagem JMS e o código para o form HTML para adicionar uma mensagem.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse em um projeto de módulo web e selecione Novo &gt; Servlet.</p>
</li>
<li>
<p>Digite  <code>PostMessage</code>  para Nome da Classe.</p>
</li>
<li>
<p>Insira  <code>web</code>  para nome do Pacote e clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, a classe  <code>PostMessage.java</code>  se abrirá no editor de código-fonte. No editor de código-fonte, execute as etapas a seguir.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use anotações para injetar os recursos  <code>ConnectionFactory</code>  e  <code>Queue</code>  adicionando as seguintes declarações de campo (em negrito):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@WebServlet(name="PostMessage", urlPatterns={"/PostMessage"})
public class PostMessage extends HttpServlet {
    *@Resource(mappedName="jms/NewMessageFactory")
    private  ConnectionFactory connectionFactory;

    @Resource(mappedName="jms/NewMessage")
    private  Queue queue;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Agora você insere o código para enviar as mensagens JMS adicionando o seguinte código em negrito ao método  <code>processRequest</code> :</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">response.setContentType("text/html;charset=UTF-8");

// Add the following code to send the JMS message
*String title=request.getParameter("title");
String body=request.getParameter("body");
if ((title!=null) &amp;amp;&amp;amp; (body!=null)) {
    try {
        Connection connection = connectionFactory.createConnection();
        Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
        MessageProducer messageProducer = session.createProducer(queue);

        ObjectMessage message = session.createObjectMessage();
        // here we create NewsEntity, that will be sent in JMS message
        NewsEntity e = new NewsEntity();
        e.setTitle(title);
        e.setBody(body);

        message.setObject(e);
        messageProducer.send(message);
        messageProducer.close();
        connection.close();
        response.sendRedirect("ListNews");

    } catch (JMSException ex) {
        ex.printStackTrace();
    }
}*

PrintWriter out = response.getWriter();</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione as linhas a seguir (em negrito) ao método  <code>processRequest</code>  para adicionar o form web para adicionar uma mensagem. (Remova o comentário do código para imprimir o HTML, se necessário.)</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">out.println("Servlet PostMessage at " + request.getContextPath() + "&lt;/h1&gt;");

// The following code adds the form to the web page
*out.println("&lt;form&gt;");
out.println("Title: &lt;input type='text' name='title'&gt;&lt;br/&gt;");
out.println("Message: &lt;textarea name='body'&gt;&lt;/textarea&gt;&lt;br/&gt;");
out.println("&lt;input type='submit'&gt;&lt;br/&gt;");
out.println("&lt;/form&gt;");*

out.println("&lt;/body&gt;");</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Pressione Ctrl-Shift-I para gerar as instruções de importação necessárias para a classe.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
ao selecionar bibliotecas para importação para  <code>Connection</code> ,  <code>ConnectionFactory</code> ,  <code>Session</code>  e <code>Queue</code> , *certifique-se de importar as bibliotecas  <code>javax.jms</code> *.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/import-jms.png" alt="import jms">
</div>
<div class="title">Figure 9. Selecione as bibliotecas JMS na caixa de diálogo Corrigir Todas as Importações</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Salve as alterações feitas no arquivo.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_executando_o_projeto">Executando o Projeto</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Você agora pode executar o projeto. Quando executamos o projeto, queremos que o browser abra a página com o servlet  <code>ListNews. </code>  Para isso, especificamos o URL na caixa de diálogo Propriedades da aplicação corporativa. O URL é relativo ao caminho de contexto da aplicação. Após inserirmos o URL relativo, poderemos construir, implantar e executar a aplicação a partir da janela Projetos.</p>
</div>
<div class="paragraph">
<p>Para definir o URL relativo e executar a aplicação, faça o seguinte:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na janela Projetos, clique com o botão direito do mouse no nó da aplicação corporativa NewsApp e selecione Propriedades no menu pop-up.</p>
</li>
<li>
<p>Selecione Executar no painel Categorias.</p>
</li>
<li>
<p>No campo de texto do URL relativo, digite <strong>/ListNews</strong>.</p>
</li>
<li>
<p>Clique em OK.</p>
</li>
<li>
<p>Na janela Projetos, clique com o botão direito do mouse no nó da aplicação corporativa NewsApp e selecione Executar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você executa o projeto, o servlet  <code>ListNews</code>  é aberto no browser e exibe uma lista das mensagens no banco de dados. Quando você executa o projeto pela primeira vez, o banco de dados está vazio, mas você pode clicar em Adicionar Mensagem para adicionar uma mensagem.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ejb-browser1.png" alt="ejb browser1">
</div>
<div class="title">Figure 10. A página do Servlet ListNews</div>
</div>
<div class="paragraph">
<p>Quando você adiciona uma mensagem com o servlet  <code>PostMessage</code> , a mensagem é enviada para o bean baseado em mensagens para gravar em armazenamento persistente e o servlet  <code>ListNews</code>  é chamado para exibir as mensagens no banco de dados. A lista de mensagens no banco de dados recuperada por  <code>ListNews</code>  em geral ainda não contém a nova mensagem, porque o serviço de mensagens é assíncrono.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fazendo_download_do_projeto_da_solução">Fazendo Download do Projeto da Solução</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Você pode fazer o download da solução para este projeto como um projeto das seguintes formas.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Faça download <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FNewsAppEE6.zip">de um arquivo compactado zip do projeto finalizado</a>.</p>
</li>
<li>
<p>Faça o check-out do código-fonte do projeto das Amostras do NetBeans ao executar as etapas a seguir:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Escolha Equipe &gt; Subversion &gt; Efetuar check-out no menu principal.</p>
</li>
<li>
<p>Na caixa de diálogo Efetuar Check-out, insira o Repositório URL a seguir:
 <code><a href="https://svn.netbeans.org/svn/samples~samples-source-code" class="bare">https://svn.netbeans.org/svn/samples~samples-source-code</a></code>
Clique em Próximo.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Procurar para abrir a caixa de diálogo Procurar Pastas do Repositório.</p>
</li>
<li>
<p>Expanda o nó raiz e selecione <strong>samples/javaee/NewsAppEE6</strong>. Clique em OK.</p>
</li>
<li>
<p>Especifique a Pasta Local para o códigos-fonte (a pasta local precisa estar vazia).</p>
</li>
<li>
<p>Clique em Finalizar.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, o IDE inicializa a pasta local como um repositório Subversion e verifica os códigos-fonte do projeto.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Abrir Projeto na caixa de diálogo exibida quando o check-out for concluído.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Observações.</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>É necessário um cliente Subversion para verificar os códigos-fonte. Para saber mais sobre a instalação do Subversion, consulte a seção <a href="../ide/subversion.html#settingUp">Configurando o Subversion</a> no <a href="../ide/subversion.html">Guia do Subversion no NetBeans IDE</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_solução_de_problemas">Solução de Problemas</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A seguir estão alguns dos problemas que você poderá encontrar ao criar o projeto.</p>
</div>
<div class="sect2">
<h3 id="_problema_com_os_recursos_jms">Problema com os Recursos JMS</h3>
<div class="paragraph">
<p>Ao usar o assistente para criar recursos JMS, você poderá receber a seguinte mensagem de erro na janela de saída:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">[com.sun.enterprise.connectors.ConnectorRuntimeException:
                    JMS resource not created : jms/Queue]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Esta mensagem pode indicar que o recurso JMS não foi criado ou não foi registrado no servidor de aplicações. Você pode usar a Console de Admin do servidor de aplicações para verificar, criar e editar recursos JMS.</p>
</div>
<div class="paragraph">
<p>Para abrir a Console Admin, faça o seguinte:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Confirme se o servidor de aplicações está sendo executado, expandindo o nó Servidores na janela Serviços do IDE. Uma pequena seta verde ao lado do nó do servidor de aplicações indica que o servidor está sendo executado.</p>
</li>
<li>
<p>Clique com o botão direito do mouse no nó do servidor de aplicações e selecione Exibir Console Admin para abrir a janela de log-in no browser.</p>
</li>
<li>
<p>Faça log-in no servidor. O nome de usuário e a senha default são  <code>admin</code>  e  <code>adminadmin</code> .</p>
</li>
<li>
<p>Na Console Admin no browser, expanda o nó Recursos e o nó Recursos JMS no quadro à esquerda.</p>
</li>
<li>
<p>Clique nos links Fábricas de Conexão e Recursos de Destino no quadro à esquerda para verificar se os recursos estão registrados no servidor e, se necessário, modifique os recursos. Se os recursos não existirem, crie-os na Console Admin.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Certifique-se de que o recurso de fábrica de conexões JMS no servlet PostMessage esteja mapeado para o nome JNDI correto do recurso de fábrica de conexões JMS registrado no Servidor de Aplicações Sun Java System.</p>
</div>
<div class="paragraph">
<p>Os seguintes recursos devem estar registrados no Servidor de Aplicações Sun Java System:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>um recurso de Destino com o nome JNDI  <code>jms/NewMessage</code>  e digite  <code>javax.jms.Queue</code></p>
</li>
<li>
<p>um recurso de Fábrica de Conexões com o nome JNDI  <code>jms/NewMessageFactory</code>  e digite  <code>javax.jms.QueueConnectionFactory</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Creating%20an%20Enterprise%20Application%20with%20EJB%203.1">Enviar Feedback neste Tutorial</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_consulte_também">Consulte Também</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para obter mais informações sobre o uso do NetBeans IDE para desenvolver aplicações Java EE, consulte os seguintes recursos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javaee-intro.html">Introdução à Tecnologia Java EE</a></p>
</li>
<li>
<p><a href="javaee-gettingstarted.html">Conceitos Básicos sobre Aplicações do Java EE</a></p>
</li>
<li>
<p><a href="../web/quickstart-webapps.html">Introdução ao Desenvolvimento de Aplicações Web</a></p>
</li>
<li>
<p><a href="../../trails/java-ee.html">Trilha de Aprendizado do Java EE e Java Web</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Para obter mais informações sobre o uso de enterprise beans, consulte o <a href="http://docs.oracle.com/javaee/7/tutorial/doc/ejb-intro.htm">Tutorial do Java EE 7</a>.</p>
</div>
<div class="paragraph">
<p>Para enviar comentários e sugestões, obter suporte e se manter informado sobre os mais recentes desenvolvimentos das funcionalidades de desenvolvimento do Java EE do NetBeans IDE, <a href="../../../community/lists/top.html">inscreva-se na lista de correspondência de nbj2ee</a>.</p>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/javaee/javaee-entapp-ejb_pt_BR.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
