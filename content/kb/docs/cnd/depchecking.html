
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Make Dependency Checking</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Make Dependency Checking - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Make Dependency Checking">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>

  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">Make Dependency Checking</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/cnd/depchecking.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_requirements">Requirements</a></li>
<li><a href="#_introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#_enabling_dependency_checking_for_a_project">Enabling Dependency Checking for a Project</a></li>
<li><a href="#_enabling_dependency_checking_by_default_for_new_projects">Enabling Dependency Checking by Default for New Projects</a></li>
<li><a href="#_notes">Notes</a></li>
</ul>
</li>
<li><a href="#_build_process_make_and_makefiles">Build Process (make and makefiles)</a></li>
<li><a href="#_dependency_generation_basics">Dependency Generation Basics</a></li>
<li><a href="#_implementation">Implementation</a></li>
<li><a href="#_references">References</a></li>
<li><a href="#_see_also">See Also</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial shows you how to enable the NetBeans IDE to check file dependencies in your projects when building. Dependency checking is performed by the  <code>make</code>  utility through instructions in the  <code>Makefile</code> .</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/netbeans-stamp-80-74-73.png" alt="netbeans stamp 80 74 73">
</div>
<div class="title">Figure 1. Content on this page applies to the NetBeans IDE 7.3 and 7.4 and 8.0</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_requirements">Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>To follow this tutorial, you need the following software and resources.</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software</th>
<th class="tableblock halign-left valign-top">Version Required</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NetBeans IDE (including C/C++ support)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../../download/index.html">version 7.3, 7.4, or 8.0 with NetBeans C/C&#43;&#43; plugin</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java Development Kit (JDK)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.oracle.com/java/technologies/downloads/">version 7 or 8</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>See the <a href="../../../community/releases/80/install.html">NetBeans IDE Installation Instructions</a> and <a href="../../../community/releases/80/cpp-setup-instructions.html">Configuring the NetBeans IDE for C/C&#43;&#43;/Fortran</a>
for information about downloading and installing the required software.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Large C/C++ projects consist of thousands of files. For example, the Linux kernel has about 20,000 files. If you are developing such a project and want to rebuild it after a small change - say, a one line fix - there are two options.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Full rebuild (Clean and Build action). It is slower, but guarantees a consistent build result.</p>
</li>
<li>
<p>Incremental rebuild (Build action). It is faster, but will it correctly rebuild everything that should be rebuilt?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The major problem with incremental rebuild is the presence of  <code>#include</code>  directives, which include one file&#8217;s content into another file. The included file is known as a file dependency. Modification of the included file should be treated as modification of all files that include it. Indirect includes (A includes B, B includes C &#8658; A includes C) make the problem even harder.</p>
</div>
<div class="paragraph">
<p>NetBeans IDE supports automatic checking of file dependencies and does its best to make incremental rebuild work correctly. If you change a header file that is included into some of your source files and then click Build, the IDE will rebuild only those parts of the project that really depend on the changed header. This feature saves time and guarantees consistent build results.</p>
</div>
<div class="sect2">
<h3 id="_enabling_dependency_checking_for_a_project">Enabling Dependency Checking for a Project</h3>
<div class="paragraph">
<p>Dependency checking can be controlled for each particular project. You may want to ensure that it&#8217;s enabled.</p>
</div>
<div class="paragraph">
<p><strong>To enable dependency checking for a project:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Right-click the project in the Projects window and choose Properties.</p>
</li>
<li>
<p>In the Project Properties dialog box, select the Build node in the Categories list.</p>
</li>
<li>
<p>In the build properties, select the checkbox for Enable Make Dependency Checking.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/project-checkbox.png" alt="project checkbox">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_enabling_dependency_checking_by_default_for_new_projects">Enabling Dependency Checking by Default for New Projects</h3>
<div class="paragraph">
<p>You can set a default state for dependency checking so that new projects you create are automatically enabled for make dependency checking.</p>
</div>
<div class="paragraph">
<p><strong>To enable dependency checking for all new projects created in the IDE:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Choose Tools &gt; Options in the IDE main menu.</p>
</li>
<li>
<p>Click the C/C++ button in the top pane.</p>
</li>
<li>
<p>Click the Project Options tab.</p>
</li>
<li>
<p>Select the checkbox for Enable dependency checking in generated makefiles</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/global-checkbox.png" alt="global checkbox">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notes">Notes</h3>
<div class="ulist">
<ul>
<li>
<p>Automatic dependency checking works for C/C++ projects that were created in the IDE (managed projects). The IDE builds dependency checking logic into the generated  <code>Makefile</code> . For projects created with existing sources you have to rely on dependency checking logic (if any) in the existing  <code>Makefile</code> .</p>
</li>
<li>
<p>Dependency checking requires support from your tool collection ( <code>make</code>  and compilers). It has been tested with the Oracle Solaris Studio tool collection and GNU tool collections including Cygwin and MinGW.</p>
</li>
<li>
<p>Dependency checking works when Oracle Solaris Studio compilers are used together with Oracle Solaris  <code>make</code>  and when GNU compilers are used with GNU  <code>gmake</code> . Mixing Oracle Solaris  <code>make</code>  with GNU compilers and vice versa is not supported.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The rest of the article is for those advanced users who want to know what happens under the IDE&#8217;s hood.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_build_process_make_and_makefiles">Build Process (make and makefiles)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The build process of every C/C++ project in NetBeans is described in a  <code>Makefile</code> , a file of special format understood by the  <code>make</code>  utility. When you build or clean your project from the GUI, the IDE invokes  <code>make</code> , which executes the Makefile. This approach allows you to easily build your project outside of the IDE using  <code>make</code> : just go to your project directory and type  <code>make help</code>  to get instructions.</p>
</div>
<div class="paragraph">
<p>Makefiles used by NetBeans IDE for a C/C++ project are shown below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/makefiles.png" alt="makefiles">
</div>
</div>
<div class="paragraph">
<p>The master  <code>Makefile</code>  is generated once and you can edit it manually. Makefiles in  <code>nbproject</code>  directory are not meant for manual editing; they are updated automatically by the IDE. The file  <code>Makefile-<em>CONF</em>.mk</code>  in the illustration represents multiple files for all your project configurations, such as  <code>Makefile-Release.mk</code> ,  <code>Makefile-Debug.mk</code> , and so on.</p>
</div>
<div class="paragraph">
<p>For a managed project, the IDE generates all the makefiles itself and inserts proper instructions for dependency checking. For a project created from existing sources, dependency checking will work only if the existing  <code>Makefile</code>  contains such instructions, because the NetBeans IDE doesn&#8217;t change the existing  <code>Makefile</code> .</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dependency_generation_basics">Dependency Generation Basics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want  <code>make</code>  to check included file dependencies during build then you have to insert dependency information into the  <code>Makefile</code> . Unfortunately there is no portable way to do this for all  <code>make</code>  utilities and compilers. First, you should detect which  <code>make</code>  is running, and then generate corresponding dependency checking instructions.</p>
</div>
<div class="paragraph">
<p>The Oracle Solaris  <code>make</code>  has a very simple solution. A special  <code>.KEEP_STATE:</code>  rule in the  <code>Makefile</code>  instructs  <code>make</code>  to query the compiler about included file dependencies and store them in a temporary file. Next time the project is rebuilt,  <code>make</code>  loads that temporary file, analyzes dependencies stored there, and determines which headers changed and which object files should be recompiled.</p>
</div>
<div class="paragraph">
<p>For GNU  <code>make</code>  (called  <code>gmake</code> ) the solution is more complex. You have to explicitly ask the compiler to generate dependency information and then explicitly include it into the  <code>Makefile</code> . The idea is to pass special flags to the compiler, so that the compiler will generate dependency information for each compiled source file. Next time the project is rebuilt, dependency information is collected and included into the  <code>Makefile</code> .</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation">Implementation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following code is added to  <code>nbproject/Makefile-impl.mk</code> . It detects which  <code>make</code>  is running and puts corresponding dependency checking code into the file  <code>.dep.inc</code> . GNU  <code>make</code>  is detected by the presence of  <code>MAKE_VERSION</code>  variable. If  <code>MAKE_VERSION</code>  is not set, then the Solaris  <code>make</code> -specific instructions are generated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java"># dependency checking support
.depcheck-impl:
	@echo "# This code depends on make tool being used" &gt;.dep.inc
	@if [ -n "${MAKE_VERSION}" ]; then \
	    echo "DEPFILES=\$$(wildcard \$$(addsuffix .d, \$${OBJECTFILES}))" &gt;&gt;.dep.inc; \
	    echo "ifneq (\$${DEPFILES},)" &gt;&gt;.dep.inc; \
	    echo "include \$${DEPFILES}" &gt;&gt;.dep.inc; \
	    echo "endif" &gt;&gt;.dep.inc; \
	else \
	    echo ".KEEP_STATE:" &gt;&gt;.dep.inc; \
	    echo ".KEEP_STATE_FILE:.make.state.\$${CONF}" &gt;&gt;.dep.inc; \
	fi</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following code is added to  <code>nbproject/Makefile-${CONF}.mk</code> . It instructs  <code>make</code>  to read previously generated  <code>.dep.inc</code>  and execute instructions from it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java"># Enable dependency checking
.dep.inc: .depcheck-impl

include .dep.inc</code></pre>
</div>
</div>
<div class="paragraph">
<p>The rule  <code>.dep.inc: .depcheck-impl</code>  is added to prevent build failure when  <code>.dep.inc</code>  does not exist. There is only one case when it happens: when you compile single file from the Projects window. In this case  <code>make</code>  executes file  <code>nbproject/Makefile-${CONF}.mk</code>  directly.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references">References</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://en.wikipedia.org/wiki/Make_%28software%29">Wikipedia article about  <code>make</code> </a></p>
</li>
<li>
<p><a href="http://make.paulandlesley.org/autodep.html">Advanced Auto-Dependency Generation</a></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see_also">See Also</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please see the <a href="../cnd.html">C/C&#43;&#43; Learning Trail</a> for more articles about developing with C/C++/Fortran in NetBeans IDE.</p>
</div>
<div class="paragraph">
<p><a href="../../../community/mailing-lists.html">Send Us Your Feedback</a></p>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/cnd/depchecking.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
