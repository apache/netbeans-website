
<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>端到端二进制 SOAP 附件第 3 部分：对 Web 服务进行编码和测试</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="端到端二进制 SOAP 附件第 3 部分：对 Web 服务进行编码和测试 - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, 端到端二进制 SOAP 附件第 3 部分：对 Web 服务进行编码和测试">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
     <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet"> 
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
</head>


    <body>
        

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="/plugins/index.html">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


        
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Just released!</div>
            <h1 syle='font-size: 2rem'>Apache NetBeans 11.3</h1>
            <p><a class="button success" href="/download/nb113/index.html">Find out more</a></p>
        </div>
    </div>
</section>

        <div class='grid-container main-content tutorial'>
            <h1 class="sect0">端到端二进制 SOAP 附件第 3 部分：对 Web 服务进行编码和测试</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://issues.apache.org/jira/projects/NETBEANS/issues">open a JIRA issue</a>, 
                     or <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/websvc/flower-code-ws_zh_CN.asciidoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
            <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#coding-ws">对 Web 服务进行编码</a>
<ul class="sectlevel2">
<li><a href="#retrieve-jpeg-as-bytes">以字节数组形式获取 JPEG 文件</a></li>
<li><a href="#read-bytes-as-image">读取字节数组作为图像</a></li>
<li><a href="#implement-getflower">实现 getFlower</a></li>
<li><a href="#create-byte-array-list">为所有 JPEG 文件创建字节数组列表</a></li>
<li><a href="#implement-getthumbnails">实现 getThumbnails</a></li>
</ul>
</li>
<li><a href="#test-ws">测试 Web 服务</a></li>
<li><a href="#_后续步骤">后续步骤：</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>在本课中，将学习如何向 Web 服务/会话 Bean 类中添加代码，以将 JPEG 文件转换为字节数组以及将字节数组转换为  <code>java.awt.Image</code>  对象。您还将向公共 Web 服务操作中添加代码以便操作可返回这些  <code>Image</code>  对象。最后，将使用 NetBeans IDE 的 "Test Web Service"（测试 Web 服务）实用程序来在浏览器中对 Web 服务进行测试。</p>
</div>
<div class="paragraph">
<p><strong>本教程中的课程</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/netbeans-stamp-80-74-73.png" alt="netbeans stamp 80 74 73">
</div>
<div class="title">Figure 1. 此页上的内容适用于 NetBeans IDE 7.2、7.3、7.4 和 8.0</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="./flower_overview.html">概述</a></p>
</li>
<li>
<p><a href="flower_ws.html">创建 Web 服务</a></p>
</li>
<li>
<p>&#8658; 对 Web 服务进行编码和测试</p>
</li>
<li>
<p><a href="./flower_wsdl_schema.html">修改方案文件和 WSDL 文件以传递二进制数据</a></p>
</li>
<li>
<p><a href="./flower_swing.html">创建 Swing 客户端</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>本课内容</strong>
6. <a href="#coding-ws">对 Web 服务进行编码</a></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#retrieve-jpeg-as-bytes">以字节数组形式获取 JPEG 文件</a></p>
</li>
<li>
<p><a href="#read-bytes-as-image">读取字节数组作为图像</a></p>
</li>
<li>
<p><a href="#implement-getflower">实现 getFlower</a></p>
</li>
<li>
<p><a href="#create-byte-array-list">为所有 JPEG 文件创建字节数组列表</a></p>
</li>
<li>
<p><a href="#implement-getthumbnails">实现 getThumbnails</a></p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p><a href="#test-ws">测试 Web 服务</a></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="coding-ws">对 Web 服务进行编码</h2>
<div class="sectionbody">
<div class="paragraph">
<p>现在得到了包含一组 JPEG 文件和一个 Web 服务的 Web 应用程序。Web 服务被实现为一个无状态会话 Bean。Web 服务包含两个空 Web 操作。在本课中，您将向 Web 服务中添加代码，以将 JPEG 文件转换为字节数组以及将字节数组转换为  <code>java.awt.Image</code>  对象。您还将向公共 Web 服务操作中添加代码以便操作可返回这些  <code>Image</code>  对象。</p>
</div>
<div class="sect2">
<h3 id="retrieve-jpeg-as-bytes">以字节数组形式获取 JPEG 文件</h3>
<div class="paragraph">
<p>在此部分，将向  <code>FlowerService</code>  类主体中添加一对私有方法。这些方法采用鲜花的名称，创建到鲜花的 JPEG 文件的路径，并返回 JPEG 文件的二进制表示（字节数组）。在后续部分中，将向公共 Web 服务操作中添加代码以使操作调用这些私有方法。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>打开项目的 "Source"（源）视图。需要添加代码，该代码采用图像的名称，基于该名称创建到图像的路径，以及检索图像以作为字节数组。将以下代码键入或粘贴到  <code>FlowerService</code>  类主体中：</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private byte[] getFlowerBytes(String name) throws IOException {
    URL resource = this.getClass().getResource("/org/flower/resources/"+name+".jpg");
    return getBytes(resource);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>随即出现 IDE 无法找到类  <code>URL</code>  的警告。通过手动方式或者按 Ctrl-Shift-I 组合键（在 Mac 上为 ⌘-Shift-I 组合键）为  <code><a href="http://download.oracle.com/javase/6/docs/api/java/net/URL.html">java.net.URL</a></code>  添加一条导入语句。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>随即出现新的警告。警告表明 IDE 无法找到  <code>getBytes</code>  方法。左键单击警告图标然后单击提示以创建  <code>getBytes</code>  方法。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/create-method-tip.png" alt="create method tip">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>编辑器会将焦点置于刚刚创建的  <code>getBytes</code>  方法上。将以下代码添加到方法中。此代码<a href="http://download.oracle.com/javase/6/docs/api/java/net/URL.html#openStream%28%29">打开到 URL 的连接</a>，通过  <code>getFlowerBytes</code>  方法传递该 URL 并返回一个  <code><a href="http://download.oracle.com/javase/6/docs/api/java/io/InputStream.html">InputStream</a></code> 。然后此代码读取输入流（一次 1024 个字节），将字节存储在字节数组缓冲区中，接着再从缓冲区写入  <code><a href="http://download.oracle.com/javase/6/docs/api/java/io/ByteArrayOutputStream.html">ByteArrayOutputStream</a></code> 。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private byte[] getBytes(URL resource) throws IOException {
    InputStream in = resource.openStream();
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    byte[] buf = new byte[1024];
    for(int read; (read = in.read(buf)) != -1;) {
        bos.write(buf, 0, read);
    }
    return bos.toByteArray();
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>为  <code>java.io.InputStream</code>  和  <code>java.io.ByteArrayOutputStream</code>  添加导入语句。</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="read-bytes-as-image">读取字节数组作为图像</h3>
<div class="paragraph">
<p>在此部分，将向  <code>FlowerService</code>  类主体中添加一个私有方法。该方法传入一个代表 JPEG 文件的字节数组，并返回  <code>java.awt.Image</code>  对象。请注意，字节数组是由  <code>getBytes(URL)</code>  方法所创建的，该方法在<a href="#retrieve-jpeg-as-bytes">以字节数组形式获取 JPEG 文件</a>部分中创建。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在  <code>FlowerService</code>  类主体中，添加以下名为  <code>getImage</code>  的私有方法。 <code>getImage</code>  方法的返回类型为  <code>Image</code> 。该方法采用两个参数。第一个参数是由  <code>getBytes</code>  方法创建的字节数组。第二个参数是一个布尔值，用于表示该图像是否为缩略图。 <code>getImage</code>  方法抛出一个  <code>IOException</code> 。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private Image getImage(byte[] bytes, boolean isThumbnail) throws IOException {
    }</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>在  <code>getImage</code>  方法主体中，添加一行代码，以通过该方法作为参数传入的字节数组来创建  <code><a href="http://download.oracle.com/javase/6/docs/api/java/io/ByteArrayInputStream.html">ByteArrayInputStream</a></code> 。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">ByteArrayInputStream bis = new ByteArrayInputStream(bytes);</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>添加一行代码，以通过  <code>ByteArrayInputStream</code>  创建一个  <code>Object</code> 。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Object source = bis;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>添加一行代码，以通过通用  <code>Object</code>  创建一个  <code><a href="http://download.oracle.com/javase/6/docs/api/javax/imageio/stream/ImageInputStream.html">ImageInputStream</a></code> 。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">ImageInputStream iis = ImageIO.createImageInputStream(source);</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>添加一行代码来为所有当前注册的可以解码 JPEG 文件的  <code><a href="http://download.oracle.com/javase/6/docs/api/javax/imageio/ImageReader.html">ImageReader</a></code>  创建一个  <code><a href="http://download.oracle.com/javase/6/docs/api/java/util/Iterator.html">Iterator</a></code> 。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Iterator readers = ImageIO.getImageReadersByFormatName("jpeg");</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>添加一行代码，用于通过  <code>Iterator</code>  中的下一个元素创建  <code>ImageReader</code> 。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">ImageReader reader = (ImageReader) readers.next();</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>添加代码行以创建默认的<a href="http://download.oracle.com/javase/6/docs/api/javax/imageio/IIOParam.html">图像读取参数</a>，但是如果  <code>Image</code>  代表缩略图，请将四种<a href="http://download.oracle.com/javase/6/docs/api/javax/imageio/IIOParam.html#setSourceSubsampling%28int,%20int,%20int,%20int%29">二次采样</a>中的一种添加到图像读取参数中。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">ImageReadParam param = reader.getDefaultReadParam();
if (isThumbnail) {
    param.setSourceSubsampling(4, 4, 0, 0);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>最后，添加代码以使用  <code>ImageReader</code>  对象来读取  <code>ImageInputStream</code>  对象，并基于该对象和图像读取参数来返回  <code>Image</code> 。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">reader.setInput(iis, true);
return reader.read(0, param);</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>按 Ctrl-Shift-I 组合键（在 MacOS 上按 ⌘-Shift-I 组合键）。"Fix All Imports"（修复所有导入）对话框即打开。接受 "Fix All Imports"（修复所有导入）对话框的默认建议，然后单击 "OK"（确定）。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/fix-getimage-imports.png" alt="fix getimage imports">
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>``getImage``  方法现在已完成。</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private Image getImage(byte[] bytes, boolean isThumbnail) throws IOException {
    ByteArrayInputStream bis = new ByteArrayInputStream(bytes);
    Object source = bis; // File or InputStream
    ImageInputStream iis = ImageIO.createImageInputStream(source);
    Iterator readers = ImageIO.getImageReadersByFormatName("jpeg");
    ImageReader reader = (ImageReader) readers.next();
    ImageReadParam param = reader.getDefaultReadParam();
    if (isThumbnail) {
        param.setSourceSubsampling(4, 4, 0, 0);
    }
    reader.setInput(iis, true);
    return reader.read(0, param);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="implement-getflower">实现 getFlower</h3>
<div class="paragraph">
<p>将以下实现代码添加到  <code>getFlower()</code>  方法中以通过花的名称来获取鲜花并返回该花的图像，如下所示。请注意，此代码调用私有的  <code>getFlowerBytes(name)</code>  方法来以字节数组形式获取 JPEG 文件。然后该代码调用私有的  <code>getImage</code>  方法来返回字节数组以作为  <code>Image</code>  对象。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@WebMethod(operationName = "getFlower")
public Image getFlower(@WebParam(name = "name") String name) throws IOException {
    byte[] bytes = getFlowerBytes(name);
    return getImage(bytes, false);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-byte-array-list">为所有 JPEG 文件创建字节数组列表</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在  <code>FlowerService</code>  类主体的顶部，创建一个用于表示每朵花名称的 String 数组。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private static final String[] FLOWERS = {"aster", "honeysuckle", "rose", "sunflower"};</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>添加一个方法，该方法创建一个  <code><a href="http://download.oracle.com/javase/6/docs/api/java/util/ArrayList.html">ArrayList</a></code> ，并将每朵花的字节数组添加到  <code>List</code>  中。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private List allFlowers() throws IOException {
    List flowers = new ArrayList();
    for (String flower:FLOWERS) {
        URL resource = this.getClass().getResource("/org/flower/resources/"+flower+".jpg");
        flowers.add(getBytes(resource));
    }
    return flowers;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>为  <code>java.util.ArrayList</code>  和  <code>java.util.List</code>  添加导入语句。</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="implement-getthumbnails">实现 getThumbnails</h3>
<div class="paragraph">
<p>按照如下所示更改  <code>getThumbnails()</code>  方法。请注意，添加实现代码并将返回类型从  <code>List</code>  更改为  <code>List&lt;Image&gt;</code> 。还请注意，将布尔型  <code>isThumbnail</code>  的值  <code>true</code>  传递到  <code>getImage</code>  方法。 <code>getThumbnails</code>  的实现代码调用  <code>allFlowers</code>  方法来<a href="#create-byte-array-list">为所有 JPEG 文件创建字节数组列表</a>。然后  <code>getThumbnails</code>  方法创建一个  <code>Image</code>  的  <code>List</code>  并为每朵花调用  <code>getImage</code>  方法，从而将该花的字节数组作为  <code>Image</code>  对象返回，并将该  <code>Image</code>  添加到  <code>List</code>  中。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@WebMethod(operationName = "getThumbnails")
public List&lt;Image&gt; getThumbnails() throws IOException {
    List&lt;byte[]&gt; flowers = allFlowers();
    List&lt;Image&gt; flowerList = new ArrayList&lt;Image&gt;(flowers.size());
    for (byte[] flower : flowers) {
        flowerList.add(getImage(flower, true));
    }
    return flowerList;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>结合的 Web 服务/会话 Bean 现在已完成。Web 服务类的最终窗体如下：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package org.flower.service;import java.awt.Image;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.net.URL;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebService;
import javax.ejb.Stateless;
import javax.imageio.ImageIO;
import javax.imageio.ImageReadParam;
import javax.imageio.ImageReader;
import javax.imageio.stream.ImageInputStream;@WebService(serviceName = "FlowerService")
@Stateless()
public class FlowerService {private static final String[] FLOWERS = {"aster", "honeysuckle", "rose", "sunflower"};@WebMethod(operationName = "getFlower")
    public Image getFlower(@WebParam(name = "name") String name) throws IOException {
        byte[] bytes = getFlowerBytes(name);
        return getImage(bytes, false);
    }@WebMethod(operationName = "getThumbnails")
    public List&lt;Image&gt; getThumbnails() throws IOException {
        List flowers = allFlowers();
        List&lt;Image&gt; flowerList = new ArrayList&lt;Image&gt;(flowers.size());
        for (byte[] flower : flowers) {
            flowerList.add(getImage(flower, true));
        }
        return flowerList;
    }private byte[] getFlowerBytes(String name) throws IOException {
        URL resource = this.getClass().getResource("/org/flower/resources/" + name + ".jpg");
        return getBytes(resource);
    }private byte[] getBytes(URL resource) throws IOException {
        InputStream in = resource.openStream();
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        byte[] buf = new byte[1024];
        for (int read; (read = in.read(buf)) != -1;) {
            bos.write(buf, 0, read);
        }
        return bos.toByteArray();
    }private Image getImage(byte[] bytes, boolean isThumbnail) throws IOException {
        ByteArrayInputStream bis = new ByteArrayInputStream(bytes);
        Iterator readers = ImageIO.getImageReadersByFormatName("jpeg");
        ImageReader reader = (ImageReader) readers.next();
        Object source = bis; // File or InputStream
        ImageInputStream iis = ImageIO.createImageInputStream(source);
        reader.setInput(iis, true);
        ImageReadParam param = reader.getDefaultReadParam();
        if (isThumbnail) {
            param.setSourceSubsampling(4, 4, 0, 0);
        }
        return reader.read(0, param);
    }private List allFlowers() throws IOException {
        List flowers = new ArrayList();
        for (String flower : FLOWERS) {
            URL resource = this.getClass().getResource("/flower/album/resources/" + flower + ".jpg");
            flowers.add(getBytes(resource));
        }
        return flowers;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="test-ws">测试 Web 服务</h2>
<div class="sectionbody">
<div class="paragraph">
<p>既然 Web 服务已完成，您可以对其进行部署和测试。</p>
</div>
<div class="paragraph">
<p><strong>测试 Web 服务：</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>右键单击 "FlowerAlbumService" 节点，然后选择 "Deploy"（部署）。IDE 编译源代码，启动 GlassFish Server，并将项目的 WAR 文件部署到服务器。如果打开 "Services"（服务）窗口，将在服务器的 "Applications"（应用程序）节点中看到已部署的  <code>FlowerService</code> 。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*重要说明：*GlassFish Server Open Source Edition 的版本必须是 3.1 或更高版本。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/deployed-service.png" alt="deployed service">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>展开项目的 "Web Services"（Web 服务）节点。右键单击 "FlowerService" 然后选择 "Test Web Service"（测试 Web 服务）。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/test-ws-node.png" alt="test ws node">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Web 服务测试器在浏览器中打开。在  <code>getFlower</code>  参数字段中键入 "rose"。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ws-tester.png" alt="ws tester">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>按  <code>getFlower</code>  按钮。IDE 在浏览器中显示有关调用的信息。查看“Method Returned”时，会看到乱码。您想要看到一幅图像，而不是一系列的符号。但是，由于  <code>java.awt.Image</code>  不是有效的方案类型，需要手动配置方案文件以返回二进制 image/jpeg 数据。这将在下一个教程中完成。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ws-tester-badschema.png" alt="ws tester badschema">
</div>
</div>
<div class="paragraph">
<p>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_后续步骤">后续步骤：</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="./flower_wsdl_schema.html">修改方案文件和 WSDL 文件以传递二进制数据</a></p>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Flower%20Coding%20WS%20EE6">发送有关此教程的反馈意见</a></p>
</div>
<div class="paragraph">
<p>要发送意见和建议、获得支持以及随时了解 NetBeans IDE Java EE 开发功能的最新开发情况，请<a href="../../../community/lists/top.html">加入 nbj2ee@netbeans.org 邮件列表</a>。</p>
</div>
</div>
</div>
            
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="JIRA" href="https://issues.apache.org/jira/projects/NETBEANS/summary"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/websvc/flower-code-ws_zh_CN.asciidoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

        </div>
        

<div class='grid-container incubator-area' style='margin-top: 64px'>
    <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/">
                <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
            </a>
        </div>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/events/current-event.html">
               <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
            </a>
        </div>
    </div>
</div>
<footer>
    <div class="grid-container">
        <div class="grid-x grid-padding-x">
            <div class="large-auto cell">
                
                <h1><a href="/about/index.html">About</a></h1>
                <ul>
                    <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
                    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                    <li><a href="https://www.apache.org/security/">Security</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/community/index.html">Community</a></h1>
                <ul>
                    <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
                    <li><a href="/community/committer.html">Becoming a committer</a></li>
                    <li><a href="/community/events.html">NetBeans Events</a></li>
                    <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/participate/index.html">Participate</a></h1>
                <ul>
                    <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
                    <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
                    <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/help/index.html">Get Help</a></h1>
                <ul>
                    <li><a href="/help/index.html#documentation">Documentation</a></li>
                    <li><a href="/wiki/index.asciidoc">Wiki</a></li>
                    <li><a href="/help/index.html#support">Community Support</a></li>
                    <li><a href="/help/commercial-support.html">Commercial Support</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/download/nb110/nb110.html">Download</a></h1>
                <ul>
                    <li><a href="/download/index.html">Releases</a></li>                    
                    <li><a href="/plugins/index.html">Plugins</a></li>
                    <li><a href="/download/index.html#source">Building from source</a></li>
                    <li><a href="/download/index.html#previous">Previous releases</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<div class='footer-disclaimer'>
    <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2019 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
            <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
            <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
        </div>
        
    </div>
</div>



        <script src="/js/vendor/jquery-3.2.1.min.js"></script>
        <script src="/js/vendor/what-input.js"></script>
        <script src="/js/vendor/jquery.colorbox-min.js"></script>
        <script src="/js/vendor/foundation.min.js"></script>
        <script src="/js/netbeans.js"></script>
        <script>
            
            $(function(){ $(document).foundation(); });
        </script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        <script>
         $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
        </script>
        
    </body>
</html>
