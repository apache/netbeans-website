
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Создание простого веб-приложения с использованием базы данных MySQL</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Создание простого веб-приложения с использованием базы данных MySQL - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Создание простого веб-приложения с использованием базы данных MySQL">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">Создание простого веб-приложения с использованием базы данных MySQL</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/mysql-webapp_ru.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#planStructure">Планирование структуры</a>
<ul class="sectlevel2">
<li><a href="#_index_jsp">index.jsp</a></li>
<li><a href="#_response_jsp">response.jsp</a></li>
</ul>
</li>
<li><a href="#createProject">Создание нового проекта</a></li>
<li><a href="#prepareInterface">Подготовка веб-интерфейса</a>
<ul class="sectlevel2">
<li><a href="#welcomePage">Настройка страницы приветствия</a></li>
<li><a href="#responsePage">Создание страницы ответов</a></li>
<li><a href="#stylesheet">Создание таблицы стилей</a></li>
</ul>
</li>
<li><a href="#prepareCommunication">Подготовка средств обмена данными между приложениями и базой данных</a>
<ul class="sectlevel2">
<li><a href="#setUpJDBC">Настройка источника данных JDBC и пула подключений</a></li>
<li><a href="#referenceDataSource">Обращение к источнику данных из приложения</a></li>
<li><a href="#addJar">Добавление файла JAR драйвера базы данных к серверу</a></li>
</ul>
</li>
<li><a href="#addLogic">Добавление динамической логики</a>
<ul class="sectlevel2">
<li><a href="#addJSTL">Добавление библиотеки JSTL к пути к классам проекта</a></li>
<li><a href="#implementCode">Реализация кода JSTL</a></li>
</ul>
</li>
<li><a href="#run">Запуск готового приложения</a></li>
<li><a href="#troubleshoot">Устранение проблем</a>
<ul class="sectlevel2">
<li><a href="#access">Существуют ли ресурсы базы данных?</a></li>
<li><a href="#datasource">Существуют ли на сервере пул подключений и источник данных?</a></li>
<li><a href="#driver">Доступен ли MySQL Connector/драйвер J для сервера GlassFish?</a></li>
<li><a href="#password">Защищена ли база данных паролем?</a></li>
<li><a href="#ping">Корректно ли установлены значения свойств пула подключений?</a></li>
</ul>
</li>
<li><a href="#seealso">Дополнительные сведения</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Автор: Трой Джуниперо (Troy Giunipero)</p>
</div>
<div class="paragraph">
<p>В этом документе описана процедура создания простого веб-приложения, которое подключается к серверу базы данных MySQL. Здесь также рассмотрены основные идеи и технологии веб-разработки, такие как<a href="http://www.oracle.com/technetwork/java/overview-138580.html">JavaServer Pages</a> (JSP), <a href="http://www.oracle.com/technetwork/java/index-jsp-135995.html">библиотека стандартных тегов JavaServer Pages</a> (JSTL), интерфейс API связи с базами данных Java (JDBC) и двухуровневая архитектура между клиентом и сервером. Этот учебный курс разработан для начинающих разработчиков, обладающих базовыми знаниями в области веб-разработок и желающих применить свои знания к базе данных MySQL.</p>
</div>
<div class="paragraph">
<p><a href="http://www.mysql.com">MySQL</a> является популярной системой управления базами данных с открытым кодом, которая обычно используется в веб-приложениях благодаря своей скорости, гибкости и надежности. MySQL использует SQL (<em>язык структурированных запросов</em>) для доступа к данным в базе данных и их обработки.</p>
</div>
<div class="paragraph">
<p>Этот учебный курс является продолжением учебного курса <a href="../ide/mysql.html">Подключение к базе данных MySQL</a> и в нем предполагается, что уже создана база данных MySQL с именем <code>MyNewDatabase</code>, для которой зарегистрировано подключение в IDE NetBeans. Табличные данные, используемые в этом учебном курсе, содержатся в <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJava%2520Web%252Fifpwafcad.sql">ifpwafcad.sql</a> и также необходимы для работы с этим учебным курсом. Этот файл SQL создает две таблицы <code>Subject</code> и <code>Counselor</code> и затем заполняет их данными для примера. При необходимости сохраните этот файл на компьютер, затем откройте его в IDE NetBeans и запустите его в базе данных MySQL с именем <code>MyNewDatabase</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/netbeans-stamp-80-74-73.png" alt="netbeans stamp 80 74 73">
</div>
<div class="title">Figure 1. Содержимое этой страницы применимо к IDE NetBeans 7.2, 7.3, 7.4 и 8.0</div>
</div>
<div class="paragraph">
<p><strong>Для работы с этим учебным курсом требуется следующее программное обеспечение и ресурсы.</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Программное обеспечение или материал</th>
<th class="tableblock halign-left valign-top">Требуемая версия</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">IDE NetBeans</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.2, 7.3, 7.4, 8.0, пакет Java EE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Комплект для разработчика на языке Java (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">версия 7 или 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://dev.mysql.com/downloads/mysql/">Сервер базы данных MySQL</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Драйвер JDBC MySQL Connector/J</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">версия 5.x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GlassFish Server Open Source Edition 3.1.2.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.x или 4.x</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Примечания:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Комплект загрузки Java среды IDE NetBeans позволяет пользователям установить сервер GlassFish. Для работы с данным учебным курсом требуется сервер GlassFish.</p>
</li>
<li>
<p>Если необходимо сравнить проект с работающим решением, можно <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJava%2520Web%252FIFPWAFCAD.zip">загрузить демонстрационное приложение</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="planStructure">Планирование структуры</h2>
<div class="sectionbody">
<div class="paragraph">
<p>С помощью <em>двухуровневой архитектуры</em>, в которой клиент взаимодействует с сервером напрямую, можно создать простое веб-приложение. В рамках данного учебного курса веб-приложение Java взаимодействует напрямую с базой данных MySQL с использованием API связи с базами данных Java. В сущности, именно <a href="http://dev.mysql.com/downloads/connector/j/">драйвер MySQL Connector/J JDBC</a> обеспечивает обмен данными между кодом Java, распознанным сервером приложения (GlassFish), и любым содержимым на SQL, языке, понятном для сервера базы данных (MySQL).</p>
</div>
<div class="paragraph">
<p>Приложение, создаваемое в этом учебном курсе, предполагает создание двух страниц JSP. На каждой такой странице с помощью HTML и CSS реализован простой интерфейс, и применяется технология JSTL для выполнения логики, напрямую запрашивающей базу данных с вставкой извлеченных данных на двух страницах. В базе данных MySQL <code>MyNewDatabase</code> содержатся две таблицы базы данных <code>Subject</code> и <code>Counselor</code>, которые были созданы при работе с учебным курсом <a href="../ide/mysql.html">Подключение базы данных MySQL</a>. Рассмотрим следующий двухуровневый сценарий.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>image::images/ifpwafcad-structure.png[title="Образец структуры двухуровневого веб-приложения"]</pre>
</div>
</div>
<div class="paragraph">
<p>Страница приветствия <code>index.jsp</code> представляется пользователю с помощью простой формы HTML. При запросе браузером`index.jsp` код JSTL на странице инициирует запрос в <code>MyNewDatabase</code>. Выполняется извлечение данных из таблицы <code>Subject</code> со вставкой их на страницу перед ее передачей в браузер. При передаче данных о выборе пользователя в форме HTML на странице приветствия инициируется запрос страницы ответов (<code>response.jsp</code>). И снова код JSTL на странице инициирует запрос в <code>MyNewDatabase</code>. На этот раз данные извлекаются из обеих таблиц - <code>Subject</code> и <code>Counselor</code>. После чего выполняется их вставка на страницу, что позволяет пользователю просматривать данные в зависимости от вариантов выбора при возврате страницы в браузер.</p>
</div>
<div class="paragraph">
<p>Для реализации описанного выше сценария необходимо разработать простое приложение для организации IFPWAFCAD Международной ассоциации по консультированию и развитию для бывших профессиональных борцов.</p>
</div>
<div class="sect2">
<h3 id="_index_jsp">index.jsp</h3>
<div class="imageblock">
<div class="content">
<img src="images/index-page.png" alt="index page">
</div>
<div class="title">Figure 2. Файл index.jsp отображается в браузере</div>
</div>
</div>
<div class="sect2">
<h3 id="_response_jsp">response.jsp</h3>
<div class="imageblock">
<div class="content">
<img src="images/response-page.png" alt="response page">
</div>
<div class="title">Figure 3. Файл response.jsp отображается в браузере</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="createProject">Создание нового проекта</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Сначала необходимо создать новый веб-проект в среде IDE:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите "Файл &gt; Новый проект" (CTRL+SHIFT+N; &amp;#8984+SHIFT+N в Mac ОС) в главном меню. Выберите категорию "Java Web", а затем выберите "Веб-приложение". Нажмите кнопку "Далее".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new-project.png" alt="new project">
</div>
<div class="title">Figure 4. Используйте мастер создания проекта для создания нового проекта </div>
</div>
<div class="paragraph">
<p>С помощью этого мастера можно создать пустое веб-приложение в стандартном проекте IDE. В стандартном проекте для компиляции, развертывания и выполнения приложения используется созданный в среде IDE сценарий сборки проекта Ant.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>В поле "Имя проекта" введите "IFPWAFCAD".</strong> Также укажите местоположение проекта на компьютере. По умолчанию проекты в среде IDE помещаются в папку <code>NetBeansProjects</code> в домашнем каталоге. Нажмите кнопку "Далее".</p>
</li>
<li>
<p>В панели "Сервер и параметры" укажите сервер GlassFish в качестве сервера, на котором будет запускаться приложение.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*Примечание.*Сервер GlassFish отображается в раскрывающемся списке 'Сервер', если установлена версия Java <a href="https://netbeans.org/downloads/index.html">IDE NetBeans</a>. Поскольку сервер GlassFish включен в загрузку, он регистрируется в среде IDE автоматически. Для использования в проекте другого сервера нажмите кнопку "Добавить" рядом с полем с раскрывающимся списком "Сервер" и зарегистрируйте другой сервер в среде IDE. Работа с другими серверами, помимо GlassFish в рамках данного учебного курса не рассматривается.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В поле "Версия Java EE" выберите <strong>Java EE 5</strong>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/server-settings.png" alt="server settings">
</div>
<div class="title">Figure 5. Укажите настройки сервера в мастере создания веб-приложений</div>
</div>
<div class="paragraph">
<p>Для веб-проектов Java EE 6 и Java EE 7 использование дескриптора развертывания <code>web.xml</code> не требуется. Шаблон проекта NetBeans не содержит файл <code>web.xml</code> в проектах Java EE 6 и Java EE 7. Однако в данном учебном курсе рассматривается процесс объявления источника данных в дескрипторе развертывания. Функции, характерные только для Java EE 6 или Java EE 7, не требуются, поэтому в качестве версии проекта можно указать Java EE 5.</p>
</div>
<div class="paragraph">
<p><strong>Примечание.</strong> Точно так же можно указать в качестве версии проекта Java EE 6 или Java EE 7, а затем создать дескриптор развертывания <code>web.xml</code>. В мастере создания файла выберите категорию "Web", а затем выберите "Стандартный дескриптор развертывания".</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "Завершить". Создается шаблон проекта для всего приложения и в редакторе открывается пустая страница JSP (<code>index.jsp</code>). Файл `index.jsp`служит в приложении страницей приветствия.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prepareInterface">Подготовка веб-интерфейса</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Начните с подготовки страницы приветствия (<code>index.jsp</code>) и страницы ответов (<code>response.jsp</code>). На странице приветствия реализована форма HTML для сбора пользовательских данных. На обеих страницах для просмотра структурированных данных используется таблица HTML. В этом разделе также рассматривается процесс создания таблицы стилей, которая расширяет внешний вид обеих страниц.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#welcomePage">Настройка страницы приветствия</a></p>
</li>
<li>
<p><a href="#responsePage">Создание страницы ответов</a></p>
</li>
<li>
<p><a href="#stylesheet">Создание таблицы стилей</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="welcomePage">Настройка страницы приветствия</h3>
<div class="paragraph">
<p>Убедитесь, что страница <code>index.jsp</code> открыта в редакторе. Если файл еще не открыт, дважды щелкните <code>index.jsp</code> под узлом "Веб-страницы" проекта IFPWAFCAD в окне "Проекты".</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В редакторе измените текст между тегами <code>&lt;title&gt;</code> на <code>Домашняя страница IFPWAFCAD</code>.</p>
</li>
<li>
<p>Измените текст между тегами <code>&lt;h1&gt;</code> на <code>Добро пожаловать в IFPWAFCAD, Международную ассоциацию по консультированию и развитию для бывших профессиональных борцов!</code></p>
</li>
<li>
<p>Откройте палитру среды IDE, выбрав в главном меню "Окно" &gt; "Палитра" (CTRL+SHIFT+8; &amp;#8984+SHIFT+8 в ОС Mac). Наведите курсор на значок "Таблица" в категории "HTML" и обратите внимание на то, что отображается фрагмент кода для элемента по умолчанию.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/palette.png" alt="palette">
</div>
<div class="title">Figure 6. На палитре отображается фрагмент кода при подведении курсора к элементу</div>
</div>
<div class="paragraph">
<p><span class="tips">Палитру можно настроить в соответствии с существующими требованиями - щелкните правой кнопкой мыши палитру и выберите 'Показать крупные значки' и 'Скрыть имена элементов', чтобы палитра выглядела как на рисунке выше.</span></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Установите курсор сразу же после тегов <code>&lt;h1&gt;</code>. (Именно в этом месте будет внедрена новая таблица HTML). Далее в окне "Палитра" дважды щелкните значок "Таблица".</p>
</li>
<li>
<p>В появившемся диалоговом окне "Вставка таблицы" укажите следующие значения и затем нажмите кнопку "ОК":</p>
<div class="ulist">
<ul>
<li>
<p><strong>Рядов</strong>: 2</p>
</li>
<li>
<p><strong>Столбцов</strong>: 1</p>
</li>
<li>
<p><strong>Размер границы</strong>: 0
Код таблицы HTML создан и добавлен на страницу.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Добавьте следующее содержимое в заголовок таблицы и ячейку первой строки таблицы (новое содержимое выделено <strong>полужирным шрифтом</strong>):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;table border="0"&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th&gt;*IFPWAFCAD offers expert counseling in a wide range of fields.*&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
        &lt;tr&gt;
            &lt;td&gt;*To view the contact details of an IFPWAFCAD certified former
                professional wrestler in your area, select a subject below:*&lt;/td&gt;
        &lt;/tr&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Для нижней строки таблицы вставьте форму HTML. Для этого поместите курсор между второй парой тегов <code>&lt;td&gt;</code> и дважды щелкните значок формы HTML ( <span class="image"><img src="images/html-form-icon.png" alt="html form icon"></span> ) на палитре. В диалоговом окне "Вставка формы" введите <code>response.jsp</code> в текстовом поле "Действие" и нажмите кнопку "ОК".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/insert-form.png" alt="insert form">
</div>
<div class="title">Figure 7. Укажите настройки формы в диалоговом окне 'Вставить форму'</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Между тегами <code>&lt;form&gt;</code> введите следующее содержимое (новое содержимое выделено <strong>полужирным шрифтом</strong>):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;tr&gt;
    &lt;td&gt;
        &lt;form action="response.jsp"&gt;
            *&lt;strong&gt;Select a subject:&lt;/strong&gt;*
        &lt;/form&gt;
    &lt;/td&gt;
&lt;/tr&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите клавишу Enter, чтобы добавить пустую строку после добавленного содержимого, затем дважды щелкните "Список" в палитре, чтобы открыть диалоговое окно "Вставить список".</p>
</li>
<li>
<p>В диалоговом окне "Вставить список" ведите <code>subject_id</code> для текстового поля "Имя" и нажмите "OK". Обратите внимание на то, что к форме добавляется фрагмент кода для раскрывающегося списка.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Количество параметров для раскрывающегося списка не имеет значения. Позже в этом учебном курсе будет показано добавление тегов JSTL для динамического создания на основе данных, полученных из таблицы базы данных "Subject".</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте элемент кнопки 'Отправить' ( <span class="image"><img src="images/submit-button.png" alt="submit button"></span> ) в точку, расположенную непосредственно после только что добавленного раскрывающегося списка. Для этого можно использовать окно "Палитра" или вызвать дополнение кода в редакторе, как показано в предыдущем шаге. В диалоговом окне "Вставка кнопки" в текстовых полях "Подпись" и "Имя" введите <code>Отправить</code> и нажмите кнопку ОК.</p>
</li>
<li>
<p>Для форматирования кода щелкните правой кнопкой мыши в редакторе и выберите 'Формат' (Alt-Shift-F; Ctrl-Shift-F в Mac). Код автоматически форматируется и должен теперь выглядеть следующим образом:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;body&gt;
    &lt;h2&gt;Welcome to &lt;strong&gt;IFPWAFCAD&lt;/strong&gt;, the International Former
        Professional Wrestlers' Association for Counseling and Development!
    &lt;/h2&gt;

    &lt;table border="0"&gt;
        &lt;thead&gt;
            &lt;tr&gt;
                &lt;th&gt;IFPWAFCAD offers expert counseling in a wide range of fields.&lt;/th&gt;
            &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
            &lt;tr&gt;
                &lt;td&gt;To view the contact details of an IFPWAFCAD certified former
                    professional wrestler in your area, select a subject below:&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;
                    &lt;form action="response.jsp"&gt;
                        &lt;strong&gt;Select a subject:&lt;/strong&gt;
                        &lt;select name="subject_id"&gt;
                            &lt;option&gt;&lt;/option&gt;
                        &lt;/select&gt;
                        &lt;input type="submit" value="submit" name="submit" /&gt;
                    &lt;/form&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
        &lt;/tbody&gt;
    &lt;/table&gt;
&lt;/body&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Для просмотра этой страницы в браузере щелкните правой кнопкой мыши в редакторе и выберите 'Запустить файл' (Shift-F6; Fn-Shift-F6 в Mac). После этого страница JSP будет автоматически скомпилирована и развернута на сервере. Открывается браузер по умолчанию, и в нем выводится страница из местоположения, где она развернута.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/browser-output.png" alt="browser output">
</div>
<div class="title">Figure 8. Файл index.jsp отображается в браузере</div>
</div>
</div>
<div class="sect2">
<h3 id="responsePage">Создание страницы ответов</h3>
<div class="paragraph">
<p>Для подготовки интерфейса для страницы <code>response.jsp</code> сначала необходимо создать файл в проекте. Обратите внимание на то, что большая часть содержимого, отображаемого на странице, создана динамически с помощью технологии JSP. Поэтому в следующих шагах будет необходимо добавить <em>метки-заполнители</em>, которые позже будут заменены кодом JSP.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните правой кнопкой мыши узел проекта "IFPWAFCAD" в окне "Проекты" и выберите "Создать &gt; JSP". Откроется диалоговое окно "Новый файл JSP".</p>
</li>
<li>
<p>В поле "Имя файла JSP" введите <code>response</code>. Обратите внимание на то, что в настоящий момент для поля "Расположение" выбран каталог "Веб-страницы", это означает, что файл будет создан в каталоге проекта <code>web</code>. Это то же местоположение, что и для страницы приветствия <code>index.jsp</code>.</p>
</li>
<li>
<p>Примите остальные значения по умолчанию и нажмите кнопку "Готово". В редакторе выполняется создание и открытие шаблона новой страницы <code>response.jsp</code>. Новый узел JSP также отображается в каталоге "Веб-страницы" в окне "Проекты".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/response-jsp-node.png" alt="response jsp node">
</div>
<div class="title">Figure 9. Узел response.jsp отображается в окне 'Проекты'</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В редакторе измените заголовок на <code>IFPWAFCAD - {местозаполнитель}</code></p>
</li>
<li>
<p>Удалите строку <code>&lt;h1&gt;Hello World!&lt;/h1&gt;</code> строка между тегами <code>&lt;body&gt;</code>. Скопируйте и вставьте в тело страницы следующую таблицу HTML:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;table border="0"&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th colspan="2"&gt;{placeholder}&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;strong&gt;Description: &lt;/strong&gt;&lt;/td&gt;
            &lt;td&gt;&lt;span style="font-size:smaller; font-style:italic;"&gt;{placeholder}&lt;/span&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;strong&gt;Counselor: &lt;/strong&gt;&lt;/td&gt;
            &lt;td&gt;{placeholder}
                &lt;br&gt;
                &lt;span style="font-size:smaller; font-style:italic;"&gt;
                member since: {placeholder}&lt;/span&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;strong&gt;Contact Details: &lt;/strong&gt;&lt;/td&gt;
            &lt;td&gt;&lt;strong&gt;email: &lt;/strong&gt;
                &lt;a href="mailto:{placeholder}"&gt;{placeholder}&lt;/a&gt;
                &lt;br&gt;&lt;strong&gt;phone: &lt;/strong&gt;{placeholder}
            &lt;/td&gt;
        &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Для просмотра этой страницы в браузере щелкните правой кнопкой мыши в редакторе и выберите 'Запустить файл' (Shift-F6; Fn-Shift-F6 в Mac). Выполняется компиляция и развертывание страницы на сервере GlassFish с последующим открытием в браузере по умолчанию.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/browser-response.png" alt="browser response">
</div>
<div class="title">Figure 10. Файл response.jsp отображается в браузере</div>
</div>
</div>
<div class="sect2">
<h3 id="stylesheet">Создание таблицы стилей</h3>
<div class="paragraph">
<p>Создайте простую таблицу стилей для расширения просмотра в веб-интерфейсе. При работе с данным учебным курсом предполагается, что пользователь обладает знаниями о правилах стилей и их влиянии на соответствующие элементы HTML на страницах <code>index.jsp</code> и <code>response.jsp</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте мастер создания файлов, нажав кнопку 'Создать файл' ( <span class="image"><img src="images/new-file-btn.png" alt="new file btn"></span> ) на главной панели инструментов IDE. Выберите категорию "Web", а затем выберите "Каскадная таблица стилей" и нажмите кнопку "Далее".</p>
</li>
<li>
<p>Введите <code>style</code> в поле "Имя файла CSS" и нажмите кнопку "Готово". Среда IDE создает пустой файл CSS и располагает его в том же местоположении проекта, что и <code>index.jsp</code> и <code>response.jsp</code>. Обратите внимание на то, что узел для <code>style.css</code> отображается теперь внутри проекта в окне "Проекты", а файл открывается в редакторе.</p>
</li>
<li>
<p>В редакторе добавьте следующее содержимое к файлу <code>style.css</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">body {
    font-family: Verdana, Arial, sans-serif;
    font-size: smaller;
    padding: 50px;
    color: #555;
}

h1 {
    text-align: left;
    letter-spacing: 6px;
    font-size: 1.4em;
    color: #be7429;
    font-weight: normal;
    width: 450px;
}

table {
    width: 580px;
    padding: 10px;
    background-color: #c5e7e0;
}

th {
    text-align: left;
    border-bottom: 1px solid;
}

td {
    padding: 10px;
}

a:link {
   color: #be7429;
   font-weight: normal;
   text-decoration: none;
}

a:link:hover {
   color: #be7429;
   font-weight: normal;
   text-decoration: underline;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Подключите таблицу стилей к <code>index.jsp</code> и <code>response.jsp</code>. На обеих страницах добавьте следующую строку между тегами <code>&lt;head&gt;</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;link rel="stylesheet" type="text/css" href="style.css"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tips">Для быстрого перехода между открытыми в редакторе файлами нажмите CTRL+TAB, а затем выберите требуемый файл.</span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prepareCommunication">Подготовка средств обмена данными между приложениями и базой данных</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Наиболее эффективным способом реализации соединения между сервером и базой данных является настройка <em>пула подключений</em> базы данных. Создание нового подключения для каждого запроса клиента может занимать много времени, особенно для приложений, постоянно получающих огромное количество запросов. Во избежание этого создается и поддерживается множество подключений, организованных в виде пула подключений. Входящие запросы, требующие доступа к данным приложения, используют уже созданное подключение из пула. Аналогичным образом, когда запрос завершен, подключение не закрывается, а возвращается в пул.</p>
</div>
<div class="paragraph">
<p>После подготовки источника данных и пула подключений для сервера необходимо определить в приложении необходимость использования источника данных. Как правило, для этого создается запись в дескрипторе развертывания приложения <code>web.xml</code>. Наконец, необходимо проверить доступность для сервера драйвера базы данных (JDBC MySQL Connector/J).</p>
</div>
<div class="paragraph">
<p>*Примечание. *Для дальнейшей работы необходимо убедиться в том, что база данных MySQL с именем <code>MyNewDatabase</code> настроена корректно и содержит данные примера из <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJava%2520Web%252Fifpwafcad.sql">ifpwafcad.sql</a>. Этот файл SQL создает две таблицы <code>Subject</code> и <code>Counselor</code> и затем заполняет их данными для примера. Если это не было выполнено ранее, или с этим заданием возникли сложности, то прежде чем продолжить учебный курс, обратитесь к разделу <a href="../../docs/ide/mysql.html">Подключение к базе данных MySQL</a>.</p>
</div>
<div class="paragraph">
<p>Помимо этого для создания источника данных и работы с сервером GlassFish в рамках данного учебного курса необходимо защитить базу данных паролем. При использовании учетной записи MySQL <code>root</code> по умолчанию с пустым паролем с помощью командной строки можно установить другой пароль.</p>
</div>
<div class="paragraph">
<p>В качестве пароля в этом учебном курсе используется <code>nbuser</code>. Для установки пароля <code><em>nbuser</em></code> в командной строке откройте в системе MySQL каталог <code>bin</code> и введите следующие данные:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">shell&gt; mysql -u root
mysql&gt; UPDATE mysql.user SET Password = PASSWORD('_nbuser_')
    -&gt;     WHERE User = 'root';
mysql&gt; FLUSH PRIVILEGES;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Дополнительные сведения приведены в официальном справочном руководстве по работе с MySQL: <a href="http://dev.mysql.com/doc/refman/5.1/en/default-privileges.html">Защита исходных учетных записей MySQL</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#setUpJDBC">Настройка источника данных JDBC и пула подключений</a></p>
</li>
<li>
<p><a href="#referenceDataSource">Обращение к источнику данных из приложения</a></p>
</li>
<li>
<p><a href="#addJar">Добавление файла JAR драйвера базы данных к серверу</a></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="setUpJDBC">Настройка источника данных JDBC и пула подключений</h3>
<div class="paragraph">
<p>Сервер GlassFish Server Open Source Edition содержит библиотеку формирования пула подключений к базе данных (DBCP) с функцией формирования пула подключений в прозрачном для разработчика режиме. Для этого необходимо настроить для сервера <em>источник данных</em> <a href="http://docs.oracle.com/javase/tutorial/jdbc/overview/index.html">JDBC</a> (связь с базами данных Java) для использования в приложении при формировании пула подключений.</p>
</div>
<div class="paragraph">
<p>Дополнительные сведения о технологии JDBC приведены в документе <a href="http://docs.oracle.com/javase/tutorial/jdbc/basics/index.html">Учебные курсы Java: основы JDBC</a>.</p>
</div>
<div class="paragraph">
<p>Источник данных можно настроить непосредственно в консоли администратора сервера GlassFish или объявить необходимые для приложения ресурсы в файле <code>glassfish-resources.xml</code>, как описано ниже. При развертывании приложения сервер считывает объявления ресурсов и создает требуемые ресурсы.</p>
</div>
<div class="paragraph">
<p>Далее рассматривается процесс объявления пула подключений и источника данных, использующего этот пул. Оба действия можно выполнить с помощью мастера ресурсов JDBC NetBeans.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте мастер создания файлов, нажав кнопку 'Создать файл' ( <span class="image"><img src="images/new-file-btn.png" alt="new file btn"></span> ) на главной панели инструментов IDE. Выберите категорию сервера GlassFish, затем выберите "Ресурс JDBC" и нажмите кнопку "Далее".</p>
</li>
<li>
<p>В шаге 2, в области "Общие атрибуты" выберите параметр "Создать новый пул соединений JDBC", а затем в текстовом поле "Имя JNDI" введите <strong>jdbc/IFPWAFCAD</strong>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jdbc-resource-wizard.png" alt="jdbc resource wizard">
</div>
<div class="title">Figure 11. Укажите настройки источника данных в мастере ресурсов JDBC</div>
</div>
<div class="paragraph">
<p><span class="tips">Источник данных JDBC использует <a href="http://www.oracle.com/technetwork/java/jndi/index.html">JNDI</a>. В интерфейсе API JNDI предоставляется единый для всех приложений способ поиска источников данных и получения доступа к ним. Дополнительные сведения приведены в <a href="http://docs.oracle.com/javase/jndi/tutorial/">Учебном курсе по JND</a>.</span></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Дополнительно можно добавить описание источника данных. Например, укажите <code>Обеспечивает доступ к базам данных, поставляющим данные для приложения IFPWAFCAD</code>.</p>
</li>
<li>
<p>Нажмите кнопку "Далее". После этого еще раз нажмите кнопку "Далее" и пропустите шаг 3, "Дополнительные свойства".</p>
</li>
<li>
<p>В шаге 4 укажите имя пула подключений JDBC <strong>IfpwafcadPool</strong>. Убедитесь, что выбран параметр "Извлечь из существующего соединения" и выберите <code>jdbc:mysql://localhost:3306/MyNewDatabase</code> из раскрывающегося списка. Нажмите кнопку "Далее".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jdbc-resource-wizard2.png" alt="jdbc resource wizard2">
</div>
<div class="title">Figure 12. Укажите настройки пула подключений в мастере ресурсов JDBC</div>
</div>
<div class="paragraph">
<p>*Примечание. *Мастер обнаруживает все соединения с базой данных, настроенные в IDE. Поэтому на этот момент должно существовать созданное подключение к базе данных <code>MyNewDatabase</code>. Можно проверить, какие подключения были созданы, открыв окно 'Службы' (Ctrl-5; ⌘-5 в Mac) и выполнив поиск узлов подключения ( <span class="image"><img src="images/connection-node-icon.png" alt="connection node icon"></span> ) в категории 'Базы данных'.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>На этапе 5 выберите файл <code>javax.sql.ConnectionPoolDataSource</code> в списке "Тип ресурса".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Обратите внимание на то, что среда IDE извлекает информацию из подключенной базы данных, указанной на предыдущем этапе, и задает свойства "имя-значение" для нового пула подключений.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jdbc-resource-wizard3.png" alt="jdbc resource wizard3">
</div>
<div class="title">Figure 13. Значения по умолчанию основаны на данных, извлеченных из выбранного подключения к базе данных</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "Завершить". Мастер ресурсов создает файл <code>glassfish-resources.xml</code>, который содержит записи для источника данных и указанный пул подключения.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>В окне "Проекты" можно открыть <code>glassfish-resources.xml</code>, созданный в дереве узла "Серверные ресурсы". Обратите внимание, что в тегах <code>&lt;resources&gt;</code> источник данных и пул соединений объявлены как содержащие ранее указанные значения.</p>
</div>
<div class="paragraph">
<p>Для подтверждения регистрации нового источника данных и пула подключения на сервере GlassFish, можно развернуть проект на сервере, затем расположить ресурсы в окне "Службы" среды IDE.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В окне 'Проекты', щелкните правой кнопкой мыши узел проекта IFPWAFCAD и выберите 'Развернуть'. Запустится сервер, если это не было выполнено ранее, и проект будет скомпилирован и развернут на этом сервере.</p>
</li>
<li>
<p>Откройте окно "Службы" (CTRL+5; &amp;#8984+5 в системе Mac OS) и разверните узлы "Серверы" &gt; "GlassFish" &gt; "Ресурсы" &gt; "JDBC" &gt; "Ресурсы и пулы подключения JDBC". Проверьте, что теперь отображаются новый источник данных и пул подключений:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/services-window-glassfish.png" alt="services window glassfish">
</div>
<div class="title">Figure 14. Новый источник данных и пул подключений отображаются в окне 'Службы'</div>
</div>
</div>
<div class="sect2">
<h3 id="referenceDataSource">Обращение к источнику данных из приложения</h3>
<div class="paragraph">
<p>Необходимо создать ссылку на только что созданный в веб-приложении ресурс JDBC. Для этого можно создать запись в дескрипторе развертывания приложения <code>web.xml</code>.</p>
</div>
<div class="paragraph">
<p>Дескрипторы развертывания являются текстовыми файлами на основе XML, содержащими информацию о развертывании приложения в определенной среде. Например, они обычно используются для указания параметров контекста приложения и поведенческих шаблонов, настроек безопасности, а также отображений для сервлетов, фильтров и прослушивающих процессов.</p>
</div>
<div class="paragraph">
<p><strong>Примечание.</strong> Если в качестве версии Java при создании проекта указана Java EE 6 или Java EE 7, необходимо создать файл дескриптора развертывания. Для этого выберите "Веб &gt; Стандартный дескриптор развертывания" в мастере создания файлов.</p>
</div>
<div class="paragraph">
<p>Произведите следующие действия, чтобы поместить ссылку на источник данных в дескрипторе развертывания приложения.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В окне "Проекты" разверните структуру папки "Файлы конфигурации" и дважды щелкните <code>web.xml</code>, чтобы открыть файл в редакторе.</p>
</li>
<li>
<p>Откройте вкладку "Ссылки" в верхней области экрана редактора.</p>
</li>
<li>
<p>Разверните заголовок "Ссылки на ресурсы" и нажмите кнопку "Добавить", чтобы открыть диалог "Добавление ссылки на ресурс".</p>
</li>
<li>
<p>В поле "Имя ресурса" введите имя ресурса, указанное выше при настройке источника данных для сервера (<code>jdbc/IFPWAFCAD</code>).</p>
</li>
<li>
<p>Укажите <strong><code>javax.sql.ConnectionPoolDataSource</code></strong> в поле "Тип ресурса". Нажмите кнопку "ОК".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Поле "Описание" является необязательным, но можно добавить удобочитаемое описание ресурса, например, <code>База данных для приложения "IFPWAFCAD"</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/add-resource-reference.png" alt="add resource reference">
</div>
<div class="title">Figure 15. Укажите свойсва ресурсов в диалоговом окне 'Добавление ссылок на ресурсы'</div>
</div>
<div class="paragraph">
<p>Новый ресурс теперь перечислен в списке под заголовком 'Ссылки на ресурсы'.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Чтобы убедиться, что ресурс добавлен в файл <code>web.xml</code>, перейдите на вкладку "Исходный код" в верхней части экрана редактора. Заметим, что теперь в код включены следующие теги &lt;`resource-ref`&gt;.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;resource-ref&gt;
    &lt;description&gt;Database for IFPWAFCAD application&lt;/description&gt;
    &lt;res-ref-name&gt;jdbc/IFPWAFCAD&lt;/res-ref-name&gt;
    &lt;res-type&gt;javax.sql.ConnectionPoolDataSource&lt;/res-type&gt;
    &lt;res-auth&gt;Container&lt;/res-auth&gt;
    &lt;res-sharing-scope&gt;Shareable&lt;/res-sharing-scope&gt;
&lt;/resource-ref&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="addJar">Добавление файла JAR драйвера базы данных к серверу</h3>
<div class="paragraph">
<p>Добавление файла JAR драйвера базы данных является следующим шагом, необходимым для обеспечения взаимодействия сервера с базой данных. Необходимо поместить каталог установки драйвера базы данных и скопировать файл <code>mysql-connector-java-5.1.6.x-bin.jar</code> из корневого каталога драйвера в папку библиотеки на используемом сервере. Управление сервером в среде IDE при развертывании может обнаружить, добавлен ли файл JAR, и если нет, выполняет это автоматически.</p>
</div>
<div class="paragraph">
<p>Чтобы продемонстрировать это, откройте Диспетчер серверов (выберите "Сервис &gt; Серверы"). В среде IDE предоставляется параметр "Развертывание драйвера JDBC". Если параметр включен, он запускает проверку для определения, требуются ли драйверы для развернутых на сервере приложений. В случае MySQL, если драйвер требуется, но он отсутствует, включенный драйвер среды IDE развертывается в соответствующем месте на сервере.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите "Сервис &gt; Серверы", чтобы открыть Диспетчер серверов. На левой панели выберите "GlassFish".</p>
</li>
<li>
<p>В главном окне выберите параметр "Включить развертывание драйвера JDBC".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/servers-window.png" alt="servers window">
</div>
<div class="title">Figure 16. Параметр развертывания драйвера JDBC обеспечивает поддержку автоматического развертывания драйверов</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Прежде чем закрыть Диспетчер серверов, запишите путь, указанный в текстовом поле "Папка доменов". При подключении к серверу GlassFish в среде IDE фактически подключение выполняется к <em>экземпляру</em> сервера приложений. Каждый экземпляр запускает приложения в уникальном домене, а в поле "Имя домена" указано имя используемого сервером домена. Как видно на рисунке выше, файл JAR драйвера должен находиться в <code>domain1</code>. Это домен по умолчанию, созданный при установке сервера GlassFish.</p>
</li>
<li>
<p>Нажмите кнопку "Закрыть", чтобы выйти из Диспетчера серверов.</p>
</li>
<li>
<p>На компьютере перейдите к каталогу установки GlassFish и войдите в подпапку <code>domains</code> &gt; <code>domain1</code> &gt; <code>lib</code>. Поскольку проект IFPWAFCAD уже должен быть развернут на сервере, должен отображаться файл <code>mysql-connector-java-5.1.6-bin.jar</code>. Если файл JAR драйвера не отображается, выполните следующий шаг.</p>
</li>
<li>
<p>Разверните проект на сервере. В окне 'Проекты' среды IDE выберите 'Развернуть' в контекстном меню узла проекта. Ход выполнения можно видеть в окне "Вывод" среды IDE (CTRL+4; &amp;#8984+4 для Mac). В окне "Вывод" указывается, что драйвер MySQL развернут в местоположении на сервере GlassFish.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/output-window.png" alt="output window">
</div>
<div class="title">Figure 17. В окне вывода указывается, что драйвер MySQL был развернут</div>
</div>
<div class="paragraph">
<p>При возврате в подпапку <code>domain1/lib</code> на компьютере видно, что файл <code>mysql-connector-java-5.1.6.x-bin.jar</code> добавлен автоматически.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="addLogic">Добавление динамической логики</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Вернемся к местозаполнителям <code>index.jsp</code> и <code>response.jsp</code>, созданным выше при работе с учебным курсом. Теперь можно реализовать код JSTL для <em>динамического</em> (т. е. на основе пользовательского ввода) создания содержимого на страницах. Для этого выполните следующие три задания.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#addJSTL">Добавление библиотеки JSTL к пути к классам проекта</a></p>
</li>
<li>
<p><a href="#implementCode">Реализация кода JSTL</a></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="addJSTL">Добавление библиотеки JSTL к пути к классам проекта</h3>
<div class="paragraph">
<p>Для доступа к данным из базы данных и их просмотра используйте <a href="http://www.oracle.com/technetwork/java/index-jsp-135995.html">Библиотеку стандартных тегов JavaServer Pages</a> (JSTL). Сервер GlassFish по умолчанию содержит библиотеку JSTL. Для проверки разверните узел сервера GlassFish под узлом "Библиотеки" в окне "Проекты" и найдите библиотеку <code>javax.servlet.jsp.jstl.jar</code>. (В более ранних версиях сервера GlassFish используется библиотека <code>jstl-impl.jar</code>.) Поскольку библиотеки сервера GlassFish по умолчанию добавляются в путь классов проекта, на данном этапе никаких действий не требуется.</p>
</div>
<div class="paragraph">
<p>JSTL имеет четыре основных раздела функциональности.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>core</code>: базовые, структурные задачи, такие как итерации и условные выражения для контроля потока операций</p>
</li>
<li>
<p><code>fmt</code>: форматирование сообщений интернационализации и локализации</p>
</li>
<li>
<p><code>sql</code>: простой доступ к базе данных</p>
</li>
<li>
<p><code>xml</code>: обработка содержимого XML</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Основное внимание в данном учебном курсе уделяется библиотекам тегов <code>core</code> и <code>sql</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="implementCode">Реализация кода JSTL</h3>
<div class="paragraph">
<p>Теперь можно реализовать код для динамического извлечения и просмотра данных на каждой странице. Для обеих страниц требуется реализация запроса SQL с использованием источника данных, созданного выше в рамках данного учебного курса.</p>
</div>
<div class="paragraph">
<p>В среде IDE предоставляется несколько специфичных для базы данных фрагментов JSTL, доступных для выбора в окне "Палитра" (CTRL+SHIFT+8; &amp;#8984+SHIFT+8 для Mac).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/palette-db.png" alt="palette db">
</div>
<div class="title">Figure 18. В палитре выберите фрагменты JSTL, связанные с базой данных</div>
</div>
<div class="sect3">
<h4 id="_index_jsp_2">index.jsp</h4>
<div class="paragraph">
<p>Для динамического отображения содержимого формы на странице <code>index.jsp</code> необходимо получить доступ ко всем <code>именам</code> из таблицы базы данных "Subject":</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Наведите курсор мыши на элемент "Отчет БД" в окне "Палитра".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/db-report.png" alt="db report">
</div>
<div class="title">Figure 19. Введите 'db' и нажмите Ctrl-Пробел для доступа к фрагментам JSTL, связанных с базами данных</div>
</div>
<div class="paragraph">
<p>Для элемента "Отчет БД" при создании запроса SQL используется тег <code>&lt;sql:query&gt;</code>, после чего с помощью тега <code>&lt;c:forEach&gt;</code> обрабатывается <code>resultset</code> запроса, а затем выполняется вывод извлеченных данных.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Установите курсор над объявлением <code>&lt;%@page &#8230;&#8203; %&gt;</code> (строка 7) и дважды щелкните элемент "Отчет БД" в окне "Палитра". В открывшемся диалоговом окне введите следующие подробные сведения:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Имя переменной:</strong> <code>subjects</code></p>
</li>
<li>
<p><strong>Контекст:</strong> <code>страница</code></p>
</li>
<li>
<p><strong>Источник данных:</strong> <code>jdbc/IFPWAFCAD</code></p>
</li>
<li>
<p><strong>Оператор запроса:</strong> <code>SELECT subject_id, name FROM Subject</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/insert-db-report.png" alt="insert db report">
</div>
<div class="title">Figure 20. Используйте диалоговое окно 'Вставить отчет базы данных' для указания сведения, связанных с запросом</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "ОК". В файле <code>index.jsp</code> создается следующее содержимое. Новое содержимое выделено <strong>полужирным шрифтом</strong>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">*&lt;%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%&gt;
&lt;%@taglib prefix="sql" uri="http://java.sun.com/jsp/jstl/sql"%&gt;*
&lt;%--
    Document   : index
    Author     : nbuser
--%&gt;

*&lt;sql:query var="subjects" dataSource="jdbc/IFPWAFCAD"&gt;
    SELECT subject_id, name FROM Subject
&lt;/sql:query&gt;

&lt;table border="1"&gt;
    &lt;!-- column headers --&gt;
    &lt;tr&gt;
    &lt;c:forEach var="columnName" items="${subjects.columnNames}"&gt;
        &lt;th&gt;&lt;c:out value="${columnName}"/&gt;&lt;/th&gt;
    &lt;/c:forEach&gt;
&lt;/tr&gt;
&lt;!-- column data --&gt;
&lt;c:forEach var="row" items="${subjects.rowsByIndex}"&gt;
    &lt;tr&gt;
    &lt;c:forEach var="column" items="${row}"&gt;
        &lt;td&gt;&lt;c:out value="${column}"/&gt;&lt;/td&gt;
    &lt;/c:forEach&gt;
    &lt;/tr&gt;
&lt;/c:forEach&gt;
&lt;/table&gt;*

&lt;%@page contentType="text/html" pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Обратите внимание на то, что в среде IDE автоматически добавлены директивы <code>taglib</code>, необходимые для тегов JSTL, используемых в созданном содержимом, (<code>&lt;sql:query&gt;</code> и <code>&lt;c:forEach&gt;</code>). Директива <code>taglib</code> объявляет, что на странице JSP используются пользовательские теги (JSTL), указывает библиотеку тегов, которая их определяет, а также префикс тега.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Запустите проект, чтобы проверить его отображение в браузере. Щелкните правой кнопкой мыши узел проекта в окне "Проекты" и выберите "Выполнить".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При выборе "Выполнить", IDE развертывает проект на сервере GlassFish, страница индексов компилируется в сервлет, а страница приветствия открывается в браузере по умолчанию. Код, созданный на основе элемента "Отчет БД", определяет следующую таблицу на странице приветствия.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/db-report-table.png" alt="db report table">
</div>
<div class="title">Figure 21. Используйте отчет базы данных для быстрого создания прототипов данных таблицы базы данных</div>
</div>
<div class="paragraph">
<p>Как видно, с помощью элемента "Отчет БД" можно быстро протестировать подключение к базе данных и просмотреть табличные данные из базы данных в браузере. Это особенно рекомендуется при создании прототипов.</p>
</div>
<div class="paragraph">
<p>В следующих шагах рассматривается интеграция созданного кода в раскрывающийся список HTML, созданный выше при работе с данным учебным курсом.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Проверьте данные столбцов в созданном коде. Используется два тега <code>&lt;c:forEach&gt;</code>, причем один из них вставляется в другой. В результате контейнер JSP (сервер GlassFish) выполняет цикл по всем строкам таблицы с циклическим прохождением всех столбцов. Аналогично отображаются данные для всей таблицы.</p>
</li>
<li>
<p>Интегрируйте теги <code>&lt;c:forEach&gt;</code> в форму HTML следующим образом. Значение каждого элемента изменяется на <code>subject_id</code>, а текст вывода - на <code>name</code>, как записано в базе данных. (Изменения выделяются <strong>полужирным шрифтом</strong>).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;form action="response.jsp"&gt;
    &lt;strong&gt;Select a subject:&lt;/strong&gt;
    &lt;select name="subject_id"&gt;
        *&lt;c:forEach var="row" items="${subjects.rowsByIndex}"&gt;
            &lt;c:forEach var="column" items="${row}"&gt;*
                &lt;option *value="&lt;c:out value="${column}"/&gt;"*&gt;*&lt;c:out value="${column}"/&gt;*&lt;/option&gt;
            *&lt;/c:forEach&gt;
        &lt;/c:forEach&gt;*
    &lt;/select&gt;
    &lt;input type="submit" value="submit" name="submit" /&gt;
&lt;/form&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tips">Ниже показан более простой способ интеграции тегов <code>&lt;c:forEach&gt;</code> в форму HTML.</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;form action="response.jsp"&gt;
    &lt;strong&gt;Select a subject:&lt;/strong&gt;
    &lt;select name="subject_id"&gt;
        *&lt;c:forEach var="row" items="${subjects.rows}"&gt;*
            &lt;option *value="${row.subject_id}"*&gt;*${row.name}*&lt;/option&gt;
        *&lt;/c:forEach&gt;*
    &lt;/select&gt;
    &lt;input type="submit" value="submit" name="submit" /&gt;
&lt;/form&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Во всех случаях теги <code>&lt;c:forEach&gt;</code> циклически обрабатывает значения <code>subject_id</code> и <code>name</code> из запроса SQL со вставкой каждой пары в теги HTML <code>&lt;option&gt;</code>. Таким образом раскрывающийся список формы заполняется данными.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Удалите таблицу, созданную из элемента "Отчет БД". (Удаление показано ниже <strong><span class="line-through">перечеркнутым текстом</span></strong>.)</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%&gt;
&lt;%@taglib prefix="sql" uri="http://java.sun.com/jsp/jstl/sql"%&gt;
&lt;%--
    Document   : index
    Created on : Dec 22, 2009, 7:39:49 PM
    Author     : nbuser
--%&gt;

&lt;sql:query var="subjects" dataSource="jdbc/IFPWAFCAD"&gt;
    SELECT subject_id, name FROM Subject
&lt;/sql:query&gt;

*[.line-through]#&lt;table border="1"&gt;
    &lt;!-- column headers --&gt;
    &lt;tr&gt;
    &lt;c:forEach var="columnName" items="${subjects.columnNames}"&gt;
        &lt;th&gt;&lt;c:out value="${columnName}"/&gt;&lt;/th&gt;
    &lt;/c:forEach&gt;
&lt;/tr&gt;
&lt;!-- column data --&gt;
&lt;c:forEach var="row" items="${subjects.rowsByIndex}"&gt;
    &lt;tr&gt;
    &lt;c:forEach var="column" items="${row}"&gt;
        &lt;td&gt;&lt;c:out value="${column}"/&gt;&lt;/td&gt;
    &lt;/c:forEach&gt;
    &lt;/tr&gt;
&lt;/c:forEach&gt;
&lt;/table&gt;#*

&lt;%@page contentType="text/html" pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd"&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Сохраните изменения (CTRK+S; &amp;#8984+S в Mac OS).</p>
</li>
<li>
<p>Обновите страницу приветствия проекта в браузере.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Заметим, что раскрывающийся список в браузере теперь содержит названия тем, полученные из базы данных.</p>
</div>
<div class="paragraph">
<p>Повторно развертывать проект не нужно, так как функция "Компилировать при сохранении" (compile-on-save) включена для вашего проекта по умолчанию. Это означает, что при изменении и сохранении файла он автоматически компилируется и развёртывается, и нет необходимости перекомпилировать весь проект. Функцию компиляции при сохранении можно отключать в категории "Компиляция" в окне проекта "Свойства".</p>
</div>
</div>
<div class="sect3">
<h4 id="_response_jsp_2">response.jsp</h4>
<div class="paragraph">
<p>На странице ответов предоставляются подробные сведения о консультанте по теме, выбранной на странице приветствия. Созданный запрос должен содержать запись консультанта, идентификатор которого <code>counselor_id</code> соответствует значению <code>counselor_idfk</code> из выбранной записи темы.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Наведите указатель мыши на объявление <code>&lt;%@page &#8230;&#8203; %&gt;</code> (строка 7) и дважды щелкните "Запрос к БД" в палитре, чтобы открыть диалоговое окно "Вставить запрос к БД".</p>
</li>
<li>
<p>В диалоговом окне "Вставить запрос к БД" введите следующие данные.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Имя переменной:</strong> <code>counselorQuery</code></p>
</li>
<li>
<p><strong>Контекст:</strong> <code>страница</code></p>
</li>
<li>
<p><strong>Источник данных:</strong> <code>jdbc/IFPWAFCAD</code></p>
</li>
<li>
<p><strong>Оператор запроса:</strong> <code>SELECT * FROM Subject, Counselor WHERE Counselor.counselor_id = Subject.counselor_idfk AND Subject.subject_id = ? &lt;sql:param value="${param.subject_id}"/&gt;</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/insert-db-query2.png" alt="insert db query2">
</div>
<div class="title">Figure 22. Используйте диалоговое окно 'Вставить запрос базы данных' для указания сведения, связанных с запросом</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "ОК". В файле <code>response.jsp</code> создается следующее содержимое. Новое содержимое выделено <strong>полужирным шрифтом</strong>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">*&lt;%@taglib prefix="sql" uri="http://java.sun.com/jsp/jstl/sql"%&gt;*
&lt;%--
    Document   : response
    Created on : Dec 22, 2009, 8:52:57 PM
    Author     : nbuser
--%&gt;

*&lt;sql:query var="counselorQuery" dataSource="jdbc/IFPWAFCAD"&gt;
    SELECT * FROM Subject, Counselor
    WHERE Counselor.counselor_id = Subject.counselor_idfk
    AND Subject.subject_id = ? &lt;sql:param value="${param.subject_id}"/&gt;
&lt;/sql:query&gt;*

&lt;%@page contentType="text/html" pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Обратите внимание на то, что в среде IDE автоматически добавлена директива <code>taglib</code> для тега <code>&lt;sql:query&gt;</code>. Также отметьте, что непосредственно в запросе использовался тег <code>&lt;sql:param&gt;</code>. Поскольку для этого запроса используется значение <code>subject_id</code>, отправленное с <code>index.jsp</code>, извлечь это значение можно с помощью оператора EL (язык выражений) в форме <code>${param.subject_id}</code>, а затем передать его для тега <code>&lt;sql:param&gt;</code>. В этом случае его можно использовать вместо вопросительного знака SQL (<code>?</code>) во время выполнения.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Используйте тег <code>&lt;c:set&gt;</code> для установки переменной, соответствующей первой записи (строке) <code>resultset</code>, возвращенного из запроса. Новое содержимое выделено <strong>полужирным шрифтом</strong>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;sql:query var="counselorQuery" dataSource="jdbc/IFPWAFCAD"&gt;
    SELECT * FROM Subject, Counselor
    WHERE Counselor.counselor_id = Subject.counselor_idfk
    AND Subject.subject_id = ? &lt;sql:param value="${param.subject_id}"/&gt;
&lt;/sql:query&gt;

*&lt;c:set var="counselorDetails" value="${counselorQuery.rows[0]}"/&gt;*</code></pre>
</div>
</div>
<div class="paragraph">
<p>Несмотря на то, что возвращенный из запроса <code>resultset</code> должен содержать только одну запись, этот шаг является обязательным, поскольку для страницы необходимо обеспечить доступ к значениям в записи с помощью операторов EL (язык выражений). Вспомните, что на странице <code>index.jsp</code> можно было получить доступ к значениям из <code>resultset</code> просто посредством тега <code>&lt;c:forEach&gt;</code>. Однако тег <code>&lt;c:forEach&gt;</code> функционирует путем настройки переменной для строк из запроса, что позволяет извлекать значения путем включения переменной строки в операторы EL.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте директиву <code>taglib</code> для <code>базовой</code> библиотеки JSTL файла. Это обеспечит распознавание тега <code>&lt;c:set&gt;</code>. Новое содержимое выделено <strong>полужирным шрифтом</strong>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">*&lt;%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%&gt;*
&lt;%@taglib prefix="sql" uri="http://java.sun.com/jsp/jstl/sql"%&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В разметке HTML замените все местозаполнители кодом операторов EL с отображением данных из переменной <code>counselorDetails</code>. (Изменения выделены ниже <strong>полужирным шрифтом</strong>):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/&gt;
        &lt;link rel="stylesheet" type="text/css" href="style.css"&gt;
        &lt;title&gt;*${counselorDetails.name}*&lt;/title&gt;
    &lt;/head&gt;

    &lt;body&gt;
        &lt;table&gt;
            &lt;tr&gt;
                &lt;th colspan="2"&gt;*${counselorDetails.name}*&lt;/th&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;strong&gt;Description: &lt;/strong&gt;&lt;/td&gt;
                &lt;td&gt;&lt;span style="font-size:smaller; font-style:italic;"&gt;*${counselorDetails.description}*&lt;/span&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;strong&gt;Counselor: &lt;/strong&gt;&lt;/td&gt;
                &lt;td&gt;&lt;strong&gt;*${counselorDetails.first_name} ${counselorDetails.nick_name} ${counselorDetails.last_name}*&lt;/strong&gt;
                    &lt;br&gt;&lt;span style="font-size:smaller; font-style:italic;"&gt;
                    &lt;em&gt;member since: *${counselorDetails.member_since}*&lt;/em&gt;&lt;/span&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;strong&gt;Contact Details: &lt;/strong&gt;&lt;/td&gt;
                &lt;td&gt;&lt;strong&gt;email: &lt;/strong&gt;
                    &lt;a href="mailto:*${counselorDetails.email}*"&gt;*${counselorDetails.email}*&lt;/a&gt;
                    &lt;br&gt;&lt;strong&gt;phone: &lt;/strong&gt;*${counselorDetails.telephone}*&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="run">Запуск готового приложения</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Процесс создания приложения завершен. Попробуйте снова запустить его для просмотра результата в браузере. Обратите внимание на то, что благодаря функции NetBeans "Компиляция при сохранении" специально выполнять компиляцию или повторное развертывание приложения не требуется. При выполнении проекта развертывание гарантированно содержит самые последние изменения.</p>
</div>
<div class="paragraph">
<p>Нажмите кнопку 'Запустить проект' (<span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span>) на главной панели инструментов. В браузере по умолчанию среды IDE открывается страница <code>index.jsp.</code>.</p>
</div>
<div class="paragraph">
<p>Когда в браузере отображена страница <code>index.jsp</code>, выберите тему из раскрывающегося списка и нажмите кнопку <code>submit</code>. Выполняется переадресация на страницу <code>response.jsp</code>, отображающую подробные сведения в соответствии с выбором.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/response-display.png" alt="response display">
</div>
<div class="title">Figure 23. response.jsp отображается в браузере, в котором отображаются данные, извлеченные из базы данных</div>
</div>
<div class="paragraph">
<p>Это заключительный раздел учебного курса "Создание простого веб-приложения, использующего базу данных MySQL" В этом документе описана процедура создания простого веб-приложения с подключением к базе данных MySQL. Здесь также рассматривается процесс создания приложения с помощью базовой двухуровневой архитектуры при использовании технологий JSTL и JSP для доступа к данным с динамическим просмотром.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="troubleshoot">Устранение проблем</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Большинство проблем в приложении из учебного курса возникают по причине сложностей процесса обмена данными между сервером GlassFish Server Open Source Edition и сервером базы данных MySQL. В случае некорректного отображения приложения или генерации ошибки сервера рекомендуется выполнить следующие проверки.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#access?">Существуют ли ресурсы базы данных?</a></p>
</li>
<li>
<p><a href="#datasource?">Существуют ли на сервере пул подключений и источник данных?</a></p>
</li>
<li>
<p><a href="#driver?">Доступен ли MySQL Connector/драйвер J для сервера GlassFish?</a></p>
</li>
<li>
<p><a href="#password?">Защищена ли база данных паролем?</a></p>
</li>
<li>
<p><a href="#ping?">Корректно ли установлены значения свойств пула подключений?</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="access">Существуют ли ресурсы базы данных?</h3>
<div class="paragraph">
<p>В среде IDE в окне "Службы" (CTRL+5; &amp;#8984+5 для Mac) проверьте функционирование сервера MySQL, а также доступность <code>MyNewDatabase</code> и наличие в ней соответствующих табличных данных.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Для подключения к серверу баз данных MySQL щелкните правой кнопкой мыши узел сервера MySQL и выберите 'Подключение'.</p>
</li>
<li>
<p>Если узел подключения ( <span class="image"><img src="images/db-connection-node.png" alt="db connection node"></span> ) для <code>MyNewDatabase</code> не отображается в окне 'Службы' можно создать подключение, щелкнув правой кнопкой мыши узел драйвера MySQL ( <span class="image"><img src="images/driver-node.png" alt="driver node"></span> ) и выбрав 'Подключение с помощью'. В появившемся диалоговом окне укажите требуемые подробные сведения.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new-db-connection-dialog.png" alt="new db connection dialog">
</div>
<div class="title">Figure 24. Установите подключение к базе данных в среде IDE с помощью диалогового окна 'Создать подключение к базе данных'</div>
</div>
<div class="paragraph">
<p><span class="tips">Поля в диалоговом окне "Новое подключение к базе данных" зеркально отражают строку URL в параметре "Показать URL JDBC". Таким образом, если известен URL (например, <code>jdbc:mysql://localhost:3306/MyNewDatabase</code>), можно вставить его в поле "Показать URL JDBC". При этом остальные поля заполняются автоматически.</span>
* Чтобы убедиться, что таблицы <code>Subject</code> и <code>Counselor</code> существуют и содержат образцы данных, разверните узел подключения <code>MyNewDatabase</code>( <span class="image"><img src="images/db-connection-node.png" alt="db connection node"></span> ) и найдите узел каталога <code>MyNewDatabase</code> ( <span class="image"><img src="images/db-catalog-node.png" alt="db catalog node"></span> ). Для просмотра существующих таблиц разверните узел каталога. Табличные данные можно просмотреть, щелкнув правой кнопкой мыши узел таблицы и выбрав 'Просмотреть данные'.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/services-window-view-data.png" alt="services window view data">
</div>
<div class="title">Figure 25. Просмотрите данные таблицы, выбрав 'Просмотреть данные' в контекстном меню узла таблицы баз данных</div>
</div>
</div>
<div class="sect2">
<h3 id="datasource">Существуют ли на сервере пул подключений и источник данных?</h3>
<div class="paragraph">
<p>После развертывания приложения на сервере GlassFish файл проекта <code>glassfish-resources.xml</code> должен содержать инструкции для сервера по созданию ресурсов и пула подключения JDBC. Их наличие можно проверить в узле "Серверы" в окне "Службы".</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Разверните узел "Серверы" &gt; "Сервер GlassFish" &gt; "Ресурсы". Разверните узел "JDBC Resources" (Ресурсы JDBC), чтобы увидеть источник данных <code>jdbc/IFPWAFCAD</code>, созданный из файла <code>glassfish-resources.xml</code>. Разверните узел "Пул подключения", чтобы увидеть пул подключения <code>IfpwafcadPool</code>, созданный из файла <code>glassfish-resources.xml</code>. Подробное описание <a href="#view-connection-pool">приведено выше</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="driver">Доступен ли MySQL Connector/драйвер J для сервера GlassFish?</h3>
<div class="paragraph">
<p>Проверьте, что на сервере GlassFish выполнено развертывание драйвера MySQL Connector/J. Соответствующее описание приведено в разделе <a href="#addJar">Добавление файла JAR драйвера базы данных на сервер</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Найдите на компьютере папку установки сервера GlassFish и откройте подпапку <code>GlassFish domains/domain1/lib</code>. В ней должен находиться файл <code>mysql-connector-java-5.1.6-bin.jar</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="password">Защищена ли база данных паролем?</h3>
<div class="paragraph">
<p>Необходимо защитить базу данных паролем, чтобы при выполнении упражнений данного учебного курса источник данных сервера GlassFish работал корректно. При использовании учетной записи MySQL <code>root</code> по умолчанию с пустым паролем с помощью командной строки можно установить другой пароль.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Для установки пароля <code><em>nbuser</em></code> в командной строке откройте в системе MySQL каталог <code>bin</code> и введите следующие данные:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">shell&gt; mysql -u root
mysql&gt; UPDATE mysql.user SET Password = PASSWORD('_nbuser_')
    -&gt;     WHERE User = 'root';
mysql&gt; FLUSH PRIVILEGES;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Дополнительные сведения приведены в официальном справочном руководстве по работе с MySQL: <a href="http://dev.mysql.com/doc/refman/5.1/en/default-privileges.html">Защита исходных учетных записей MySQL</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="ping">Корректно ли установлены значения свойств пула подключений?</h3>
<div class="paragraph">
<p>Проверьте правильность работы пула подключений для сервера.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте окно "Службы" (CTRL+5; &amp;#8984+5 для Mac) и разверните узел "Серверы.</p>
</li>
<li>
<p>В контекстном меню узла "Сервер GlassFish" выберите "Просмотр консоли администратора".</p>
</li>
<li>
<p>При отображении соответствующего запроса введите имя пользователя и пароль. Имя пользователя и пароль можно посмотреть в Диспетчере серверов.</p>
</li>
<li>
<p>В дереве в левой части консоли разверните узел "Ресурсы &gt; JDBC &gt; Пулы подключений &gt; <code>IfpwafcadPool`". В главном окне отображаются подробные сведения о пуле подключений `IfpwafcadPool</code>.</p>
</li>
<li>
<p>Нажмите кнопку "Ping". Если пул подключений настроен правильно, отображается сообщение <code>Ping Succeeded</code>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ping-succeeded.png" alt="ping succeeded">
</div>
<div class="title">Figure 26. Проверьте пул подключений, щелкнув 'Ping' на консоли администрирования сервера GlassFish</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Если выполнение ping-тестирования завершается неуспешно, откройте вкладку "Дополнительные свойства" для проверки правильности настройки указанных значений свойств.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Creating%20Web%20App%20MySQL">Мы ждем ваших отзывов</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="seealso">Дополнительные сведения</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Дополнительные сведения о развертывании веб-приложений Java приведены в следующих материалах.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Статьи и руководства по NetBeans</strong></p>
</li>
<li>
<p><a href="../ide/mysql.html">Соединение с базой данных MySQL в IDE NetBeans</a>. Описывает основы работы с базой данных MySQL в среде IDE.</p>
</li>
<li>
<p><a href="jsf20-intro.html">Введение в JavaServer Faces 2.x</a>. Вводный учебный курс по работе с архитектурой JSF в веб-проекте Java.</p>
</li>
<li>
<p><a href="quickstart-webapps-spring.html">Введение в инфраструктуру Spring</a> В рамках вводного учебного курса рассматривается процедура создания веб-приложения MVC с использованием инфраструктуры Spring.</p>
</li>
<li>
<p><strong>Связь с базами данных Java (JDBC)</strong></p>
</li>
<li>
<p><a href="http://docs.oracle.com/javase/tutorial/jdbc/overview/index.html">Обзор JDBC</a></p>
</li>
<li>
<p><a href="http://download.oracle.com/javase/6/docs/technotes/guides/jdbc/getstart/GettingStartedTOC.fm.html">Начало работы с API JDBC</a></p>
</li>
<li>
<p><a href="http://docs.oracle.com/javase/tutorial/jdbc/basics/index.html">Учебные курсы Java: основы JDBC</a></p>
</li>
<li>
<p><strong>Библиотека стандартных тегов JavaServer Pages (JSTL)</strong></p>
</li>
<li>
<p><a href="http://www.oracle.com/technetwork/java/index-jsp-135995.html">Библиотека стандартных тегов JavaServer Pages</a> (официальная страница продукта)</p>
</li>
<li>
<p><strong>Имена Java и интерфейс каталогов (JNDI)</strong></p>
</li>
<li>
<p><a href="http://www.oracle.com/technetwork/java/jndi-136720.html">Базовые технологии Java SE - Имена Java и интерфейс каталогов</a></p>
</li>
<li>
<p><a href="http://docs.oracle.com/javase/jndi/tutorial/">Учебный курс по JNDI</a></p>
</li>
<li>
<p><a href="http://docs.oracle.com/javase/tutorial/jndi/index.html">Учебные курсы Java: Имена Java и интерфейс каталогов</a></p>
</li>
</ul>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/mysql-webapp_ru.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
