
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Gerando uma Aplicação CRUD JavaServer Faces 2.x Usando um Banco de Dados</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Gerando uma Aplicação CRUD JavaServer Faces 2.x Usando um Banco de Dados - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Gerando uma Aplicação CRUD JavaServer Faces 2.x Usando um Banco de Dados">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">Gerando uma Aplicação CRUD JavaServer Faces 2.x Usando um Banco de Dados</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/jsf20-crud_pt_BR.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#createDB">Criando o Banco de Dados</a></li>
<li><a href="#examineDB">Examinando a Estrutura do Banco de Dados</a></li>
<li><a href="#createProject">Criando o Projeto de Aplicação Web</a></li>
<li><a href="#generateEntity">Gerando as Classes de Entidade do Banco de Dados</a></li>
<li><a href="#jsfPagesEntityClasses">Gerando Páginas JSF de Classes de Entidade</a></li>
<li><a href="#explore">Explorando a Aplicação</a>
<ul class="sectlevel2">
<li><a href="#completedProject">Examinando o Projeto Concluído</a></li>
<li><a href="#populateDB">Preenchendo o Banco de Dados com um Script SQL</a></li>
<li><a href="#_suporte_ao_banco_de_dados_netbeans">Suporte ao Banco de Dados NetBeans</a></li>
<li><a href="#editorSupport">Explorando o Suporte do Editor em Páginas de Facelets</a></li>
<li><a href="#dbIntegrity">Explorando a Integridade do Banco de Dados com Validação de Campo</a></li>
<li><a href="#editEntity">Editando as Classes de Entidade</a></li>
</ul>
</li>
<li><a href="#troubleshooting">Solução de Problemas</a></li>
<li><a href="#seealso">Consulte Também</a>
<ul class="sectlevel2">
<li><a href="#_tutoriais_e_artigos_netbeans">Tutoriais e Artigos NetBeans</a></li>
<li><a href="#_recursos_externos">Recursos Externos</a></li>
<li><a href="#_blogs">Blogs</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Neste tutorial, você utilizará o NetBeans IDE para criar uma aplicação Web que interaja com um banco de dados de backend. A aplicação oferece a capacidade de exibir e modificar os dados contidos no banco de dados, conhecida como recurso <em>CRUD</em> (Create, Read, Update, Delete). A aplicação que você desenvolverá contará com as seguintes tecnologias.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JavaServer Faces (JSF) 2.x</strong> para páginas Web de frontend, manipulação de validação e gerenciamento do ciclo de solicitação-resposta.</p>
</li>
<li>
<p><strong>Java Persistence API (JPA) 2.0</strong> utilizando EclipseLink para gerar classes de entidade a partir do banco de dados e gerenciar transações. (EclipseLink é a implementação de referência para JPA e é o provedor de persistência default para o GlassFish Server.)</p>
</li>
<li>
<p><strong>Enterprise JavaBeans (EJB) 3.1</strong>, que oferece EJBs sem estado que acessam as classes de entidade e contém a lógica de negócios da aplicação.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>O IDE oferece dois assistentes que geram todos os códigos da aplicação. O primeiro é o <a href="#generateEntity">assistente para Classes de Entidade do Banco de Dados</a> que permite gerar as classes de entidade a partir do banco de dados fornecido. Após criar as classes de entidade, você utiliza o <a href="#jsfPagesEntityClasses">assistente de Páginas JSF de Classes de Entidade</a> para criar EJBs e beans gerenciados pelo JSF para as classes de entidade, bem como um conjunto de páginas de Facelets para manipular as views dos dados da classe de entidade. A seção final do tutorial, <a href="#explore">Explorando a Aplicação</a>, é opcional e oferece vários exercícios para ajudá-lo a entender melhor a aplicação e a se familiarizar mais com o IDE.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/netbeans-stamp-80-74-73.png" alt="netbeans stamp 80 74 73">
</div>
<div class="title">Figure 1. O conteúdo desta página se aplica ao NetBeans IDE 7.2, 7.3, 7.4 e 8.0</div>
</div>
<div class="paragraph">
<p>Para concluir este tutorial, você precisa dos seguintes recursos e softwares.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software ou Recurso</th>
<th class="tableblock halign-left valign-top">Versão Necessária</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">NetBeans IDE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pacote Java EE 7.2, 7.3, 7.4, 8.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK (Java Development Kit)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 ou 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://glassfish.dev.java.net/">GlassFish Server Open Source Edition</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.x, 4.x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fmysql-consult.zip">mysql-consult.zip</a> (MySQL)
<em>ou</em>
<a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fjavadb-consult.zip">javadb-consult.zip</a> (JavaDB)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">n/d</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Observações:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>O pacote Java EE do NetBeans IDE também inclui o GlassFish Server, um servidor compatível com Java EE necessário para este tutorial.</p>
</li>
<li>
<p>Para o projeto de solução deste tutorial, faça o download de <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FConsultingAgencyJSF20.zip">ConsultingAgencyJSF20.zip</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="createDB">Criando o Banco de Dados</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Este tutorial utiliza um banco de dados de agência de consultoria chamado <code>consult</code>. O banco de dados não é incluído quando você instala o IDE, portanto, é necessário criar primeiro o banco de dados para seguir este tutorial.</p>
</div>
<div class="paragraph">
<p>O banco de dados <code>consult</code> foi projetado para demonstrar o escopo do suporte do IDE para manipular uma variedade de estruturas de banco de dados. Portanto, o banco de dados não é um exemplo de melhores práticas ou design de banco de dados recomendado. Em vez disso, ele tenta incorporar muitas funcionalidades relevantes encontradas em um design de banco de dados. Por exemplo, o banco de dados <code>consult</code> contém todos os tipos de relacionamento possíveis, chaves primárias compostas e muitos tipos de dados diferentes. Consulte as tabelas abaixo para obter uma visão geral mais detalhada da estrutura do banco de dados.</p>
</div>
<div class="paragraph">
<p><strong>Observações:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Este tutorial utiliza o servidor de banco de dados MySQL, mas também é possível concluí-lo utilizando o servidor do banco de dados JavaDB. Para criar o banco de dados no JavaDB, faça download e extraia o arquivo compactado <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fjavadb-consult.zip">javadb-consult.zip</a>. O arquivo compactado contém scripts SQL para criar, eliminar e preencher o banco de dados de <code>consult</code>.</p>
</li>
<li>
<p>Para obter mais informações sobre a configuração do IDE para trabalhar com o MySQL, consulte o tutorial <a href="../ide/mysql.html">Estabelecendo Conexão com um Banco de Dados MySQL</a>.</p>
</li>
<li>
<p>Para obter mais informações sobre como configurar o IDE para trabalhar com JavaDB, consulte o tutorial <a href="../ide/java-db.html">Trabalhando com o Banco de Dados Java DB (Derby)</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Combinação MySQL com GlassFish:</strong></p>
</div>
<div class="paragraph">
<p>Se você estiver usando o MySQL, e estiver usando o GlassFish v3 ou Open Source Edition 3.0.1, será preciso garantir que seu banco de dados esteja protegido por senha. (Para obter mais informações, consulte GlassFish <a href="https://java.net/jira/browse/GLASSFISH-12221">Edição 12221</a>.) Se você estiver utilizando a conta MySQL <code>root</code> sem senha, você poderá definir a senha usando um prompt de linha de comandos.</p>
</div>
<div class="paragraph">
<p>Por exemplo, para definir a senha para <code><em>nbuser</em></code>, digite os comandos a seguir no prompt de linha de comandos.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">shell&gt; mysql -u root
mysql&gt; UPDATE mysql.user SET Password = PASSWORD('_nbuser_') WHERE User = 'root';
mysql&gt; FLUSH PRIVILEGES;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se você receber um erro &#8216;mysql: command not found&#8217;, será porque o comando <code>mysql</code> não foi adicionado à sua variável de ambiente <code>PATH</code>. É possível chamar o comando inserindo o caminho completo para o diretório <code>bin</code> da instalação do MySQL. Por exemplo, se o comando <code>mysql</code> estiver localizado no seu computador em <code>/usr/local/mysql/bin</code>, digite o seguinte:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">shell&gt; /usr/local/mysql/bin/mysql -u root</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para obter mais informações, consulte o Manual de Referência oficial do MySQL:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://dev.mysql.com/doc/refman/5.1/en/default-privileges.html">Proteção das Contas MySQL Iniciais</a></p>
</li>
<li>
<p><a href="http://dev.mysql.com/doc/refman/5.1/en/invoking-programs.html">4.2.1. Chamando Programas MySQL</a></p>
</li>
<li>
<p><a href="http://dev.mysql.com/doc/refman/5.1/en/setting-environment-variables.html">4.2.4. Configurando Variáveis de Ambiente</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Execute as etapas a seguir para criar um banco de dados e conecte-o a partir do IDE.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Faça download de <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fmysql-consult.zip">mysql-consult.zip</a> e o extraia o arquivo compactado no seu sistema local. Quando você extrair o arquivo compactado, você verá os scripts SQL para criação e preenchimento do banco de dados. O arquivo compactado também tem scripts para eliminação de tabelas.</p>
</li>
<li>
<p>Na janela Serviços, expanda o nó Bancos de Dados, clique com o botão direito do mouse no nó MySQL e selecione Iniciar Servidor.</p>
</li>
<li>
<p>Clique com o botão direito do mouse no nó Servidor MySQL e escolha Criar Banco de Dados.</p>
</li>
<li>
<p>Digite <strong>consult</strong> como o Nome do Banco de Dados na caixa de diálogo Criar Banco de Dados MySQL. Clique em OK. Um novo nó aparecerá sob o nó Bancos de Dados (<code>jdbc:mysql://localhost:3306/consult [raiz no esquema Default]</code>).</p>
</li>
<li>
<p>Clique com o botão direito do mouse no novo nó e selecione Conectar.</p>
</li>
<li>
<p>Selecione Arquivo &gt; Abrir Arquivo, no menu principal e vá até o arquivo extraído <code>mysql_create_consult.sql</code>. Clique em Abrir. O arquivo abre automaticamente no editor SQL.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/run-sql-script.png" alt="run sql script">
</div>
<div class="title">Figure 2. Abrir arquivos SQL no editor do IDE</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Certifique-se de que o banco de dados <code>consult</code> esteja selecionado na lista drop-down Conexão da barra de ferramentas do editor SQL. Em seguida, clique no botão ( <span class="image"><img src="images/run-sql-btn.png" alt="run sql btn"></span> ) Executar SQL.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clica em Executar SQL, a saída a seguir é exibida na janela de Saída.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/run-sql-output.png" alt="run sql output">
</div>
<div class="title">Figure 3. A janela de Saída oferece informações sobre a execução SQL</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examineDB">Examinando a Estrutura do Banco de Dados</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para confirmar se as tabelas foram criadas corretamente, expanda o nó Tabelas sob o nó da conexão do banco de dados. Você pode expandir um nó da tabela para ver suas colunas, índices e chaves estrangeiras. É possível clicar com o botão direito do mouse em uma coluna e selecionar Propriedades para exibir informações adicionais sobre a coluna.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/services-window-tables.png" alt="services window tables">
</div>
<div class="title">Figure 4. A janela Serviços exibe conexões de bancos de dados, tabelas, colunas de tabelas, índices e chaves estrangeiras</div>
</div>
<div class="paragraph">
<p><strong>Observação:</strong> Se você não vir nenhuma tabela sob o nó Tabelas, clique com o botão direito do mouse no nó Tabelas e selecione Atualizar.</p>
</div>
<div class="paragraph">
<p>Ao observar a estrutura do banco de dados <code>consult</code>, você pode ver que o banco de dados contém tabelas que possuem uma variedade de relacionamentos e vários tipos de campo. Quando você cria classes de entidade de um banco de dados, o IDE gera automaticamente o código apropriado para os vários tipos de campo.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/diagram_consult.png" alt="diagram consult">
</div>
<div class="title">Figure 5. Diagrama de relacionamento com entidades do banco de dados consult</div>
</div>
<div class="paragraph">
<p>A tabela a seguir descreve as tabelas encontradas no banco de dados <code>consult</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Tabela de Banco de Dados</th>
<th class="tableblock halign-left valign-top">Descrição</th>
<th class="tableblock halign-left valign-top">Funcionalidades de Design</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Um cliente da agência de consultoria</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chave primária composta, não gerada (cujos campos não constituem uma chave estrangeira)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Um funcionário da agência de consultoria que os clientes podem contratar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inclui um campo de retomada do tipo LONG VARCHAR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT_STATUS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">O status de um consultor na agência de consultoria (por exemplo, Ativo e Inativo são status possíveis)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chave primária não gerada do tipo CHAR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RECRUITER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Um funcionário da agência de consultoria responsável por conectar clientes e consultores</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROJECT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Um projeto cuja equipe é formada pelos consultores da agência de consultoria</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chave primária composta, não gerada que inclui dois campos que constituem uma chave estrangeira para a tabela CLIENT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BILLABLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Um conjunto de horas trabalhadas por um consultor em um projeto, o qual a agência de consultoria cobra do cliente relevante</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inclui um campo de artefato do tipo CLOB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADDRESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">O endereço de cobrança de um cliente</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROJECT_CONSULTANT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tabela com junção indicando a quais projetos os consultores estão designados no momento</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Faz referência cruzada entre PROJECT e CONSULTANT, a primeira possui uma chave primária composta</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>O banco de dados <code>consult</code> inclui uma variedade de relacionamentos. Quando você cria classes de entidade de um banco de dados, o IDE gera automaticamente as propriedades do tipo Java apropriado com base no tipo SQL das colunas. A tabela a seguir descreve os relacionamentos de entidade do banco de dados <code>consult</code>. (os relacionamentos inversos não são mostrados.)</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Entidade</th>
<th class="tableblock halign-left valign-top">Entidade Relacionada</th>
<th class="tableblock halign-left valign-top">Informações sobre Relacionamento</th>
<th class="tableblock halign-left valign-top">Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RECRUITER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pode ser nulo, um para um com edição manual; pode ser nulo, um para muitos, caso não seja editado</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT possui muitos RECRUITERs e RECRUITER não possui nenhum ou um CLIENT (se não for manualmente editado)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADDRESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">não pode ser nulo, um para um</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT possui um ADDRESS e ADDRESS não possui nenhum ou um CLIENT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROJECT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">não pode ser nulo, um para muitos; em uma entidade de Projeto, o valor do campo do cliente faz parte da chave primária do Projeto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT tem muitos PROJECTS e PROJECT tem um CLIENT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROJECT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">muitos para muitos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT tem muitos PROJECTs e PROJECT tem muitos CONSULTANTs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BILLABLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">não pode ser nulo, um para muitos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT possui muitos BILLABLEs e BILLABLE possui um CONSULTANT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT_STATUS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">não pode ser nulo, um para muitos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT_STATUS possui muitos CONSULTANTs e CONSULTANT possui um CONSULTANT_STATUS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RECRUITER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pode ser nulo, um para muitos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT não possui nenhum ou um RECRUITER e RECRUITER possui muitos CONSULTANTs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BILLABLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROJECT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">não pode ser nulo, um para muitos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BILLABLE possui um PROJECT e PROJECT possui muitos BILLABLES</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Agora que o banco de dados está criado, você pode criar a aplicação Web e utilizar o assistente de Classes de Entidade do Banco de Dados para gerar bancos de dados com base nas tabelas do banco de dados.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="createProject">Criando o Projeto de Aplicação Web</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Neste exercício, você criará um projeto Web e adicionará o framework JavaServer Faces ao projeto. Ao criar o projeto, você irá selecionar JavaServer Faces no painel Frameworks do assistente de Novo Projeto.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Escolha Arquivo &gt; Novo Projeto (Ctrl-Shift-N; &amp;#8984-Shift-N no Mac) no menu principal.</p>
</li>
<li>
<p>Na categoria Java Web, selecione Aplicação Web. Clique em Próximo.</p>
</li>
<li>
<p>Digite `ConsultingAgency ` para o nome do projeto e defina a localização do projeto. Clique em Próximo.</p>
</li>
<li>
<p>Defina o servidor como GlassFish Server e defina a versão do Java EE para Java EE 6 Web ou Java EE 7 Web. Clique em Próximo.</p>
</li>
<li>
<p>No painel Frameworks, selecione a opção JavaServer Faces. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clicar em Finalizar, o IDE irá gerar o projeto de aplicação Web e abrir <code>index.xhtml</code> no editor.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="generateEntity">Gerando as Classes de Entidade do Banco de Dados</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Depois de se conectar a um banco de dados do IDE, você pode utilizar o assistente de Classes de Entidade do Banco de Dados para gerar rapidamente classes de entidade com base nas tabelas do banco de dados. O IDE pode gerar classes de entidade para cada tabela selecionada, e também pode gerar classes de entidade necessárias para tabelas relacionadas.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na janela Projetos, clique com o botão direito do mouse no nó do projeto ` ConsultingAgency` e selecione Novo &gt; Classes de Entidade do Banco de Dados. (Se esta opção não estiver na lista, escolha Outros. Em seguida, no assistente de Arquivo, selecione a categoria Persistência e, depois, Classes de Entidade do Banco de Dados.)</p>
</li>
<li>
<p>Selecione Nova Fonte de Dados na lista drop-down Fonte de Dados para abrir a caixa de diálogo Criar Fonte de Dados.</p>
</li>
<li>
<p>Digite <code>jdbc/consult</code> como o Nome da JNDI e selecione a conexão <code>jdbc:mysql://localhost:3306/consult</code> como a Conexão do Banco de Dados.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/create-datasource.png" alt="create datasource">
</div>
<div class="title">Figure 6. Especificar um nome e uma conexão de banco de dados JNDI para criar uma fonte de dados</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em OK para fechar a caixa de diálogo e retornar ao assistente. As tabelas no banco de dados <code>consult</code> serão exibidas na lista de conteúdo Tabelas Disponíveis.</p>
</li>
<li>
<p>Clique no botão Adicionar Tudo para selecionar todas as tabelas contidas no banco de dados. Clique em Próximo.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new-entities-wizard.png" alt="new entities wizard">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Digite <code>jpa.entities</code> como o nome do Pacote.</p>
</li>
<li>
<p>Verifique se as caixas de seleção para gerar as consultas nomeadas e criar uma unidade persistente estão marcadas. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clicar em Finalizar, o IDE gerará as classes de entidade no pacote <code>jpa.entities</code> do projeto.</p>
</div>
<div class="paragraph">
<p>Quando você utiliza o assistente para criar classes de entidade de um banco de dados, o IDE examina os relacionamentos entre as tabelas do banco de dados. Na janela Projetos, se você expandir o nó do pacote <code>jpa.entities</code>, você verá que o IDE gerou uma classe de entidade para cada tabela, exceto para a tabela <code>PROJECT_CONSULTANT</code>. O IDE não criou uma classe de entidade para <code>PROJECT_CONSULTANT</code> porque a tabela é uma tabela com junção.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/projects-window-entities.png" alt="projects window entities">
</div>
<div class="title">Figure 7. Tela da janela Projetos mostrando as classes de entidades geradas</div>
</div>
<div class="paragraph">
<p>O IDE também gerou duas classes adicionais para as tabelas com chaves primárias compostas: <code>CLIENT</code> e <code>PROJECT</code>. As classes de chave primária dessas tabelas (<code>ClientPK.java</code> e <code>ProjectPK.java</code>) têm as letras <code>PK</code> acrescentadas ao nome.</p>
</div>
<div class="paragraph">
<p>Se você observar o código gerado para as classes de entidade, você verá que o assistente adicionou anotações <code>@GeneratedValue</code> aos campos ID gerados automaticamente e anotações <code>@Basic(optional = "false")</code> a alguns dos campos das classes de entidade. Com base nas anotações <code>@Basic(optional = "false")</code>, o assistente de Páginas JSF de Classes de Entidade pode gerar o código que inclui verificações para evitar violações de coluna que não podem ser nulas para esses campos.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jsfPagesEntityClasses">Gerando Páginas JSF de Classes de Entidade</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Agora que as classes de entidade estão criadas, você pode criar a interface Web para exibir e modificar os dados. Você utilizará o assistente de Páginas JSF de Classes de Entidade para gerar páginas JavaServer Faces. O código gerado pelo assistente baseia-se nas anotações de persistência contidas nas classes de entidade.</p>
</div>
<div class="paragraph">
<p>Para cada classe de entidade o assistente gera os seguintes arquivos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>um bean de sessão sem estado que estende  <code>AbstractFacade.java</code></p>
</li>
<li>
<p>um bean gerenciado com escopo de sessão JSF</p>
</li>
<li>
<p>um diretório contendo quatro arquivos de Facelets para os recursos CRUD (<code>Create.xhtml</code>, <code>Edit.xhtml</code>, <code>List.xhtml</code> e <code>View.xhtml</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>O assistente também gera os seguintes arquivos.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a classe  <code>AbstractFacade.java</code>  que contém a lógica de negócio para criação, recuperação, modificação e remoção das instâncias da entidade</p>
</li>
<li>
<p>classes de utilitário utilizadas pelos beans gerenciados pelo JSF (<code>JsfUtil</code>, <code>PaginationHelper</code>)</p>
</li>
<li>
<p>um conjunto de propriedades para mensagens localizadas e uma entrada correspondente no arquivo de configuração Faces do projeto (será criado um arquivo <code>faces-config.xml</code>, caso já não exista um).</p>
</li>
<li>
<p>arquivos web auxiliares, incluindo uma folha de estilo default para componentes renderizados e um arquivo de modelo de Facelets</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Para gerar as páginas JSF:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na janela Projetos, clique com o botão direito do mouse no nó do projeto e selecione Novo &gt; Páginas JSF de Classes de Entidade para abrir o assistente. (Se esta opção não estiver na lista, escolha Outros. Em seguida, no assistente de Arquivo, selecione a categoria JavaServer Faces e, depois, Páginas JSF de Classes de Entidade.)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A caixa Classes de Entidade Disponíveis lista as sete classes de entidade contidas no projeto. A caixa não lista as classes incorporadas (<code>ClientPK.java</code> e <code>ProjectPK.java</code>).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Adicionar Tudo para mover todas as classes para a caixa Classes de Entidade Selecionadas.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/newjsf-wizard.png" alt="newjsf wizard">
</div>
<div class="title">Figure 8. O assistente de Novas Páginas JSF de Classes de Entidade exibe todas as classes de entidade contidas no projeto</div>
</div>
<div class="paragraph">
<p>Clique em Próximo.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na etapa 3 do assistente, Gerar Classes e Páginas JSF, digite <code>jpa.session</code> no Pacote de Bean de Sessão JPA.</p>
</li>
<li>
<p>Digite <code>jsf</code> para o Pacote de Classes JSF.</p>
</li>
<li>
<p>Digite &#8216;/resources/Bundle&#8217; no campo Nome do Pacote de Localização. Isso gerará um pacote com o nome <code>resources</code> no qual o arquivo <code>Bundle.properties</code> residirá. (Se deixá-lo em branco, o conjunto de propriedades será criado no pacote default do projeto.)</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/newjsf-wizard2.png" alt="newjsf wizard2">
</div>
<div class="title">Figure 9. Especificar pacote e nomes de pastas para os arquivos gerados</div>
</div>
<div class="paragraph">
<p>Para que o IDE se ajuste melhor às convenções do projeto, você pode personalizar os arquivos gerados pelo assistente. Clique no link Personalizar Modelo para modificar os modelos de arquivo utilizados pelo assistente.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/customize-template.png" alt="customize template">
</div>
<div class="title">Figure 10. Personalizar modelos de arquivos gerados pelo assistente</div>
</div>
<div class="paragraph">
<p>Em geral, você pode acessar e fazer alterações em todos os modelos mantidos pelo IDE utilizando o Gerenciador de Modelos (Ferramentas &gt; Modelos).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Finalizar. O IDE gera os beans de sessão sem estado no pacote <code>jpa.session</code>, e o escopo de sessão e beans gerenciados com JSF no pacote <code>jsf</code>. Cada bean de sessão sem estado manipula as operações da classe de entidade correspondente, incluindo a criação, edição e destruição de instâncias da classe de entidade por meio da API de Persistência Java. Cada Bean gerenciado pelo JSF implementa a interface <code>javax.faces.convert.Converter</code> e realiza as tarefas de conversão das instâncias da classe de entidade correspondente para objetos <code>String</code> e vice-versa.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Se você expandir o nó Páginas Web, você poderá ver que o IDE gerou uma pasta para cada uma das classes de entidade. Cada pasta contém os arquivos <code>Create.xhtml</code>, <code>Edit.xhtml</code>, <code>List.xhtml</code> e <code>View.xhtml</code>. O IDE também modificou o arquivo <code>index.xhtml</code> inserindo links em cada uma das páginas <code>List.xhtml</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/projects-jsfpages.png" alt="projects jsfpages">
</div>
<div class="title">Figure 11. Páginas de Facelets para cada classe de entidade são geradas pelo assistente</div>
</div>
<div class="paragraph">
<p>Cada Bean gerenciado pelo JSF é específico dos quatro arquivos de Facelets correspondentes e inclui o código que chama os métodos no Bean de sessão apropriado.</p>
</div>
<div class="paragraph">
<p>Expanda o nó da pasta <code>resources</code> para localizar a folha de estilo <code>jsfcrud.css</code> default gerada pelo assistente. Se você abrir a página de boas-vindas da aplicação (<code>index.xhtml</code>) ou o arquivo de modelo de Facelets (<code>template.xhtml</code>) no editor, verá que eles contêm uma referência à folha de estilo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;h:outputStylesheet name="css/jsfcrud.css"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>O arquivo de modelo de Facelets é utilizado por cada um dos quatro arquivos de Facelets para cada classe de entidade.</p>
</div>
<div class="paragraph">
<p>Se você expandir o nó Pacotes de Código-Fonte, você verá os Beans de sessão, os Beans gerenciados pelo JSF, as classes de utilitário e o conjunto de propriedades gerados pelo assistente.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/projects-generated-classes70.png" alt="projects generated classes70">
</div>
<div class="title">Figure 12. Tela do diretório de Pacotes de Código-Fonte na janela Projetos mostrando as classes geradas pelo assistente</div>
</div>
<div class="paragraph">
<p>O assistente também gerou o arquivo de Configuração do Faces (<code>faces-config.xml</code>) a fim de registrar a localização do conjunto de propriedades. Se expandir o nó Arquivos de Configuração e abrir <code>faces-config.xml</code> no editor XML, você verá que a entrada a seguir está incluída.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;application&gt;
    &lt;resource-bundle&gt;
        &lt;base-name&gt;/resources/Bundle&lt;/base-name&gt;
        &lt;var&gt;bundle&lt;/var&gt;
    &lt;/resource-bundle&gt;
&lt;/application&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Além disso, se expandir o novo pacote <code>resources</code>, você encontrará o arquivo <code>Bundle.properties</code> que contém mensagens no idioma default do cliente. As mensagens são obtidas das propriedades da classe de entidade.</p>
</div>
<div class="paragraph">
<p>Para adicionar um novo conjunto de propriedades, clique com o botão direito do mouse no arquivo <code>Bundle.properties</code> e selecione Personalizar. A caixa de diálogo Personalizador permite adicionar novas configurações regionais à aplicação.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="explore">Explorando a Aplicação</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Agora que seu projeto contém classes de entidade, Beans de sessão EJB para controlar as classes de entidade e um frontend desenvolvido para JSF para exibir e modificar bancos de dados, tente executar o projeto para ver os resultados.</p>
</div>
<div class="paragraph">
<p>A seguir, encontra-se uma série opcional de exercícios rápidos que ajudará você a se familiarizar com a aplicação, bem como com os recursos e as funcionalidades que o IDE oferece.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#completedProject">Examinando o Projeto Concluído</a></p>
</li>
<li>
<p><a href="#populateDB">Preenchendo o Banco de Dados com um Script SQL</a></p>
</li>
<li>
<p><a href="#editorSupport">Explorando o Suporte do Editor em Páginas de Facelets</a></p>
</li>
<li>
<p><a href="#dbIntegrity">Explorando a Integridade do Banco de Dados com Validação de Campo</a></p>
</li>
<li>
<p><a href="#editEntity">Editando as Classes de Entidade</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="completedProject">Examinando o Projeto Concluído</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Para executar o projeto, clique com o botão direito do mouse no nó do projeto, na janela Projetos, e selecione Executar ou clique no botão ( <span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span> ) Executar Projeto na barra de ferramentas principal.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando a página de boas-vindas da aplicação é exibida, aparece uma lista de links que permite exibir as entradas contidas em cada uma das tabelas do banco de dados.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/welcome-page-links.png" alt="welcome page links">
</div>
<div class="title">Figure 13. Links para exibição do conteúdo do banco de dados para cada tabela</div>
</div>
<div class="paragraph">
<p>Os links foram adicionados à página de boas-vindas (<code>index.xhtml</code>) ao concluir o assistente de Páginas JSF de Classes de Entidade. Esses links são fornecidos como pontos de entrada nas páginas de Facelets que oferecem a funcionalidade CRUD no banco de dados da Agência de Consultoria.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;h:body&gt;
    Hello from Facelets
    &lt;h:form&gt;
        &lt;h:commandLink action="/address/List" value="Show All Address Items"/&gt;
    &lt;/h:form&gt;
    &lt;h:form&gt;
        &lt;h:commandLink action="/billable/List" value="Show All Billable Items"/&gt;
    &lt;/h:form&gt;
    &lt;h:form&gt;
        &lt;h:commandLink action="/client/List" value="Show All Client Items"/&gt;
    &lt;/h:form&gt;
    &lt;h:form&gt;
        &lt;h:commandLink action="/consultant/List" value="Show All Consultant Items"/&gt;
    &lt;/h:form&gt;
    &lt;h:form&gt;
        &lt;h:commandLink action="/consultantStatus/List" value="Show All ConsultantStatus Items"/&gt;
    &lt;/h:form&gt;
    &lt;h:form&gt;
        &lt;h:commandLink action="/project/List" value="Show All Project Items"/&gt;
    &lt;/h:form&gt;
    &lt;h:form&gt;
        &lt;h:commandLink action="/recruiter/List" value="Show All Recruiter Items"/&gt;
    &lt;/h:form&gt;
&lt;/h:body&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique no link &#8216;Mostrar todos os Itens do Consultor&#8217;. Ao observar o código acima, você pode ver que a página de destino é <code>/consultant/List.xhtml</code>. (No JSF 2.x, a extensão do arquivo é deduzida devido à navegação implícita.)</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/empty-consultants-list.png" alt="empty consultants list">
</div>
<div class="title">Figure 14. A tabela Consultores está vazia no momento</div>
</div>
<div class="paragraph">
<p>Atualmente, o banco de dados não contém dados de amostra. É possível adicionar dados manualmente clicando no link &#8216;Criar Novo Consultor&#8217; e utilizando o Web form fornecido. A página <code>/consultant/Create.xhtml</code> é carregada para que seja exibida. Você também pode executar um script SQL no IDE para preencher as tabelas com os dados de amostra. As subseções a seguir exploram ambas as opções.</p>
</div>
<div class="paragraph">
<p>Você pode clicar no link do índice para voltar à lista de links da página de boas-vindas. Os links oferecem uma view dos dados contidos em cada tabela do banco de dados e carrega o arquivo <code>List.xhtml</code> de cada pasta de entidade para que seja exibido. Conforme será demonstrado posteriormente, após adicionar os dados às tabelas, outros links serão exibidos em cada entrada permitindo que você exiba (<code>View.xhtml</code>), edite (<code>Edit.xhmtl</code>) e destrua os dados de um único registro da tabela.</p>
</div>
<div class="paragraph">
<p><strong>Observação.</strong> Se a implantação da aplicação falhar, consulte a <a href="#troubleshooting">seção de solução de problemas</a> a seguir. (Consulte também a seção de solução de problemas de <a href="mysql-webapp.html#troubleshoot">Criando uma Aplicação Web Simples Usando um Banco de Dados MySQL</a>.)</p>
</div>
</div>
<div class="sect2">
<h3 id="populateDB">Preenchendo o Banco de Dados com um Script SQL</h3>
<div class="paragraph">
<p>Execute o script fornecido, que gera dados de amostra para as tabelas do banco de dados. O script (<code>mysql_insert_data_consult.sql</code>) está incluído no arquivo ZIP Consultando o Banco de Dados da Agência que pode ser obtido por download da <a href="#requiredSoftware">tabela de software exigido</a>.</p>
</div>
<div class="paragraph">
<p>Dependendo do servidor de banco de dados com que estiver trabalhando (MySQL ou JavaDB), você poderá executar o script fornecido, que irá gerar dados de amostra para as tabelas de banco de dados. Para o MySQL, esse é o script <code>mysql_insert_data_consult.sql</code>. Para o JavaDB, esse é o script <code>javadb_insert_data_consult.sql</code>. Ambos os scripts são incluídos nos respectivos arquivos compactados, que podem ser obtidos por download na <a href="#requiredSoftware">tabela de software exigido</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Selecione Arquivo &gt; Abrir Arquivo no menu principal e, em seguida, vá até o local do script no seu computador. Clique em Abrir. O arquivo é aberto automaticamente no editor SQL do IDE.</p>
</li>
<li>
<p>Certifique-se de que o banco de dados <code>consult</code> esteja selecionado na lista drop-down Conexão da barra de ferramentas do editor SQL.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/run-sql-insert.png" alt="run sql insert">
</div>
<div class="title">Figure 15. Abrir o script no editor SQL do IDE</div>
</div>
<div class="paragraph">
<p>Clique com o botão direito do mouse no editor e selecione Executar Instrução ou clique no botão ( <span class="image"><img src="images/run-sql-btn.png" alt="run sql btn"></span> ) Executar SQL. É possível ver o resultado da execução do script na janela de Saída.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Reinicie o GlassFish Server. Essa é uma etapa necessária para ativar o servidor e recarregar e armazenar no cache os novos dados contidos no banco de dados <code>consult</code>. Para isso, clique na guia do GlassFish Server na janela de Saída (A guia do GlassFish Server exibirá o log do servidor.), em seguida, clique no botão ( <span class="image"><img src="images/glassfish-restart.png" alt="glassfish restart"></span> ) Reiniciar Servidor na margem esquerda. O servidor para e, em seguida, reinicia.</p>
</li>
<li>
<p>Execute o projeto novamente e clique no link &#8216;Mostrar Todos os Itens do Consultor&#8217;. Você verá que a lista não está mais vazia.</p>
</li>
</ol>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><span class="image left"><a class="image" href="images/consultants-list.png"><img src="images/consultants-list-small.png" alt="consultants list small"></a></span></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_suporte_ao_banco_de_dados_netbeans">Suporte ao Banco de Dados NetBeans</h3>
<div class="paragraph">
<p>É possível utilizar o visualizador de tabelas do banco de dados do IDE para exibir e modificar os dados da tabela mantidos diretamente no banco de dados. Por exemplo, clique com o botão direito do mouse na tabela <code>consultant</code> na janela Serviços e selecione Exibir Dados.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/view-data.png" alt="view data">
</div>
<div class="title">Figure 16. Selecione Exibir Dados no menu contextual das tabelas de banco de dados</div>
</div>
<div class="paragraph">
<p>A consulta SQL utilizada para executar a ação é exibida na parte superior do editor e uma exibição gráfica da tabela é exibida abaixo.</p>
</div>
<div class="openblock feature">
<div class="content">
<div class="imageblock left">
<div class="content">
<a class="image" href="images/view-data-table.png"><img src="images/view-data-table-small.png" alt="view data table small"></a>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Clique duas vezes nas células da tabela para efetuar modificações diretamente nos dados. Clique no ícone ( <span class="image"><img src="images/commit-records-icon.png" alt="commit records icon"></span> ) Confirmar Registros para confirmar as alterações feitas no banco de dados.</p>
</div>
<div class="paragraph">
<p>A view gráfica oferece mais funcionalidade. Consulte <a href="../../docs/ide/database-improvements-screencast.html">Suporte ao Banco de Dados no NetBeans IDE</a> para obter mais informações.</p>
</div>
</div>
<div class="sect2">
<h3 id="editorSupport">Explorando o Suporte do Editor em Páginas de Facelets</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Abra a página <code>/consultant/List.xhtml</code> no editor. A linha 8 indica que a página depende do arquivo de Facelets <code>template.xhtml</code> para que ser renderizada.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;ui:composition template="/template.xhtml"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para exibir os números das linhas, clique com o botão direito do mouse na margem esquerda do editor e selecione Mostrar Números de Linhas.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Utilize a caixa de diálogo Ir para Arquivo do IDE para abrir o arquivo <code>template.xhtml</code>. Pressione Alt-Shift-O (Ctrl-Shift-O no Mac) e, em seguida, digite <code>modelo</code>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/go-to-file.png" alt="go to file">
</div>
<div class="title">Figure 17. Utilizar a caixa de diálogo Ir para Arquivo para abrir rapidamente arquivos do projeto</div>
</div>
<div class="paragraph">
<p>Clique em OK (ou pressione Enter).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>O modelo aplica as tags <code>&lt;ui:insert&gt;</code> para inserir o conteúdo de outros arquivos no título e corpo. Coloque o cursor na tag <code>&lt;ui:insert&gt;</code> e pressione Ctrl-Espaço para chamar uma janela pop-up de documentação.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/doc-popup.png" alt="doc popup">
</div>
<div class="title">Figure 18. Pressione Ctrl-Espaço para chamar um pop-up de documentação nas tags de Facelets</div>
</div>
<div class="paragraph">
<p>É possível pressionar Ctrl-Espaço nas tags JSF e seus atributos para chamar o pop-up da documentação. A documentação exibida é obtida das descrições fornecidas na <a href="http://javaserverfaces.java.net/nonav/docs/2.1/vdldocs/facelets/index.html">Documentação da Biblioteca de Tags JSF</a> Oficial.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Volte para o arquivo <code>List.xhtml</code> (pressione Ctrl-Tab). As tags <code>&lt;ui:define&gt;</code> são utilizadas para definir o conteúdo que será aplicado ao título e ao corpo do modelo. Esse padrão é utilizado nos quatro arquivos de Facelets (<code>Create.xhtml</code>, <code>Edit.xhtml</code>, <code>List.xhtml</code> e <code>View.xhtml</code>) gerados para cada classe de entidade.</p>
</li>
<li>
<p>Coloque seu cursor em qualquer uma das expressões EL utilizadas nas mensagens localizadas contidas no arquivo <code>Bundle.properties</code>. Pressione Ctrl-Espaço para exibir a mensagem localizada.</p>
</li>
</ol>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><span class="image left"><a class="image" href="images/localized-messages.png"><img src="images/localized-messages-small.png" alt="localized messages small"></a></span></p>
</div>
</div>
</div>
<div class="paragraph">
<p>Na imagem acima, você pode ver que a expressão EL é determinada como &#8216;List&#8217;, que é aplicada ao título do modelo e pode ser verificada na página renderizada no browser.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navegue até a parte inferior do arquivo e localize o código do link <code>Criar novo consultor</code> (Linha 92). Trata-se do seguinte:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;h:commandLink action="#{consultantController.prepareCreate}" value="#{bundle.ListConsultantCreateLink}"/&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Pressione Ctrl-Espaço no atributo <code>action</code> do <code>commandLink</code> para chamar a janela pop-up da documentação.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>O atributo <code>ação</code> indica o método que manipula a solicitação quando o link é clicado no browser. A documentação a seguir será fornecida:</p>
</div>
<div class="paragraph">
<p><em>MethodExpression, que representa a ação da aplicação a qual será chamada quando este componente for ativado pelo usuário. A expressão deve ser interpretada como um método público que não toma nenhum parâmetro e retorna um Object (o toString() do qual é chamado para gerar o resultado lógico) que será passado para o NavigationHandler desta aplicação.</em>
Em outras palavras, o valor de <code>action</code> se refere normalmente a um método em um bean gerenciado pelo JSF que é avaliado como uma <code>String</code>. Então, a string é utilizada pelo <code>NavigationHandler</code> do JSF para encaminhar a solicitação para a view apropriada. É possível verificar isso nas etapas a seguir.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Coloque o cursor no <code>consultantController</code> e pressione Ctrl-Espaço. A funcionalidade autocompletar código do editor indica que <code>consultantController</code> é um Bean gerenciado pelo JSF.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/code-completion-managed-bean.png" alt="code completion managed bean">
</div>
<div class="title">Figure 19. A funcionalidade autocompletar código é fornecida para Beans gerenciados pelo JSF</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Mova o cursor para <code>prepareCreate</code> e pressione Ctrl-Espaço. A funcionalidade autocompletar código lista os métodos contidos no Bean gerenciado <code>ConsultantController</code>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/code-completion-properties.png" alt="code completion properties">
</div>
<div class="title">Figure 20. A funcionalidade autocompletar código é fornecida para métodos de classe</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Pressione Ctrl (&amp;#8984 no Mac) e, em seguida mova o mouse sobre <code>prepareCreate</code>. É formado um link, que permite ir diretamente para o método <code>prepareCreate()</code> no Bean gerenciado <code>ConsultantController</code>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/editor-navigation.png" alt="editor navigation">
</div>
<div class="title">Figure 21. Utilizar a navegação do editor para ir rapidamente até o código-fonte</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique no link e exiba o método <code>prepareCreate()</code> (exibido a seguir).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public String prepareCreate() {
    current = new Consultant();
    selectedItemIndex = -1;
    return "Create";
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>O método retornará <code>Create</code>. O <code>NavigationHandler</code> coleta informações em segundo plano e aplica a string <code>Create</code> ao caminho que indica a view enviada em resposta à solicitação: <code>/consultant/<strong>Create</strong>.xhtml</code>. (No JSF 2.x, a extensão do arquivo é deduzida devido à navegação implícita.)</p>
</div>
</div>
<div class="sect2">
<h3 id="dbIntegrity">Explorando a Integridade do Banco de Dados com Validação de Campo</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na <a href="#consultantsList">página Lista de Consultores</a> do browser, clique no link &#8216;Criar Novo Consultor&#8217;. Conforme demonstrado na subseção anterior, isso carrega a página <code>/consultant/Create.xhtml</code> para que seja renderizada.</p>
</li>
<li>
<p>Informe os detalhes a seguir no form: Temporariamente, deixe os campos <code>RecruiterId</code> e <code>StatusId</code> em branco.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Campo</th>
<th class="tableblock halign-left valign-top">Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ConsultantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Email</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:jack.smart@jsfcrudconsultants.com">jack.smart@jsfcrudconsultants.com</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jack.smart</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HourlyRate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">75</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BillableHourlyRate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HireDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">22/07/2008</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retomar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sou um ótimo consultor. Contrate-me - Você não vai se arrepender!</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RecruiterId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">StatusId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
</tr>
</tbody>
</table>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Salvar. Quando você fizer isso, um erro de validação será sinalizado no campo <code>StatusId</code>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/create-new-consultant.png" alt="create new consultant">
</div>
<div class="title">Figure 22. Informar os dados de amostra no form</div>
</div>
<div class="paragraph">
<p>Por que aconteceu isso? Examine novamente o <a href="#er-diagram">diagrama de relacionamento com entidades do banco de dados da Agência de Consultoria</a>. Conforme apresentado na <a href="#relationships">tabela de relacionamentos</a> acima, as tabelas <code>CONSULTANT</code> e <code>CONSULTANT_STATUS</code> compartilham um relacionamento que não pode ser nulo, um para muitos. Portanto, cada entrada da tabela <code>CONSULTANT</code> deve conter uma referência a uma entrada na tabela <code>CONSULTANT_STATUS</code>. Isso é indicado pela chave estrangeira <code>consultant_fk_consultant_status</code> que vincula as duas tabelas.</p>
</div>
<div class="paragraph">
<p>É possível exibir as chaves estrangeiras contidas nas tabelas expandindo o nó Chaves Estrangeiras da tabela na janela Serviços (Ctrl-5; &amp;#8984-5 no Mac).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/consultant-fk.png" alt="consultant fk">
</div>
<div class="title">Figure 23. Examinar os atributos da chave estrangeira na janela Serviços</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Para solucionar o erro de validação, selecione <code>entity.ConsultantStatus[statusId=A]</code> na lista drop-down <code>StatusId</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*Observação: *Você pode deixar o campo <code>RecruiterId</code> em branco. Conforme indicado no <a href="#er-diagram">diagrama de relacionamento com as entidades do banco de dados</a>, há um relacionamento que pode ser nulo, um para muitos entre as tabelas <code>CONSULTANT</code> e <code>RECRUITER</code>, indicando que as entradas em <code>CONSULTANT</code> não precisam estar associadas a uma entrada de <code>RECRUITER</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Salvar. Será exibida uma mensagem indicando que a entrada do consultor foi salva com êxito. Se você clicar em <code>Exibir Todos os Itens do Consultor</code>, você verá a nova entrada listada na tabela.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Em geral, as páginas de Facelets geradas produzem erros para entradas do usuário que introduz:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>campos vazios em células de tabela que não podem ser nulas.</p>
</li>
<li>
<p>modificações em dados que não podem ser alterados (por exemplo, chaves primárias).</p>
</li>
<li>
<p>inserção de dados que não são do tipo correto.</p>
</li>
<li>
<p>modificações em dados quando uma view do usuário não estiver mais sincronizada com o banco de dados.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="editEntity">Editando as Classes de Entidade</h3>
<div class="paragraph">
<p>Na subseção anterior, você viu como a lista drop-down <code>StatusId</code> forneceu a opção mais complexa <code>entity.ConsultantStatus[statusId=A]</code>. Você já deve ter notado que o texto exibido em cada item desta lista drop-down é a representação de uma string de cada entidade <code>ConsultantStatus</code> encontrada (por exemplo, o método <code>toString()</code> da classe de entidade é chamado).</p>
</div>
<div class="paragraph">
<p>Essa subseção demonstra como você pode utilizar a funcionalidade autocompletar código, a documentação e o suporte à navegação do editor para chegar a essa conclusão. Também oferece uma mensagem mais amigável para a lista drop-down.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Abra o arquivo <code>/consultant/Create.xhtml</code> no editor. Trata-se do form Criar Novo Consultor que você acaba de exibir no browser. Role para baixo até o código da lista drop-down <code>StatusId</code> (ilustrado em <strong>negrito</strong> abaixo).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">    &lt;h:outputLabel value="#{bundle.CreateConsultantLabel_resume}" for="resume" /&gt;
    &lt;h:inputTextarea rows="4" cols="30" id="resume" value="#{consultantController.selected.resume}" title="#{bundle.CreateConsultantTitle_resume}" /&gt;
    *&lt;h:outputLabel value="#{bundle.CreateConsultantLabel_statusId}" for="statusId" /&gt;
    &lt;h:selectOneMenu id="statusId" value="#{consultantController.selected.statusId}" title="#{bundle.CreateConsultantTitle_statusId}" required="true" requiredMessage="#{bundle.CreateConsultantRequiredMessage_statusId}"&gt;
        &lt;f:selectItems value="#{consultantStatusController.itemsAvailableSelectOne}"/&gt;
    &lt;/h:selectOneMenu&gt;*
    &lt;h:outputLabel value="#{bundle.CreateConsultantLabel_recruiterId}" for="recruiterId" /&gt;
    &lt;h:selectOneMenu id="recruiterId" value="#{consultantController.selected.recruiterId}" title="#{bundle.CreateConsultantTitle_recruiterId}" &gt;
        &lt;f:selectItems value="#{recruiterController.itemsAvailableSelectOne}"/&gt;
    &lt;/h:selectOneMenu&gt;
&lt;/h:panelGrid&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Examine o <code>value</code> aplicado à tag <code>&lt;f:selectItems&gt;</code>. O atributo <code>value</code> determina o texto exibido para cada item na lista drop-down.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Pressione Ctrl-Espaço em <code>itemsAvailableSelectOne</code>. A funcionalidade autocompletar código do editor indica que o método <code>getItemsAvailableSelectOne()</code> do <code>ConsultantStatusController</code> retorna um array de objetos <code>SelectItem</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/code-completion-returned-object.png" alt="code completion returned object">
</div>
<div class="title">Figure 24. A funcionalidade autocompletar código exibe as classes retornadas para os métodos</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Pressione Ctrl (&amp;#8984 no Mac) e, em seguida, mova o mouse sobre <code>itemsAvailableSelectOne</code>. É formado um link que permite ir diretamente para o método <code>getItemsAvailableSelectOne()</code> no código-fonte da entidade <code>ConsultantStatus</code>. Clique neste link.</p>
</li>
<li>
<p>Coloque o cursor sobre o valor de retorno <code>SelectItem[]</code> na assinatura do método e pressione Ctrl-Espaço para chamar a janela pop-up da documentação.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/documentation-select-item.png" alt="documentation select item">
</div>
<div class="title">Figure 25. Pressione Ctrl-Espaço para chamar o suporte à documentação</div>
</div>
<div class="paragraph">
<p>Clique no ícone ( <span class="image"><img src="images/web-browser-icon.png" alt="web browser icon"></span> ) Web browser na janela da documentação para abrir o Javadoc em um Web browser externo.</p>
</div>
<div class="paragraph">
<p>Como você pode ver, a classe <code>SelectItem</code> pertence ao framework JSF. O componente <code>UISelectOne</code>, conforme mencionado na documentação, é representado pela tag <code>&lt;h:selectOneMenu&gt;</code> da marcação que você examinou na <a href="#markup">Etapa 1</a> acima.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Pressione Ctrl (&amp;#8984 no Mac) e, em seguida, mova o mouse sobre <code>findAll()</code>. Uma janela pop-up será exibida com a assinatura do método.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/method-signature.png" alt="method signature">
</div>
<div class="title">Figure 26. Exibir pop-ups das assinaturas do método no editor</div>
</div>
<div class="paragraph">
<p>É possível observar que aqui o <code>ejbFacade.findAll()</code> retorna uma <code>Lista</code> de objetos <code>ConsultantStatus</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Vá para <code>JsfUtil.getSelectItems</code>. Coloque o mouse sobre <code>getSelectItems</code> e pressione Ctrl (&amp;#8984 no Mac), a seguir, clique no link exibido.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*Observação: *Lembre-se de que <code>JsfUtil</code> é uma das classes de utilitário geradas ao concluir o <a href="#jsfPagesEntityClasses">assistente de Páginas JSF de Classes de Entidade</a>.</p>
</div>
<div class="paragraph">
<p>O método cria o loop por meio da lista de entidades (por exemplo, a <code>List</code> de objetos <code>ConsultantStatus</code>), criando um <code>SelectItem</code> para cada entidade. Conforme indicado abaixo em <strong>negrito</strong>, cada <code>SelectItem</code> é criado utilizando o objeto da entidade e um <em>label</em> para o objeto.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public static SelectItem[] getSelectItems(List&lt;?&gt; entities, boolean selectOne) {
    int size = selectOne ? entities.size() + 1 : entities.size();
    SelectItem[] items = new SelectItem[size];
    int i = 0;
    if (selectOne) {
        items[0] = new SelectItem("", "---");
        i++;
    }
    *for (Object x : entities) {
        items[i++] = new SelectItem(x, x.toString());
    }*
    return items;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>O label é criado utilizando o método <code>toString()</code> da entidade e corresponde à representação do objeto quando renderizado na resposta. (Consulte a definição do Javadoc para o construtor <code>SelectItem(java.lang.Object value, java.lang.String label)</code>.)</p>
</div>
<div class="paragraph">
<p>Agora que você verificou que o método <code>toString()</code> da entidade é o método renderizado no browser ao exibir os itens em uma lista drop-down, modifique o método <code>toString()</code> do <code>ConsultantStatus</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Abra a classe de entidade <code>ConsultantStatus</code> no editor. Modifique o método <code>toString</code> para retornar <code>statusId</code> e <code>description</code>. Trata-se das propriedades da entidade que correspondem às duas colunas da tabela <code>CONSULTANT_STATUS</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public String toString() {
    return *statusId + ", " + description;*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Execute o projeto novamente. Quando o browser exibir a página de boas-vindas, clique no link <code>Mostrar Todos os Itens do Consultor</code> e, em seguida, em <code>Criar Novo Consultor</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Inspecione a lista drop-down <code>StatusId</code>. Você verá que agora ela exibe o ID de status e a descrição do registro contido na tabela <code>CONSULTANT_STATUS</code> do banco de dados.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/drop-down.png" alt="drop down">
</div>
<div class="title">Figure 27. A lista drop-down StatusId exibe itens de acordo com o método toString() da entidade ConsultantStatus</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="troubleshooting">Solução de Problemas</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dependendo da sua configuração, a implantação da aplicação no servidor poderá falhar e você talvez veja a seguinte mensagem na janela Saída.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">GlassFish Server 4 is running.
In-place deployment at /MyDocuments/ConsultingAgency/build/web
GlassFish Server 4, deploy, null, false
/MyDocuments/ConsultingAgency/nbproject/build-impl.xml:1045: The module has not been deployed.
See the server log for details.</code></pre>
</div>
</div>
<div class="paragraph">
<p>A causa mais comum da falha é um problema ao gerar os recursos JDBC no servidor. Se esse for o caso, você provavelmente verá uma mensagem semelhante à seguinte na guia de log do servidor, na janela Saída.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Severe:   Exception while preparing the app : Invalid resource : jdbc/consult__pm
com.sun.appserv.connectors.internal.api.ConnectorRuntimeException: Invalid resource : jdbc/consult__pm</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se a guia de log do servidor não for aberta, será possível abri-la clicando com o botão direito do mouse no nó GlassFish Server, na janela Serviços, e escolhendo Exibir Log do Servidor de Domínio.</p>
</div>
<div class="paragraph">
<p>Essa aplicação exige dois recursos JDBC:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Recurso ou Fonte de Dados JDBC. A aplicação usa a pesquisa JNDI para localizar o recurso JDBC. Se você examinar a unidade de persistência (<code>persistence.xml</code>), poderá ver que o nome da JNDI para a fonte de dados JTA dessa aplicação é <code>jdbc/consult</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>O recurso JDBC identifica o pool de conexões atualmente utilizado pela aplicação.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pool de Conexões JDBC. O pool de conexões especifica os detalhes da conexão do banco de dados, o que inclui local, nome do usuário e senha. O pool de conexões usado nessa aplicação é <code>consultPool</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>O recurso JDBC e o pool de conexões são especificados no arquivo <code>glassfish-resources.xml</code>. Você pode abrir <code>glassfish-resources.xml</code> no editor expandindo o nó Recursos do Servidor na janela Projetos e clicando duas vezes no arquivo. O arquivo será semelhante ao seguinte:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE resources PUBLIC "-//GlassFish.org//DTD GlassFish Application Server 3.1 Resource Definitions//EN" "http://glassfish.org/dtds/glassfish-resources_1_5.dtd"&gt;
&lt;resources&gt;
  &lt;jdbc-connection-pool allow-non-component-callers="false" associate-with-thread="false" connection-creation-retry-attempts="0" connection-creation-retry-interval-in-seconds="10" connection-leak-reclaim="false" connection-leak-timeout-in-seconds="0" connection-validation-method="auto-commit" datasource-classname="com.mysql.jdbc.jdbc2.optional.MysqlDataSource" fail-all-connections="false" idle-timeout-in-seconds="300" is-connection-validation-required="false" is-isolation-level-guaranteed="true" lazy-connection-association="false" lazy-connection-enlistment="false" match-connections="false" max-connection-usage-count="0" max-pool-size="32" max-wait-time-in-millis="60000" name="consultPool" non-transactional-connections="false" ping="false" pool-resize-quantity="2" pooling="true" res-type="javax.sql.DataSource" statement-cache-size="0" statement-leak-reclaim="false" statement-leak-timeout-in-seconds="0" statement-timeout-in-seconds="-1" steady-pool-size="8" validate-atmost-once-period-in-seconds="0" wrap-jdbc-objects="false"&gt;
    &lt;property name="serverName" value="localhost"/&gt;
    &lt;property name="portNumber" value="3306"/&gt;
    &lt;property name="databaseName" value="consult"/&gt;
    &lt;property name="User" value="root"/&gt;
    &lt;property name="Password" value="nb"/&gt;
    &lt;property name="URL" value="jdbc:mysql://localhost:3306/consult?zeroDateTimeBehavior=convertToNull"/&gt;
    &lt;property name="driverClass" value="com.mysql.jdbc.Driver"/&gt;
  /&lt;jdbc-connection-pool&gt;
  &lt;jdbc-resource enabled="true" jndi-name="jdbc/consult" object-type="user" pool-name="consultPool"/&gt;
/&lt;resources&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Em <code>glassfish-resources.xml</code>, você poderá ver que o recurso JDBC <code>jdbc/consult</code> identifica <code>consultPool</code> como nome do pool de conexões. É possível também ver as propriedades de <code>consultPool</code>. Nessa aplicação, apenas uma fonte de dados e um pool de conexões são definidos em <code>glassfish-resources.xml</code>. Em alguns casos, convém especificar recursos adicionais, por exemplo, para identificar um armazenamento de dados temporário usado apenas para fins de desenvolvimento ou teste.</p>
</div>
<div class="paragraph">
<p>Se o recurso JDBC e o pool de conexões não tiverem sido gerados automaticamente no servidor quando você executou a aplicação, será possível realizar as etapas a seguir para criar manualmente os recursos na Console Admin do GlassFish.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Abra <code>glassfish-resources.xml</code> no editor se não tiver feito isso ainda.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Use os valores de propriedade especificados em <code>glassfish-resources.xml</code> ao criar o recurso JDBC e o pool de conexões.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito no nó GlassFish Server, na janela Serviços, e escolha Abrir Console Admin do Domínio no menu pop-up para abrir a Console do GlassFish no browser.</p>
</li>
<li>
<p>No painel de navegação Tarefas Comuns da Console do GlassFish, expanda o nó <strong>JDBC</strong> e os nós <strong>Recursos JDBC</strong> e <strong>Pool de Conexões JDBC</strong>.</p>
</li>
</ol>
</div>
<div class="openblock">
<div class="content">
<div class="imageblock left">
<div class="content">
<a class="image" href="images/gf-admin-console-lg.png"><img src="images/gf-admin-console-sm.png" alt="gf admin console sm"></a>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Você pode ver os recursos JDBC que estão registrados atualmente no servidor. Será necessário criar <code>jdbc/consult</code> e <code>consultPool</code> se não estiverem listados sob o nó JDBC no painel de navegação Tarefas Comuns. Alguns recursos JDBC foram criados por padrão quando você instalou o servidor e são exibidos como subnós.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique no nó <strong>Pools de Conexões JDBC</strong> e clique em Novo no painel Novo Pool de Conexões JDBC.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gf-new-jdbc-pool1.png" alt="gf new jdbc pool1">
</div>
<div class="title">Figure 28. Painel Novo Pool de Conexões JDBC na Console Admin do GlassFish</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Digite <strong>consultPool</strong> como Nome do Pool, selecione <strong>javax.sql.ConnectionPoolDataSource</strong> como Tipo de Recurso e selecione <strong>MySql</strong> como Fornecedor do Driver de Banco de Dados. Clique em Próximo.</p>
</li>
<li>
<p>Na Etapa 2, localize e especifique os valores das propriedades <strong>URL</strong>, <strong>nome do usuário</strong> e <strong>senha</strong>. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gf-new-jdbc-pool2.png" alt="gf new jdbc pool2">
</div>
<div class="title">Figure 29. Painel Novo Pool de Conexões JDBC na Console Admin do GlassFish</div>
</div>
<div class="paragraph">
<p>Os valores das propriedades se encontram em <code>glassfish-resources.xml</code>.</p>
</div>
<div class="paragraph">
<p>O novo pool de conexões é criado no servidor quando você clica em Concluir e um nó do pool de conexões é exibido sob o nó Pools de Conexões JDBC.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique no nó <strong>Recursos JDBC</strong> no painel de navegação Tarefas Comuns e clique em Novo.</p>
</li>
<li>
<p>Digite <strong>jdbc/consult</strong> como Nome da JNDI e selecione <strong>consultPool</strong> na lista drop-down Nome do Pool. Clique em OK.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gf-new-jdbc-resource.png" alt="gf new jdbc resource">
</div>
<div class="title">Figure 30. Painel Novo Recurso JDBC na Console Admin do GlassFish</div>
</div>
<div class="paragraph">
<p>O novo recurso JDBC é criado no servidor quando você clica em OK e um nó para o recurso é exibido sob o nó Recursos JDBC.</p>
</div>
<div class="paragraph">
<p>Na janela Serviço do IDE, você pode expandir o nó Recursos no GlassFish Server e ver se o IDE adicionou os novos recursos. Pode ser necessário atualizar a view (clique com o botão direito do mouse em Recursos e escolha Atualizar) para exibir as alterações.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gf-services-jdbc-resources.png" alt="gf services jdbc resources">
</div>
<div class="title">Figure 31. Recursos JDBC exibidos na janela Serviços do IDE</div>
</div>
<div class="paragraph">
<p>Para obter mais dicas sobre solução de problemas ao usar o MySQL e o IDE, consulte os seguintes documentos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tutorial <a href="../ide/mysql.html">Estabelecendo Conexão com um Banco de Dados MySQL</a>.</p>
</li>
<li>
<p>A seção de solução de problemas de <a href="mysql-webapp.html#troubleshoot">Criando uma Aplicação Web Simples Usando um Banco de Dados MySQL</a>
<a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Creating%20a%20JSF%202.0%20CRUD%20Application">Enviar Feedback neste Tutorial</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="seealso">Consulte Também</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para obter mais informações sobre o JSF 2.x, consulte os recursos a seguir:</p>
</div>
<div class="sect2">
<h3 id="_tutoriais_e_artigos_netbeans">Tutoriais e Artigos NetBeans</h3>
<div class="ulist">
<ul>
<li>
<p><a href="jsf20-intro.html">Introdução ao JavaServer Faces 2.x no NetBeans IDE</a></p>
</li>
<li>
<p><a href="jsf20-support.html">Suporte a JSF 2.x no NetBeans IDE</a></p>
</li>
<li>
<p><a href="../../samples/scrum-toys.html">Scrum Toys: A Aplicação de Amostra Completa do JSF 2.0</a></p>
</li>
<li>
<p><a href="../javaee/javaee-gettingstarted.html">Conceitos Básicos sobre Aplicações do Java EE</a></p>
</li>
<li>
<p><a href="../../trails/java-ee.html">Trilha do Aprendizado do Java EE e Java Web</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_recursos_externos">Recursos Externos</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.oracle.com/technetwork/java/javaee/javaserverfaces-139869.html">Tecnologia JavaServer Faces</a> (homepage Oficial)</p>
</li>
<li>
<p><a href="http://jcp.org/aboutJava/communityprocess/final/jsr314/index.html">Especificação do JSR 314 para o JavaServer Faces 2.0</a></p>
</li>
<li>
<p>Capítulo <a href="http://docs.oracle.com/javaee/7/tutorial/doc/jsf-intro.htm">Tecnologia do JavaServer Faces</a> no Tutorial Java EE 7</p>
</li>
<li>
<p><a href="http://javaserverfaces.dev.java.net/">Projeto Mojarra GlassFish</a> (Implementação oficial de referência do JSF 2.x)</p>
</li>
<li>
<p><a href="http://forums.oracle.com/forums/forum.jspa?forumID=982">Fóruns de Discussão OTN: JavaServer Faces</a></p>
</li>
<li>
<p><a href="http://www.jsfcentral.com/">Central do JSF</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_blogs">Blogs</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.java.net/blogs/edburns/">Ed Burns</a></p>
</li>
<li>
<p><a href="http://www.java.net/blogs/driscoll/">Jim Driscoll</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/jsf20-crud_pt_BR.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
