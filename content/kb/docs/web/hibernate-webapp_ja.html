
<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>WebアプリケーションでのHibernateの使用</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="WebアプリケーションでのHibernateの使用 - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, WebアプリケーションでのHibernateの使用">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
     <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet"> 
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
</head>


    <body>
        

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="/plugins/index.html">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


        
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Just released!</div>
            <h1 syle='font-size: 2rem'>Apache NetBeans 11.2</h1>
            <p><a class="button success" href="/download/nb112/index.html">Find out more</a></p>
        </div>
    </div>
</section>

        <div class='grid-container main-content tutorial'>
            <h1 class="sect0">WebアプリケーションでのHibernateの使用</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://issues.apache.org/jira/projects/NETBEANS/issues">open a JIRA issue</a>, 
                     or <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/hibernate-webapp_ja.asciidoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
            <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_データベースの作成">データベースの作成</a></li>
<li><a href="#_webアプリケーション_プロジェクトの作成">Webアプリケーション・プロジェクトの作成</a></li>
<li><a href="#_hibernate構成ファイルの変更">Hibernate構成ファイルの変更</a></li>
<li><a href="#_code_hibernateutil_java_code_ヘルパー_ファイルの作成"><code>HibernateUtil.java</code> ヘルパー・ファイルの作成</a></li>
<li><a href="#_hibernateのマッピング_ファイルおよびjavaクラスの生成">Hibernateのマッピング・ファイルおよびJavaクラスの生成</a>
<ul class="sectlevel2">
<li><a href="#_hibernateリバース_エンジニアリング_ファイルの作成">Hibernateリバース・エンジニアリング・ファイルの作成</a></li>
<li><a href="#_hibernateマッピング_ファイルとpojoの作成">Hibernateマッピング・ファイルとPOJOの作成</a></li>
</ul>
</li>
<li><a href="#_code_filmhelper_java_code_ヘルパー_クラスの作成"><code>FilmHelper.java</code> ヘルパー・クラスの作成</a>
<ul class="sectlevel2">
<li><a href="#_クラスの作成">クラスの作成</a></li>
<li><a href="#_hql問合せを使用した映画タイトルの列挙と俳優の取得">HQL問合せを使用した映画タイトルの列挙と俳優の取得</a></li>
<li><a href="#_ヘルパー_メソッドの追加">ヘルパー・メソッドの追加</a></li>
</ul>
</li>
<li><a href="#_jsf管理対象beanの作成">JSF管理対象Beanの作成</a></li>
<li><a href="#_webページの作成">Webページの作成</a>
<ul class="sectlevel2">
<li><a href="#_code_template_xhtml_code_の作成"><code>template.xhtml</code> の作成</a></li>
<li><a href="#_code_index_xhtml_code_の変更"><code>index.xhtml</code> の変更</a></li>
<li><a href="#_code_browse_xhtml_code_の作成"><code>browse.xhtml</code> の作成</a></li>
</ul>
</li>
<li><a href="#_プロジェクトの実行">プロジェクトの実行</a>
<ul class="sectlevel2">
<li><a href="#_ソリューション_プロジェクトのダウンロード">ソリューション・プロジェクトのダウンロード</a></li>
<li><a href="#_トラブルシューティング">トラブルシューティング</a></li>
</ul>
</li>
<li><a href="#_関連項目">関連項目</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>このチュートリアルでは、NetBeans IDEを使用してデータをデータベースから表示するWebアプリケーションを作成してデプロイします。このWebアプリケーションでは、プレーン・オールドJavaオブジェクト(POJO)を取得してリレーショナル・データベースに保存するための持続性レイヤーとして、Hibernateフレームワークを使用します。</p>
</div>
<div class="paragraph">
<p>Hibernateは、ORM (object relational mapping)のためのツールを提供するフレームワークです。このチュートリアルでは、IDEにHibernateフレームワークのサポートを追加し、必要なHibernateファイルを作成する方法を示します。Javaオブジェクトを作成し、Hibernateを使用するようにアプリケーションを構成した後、JSF管理対象Beanとデータを表示するJSF 2.0ページを作成します。</p>
</div>
<div class="paragraph">
<p>このチュートリアルを開始する前に、必要に応じて次のドキュメントをお読みください。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.hibernate.org/">hibernate.org</a>のHibernateドキュメント</p>
</li>
<li>
<p><a href="quickstart-webapps.html">Webアプリケーション開発入門</a></p>
</li>
<li>
<p><a href="jsf20-intro.html">JavaServer Faces 2.x入門</a></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/netbeans-stamp-74-73-72.png" alt="netbeans stamp 74 73 72">
</div>
<div class="title">Figure 1. このページの内容は、NetBeans IDE 7.2、7.3および7.4に適用されます</div>
</div>
<div class="paragraph">
<p><strong>このチュートリアルに従うには、次のソフトウェアとリソースが必要です。</strong></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ソフトウェアまたはリソース</th>
<th class="tableblock halign-left valign-top">必須バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">NetBeans IDE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.1、7.2、7.3、7.4、Java EEバージョン</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java Development Kit (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">バージョン6または7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GlassFish Server Open Source Edition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.xまたは4.x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.mysql.com/">MySQLデータベース・サーバー</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">バージョン5.x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sakilaデータベース</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新センターから入手できるプラグイン</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="https://netbeans.org/projects/samples/downloads/download/Samples/JavaEE/DVDStoreEE6.zip">終了したプロジェクトのZIPアーカイブ</a>はダウンロードできます。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_データベースの作成">データベースの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このチュートリアルでは、MySQLのサイトで無償提供されているMySQLサンプル・データベースの <code>sakila</code> を使用します。IDEのインストールにはsakilaデータベースが含まれないため、チュートリアルを開始する前にデータベースを作成する必要があります。</p>
</div>
<div class="paragraph">
<p>sakilaデータベースを作成するには、プラグイン・マネージャを使用してSakilaサンプル・データベース・プラグインをダウンロードしてインストールできます。このプラグインをインストールすると、「MySQLデータベースの作成」ダイアログ・ボックスのデータベース・リストにsakilaデータベースが追加されます。</p>
</div>
<div class="paragraph">
<p>MySQLを操作するためのIDEの構成については、<a href="../ide/mysql.html">MySQLデータベースへの接続</a>のチュートリアルを参照してください。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>プラグイン・マネージャを開き、Sakilaサンプル・データベース・プラグインをインストールします。</p>
</li>
<li>
<p>プラグインをインストールした後、「サービス」ウィンドウで「データベース」ノードを展開し、「MySQLサーバー」ノードを右クリックして「起動」を選択して、MySQLデータベースを起動します。</p>
</li>
<li>
<p>「MySQLサーバー」ノードを右クリックし、「データベースを作成」を選択します。</p>
</li>
<li>
<p>「MySQLデータベースの作成」ダイアログ・ボックスで「新規データベース名」ドロップダウン・リストから「Sakilaデータベース」を選択します。「OK」をクリックします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/create-sakila-mysql.png" alt="create sakila mysql">
</div>
<div class="title">Figure 2. 「MySQLデータベースの作成」ダイアログのスクリーンショット</div>
</div>
<div class="paragraph">
<p>「OK」をクリックすると、「MySQLサーバー」ノードの下に「Sakila」ノードが表示されます。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>「Sakila」ノードを右クリックし、「接続」を選択します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>「接続」をクリックすると、「Sakila」データベースのデータベース接続のノード( <code>jdbc:mysql://localhost:3306/sakila [デフォルトの_ユーザー名_]</code> )が「データベース」ノードに一覧表示されます。接続が開いたら、接続ノードを展開してデータベースのデータを表示できます。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_webアプリケーション_プロジェクトの作成">Webアプリケーション・プロジェクトの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>この課題では、Webアプリケーション・プロジェクトを作成し、Hibernateライブラリをそのプロジェクトに追加します。プロジェクトを作成する場合は、新規プロジェクト・ウィザードの「フレームワーク」パネルで「Hibernate」を選択してデータベースを指定します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>メイン・メニューから「ファイル」&gt;「新規プロジェクト」([Ctrl]-[Shift]-[N]、Macの場合は[⌘]-[Shift]-[N])を選択します。「Java Web」カテゴリから「Webアプリケーション」を選択し、「次」をクリックします。</p>
</li>
<li>
<p>プロジェクト名として「<strong>DVDStore</strong>」と入力し、プロジェクトの場所を設定します。</p>
</li>
<li>
<p>専用フォルダを使用するオプションが選択されている場合は選択を解除します。「次」をクリックします。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>このチュートリアルでは、ライブラリを他のユーザーと共有する必要がないため、プロジェクト・ライブラリを専用のフォルダにコピーする理由はほとんどありません。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>サーバーを「GlassFish Server」に設定し、「Java EEバージョン」を「Java EE 6 Web」または「Java EE 7 Web」に設定します。「次」をクリックします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>「JavaServer Faces」チェックボックスを選択し、デフォルトのJSF 2.xライブラリを使用します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>フレームワークの選択リストで「Hibernate」チェックボックスを選択します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>「データベース接続」ドロップダウン・リストから「Sakilaデータベース」を選択します。「終了」をクリックします。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>注意:</strong> Sakilaデータベースがウィザードの「フレームワーク」パネルのオプションとして使用できない場合、この接続が「サービス」ウィンドウの「データベース」ノードに一覧表示されているかどうかを確認します。ここに接続がない場合、データベース接続を作成する必要があります。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/hib-newwebapp.png" alt="hib newwebapp">
</div>
<div class="title">Figure 3. プロジェクトへのHibernateサポートの追加を示す新規プロジェクト・ウィザードの「フレームワーク」パネル</div>
</div>
<div class="paragraph">
<p>「終了」をクリックすると、Webアプリケーション・プロジェクトが作成され、 <code>hibernate.cfg.xml</code> ファイルと <code>index.xhtml</code> がエディタに表示されます。</p>
</div>
<div class="paragraph">
<p>「プロジェクト」ウィンドウの「ライブラリ」ノードを展開すると、IDEによってHibernateライブラリがそのプロジェクトに追加されたことを確認できます。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/hib-libraries.png" alt="hib libraries">
</div>
<div class="title">Figure 4. Hibernateライブラリが表示された「プロジェクト」ウィンドウのスクリーンショット</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hibernate構成ファイルの変更">Hibernate構成ファイルの変更</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hibernateフレームワークを使用する新規プロジェクトを作成する場合、IDEでは <code>hibernate.cfg.xml</code> 構成ファイルがアプリケーションのコンテキスト・クラスパスのルート(「ファイル」ウィンドウの <code>src/java</code> )に自動的に作成されます。ファイルは、「プロジェクト」ウィンドウの「ソース・パッケージ」の下の <code>&lt;デフォルト・パッケージ&gt;</code> にあります。構成ファイルには、データベース接続、リソース・マッピング、およびその他の接続プロパティに関する情報が格納されます。このファイルは、マルチビュー・エディタを使用して編集、または直接XMLエディタでXMLを編集できます。</p>
</div>
<div class="paragraph">
<p>この課題では、 <code>hibernate.cfg.xml</code> に指定されたデフォルトのプロパティを編集し、SQL文のデバッグ・ロギングを有効にし、Hibernateのセッション・コンテキスト管理を有効にします。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「デザイン」タブで <code>hibernate.cfg.xml</code> を開きます。このファイルは、「プロジェクト」ウィンドウで「ソース・パッケージ」の下の <code>&lt;デフォルト・パッケージ&gt;</code> ノードを展開し、 <code>hibernate.cfg.xml</code> をダブルクリックすることで開きます。</p>
</li>
<li>
<p>マルチビューXMLエディタで、「オプションのプロパティ」の下の「構成プロパティ」ノードを展開します。</p>
</li>
<li>
<p>「追加」をクリックして「Hibernateのプロパティの追加」ダイアログ・ボックスを開きます。</p>
</li>
<li>
<p>このダイアログ・ボックスで、「 <code>hibernate.show_sql</code> 」プロパティを選択し、値を「 <code>true</code> 」に設定します。これにより、SQL文のデバッグ・ロギングが有効になります。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/add-property-showsql.png" alt="add property showsql">
</div>
<div class="title">Figure 5. hibernate.show_sqlプロパティの設定値が表示された「Hibernateのプロパティの追加」ダイアログ・ボックス</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>「Miscellaneous Properties」ノードを展開し、「追加」をクリックします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>このダイアログ・ボックスで「 <code>hibernate.current_session_context_class</code> 」プロパティを選択し、値を「 <code>thread</code> 」に設定すると、Hibernateの自動セッション・コンテキスト管理が有効になります。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/add-property-sessioncontext.png" alt="add property sessioncontext">
</div>
<div class="title">Figure 6. hibernate.current_session_context_classプロパティの設定値が表示された「Hibernateのプロパティの追加」ダイアログ・ボックス</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>「その他のプロパティ」ノードの下の「追加」を再度クリックし、「プロパティ名」ドロップダウン・リストで <code>hibernate.query.factory_class</code> を選択します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>「プロパティ値」として「<strong>org.hibernate.hql.classic.ClassicQueryTranslatorFactory</strong>」を選択します。「OK」をクリックします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/add-property-factoryclass.png" alt="add property factoryclass">
</div>
<div class="title">Figure 7. hibernate.query.factory_classプロパティの設定値が表示された「Hibernateのプロパティの追加」ダイアログ・ボックス</div>
</div>
<div class="paragraph">
<p>エディタの「XML」タブをクリックすると、ファイルがXMLビューに表示されます。ファイルの内容は次のようになります(3つの新しいプロパティは太字)。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;hibernate-configuration&gt;
    &lt;session-factory name="session1"&gt;
        &lt;property name="hibernate.dialect"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;
        &lt;property name="hibernate.connection.driver_class"&gt;com.mysql.jdbc.Driver&lt;/property&gt;
        &lt;property name="hibernate.connection.url"&gt;jdbc:mysql://localhost:3306/sakila&lt;/property&gt;
        &lt;property name="hibernate.connection.username"&gt;root&lt;/property&gt;
        &lt;property name="hibernate.connection.password"&gt;######&lt;/property&gt;
        *&lt;property name="hibernate.show_sql"&gt;true&lt;/property&gt;
        &lt;property name="hibernate.current_session_context_class"&gt;thread&lt;/property&gt;
        &lt;property name="hibernate.query.factory_class"&gt;org.hibernate.hql.classic.ClassicQueryTranslatorFactory&lt;/property&gt;*
    &lt;/session-factory&gt;
&lt;/hibernate-configuration&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>変更内容をファイルに保存します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>このファイルは、再度編集する必要がないため閉じてかまいません。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_hibernateutil_java_code_ヘルパー_ファイルの作成"><code>HibernateUtil.java</code> ヘルパー・ファイルの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hibernateを使用するには、起動を処理し、Hibernateの <code>SessionFactory</code> にアクセスしてセッション・オブジェクトを取得するヘルパー・クラスを作成する必要があります。このクラスは、 <code>configure()</code> をコールし、 <code>hibernate.cfg.xml</code> 構成ファイルをロードし、次に <code>SessionFactory</code> をビルドしてセッション・オブジェクトを取得します。</p>
</div>
<div class="paragraph">
<p>この項では、新規ファイル・ウィザードを使用してヘルパー・クラスである <code>HibernateUtil.java</code> を作成します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「ソース・パッケージ」ノードを右クリックし、「新規」&gt;「その他」を選択して新規ファイル・ウィザードを開きます。</p>
</li>
<li>
<p>「カテゴリ」の一覧から「Hibernate」を選択し、「ファイル・タイプ」の一覧から「HibernateUtil.java」を選択します。「次」をクリックします。</p>
</li>
<li>
<p>クラス名に「<strong>HibernateUtil</strong>」、パッケージに「<strong>dvdrental</strong>」と入力します。「終了」をクリックします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/hibernate-util-wizard.png" alt="hibernate util wizard">
</div>
<div class="title">Figure 8. HibernateUtilウィザードのスクリーンショット</div>
</div>
<div class="paragraph">
<p>「終了」をクリックすると、 <code>HibernateUtil.java</code> がエディタに表示されます。このファイルは、編集する必要がないため閉じてかまいません。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hibernateのマッピング_ファイルおよびjavaクラスの生成">Hibernateのマッピング・ファイルおよびJavaクラスの生成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このチュートリアルでは、POJO (プレーン・オールドJavaオブジェクト)を使用して、これから使用するデータベース内の各表内のデータを表します。Javaクラスが、表内の列のフィールドを指定し、データの取得と書込みに単純な取得メソッドおよび設定メソッドを使用します。POJOを表にマップするには、Hibernateマッピング・ファイルを使用するか、クラス内で注釈を使用します。</p>
</div>
<div class="paragraph">
<p>データベースからのHibernateのマッピング・ファイルとPOJOウィザードを使用して、データベース表に基づいて複数のPOJOとマッピング・ファイルを作成できます。ウィザードを使用し、目的のPOJOとマッピング・ファイルのためのすべての表を選択すると、IDEでデータベース表に基づいてファイルが生成され、 <code>hibernate.cfg.xml</code> にマッピング・エントリが追加されます。ウィザードを使用する場合、たとえばPOJOのみにするなど、IDEで生成するファイルを選択でき、また、たとえばEJB 3注釈を使用するコードの生成するなど、コード生成オプションを選択できます。</p>
</div>
<div class="paragraph">
<p>*注意:*IDEには、個別のPOJOとマッピング・ファイルを最初から作成するウィザードもあります。</p>
</div>
<div class="sect2">
<h3 id="_hibernateリバース_エンジニアリング_ファイルの作成">Hibernateリバース・エンジニアリング・ファイルの作成</h3>
<div class="paragraph">
<p>データベースからのHibernateのマッピング・ファイルとPOJOウィザードを使用する場合、最初に <code>hibernate.reveng.xml</code> リバース・エンジニアリング・ファイルを作成する必要があります。データベースからのHibernateのマッピング・ファイルとPOJOウィザードには、 <code>hibernate.reveng.xml</code> および <code>hibernate.cfg.xml</code> が必要です。</p>
</div>
<div class="paragraph">
<p>リバース・エンジニアリング・ファイルを使用すると、データベース・マッピング戦略をより詳細に制御できます。Hibernateリバース・エンジニアリング・ウィザードでは、XMLエディタで編集できるデフォルト構成を持つリバース・エンジニアリング・ファイルが作成されます。</p>
</div>
<div class="paragraph">
<p>Hibernateリバース・エンジニアリング・ファイルを作成するには、次の手順を実行します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「プロジェクト」ウィンドウで「ソース・パッケージ」ノードを右クリックし、「新規」&gt;「その他」を選択して新規ファイル・ウィザードを開きます。</p>
</li>
<li>
<p>「Hibernate」カテゴリで「Hibernateリバース・エンジニアリング・ウィザード」を選択します。「次」をクリックします。</p>
</li>
<li>
<p>ファイル名に <code>hibernate.reveng</code> を指定し、フォルダに <code>src/java</code> を指定します。「次」をクリックします。</p>
</li>
<li>
<p>選択されていない場合、 <code>hibernate.cfg.xml</code> を「構成ファイル」ドロップダウン・リストから選択します。</p>
</li>
<li>
<p>「使用可能な表」から次の表を選択し、「追加」をクリックして「選択した表」に追加します。</p>
<div class="ulist">
<ul>
<li>
<p>actor</p>
</li>
<li>
<p>category</p>
</li>
<li>
<p>film</p>
</li>
<li>
<p>film_actor</p>
</li>
<li>
<p>film_category</p>
</li>
<li>
<p>language</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>「終了」をクリックします。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/hibernate-reveng-wizard.png" alt="hibernate reveng wizard">
</div>
<div class="title">Figure 9. 新規Hibernateリバース・エンジニアリング・ウィザード</div>
</div>
<div class="paragraph">
<p>このウィザードでは、 <code>hibernate.reveng.xml</code> リバース・エンジニアリング・ファイルが生成され、ファイルはエディタに表示されます。リバース・エンジニアリング・ファイルは、編集する必要がないため閉じてかまいません。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>``hibernate.reveng.xml`` ファイルの操作の詳細は、link:http://docs.jboss.org/tools/2.1.0.Beta1/hibernatetools/html/reverseengineering.html[+第5章: リバース・エンジニアリングの制御+](link:http://docs.jboss.org/tools/2.1.0.Beta1/hibernatetools/html/[+Hibernate Toolsリファレンス・ガイド+])を参照してください。</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_hibernateマッピング_ファイルとpojoの作成">Hibernateマッピング・ファイルとPOJOの作成</h3>
<div class="paragraph">
<p>データベースからのHibernateのマッピング・ファイルとPOJOウィザードを使用して、ファイルを生成できます。このウィザードでは、ウィザードで選択した表ごとに、POJOおよび対応するマッピング・ファイルを生成できます。マッピング・ファイルはXMLファイルで、表の列をPOJOのフィールドにマップする方法に関するデータが含まれています。ウィザードを使用するには、 <code>hibernate.reveng.xml</code> ファイルと <code>hibernate.cfg.xml</code> ファイルが必要です。</p>
</div>
<div class="paragraph">
<p>ウィザードを使用してPOJOとマッピング・ファイルを作成するには、次の手順を実行します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「プロジェクト」ウィンドウで「ソース・パッケージ」ノードを右クリックし、「新規」&gt;「その他」を選択して新規ファイル・ウィザードを開きます。</p>
</li>
<li>
<p>「データベースからのHibernateのマッピング・ファイルとPOJO」を「Hibernate」カテゴリから選択します。「次」をクリックします。</p>
</li>
<li>
<p>ドロップダウン・リストで、 <code>hibernate.cfg.xml</code> ファイルと <code>hibernate.reveng.xml</code> ファイルが選択されていることを確認します。</p>
</li>
<li>
<p>「一般的な設定」で「<strong>JDK 5言語機能</strong>」を選択します。</p>
</li>
<li>
<p>「<strong>ドメイン・コード</strong>」および「<strong>Hibernate XMLのマッピング</strong>」オプションが選択されていることを確認します。</p>
</li>
<li>
<p>パッケージ名に「<strong>dvdrental</strong>」を選択します。「終了」をクリックします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/hibernate-pojo-wizard2.png" alt="hibernate pojo wizard2">
</div>
<div class="title">Figure 10. 「Hibernateのマッピング・ファイルとPOJOの生成」ウィザード</div>
</div>
<div class="paragraph">
<p>「終了」をクリックすると、POJOとHibernateのマッピング・ファイルが生成され、 <code>hibernate.reveng.xml</code> で指定した列にフィールドがマップされます。また、 <code>hibernate.cfg.xml</code> にマッピング・エントリが追加されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;hibernate-configuration&gt;
  &lt;session-factory&gt;
    &lt;property name="hibernate.dialect"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;
    &lt;property name="hibernate.connection.driver_class"&gt;com.mysql.jdbc.Driver&lt;/property&gt;
    &lt;property name="hibernate.connection.url"&gt;jdbc:mysql://localhost:3306/sakila&lt;/property&gt;
    &lt;property name="hibernate.connection.username"&gt;myusername&lt;/property&gt;
    &lt;property name="hibernate.connection.password"&gt;mypassword&lt;/property&gt;
    &lt;property name="hibernate.show_sql"&gt;true&lt;/property&gt;
    &lt;property name="hibernate.current_session_context_class"&gt;thread&lt;/property&gt;
    &lt;property name="hibernate.query.factory_class"&gt;org.hibernate.hql.classic.ClassicQueryTranslatorFactory&lt;/property&gt;
    &lt;mapping resource="dvdrental/FilmActor.hbm.xml"/&gt;
    &lt;mapping resource="dvdrental/Language.hbm.xml"/&gt;
    &lt;mapping resource="dvdrental/Film.hbm.xml"/&gt;
    &lt;mapping resource="dvdrental/Category.hbm.xml"/&gt;
    &lt;mapping resource="dvdrental/Actor.hbm.xml"/&gt;
    &lt;mapping resource="dvdrental/FilmCategory.hbm.xml"/&gt;
  &lt;/session-factory&gt;
&lt;/hibernate-configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>注意:</strong> <code>hibernate.cfg.xml</code> ファイルで、 <code>mapping</code> 要素が <code>property</code> 要素の後に表示されていることを確認してください。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>``dvdrental`` パッケージを展開すると、ウィザードによって生成されたファイルを確認できます。</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/hib-projectswindow.png" alt="hib projectswindow">
</div>
<div class="title">Figure 11. 生成されたPOJOを示す「プロジェクト」ウィンドウ</div>
</div>
<div class="paragraph">
<p>特定の表を特定のクラスにマップするHibernateマッピング・ファイルを作成する場合、Hibernateマッピング・ウィザードを使用できます。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>``hibernate.reveng.xml`` ファイルの操作の詳細は、link:http://docs.jboss.org/hibernate/core/3.3/reference/en/html/mapping.html[+第5章: 基本的なO/Rマッピング+](link:http://docs.jboss.org/hibernate/stable/core/reference/en/html/[+Hibernate Reference Documentation+])を参照してください。</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_filmhelper_java_code_ヘルパー_クラスの作成"><code>FilmHelper.java</code> ヘルパー・クラスの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>データベースに対するHibernate問合せの実行に使用するヘルパー・クラスを <code>dvdrental</code> パッケージ内に作成します。Hibernate問合せ言語(HQL)エディタを使用して、データを取り出す問合せを構築し、テストします。問合せをテストしたら、問合せを構築および実行するメソッドをヘルパー・クラス内に作成します。次に、ヘルパー・クラス内のメソッドをJSF管理対象Beanから呼び出します。</p>
</div>
<div class="sect2">
<h3 id="_クラスの作成">クラスの作成</h3>
<div class="paragraph">
<p>この項では、新規ファイル・ウィザードを使用して、ヘルパー・クラス <code>FilmHelper.java</code> を <code>dvdrental</code> パッケージ内に作成します。 <code>HibernateUtil.java</code> 内の <code>getSessionFactory</code> をコールしてHibernateセッションを作成し、データベースからデータを取り出す問合せを作成するヘルパー・メソッドをいくつか作成します。ヘルパー・メソッドはJSPページから呼び出します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「 <code>dvdrental</code> 」ソース・パッケージ・ノードを右クリックし、「新規」&gt;「Javaクラス」を選択して、新規ファイル・ウィザードを開きます。</p>
</li>
<li>
<p>クラス名に「<strong>FilmHelper</strong>」と入力します。</p>
</li>
<li>
<p>「パッケージ」として*dvdrental*が選択されていることを確認します。「終了」をクリックします。</p>
</li>
<li>
<p>次のコード(太字部分)を追加して、Hibernateセッションを作成します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class FilmHelper {

    *Session session = null;

    public FilmHelper() {
        this.session = HibernateUtil.getSessionFactory().getCurrentSession();
    }*

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>エディタ上で右クリックし、「インポートを修正」([Alt]-[Shift]-[I]、Macの場合は[⌘]-[Shift]-[I])を選択して必要なインポート文( <code>org.hibernate.Session</code> )を追加し、変更を保存します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>ここで <code>FilmHelper.java</code> を変更して、データベースに対して問合せを実行するメソッドを追加します。</p>
</div>
</div>
<div class="sect2">
<h3 id="_hql問合せを使用した映画タイトルの列挙と俳優の取得">HQL問合せを使用した映画タイトルの列挙と俳優の取得</h3>
<div class="paragraph">
<p>この課題では、データベースを問合せしてFilm表から映画のタイトルのリストを取り出す、Hibernate問合せ言語(HQL)問合せ作成します。次に、特定の映画に含まれる俳優をフェッチするため、Actor表およびFilm_actor表の両方に問合せを実行するメソッドを追加します。</p>
</div>
<div class="paragraph">
<p>Film表には1000件のレコードがあるため、映画のリストを取得するメソッドは、 <code>filmId</code> 主キーに基づいてレコードを取得できる必要があります。HQL問合せの構成とテストには、HQLエディタを使用します。正しい問合せを作成した後、適切な問合せを生成できるクラスにメソッドを追加します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「プロジェクト」ウィンドウでプロジェクトのノードを右クリックし、「消去してビルド」を選択します。</p>
</li>
<li>
<p>「プロジェクト」ウィンドウで「 <code>hibernate.cfg.xml</code> 」を右クリックし、「HQL問合せの実行」を選択して、HQL問合せエディタを開きます。</p>
</li>
<li>
<p>ツールバーのドロップダウン・リストから「hibernate.cfg」を選択します。</p>
</li>
<li>
<p>接続をテストするには、エディタで次のように入力し、ツールバーの「HQL問合せの実行」ボタン(<span class="image"><img src="images/run_hql_query_16.png" alt="run hql query 16" title="「HQL問合せの実行」ボタン"></span>)をクリックします。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">from Film</code></pre>
</div>
</div>
<div class="paragraph">
<p>「HQL問合せの実行」をクリックすると、HQL問合せエディタの下部ウィンドウで問合せの結果を確認できます。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/hibernate-hqleditor1.png" alt="hibernate hqleditor1">
</div>
<div class="title">Figure 12. 「Hibernateのマッピング・ファイルとPOJOの生成」ウィザード</div>
</div>
<div class="paragraph">
<p>「SQL」ボタンをクリックすると、対応するSQL問合せを確認できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">select film0_.film_id as col_0_0_ from sakila.film film0_</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>次の問合せを入力して、filmIdが100から200の間に含まれるレコードをFilm表から取り出します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">from Film as film where film.filmId between 100 and 200</code></pre>
</div>
</div>
<div class="paragraph">
<p>結果ウィンドウにレコードのリストが表示されます。問合せが適切な結果を返すことをテストできたので、この問合せをヘルパー・クラスで使用できます。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p><code>FilmHelper.java</code> に次のメソッド <code>getFilmTitles</code> を追加して、filmIdが、変数 <code>startID</code> と <code>endID</code> で指定する範囲内にある映画を取り出します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public List getFilmTitles(int startID, int endID) {
    List&lt;Film&gt; filmList = null;
    try {
        org.hibernate.Transaction tx = session.beginTransaction();
        Query q = session.createQuery ("from Film as film where film.filmId between '"+startID+"' and '"+endID+"'");
        filmList = (List&lt;Film&gt;) q.list();
    } catch (Exception e) {
        e.printStackTrace();
    }
    return filmList;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>特定の映画から俳優を取得する次のメソッド <code>getActorsByID</code> を追加します。メソッドは、入力変数として <code>filmId</code> を使用し、問合せを構成します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public List getActorsByID(int filmId){
    List&lt;Actor&gt; actorList = null;
    try {
        org.hibernate.Transaction tx = session.beginTransaction();
        Query q = session.createQuery ("from Actor as actor where actor.actorId in (select filmActor.actor.actorId from FilmActor as filmActor where filmActor.film.filmId='" + filmId + "')");
        actorList = (List&lt;Actor&gt;) q.list();

    } catch (Exception e) {
        e.printStackTrace();
    }

    return actorList;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>インポートを修正して変更内容を保存します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>インポートを修正するときは、 <code>java.util.List</code> と <code>org.hibernate.Query</code> を選択します。</p>
</div>
</div>
<div class="sect2">
<h3 id="_ヘルパー_メソッドの追加">ヘルパー・メソッドの追加</h3>
<div class="paragraph">
<p>ここでは、入力変数に基づいて問合せを作成するヘルパー・メソッドを追加します。問合せはHQL問合せエディタで確認できます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>filmId</code> に基づいてカテゴリのリストを取り出す次のメソッドを追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public Category getCategoryByID(int filmId){
    List&lt;Category&gt; categoryList = null;
    try {
        org.hibernate.Transaction tx = session.beginTransaction();
        Query q = session.createQuery("from Category as category where category.categoryId in (select filmCat.category.categoryId from FilmCategory as filmCat where filmCat.film.filmId='" + filmId + "')");
        categoryList = (List&lt;Category&gt;) q.list();

    } catch (Exception e) {
        e.printStackTrace();
    }

    return categoryList.get(0);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p><code>filmId</code> に基づいて1つの映画を取り出す次のメソッドを追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public Film getFilmByID(int filmId){

    Film film = null;

    try {
        org.hibernate.Transaction tx = session.beginTransaction();
        Query q = session.createQuery("from Film as film where film.filmId=" + filmId);
        film = (Film) q.uniqueResult();
    } catch (Exception e) {
        e.printStackTrace();
    }

    return film;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p><code>langId</code> に基づいて映画の言語を取り出す次のメソッドを追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public String getLangByID(int langId){

    Language language = null;

    try {
        org.hibernate.Transaction tx = session.beginTransaction();
        Query q = session.createQuery("from Language as lang where lang.languageId=" + langId);
        language = (Language) q.uniqueResult();
    } catch (Exception e) {
        e.printStackTrace();
    }

    return language.getName();
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>変更を保存します。</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jsf管理対象beanの作成">JSF管理対象Beanの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>この課題では、JSF管理対象Beanを作成します。管理対象Beanのメソッドは、JSFページにデータを表示したり、ヘルパー・クラスのメソッドにアクセスしてレコードを取り出すために使用されます。JSF 2.0仕様によって、スコープを指定したりBeanに名前を指定するためのJSF管理対象Beanとしてクラスを識別するため、Beanクラスに注釈を使用できます。</p>
</div>
<div class="paragraph">
<p>管理対象Beanを作成するには、次の手順を実行します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>dvdrental</code> ソース・パッケージ・ノードを右クリックして「新規」&gt;「その他」を選択します。</p>
</li>
<li>
<p>「JavaServer Faces」カテゴリからJSF管理対象Beanを選択します。「次」をクリックします。</p>
</li>
<li>
<p>「クラス名」に「<strong>FilmController</strong>」と入力します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Beanでメソッドをコールするときに、管理対象Bean名 <code>filmController</code> を、JSFページ <code>index.xhtml</code> の <code>inputText</code> および <code>commandButton</code> の値として使用します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>パッケージに「<strong>dvdrental</strong>」を選択します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>管理対象Beanに使用する名前に「<strong>filmController</strong>」と入力します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>スコープを「セッション」に設定します。「終了」をクリックします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/hib-newmanagedbean.png" alt="hib newmanagedbean">
</div>
<div class="title">Figure 13. 新規JSF管理対象Beanウィザード</div>
</div>
<div class="paragraph">
<p>「終了」をクリックすると、IDEはBeanクラスを作成し、そのクラスがエディタに表示されます。IDEによって、 <code>@ManagedBean</code> 注釈と <code>@SessionScoped</code> 注釈が追加されています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@ManagedBean
@SessionScoped
public class FilmController {

    /** Creates a new instance of FilmController */
    public FilmController() {
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>*注意:*管理対象Beanの名前は明示的に指定されていません。デフォルトでは、Beanの名前はクラス名と同じになり、小文字で始まります。Beanの名前をクラス名とは異なるものにするには、 <code>@ManagedBean</code> 注釈のパラメータとして明示的に名前を指定します(たとえば、 <code>@ManagedBean(name="myBeanName")</code> )。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>このクラスに、次のフィールド(太字部分)を追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@ManagedBean
@SessionScoped
public class FilmController {
    *int startId;
    int endId;
    DataModel filmTitles;
    FilmHelper helper;
    private int recordCount = 1000;
    private int pageSize = 10;

    private Film current;
    private int selectedItemIndex;*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>次の太字部分のコードを追加してFilmControllerインスタンスを作成し、映画を取り出します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">    /** Creates a new instance of FilmController */
    public FilmController() {
        *helper = new FilmHelper();
        startId = 1;
        endId = 10;
    }

    public FilmController(int startId, int endId) {
        helper = new FilmHelper();
        this.startId = startId;
        this.endId = endId;
    }

    public Film getSelected() {
        if (current == null) {
            current = new Film();
            selectedItemIndex = -1;
        }
        return current;
    }


    public DataModel getFilmTitles() {
        if (filmTitles == null) {
            filmTitles = new ListDataModel(helper.getFilmTitles(startId, endId));
        }
        return filmTitles;
    }

    void recreateModel() {
        filmTitles = null;
    }*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>表の表示とページへのナビゲートに使用される、次のメソッドを追加します。*    public boolean isHasNextPage() {
    if (endId + pageSize &#8656; recordCount) {
        return true;
    }
    return false;
}</p>
<div class="literalblock">
<div class="content">
<pre>public boolean isHasPreviousPage() {
    if (startId-pageSize &gt; 0) {
        return true;
    }
    return false;
}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>public String next() {
    startId = endId+1;
    endId = endId + pageSize;
    recreateModel();
    return "index";
}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>public String previous() {
    startId = startId - pageSize;
    endId = endId - pageSize;
    recreateModel();
    return "index";
}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>public int getPageSize() {
    return pageSize;
}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>    public String prepareView(){
        current = (Film) getFilmTitles().getRowData();
        return "browse";
    }
    public String prepareList(){
        recreateModel();
        return "index";
    }
*</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>「index」または「browse」を返すメソッドによって、JSFナビゲーション・ハンドラは <code>index.xhtml</code> または <code>browse.xhtml</code> という名前のページを開くように求められます。JSF 2.0仕様では、Faceletsテクノロジを使用するアプリケーションで暗黙ナビゲーション・ルールを使用できます。このアプリケーションは、 <code>faces-config.xml</code> にナビゲーション・ルールが構成されていません。かわりに、ナビゲーション・ハンドラが、アプリケーション内で適切なページを検索しようとします。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>追加の映画の詳細を取り出すヘルパー・クラスにアクセスする、次のメソッドを追加します。*    public String getLanguage() {
    int langID = current.getLanguageByLanguageId().getLanguageId().intValue();
    String language = helper.getLangByID(langID);
    return language;
}</p>
<div class="literalblock">
<div class="content">
<pre>public String getActors() {
    List actors = helper.getActorsByID(current.getFilmId());
    StringBuffer totalCast = new StringBuffer();
    for (int i = 0; i &lt; actors.size(); i++) {
        Actor actor = (Actor) actors.get(i);
        totalCast.append(actor.getFirstName());
        totalCast.append(" ");
        totalCast.append(actor.getLastName());
        totalCast.append("  ");
    }
    return totalCast.toString();
}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>public String getCategory() {
    Category category = helper.getCategoryByID(current.getFilmId());
    return  category.getName();
}*</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java"></code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>インポートを修正([Ctrl]-[Shift]-[I])して変更内容を保存します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>エディタでコード補完を使用すると、コードの入力に役立ちます。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_webページの作成">Webページの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>この課題では、データを表示するWebページを2つ作成します。IDEが生成した <code>index.xhtml</code> を変更して、データベース内の映画を表示する表を追加します。次に、表の「View」リンクをクリックしたときに映画の詳細を表示する <code>browse.xhtml</code> を作成します。また、 <code>index.xhtml</code> と <code>browse.xhtml</code> で使用するJSFテンプレート・ページも作成します。</p>
</div>
<div class="paragraph">
<p>JSF 2.0およびFaceletsテンプレートの使用については、<a href="jsf20-intro.html">JavaServer Faces 2.0入門</a>を参照してください。</p>
</div>
<div class="sect2">
<h3 id="_code_template_xhtml_code_の作成"><code>template.xhtml</code> の作成</h3>
<div class="paragraph">
<p>最初に、 <code>index.xhtml</code> ページと <code>browse.xhtml</code> ページの構成に使用する、JSF Faceletsテンプレート <code>template.xhtml</code> を作成します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「プロジェクト」ウィンドウで「DVDStore」プロジェクト・ノードを右クリックし、「新規」&gt;「その他」を選択します。</p>
</li>
<li>
<p>「JavaServer Faces」カテゴリで「Faceletsテンプレート」を選択します。「次」をクリックします。</p>
</li>
<li>
<p>「ファイル名」に「<strong>template</strong>」と入力し、1つ目のCSSレイアウト・スタイルを選択します。</p>
</li>
<li>
<p>「終了」をクリックします。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>「終了」をクリックすると、エディタで <code>template.xhtml</code> ファイルが開きます。テンプレートには次のデフォルト・コードが含まれています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">&lt;h:body&gt;

    &lt;div id="top" class="top"&gt;
        &lt;ui:insert name="top"&gt;Top&lt;/ui:insert&gt;
    &lt;/div&gt;

    &lt;div id="content" class="center_content"&gt;
        &lt;ui:insert name="content"&gt;Content&lt;/ui:insert&gt;
    &lt;/div&gt;

&lt;/h:body&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p><code>&lt;ui:insert&gt;</code> 要素を変更して、デフォルトで生成される名前を「body」に変えます。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">&lt;div id="content" class="center_content"&gt;
        &lt;ui:insert name="*body*"&gt;Content&lt;/ui:insert&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>変更を保存します。</p>
<div class="literalblock">
<div class="content">
<pre>``index.xhtml`` および ``browse.xhtml`` の ``&lt;ui:define name="body"&gt;`` 要素内の内容は、テンプレートの ``&lt;ui:insert name="body"&gt;Content&lt;/ui:insert&gt;`` で指定された場所に挿入されます。</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_code_index_xhtml_code_の変更"><code>index.xhtml</code> の変更</h3>
<div class="paragraph">
<p>Webアプリケーションを作成すると、IDEが自動的にページの <code>index.xhtml</code> を生成します。この課題では、ページを変更して映画のタイトルのリストを表示するようにします。JSFページはJSF管理対象BeanのFilmControllerのメソッドをコールし、映画のリストを取り出して、映画のタイトルと説明の表を表示します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「プロジェクト」ウィンドウで「Webページ」フォルダを展開し、 <code>index.xhtml</code> をエディタで開きます。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>新規プロジェクト・ウィザードで、次に示すデフォルトの <code>index.xhtml</code> を生成します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"&gt;
&lt;h:head&gt;
        &lt;title&gt;Facelet Title&lt;/title&gt;
    &lt;/h:head&gt;
    &lt;h:body&gt;
        Hello from Facelets
    &lt;/h:body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>ページを変更し、JSF <code>&lt;ui:composition&gt;</code> 要素および <code>&lt;ui:define&gt;</code> 要素を使用するようにして、 <code>&lt;h:form&gt;</code> 要素を追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://java.sun.com/jsf/html"
  *xmlns:ui="http://java.sun.com/jsf/facelets"&gt;
    &lt;ui:composition template="./template.xhtml"&gt;
        &lt;ui:define name="body"&gt;
            &lt;h:form&gt;

            &lt;/h:form&gt;
        &lt;/ui:define&gt;
    &lt;/ui:composition&gt;*
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>タグの入力を開始すると、IDEは <code>xmlns:ui="http://java.sun.com/jsf/facelets"</code> タグ・ライブラリ宣言を追加します。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>``&lt;ui:composition&gt;`` 要素と ``&lt;ui:define&gt;`` 要素は、作成するページ・テンプレートと組み合せて使用されます。 ``&lt;ui:composition&gt;`` 要素は、このページによって使用されるテンプレートの場所を参照します。 ``&lt;ui:define&gt;`` 要素は、含まれているコードが占有するテンプレート内での位置を参照します。</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>JSF管理対象Beanで <code>previous</code> メソッドおよび <code>next</code> メソッドをコールする、次のナビゲーション・リンクを追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">    &lt;ui:define name="body"&gt;
            &lt;h:form&gt;
                *&lt;h:commandLink action="#{filmController.previous}" value="Previous #{filmController.pageSize}" rendered="#{filmController.hasPreviousPage}"/&gt; 
                &lt;h:commandLink action="#{filmController.next}" value="Next #{filmController.pageSize}" rendered="#{filmController.hasNextPage}"/&gt; *
            &lt;/h:form&gt;
    &lt;/ui:define&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>取り出された項目を表示する表を生成する次の <code>dataTable</code> 要素(太字部分)を追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">            &lt;h:form styleClass="jsfcrud_list_form"&gt;
                &lt;h:commandLink action="#{filmController.previous}" value="Previous #{filmController.pageSize}" rendered="#{filmController.hasPreviousPage}"/&gt; 
                &lt;h:commandLink action="#{filmController.next}" value="Next #{filmController.pageSize}" rendered="#{filmController.hasNextPage}"/&gt; 
                *&lt;h:dataTable value="#{filmController.filmTitles}" var="item" border="0" cellpadding="2" cellspacing="0" rowClasses="jsfcrud_odd_row,jsfcrud_even_row" rules="all" style="border:solid 1px"&gt;
                    &lt;h:column&gt;
                        &lt;f:facet name="header"&gt;
                            &lt;h:outputText value="Title"/&gt;
                        &lt;/f:facet&gt;
                        &lt;h:outputText value="#{item.title}"/&gt;
                    &lt;/h:column&gt;
                    &lt;h:column&gt;
                        &lt;f:facet name="header"&gt;
                            &lt;h:outputText value="Description"/&gt;
                        &lt;/f:facet&gt;
                        &lt;h:outputText value="#{item.description}"/&gt;
                    &lt;/h:column&gt;
                    &lt;h:column&gt;
                        &lt;f:facet name="header"&gt;
                            &lt;h:outputText value=" "/&gt;
                        &lt;/f:facet&gt;
                        &lt;h:commandLink action="#{filmController.prepareView}" value="View"/&gt;
                    &lt;/h:column&gt;
                &lt;/h:dataTable&gt;
                &lt;br/&gt;*
            &lt;/h:form&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>変更を保存します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>これで、indexページにデータベース内の映画のタイトル・リストが表示されます。表の各行に、管理対象Beanの <code>prepareView</code> メソッドを呼び出す「View」リンクがあります。 <code>prepareView</code> メソッドは「browse」を返し、 <code>browse.xhtml</code> を開きます。</p>
</div>
<div class="paragraph">
<p><strong>注意:</strong> <code>&lt;f:facet&gt;</code> タグを入力すると、IDEは <code>xmlns:f="http://java.sun.com/jsf/core</code> タグ・ライブラリ宣言を追加します。<strong>ファイルにタグ・ライブラリが宣言されていることを確認してください。</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="_code_browse_xhtml_code_の作成"><code>browse.xhtml</code> の作成</h3>
<div class="paragraph">
<p>ここでは、選択した映画の詳細を表示する <code>browse.xhtml</code> ページを作成します。Faceletsテンプレート・クライアント・ウィザードを使用すると、作成したJSF Faceletsテンプレート <code>template.xhtml</code> に基づいて、ページを作成できます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「プロジェクト」ウィンドウで「DVDStore」プロジェクト・ノードを右クリックし、「新規」&gt;「その他」を選択します。</p>
</li>
<li>
<p>「JavaServer Faces」カテゴリで「Faceletsテンプレート・クライアント」を選択します。「次」をクリックします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/hib-faceletsclient.png" alt="hib faceletsclient">
</div>
<div class="title">Figure 14. 新規ファイル・ウィザードの「Faceletsテンプレート・クライアント」ファイル・タイプ</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>「ファイル名」に「<strong>browse</strong>」と入力します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>「参照」をクリックして「ファイルを参照」ダイアログ・ボックスを開き、ページのテンプレートを特定します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>「Webページ」フォルダを展開し、「 <code>template.xhtml</code> 」を選択します。「ファイルを選択」をクリックします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/hib-browsetemplate.png" alt="hib browsetemplate">
</div>
<div class="title">Figure 15. 「ファイルを参照」ダイアログでのテンプレートの選択</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>「生成されたルート・タグ」に*&lt;ui:composition&gt;*を選択します。「終了」をクリックします。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>「終了」をクリックすると、 <code>browse.xhtml</code> ファイルがエディタで開き、次のコードが表示されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
    template="./template.xhtml"&gt;

    &lt;ui:define name="top"&gt;
        top
    &lt;/ui:define&gt;

    &lt;ui:define name="body"&gt;
        body
    &lt;/ui:define&gt;

&lt;/ui:composition&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>新しいファイルが <code>template.xhtml</code> ファイルを指定し、 <code>&lt;ui:define&gt;</code> タグに <code>name="body"</code> プロパティがあることを確認できます。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p><code>&lt;ui:define&gt;</code> タグの間に次の太字のコードを追加してフォームを作成し、管理対象BeanのFilmControllerでメソッドをコールして、データを取り出し、フォームを生成します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
    template="./template.xhtml"
    *xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"*&gt;

        &lt;ui:define name="top"&gt;
            top
        &lt;/ui:define&gt;

        &lt;ui:define name="body"&gt;
        *
            &lt;h:form&gt;
                &lt;h:panelGrid columns="2"&gt;
                    &lt;h:outputText value="Title:"/&gt;
                    &lt;h:outputText value="#{filmController.selected.title}" title="Title"/&gt;
                    &lt;h:outputText value="Description"/&gt;
                    &lt;h:outputText value="#{filmController.selected.description}" title="Description"/&gt;
                    &lt;h:outputText value="Genre"/&gt;
                    &lt;h:outputText value="#{filmController.category}"/&gt;

                    &lt;h:outputText value="Cast"/&gt;
                    &lt;h:outputText value="#{filmController.actors}"/&gt;


                    &lt;h:outputText value="Film Length"/&gt;
                    &lt;h:outputText value="#{filmController.selected.length} min" title="Film Length"/&gt;

                    &lt;h:outputText value="Language"/&gt;
                    &lt;h:outputText value="#{filmController.language}" title="Film Length"/&gt;

                    &lt;h:outputText value="Release Year"/&gt;
                    &lt;h:outputText value="#{filmController.selected.releaseYear}" title="Release Year"&gt;
                        &lt;f:convertDateTime pattern="MM/dd/yyyy" /&gt;
                    &lt;/h:outputText&gt;
                    &lt;h:outputText value="Rental Duration"/&gt;
                    &lt;h:outputText value="#{filmController.selected.rentalDuration}" title="Rental DUration"/&gt;
                    &lt;h:outputText value="Rental Rate"/&gt;
                    &lt;h:outputText value="#{filmController.selected.rentalRate}" title="Rental Rate"/&gt;
                    &lt;h:outputText value="Replacement Cost"/&gt;
                    &lt;h:outputText value="#{filmController.selected.replacementCost}" title="Replacement Cost"/&gt;
                    &lt;h:outputText value="Rating"/&gt;
                    &lt;h:outputText value="#{filmController.selected.rating}" title="Rating"/&gt;
                    &lt;h:outputText value="Special Features"/&gt;
                    &lt;h:outputText value="#{filmController.selected.specialFeatures}" title="Special Features"/&gt;
                    &lt;h:outputText value="Last Update"/&gt;
                    &lt;h:outputText value="#{filmController.selected.lastUpdate}" title="Last Update"&gt;
                        &lt;f:convertDateTime pattern="MM/dd/yyyy HH:mm:ss" /&gt;
                    &lt;/h:outputText&gt;
                &lt;/h:panelGrid&gt;
                &lt;br/&gt;
                &lt;br/&gt;
                &lt;h:commandLink action="#{filmController.prepareList}" value="View All List"/&gt;
                &lt;br/&gt;
            &lt;/h:form&gt;
*
        &lt;/ui:define&gt;
    &lt;/ui:composition&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>``browse.xhtml`` と ``index.xhtml`` が同じページ・テンプレートを使用していることが確認できます。</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>変更を保存します。</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_プロジェクトの実行">プロジェクトの実行</h2>
<div class="sectionbody">
<div class="paragraph">
<p>アプリケーションの基本はこれで完了です。ここでアプリケーションを実行し、すべてが正常に動作するかを確認します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>メイン・ツールバーの「メイン・プロジェクトの実行」をクリックするか、「プロジェクト」ウィンドウでDVDStoreアプリケーション・ノードを右クリックして「実行」を選択します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>変更したファイルがすべて保存され、アプリケーションがビルドされて、サーバーにデプロイされます。IDEは、映画のリストを表示するURL <code><a href="http://localhost:8080/DVDStore/" class="bare">http://localhost:8080/DVDStore/</a></code> で、ブラウザ・ウィンドウを開きます。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/hib-browser1.png" alt="hib browser1">
</div>
<div class="title">Figure 16. indexページに映画のリストが表示されたスクリーンショット</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>ブラウザで、「View」をクリックして <code>browse.xhtml</code> をロードし、映画の詳細を表示します。</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_ソリューション_プロジェクトのダウンロード">ソリューション・プロジェクトのダウンロード</h3>
<div class="paragraph">
<p>次の方法で、このチュートリアルにソリューションをプロジェクトとしてダウンロードできます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://netbeans.org/projects/samples/downloads/download/Samples/JavaEE/DVDStoreEE6.zip">終了したプロジェクトのZIPアーカイブ</a>をダウンロードします。</p>
</li>
<li>
<p>次の手順を実行して、プロジェクト・ソースをNetBeansのサンプルからチェックアウトします。</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>メイン・メニューから「チーム」&gt;「Subversion」&gt;「チェックアウト」を選択します。</p>
</li>
<li>
<p>「チェックアウト」ダイアログ・ボックスで次のリポジトリURLを入力します。
 <code><a href="https://svn.netbeans.org/svn/samples~samples-source-code" class="bare">https://svn.netbeans.org/svn/samples~samples-source-code</a></code>
「次」をクリックします。</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>「参照」をクリックして「リポジトリ・フォルダを参照」ダイアログ・ボックスを開きます。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>ルート・ノードを展開し、*samples/javaee/DVDStoreEE6*を選択します。「OK」をクリックします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>ソースのローカル・フォルダを指定します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>「終了」をクリックします。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>「終了」をクリックすると、IDEではローカル・フォルダがSubversionリポジトリとして初期化され、プロジェクト・ソースがチェックアウトされます。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>チェックアウトが完了するときに表示されるダイアログで、「プロジェクトを開く」をクリックします。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*注意:*Subversionのインストールの詳細は、<a href="../ide/subversion.html">NetBeans IDEでのSubversionガイド</a>の<a href="../ide/subversion.html#settingUp">Subversionの設定</a>の項を参照してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="_トラブルシューティング">トラブルシューティング</h3>
<div class="paragraph">
<p>チュートリアルのアプリケーションで発生する問題の多くは、GlassFish Server Open Source EditionとMySQLデータベース・サーバーとの間の接続に原因があります。アプリケーションが正しく表示されない場合、またはサーバー・エラーが表示される場合、<a href="mysql-webapp.html">MySQLデータベースを使用した単純なWebアプリケーションの作成</a>のチュートリアルの<a href="mysql-webapp.html#troubleshoot">トラブルシューティング</a>または<a href="../ide/mysql.html">MySQLデータベースへの接続</a>のチュートリアルを参照してください。</p>
</div>
<div class="paragraph">
<p>MySQLデータベースを使用するアプリケーションを初めてデプロイした場合、ソリューション・プロジェクトをダウンロードして実行すると、「出力」ウィンドウに次のエラーが表示される場合があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">    SEVERE: JDBC Driver class not found: com.mysql.jdbc.Driver
    java.lang.ClassNotFoundException: com.mysql.jdbc.Driver
	at org.glassfish.web.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1509)

        [...]

	at java.lang.Thread.run(Thread.java:680)

    SEVERE: Initial SessionFactory creation failed.org.hibernate.HibernateException: JDBC Driver class not found: com.mysql.jdbc.Driver
    INFO: cleaning up connection pool: null
    INFO: Domain Pinged: stable.glassfish.org</code></pre>
</div>
</div>
<div class="paragraph">
<p>ブラウザ・ウィンドウに <code>java.lang.ExceptionInInitializerError</code> および次のスタック・トレースが表示される場合があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">    java.lang.ExceptionInInitializerError
	at dvdrental.HibernateUtil.&lt;clinit&gt;(HibernateUtil.java:28)
	...
    Caused by: org.hibernate.HibernateException: JDBC Driver class not found: com.mysql.jdbc.Driver

	...
    Caused by: java.lang.ClassNotFoundException: com.mysql.jdbc.Driver
	...</code></pre>
</div>
</div>
<div class="paragraph">
<p>出力メッセージには、MySQLデータベースのJDBCドライバが見つからなかったことが示されます。最も可能性の高い原因は、MySQL JDBCドライバ・ファイルをGlassFishサーバー・インストールに追加する必要があるということです。ドライバがないことを確認し、ローカル・システムの <code><em>GLASSFISH-INSTALL</em>/glassfish/domains/domain1/lib</code> ディレクトリに移動します(ここで、_GLASSFISH-INSTALL_はGlassFishのインストール・ディレクトリです)。 <code>domain1/lib</code> ディレクトリにJDBCドライバ・ファイル(たとえば、`mysql-connector-java-5.1.13-bin.jar`など)が含まれていない場合、JDBCドライバをディレクトリにコピーする必要があります。サーバーのインストール時、MySQL JDBCドライバはGlassFishインストールに追加されません。</p>
</div>
<div class="paragraph">
<p>次の手順を実行して、GlassFishインストールに、MySQL JDBCドライバのコピーを追加できます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="http://dev.mysql.com/downloads/connector/j/">MySQL Connector/J JDBCドライバ</a>をダウンロードします。</p>
</li>
<li>
<p>ドライバを抽出し、GlassFishインストールの <code>domain1/lib</code> ディレクトリに、ドライバのファイル(たとえば、<code>mysql-connector-java-5.1.13-bin.jar</code>)をコピーします。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>または、IDEを使用してMySQLデータベースを使用するアプリケーションを作成する場合、プロジェクトをデプロイすると、必要に応じてバンドルされているMySQL JDBCドライバがGlassFishサーバーに自動的にコピーされます。必要なJDBCドライバがIDEによってコピーされることを確認するには、メイン・メニューから「ツール」&gt;「サーバー」を選択し、サーバー・マネージャを開いて、GlassFishサーバーに対して「JDBCドライバのデプロイメントを有効化」オプションが選択されていることを確認します。</p>
</div>
<div class="paragraph">
<p>MySQLデータベースを使用するWebアプリケーションを作成してデプロイした後、ローカルのGlassFishインストールの`domain1/lib`ディレクトリに移動すると、ディレクトリにJDBCドライバ・ファイルが含まれていることが確認できます。</p>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Using%20Hibernate%20in%20a%20Web%20Application">このチュートリアルに関するご意見をお寄せください</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_関連項目">関連項目</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="jsf20-support.html">NetBeans IDEでのJSF 2.xのサポート</a></p>
</li>
<li>
<p><a href="jsf20-intro.html">JavaServer Faces 2.x入門</a></p>
</li>
<li>
<p><a href="../../trails/java-ee.html">Java EEおよびJava Webの学習</a></p>
</li>
</ul>
</div>
</div>
</div>
            
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="JIRA" href="https://issues.apache.org/jira/projects/NETBEANS/summary"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/hibernate-webapp_ja.asciidoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

        </div>
        

<div class='grid-container incubator-area' style='margin-top: 64px'>
    <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/">
                <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
            </a>
        </div>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/events/current-event.html">
               <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
            </a>
        </div>
    </div>
</div>
<footer>
    <div class="grid-container">
        <div class="grid-x grid-padding-x">
            <div class="large-auto cell">
                
                <h1><a href="/about/index.html">About</a></h1>
                <ul>
                    <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
                    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                    <li><a href="https://www.apache.org/security/">Security</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/community/index.html">Community</a></h1>
                <ul>
                    <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
                    <li><a href="/community/committer.html">Becoming a committer</a></li>
                    <li><a href="/community/events.html">NetBeans Events</a></li>
                    <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/participate/index.html">Participate</a></h1>
                <ul>
                    <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
                    <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
                    <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/help/index.html">Get Help</a></h1>
                <ul>
                    <li><a href="/help/index.html#documentation">Documentation</a></li>
                    <li><a href="/wiki/index.asciidoc">Wiki</a></li>
                    <li><a href="/help/index.html#support">Community Support</a></li>
                    <li><a href="/help/commercial-support.html">Commercial Support</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/download/nb110/nb110.html">Download</a></h1>
                <ul>
                    <li><a href="/download/index.html">Releases</a></li>                    
                    <li><a href="/plugins/index.html">Plugins</a></li>
                    <li><a href="/download/index.html#source">Building from source</a></li>
                    <li><a href="/download/index.html#previous">Previous releases</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<div class='footer-disclaimer'>
    <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2019 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
            <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
            <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
        </div>
        
    </div>
</div>



        <script src="/js/vendor/jquery-3.2.1.min.js"></script>
        <script src="/js/vendor/what-input.js"></script>
        <script src="/js/vendor/jquery.colorbox-min.js"></script>
        <script src="/js/vendor/foundation.min.js"></script>
        <script src="/js/netbeans.js"></script>
        <script>
            
            $(function(){ $(document).foundation(); });
        </script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        <script>
         $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
        </script>
        
    </body>
</html>
