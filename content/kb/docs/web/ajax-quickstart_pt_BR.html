
<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Introdução ao Ajax para Aplicações Java Web</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Introdução ao Ajax para Aplicações Java Web - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Introdução ao Ajax para Aplicações Java Web">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
     <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet"> 
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
</head>


    <body>
        

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans (incubating)</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="/plugins/index.html">Plugins</a> </li>
            <li> <a href="/download/nb100/nb100.html">Download</a> </li>
        </ul>
    </div>
</div>


        
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Just released!</div>
            <h1 syle='font-size: 2rem'>Apache NetBeans 10.0</h1>
            <p><a class="button success" href="/download/nb100/nb100.html">Read more</a></p>
        </div>
    </div>
</section>

        <div class='grid-container main-content tutorial'>
            <h1 class="sect0">Introdução ao Ajax para Aplicações Java Web</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. You can <a href="/kb/docs/contributing.html">help us review it.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
            <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#overview">Visão Geral da Aplicação</a></li>
<li><a href="#client1">Programando o Lado do Cliente: Parte 1</a>
<ul class="sectlevel2">
<li><a href="#_usando_o_editor_html">Usando o Editor HTML</a></li>
<li><a href="#javascript">Utilizando o Editor JavaScript</a></li>
</ul>
</li>
<li><a href="#serverside">Programando o Lado do Servidor</a>
<ul class="sectlevel2">
<li><a href="#_criando_o_armazenamento_de_dados">Criando o Armazenamento de Dados</a></li>
<li><a href="#servlet">Criando um Servlet</a></li>
</ul>
</li>
<li><a href="#client2">Programando o Lado do Cliente: Parte 2</a>
<ul class="sectlevel2">
<li><a href="#_adicionando_a_funcionalidade_de_retorno_de_chamada">Adicionando a Funcionalidade de Retorno de Chamada</a></li>
<li><a href="#_atualizando_o_html_dom">Atualizando o HTML DOM</a></li>
<li><a href="#displayresults">Exibindo os Resultados</a></li>
<li><a href="#stylesheet">Anexando uma Folha de Estilo</a></li>
</ul>
</li>
<li><a href="#run">Executando o Projeto</a>
<ul class="sectlevel2">
<li><a href="#httpMonitor">Utilizando o Monitor do Servidor HTTP</a></li>
<li><a href="#conclusion">Conclusão</a></li>
</ul>
</li>
<li><a href="#seeAlso">Consulte Também</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Este documento oferece uma introdução ao Ajax e demonstra algumas das funncionalidades no NetBeans IDE que permitem que você programe de forma mais rápida e eficaz ao trabalhar com tecnologias relacionadas ao Ajax. Enquanto aprende sobre a funcionalidade de baixo nível do Ajax, você constrói uma aplicação simples que utiliza a função autocompletar em um campo de texto. O conteúdo aqui foi adaptado do artigo e da aplicação de amostra de Greg Murray <a href="http://weblogs.java.net/blog/gmurray71/archive/2005/12/using_ajax_with_1.html">Using Ajax with Java Technology</a>.</p>
</div>
<div class="paragraph">
<p>Ajax significa Asynchronous JavaScript and XML. Na essência, o Ajax é uma forma eficiente de uma aplicação web tratar as interações do usuário com uma página web: uma forma que reduz a necessidade de fazer uma atualização da página ou uma recarga completa da página para cada interação do usuário. Isso permite um comportamento detalhado (semelhante ao de uma aplicação de área de trabalho ou aplicação web com base em plug-in) na utilização de um browser. As interações do Ajax são tratadas assincronamente em segundo plano. Enquanto isso acontece, um usuário pode continuar trabalhando com a página. As interações do Ajax são iniciadas pelo código JavaScript. Quando a interação do Ajax é concluída, o JavaScript atualiza o código-fonte HTML da página. As alterações são feitas imediatamente sem requerer uma atualização da página. As interações do Ajax podem ser utilizadas para fazer coisas como validar entradas do form (enquanto o usuário as está digitando) utilizando lógica do lado do servidor, recuperar dados detalhados do servidor, atualizar dinamicamente os dados em uma página e submeter forms parciais a partir da página.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/netbeans-stamp-80-74-73.png" alt="netbeans stamp 80 74 73">
</div>
<div class="title">Figure 1. O conteúdo desta página se aplica ao NetBeans IDE 7.2, 7.3, 7.4 e 8.0</div>
</div>
<div class="paragraph">
<p><strong>Para concluir este tutorial, você precisa dos seguintes recursos e softwares.</strong></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software ou Recurso</th>
<th class="tableblock halign-left valign-top">Versão Necessária</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">NetBeans IDE, pacote Java EE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.3, 7.4, 8.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK (Java Development Kit)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 ou 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://glassfish.java.net/">GlassFish Server</a>
<em>ou</em>
<a href="http://tomcat.apache.org/index.html">servidor Tomcat</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Source Edition 3.1.x ou 4.x
_ _
versão 7.x ou 8.x</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Observações:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>A instalação do Java EE do IDE permite instalar o servidor GlassFish e o contêiner de servlets do Apache Tomcat.</p>
</li>
<li>
<p>Este tutorial presume que você tenha conhecimento das várias tecnologias que ele utiliza (ou seja, HTML, CSS, JavaScript, Java e JSP). Ele tenta fornecer uma visão geral da funcionalidade fornecida pelo código, mas <em>não</em> explica como o código funciona linha por linha.</p>
</li>
<li>
<p>Se você precisar comparar seu projeto com uma solução que funciona, <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaScript%252FMyAjaxApp.zip">faça download da aplicação de amostra</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview">Visão Geral da Aplicação</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Imagine uma página web em que um usuário pode procurar informações sobre compositores de música. A página inclui um campo onde o usuário pode digitar o nome do compositor. Na aplicação de exemplo, o campo de entrada possui uma funcionlidade autocompletar. Em outras palavras, o usuário pode digitar parte do nome do compositor e a aplicação web tentará completar o nome, listando todos os compositores cujo nome ou sobrenome começa com os caracteres digitados. A funcionalidade autocompletar poupa o usuário de ter que lembrar o nome completo do compositor e pode fornecer um caminho mais intuitivo e direto para a informação procurada.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/sample-app.png" alt="sample app">
</div>
<div class="title">Figure 2. Aplicação de amostra exibida no browser</div>
</div>
<div class="paragraph">
<p>Implementar a funcionalidade autocompletar em um campo de pesquisa é algo que pode ser feito por meio do Ajax. O Ajax funciona com o emprego de um objeto <code>XMLHttpRequest</code> para passar solicitações e respostas assincronamente entre o cliente e o servidor. O diagrama a seguir ilustra o fluxo do processo da comunicação que acontece entre o cliente e o servidor.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ajax-process-flow.png" alt="ajax process flow">
</div>
<div class="title">Figure 3. Diagrama de fluxo de processo do Ajax</div>
</div>
<div class="paragraph">
<p>O fluxo de processo do diagrama pode ser descrito pelas seguintes etapas:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>O usuário aciona um evento, por exemplo, liberando uma tecla ao digitar um nome. Isso resulta em uma chamada do JavaScript para uma função que inicializa um objeto <code>XMLHttpRequest</code>.</p>
</li>
<li>
<p>O objeto <code>XMLHttpRequest</code> é configurado com um parâmetro de solicitação que inclui o ID do componente que acionou o evento e qualquer valor que o usuário digitou. O objeto <code>XMLHttpRequest</code> faz uma solicitação assíncrona ao servidor web.</p>
</li>
<li>
<p>No servidor web, um objeto como um servlet ou um listener trata a solicitação. Os dados são recuperados do armazenamento de dados, e é preparada uma resposta contendo os dados do form em um documento XML.</p>
</li>
<li>
<p>Finalmente, o objeto <code>XMLHttpRequest</code> recebe os dados XML utilizando uma função de chamada de retorno, processa-os e atualiza o HTML DOM (Document Object Model) para exibir a página que contém os novos dados.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Este tutorial demonstra como construir o cenário da funcionalidade autocompletar, seguindo o fluxo do processo indicado no diagrama acima. Primeiro você cria os arquivos do lado do cliente para a apresentação e a funcionalidade necessárias para gerar o objeto <code>XMLHttpRequest</code>. Em seguida, você configura o lado do servidor, criando o armazenamento de dados e a lógica de negócio utilizando tecnologia baseada em Java. Finalmente, você retorna ao lado do cliente e implementa <code>callback()</code>, e outra funcionalidade JavaScript para atualizar o HTML DOM.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="client1">Programando o Lado do Cliente: Parte 1</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Comece criando um novo projeto de aplicação Web no IDE. O IDE contém modelos incorporados para vários tipos de projeto.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Escolha Arquivo &gt; Novo Projeto. Em Categorias, selecione Java Web. Em Projetos, selecione Aplicação Web e clique em Próximo.</p>
</li>
<li>
<p>No painel Nome e Localização, digite <code>MyAjaxApp</code> como o Nome do Projeto. O campo Localização do Projeto permite que você especifique a localização do projeto em seu computador. Deixe as outras opções como default e clique em Próximo.
image::images/java-name-location.png[title="Especifique o nome e a localização do seu projeto de aplicação"]</p>
</li>
<li>
<p>No painel Servidor e Definições, selecione o servidor em que deseja implantar a aplicação. Somente os servidores registrados no IDE estão listados.
image::images/java-server-settings.png[title="Especifique o servidor no qual sua aplicação será implantada"]</p>
</li>
<li>
<p>Aceite as outras definições default e clique em Finalizar. O projeto será gerado no sistema de arquivos e aberto no IDE.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando os projetos baseados em Java são criados, é gerado automaticamente um script de construção <a href="http://ant.apache.org/">Ant</a> que lhe permite compilar o projeto de forma que ele possa ser implantado imediatamente e executado em um servidor que tenha sido registrado no IDE.</p>
</div>
<div class="paragraph">
<p>Uma página de entrada default será gerada e aberta no Editor de Código-fonte do IDE. Dependendo do servidor de destino, a página de entrada será <code>index.jsp</code> ou <code>index.html</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/java-proj-win.png" alt="java proj win">
</div>
<div class="title">Figure 4. A janela Projetos exibe o projeto MyAjaxApp</div>
</div>
<div class="paragraph">
<p>Antes de começar a codificar, tente rapidamente executar a aplicação para garantir que a configuração entre o IDE, seu servidor e o browser esteja configurada corretamente.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na janela Projetos, clique com o botão direito do mouse no nó do projeto e selecione Executar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A aplicação é compilada, o servidor de aplicações é iniciado e a aplicação é implantada nele e executada. O IDE abre seu browser default e exibe a página de entrada default.</p>
</div>
<div class="sect2">
<h3 id="_usando_o_editor_html">Usando o Editor HTML</h3>
<div class="imageblock">
<div class="content">
<img src="images/palette.png" alt="palette">
</div>
<div class="title">Figure 5. Paleta que exibe elementos HTML</div>
</div>
<div class="paragraph">
<p>Agora que você tem certeza de que seu ambiente está configurado corretamente, comece transformando sua página de índice na interface de autocompletar que será vista pelos usuários.</p>
</div>
<div class="paragraph">
<p>Uma das vantagens do uso de um IDE é que o editor em que você trabalha normalmente fornece a funcionalidade autocompletar código, o que, se você aprender a aplicar quando codifica, pode aumentar, rapidamente, a sua produtividade. O Editor de Código-fonte do IDE geralmente se adapta à tecnologia que está sendo utilizada, portanto, se você estiver trabalhando em uma página HTML, pressionar a combinação de teclas de autocompletar código (Ctrl-Espaço) produzirá sugestões para tags e atributos HTML. Como será mostrado mais tarde, o mesmo se aplica a outras tecnologias, como CSS e JavaScript.</p>
</div>
<div class="paragraph">
<p>Uma segunda funcionalidade que pode ser utilizada é a Paleta do IDE. A Paleta fornece modelos fáceis de utilizar para elementos que são comumente aplicados na tecnologia em que você está codificando. Você simplesmente clica em um item e arrasta-o para um local no arquivo aberto no Editor de Código-Fonte.</p>
</div>
<div class="paragraph">
<p>Você pode exibir ícones grandes (como exibido aqui) clicando com o botão direito do mouse na Paleta e selecionando Mostrar Ícones Grandes.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Substitua o conteúdo das tags <code>&lt;title&gt;</code> e <code>&lt;h1&gt;</code> para que leia: <code>Auto-Completion using AJAX</code>. A página de índice não requer nenhuma codificação de script do lado do servidor, portanto, você pode deletar com segurança quaisquer remanescentes criados por default. A página de índice agora deve ter a seguinte aparência.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;!DOCTYPE html&gt;

&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
        &lt;title&gt;Auto-Completion using AJAX&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Auto-Completion using AJAX&lt;/h1&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione algum texto explicativo para descrever a finalidade do campo de texto. Você pode copiar e colar no texto a seguir, no ponto logo abaixo das tags <code>&lt;h1&gt;</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">&lt;p&gt;This example shows how you can do real time auto-completion using Asynchronous
    JavaScript and XML (Ajax) interactions.&lt;/p&gt;

&lt;p&gt;In the form below enter a name. Possible names that will be completed are displayed
    below the form. For example, try typing in "Bach," "Mozart," or "Stravinsky,"
    then click on one of the selections to see composer details.&lt;/p&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione um form HTML à página. Faça isso utilizando os elementos listados na Paleta do IDE. Se a Paleta não estiver aberta, selecione Janela &gt; Paleta no menu principal. Em seguida, em Forms HTML, clique e arraste um elemento Form para a página, um ponto abaixo das tags <code>&lt;p&gt;</code> que você acabou de adicionar. A caixa de diálogo Inserir Form será aberta. Especifique o seguinte:</p>
<div class="ulist">
<ul>
<li>
<p>Ação: autocompletar código</p>
</li>
<li>
<p>Método: GET</p>
</li>
<li>
<p>Nome: autofillform
image::images/insert-form.png[title="Caixa de diálogo Inserir form"]</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Clique em OK. As tags HTML <code>&lt;form&gt;</code> serão inseridas na página que contém os atributos especificados. (GET é aplicado por default e, portanto, não é declarado explicitamente.)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione uma tabela HTML à página. Na categoria HTML na Paleta, clique em um elemento Tabela e arraste-o para um ponto entre as tags <code>&lt;form&gt;</code>. A caixa de diálogo Inserir Tabela será aberta. Especifique o seguinte:</p>
<div class="ulist">
<ul>
<li>
<p>Linhas: 2</p>
</li>
<li>
<p>Colunas: 2</p>
</li>
<li>
<p>Tamanho da Borda: 0</p>
</li>
<li>
<p>Preenchimento de Células: 5
image::images/insert-table.png[title="Caixa de diálogo Inserir tabela"]</p>
</li>
</ul>
</div>
</li>
<li>
<p>Clique com o botão direito do mouse no Editor de Código-Fonte e selecione Formatar. Isso limpa o código. Seu form agora deve ser semelhante ao abaixo:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;form name="autofillform" action="autocomplete"&gt;
  &lt;table border="0" cellpadding="5"&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;&lt;/th&gt;
        &lt;th&gt;&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;/td&gt;
        &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;/td&gt;
        &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;
&lt;/form&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na primeira linha da tabela, digite o seguinte texto na primeira coluna (alterações em <strong>negrito</strong>):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;td&gt;*&lt;strong&gt;Composer Name:&lt;/strong&gt;*&lt;/td&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na segunda coluna da primeira linha, em vez de arrastar um campo Entrada de Texto da Paleta, digite o código abaixo manualmente (alterações em <strong>negrito</strong>):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;td&gt;
    *&lt;input type="text"
        size="40"
        id="complete-field"
        onkeyup="doCompletion();"&gt;*
&lt;/td&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Enquanto digita, tente utilizar o suporte à funcionalidade autocompletar código incorporado do IDE. Por exemplo, digite <code>&lt;i</code> e, em seguida, pressione Ctrl-Espaço. Uma lista de opções sugeridas será exibida abaixo do seu cursor e uma descrição do elemento selecionado aparecerá em uma caixa acima. De fato, você pode pressionar Ctrl-Espaço a qualquer momento em que estiver codificando no Editor de Código-Fonte para ter acesso às opções possíveis. Além disso, caso só haja uma opção possível, pressionar Ctrl-Espaço completará automaticamente o nome do elemento.
image::images/code-completion.png[title="Pressione Ctrl-Espaço no editor para chamar o suporte a autocompletar código e à documentação"]</p>
</div>
<div class="paragraph">
<p>O atributo <code>onkeyup</code> que você digitou acima aponta para uma função JavaScript chamada <code>doCompletion()</code>. Essa função é chamada toda vez que uma tecla é pressionada no campo de texto do form, e mapeia para a chamada JavaScript representada no <a href="#flow-diagram">fluxograma</a> do Ajax acima.</p>
</div>
</div>
<div class="sect2">
<h3 id="javascript">Utilizando o Editor JavaScript</h3>
<div class="paragraph">
<p>O novo Editor JavaScript do IDE fornece muitos recursos de edição avançados, como autocompletar código inteligente, realce de semântica, renomeação instantânea e recursos de refatoração, assim como muitas outras funcionalidades.</p>
</div>
<div class="paragraph">
<p>A funcionalidade autocompletar código JavaScript é automaticamente fornecida quando você codifica em arquivos <code>.js</code>, assim como em tags <code>&lt;script&gt;</code> quando trabalha com outras tecnologias (ou seja, HTML, RHTML, JSP, PHP). O IDE por fornecer algumas dicas quando você editar o código JavaScript. É possível especificar as opções de JavaScript escolhendo Ferramentas &gt; Opções (NetBeans &gt; Preferências, no Mac) para abrir a janela Opções e selecionar a linguagem JavaScript na guia Dicas, categoria Editor. Você também pode adicionar seus próprios modelos de código JavaScript na guia Modelos de Código, janela Opções.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/javascript-options.png" alt="javascript options">
</div>
<div class="title">Figure 6. Opções de Dicas de JavaScript na janela Opções</div>
</div>
<div class="paragraph">
<p>Adicione um arquivo JavaScript à aplicação e comece a implementar <code>doCompletion()</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na janela Projetos, clique com o botão direito do mouse no nó Páginas Web e escolha Novo &gt; arquivo JavaScript. (Se o arquivo JavaScript não estiver listado, selecione Outro. Em seguida, escolha o arquivo JavaScript na categoria Web no assistente Novo arquivo.)</p>
</li>
<li>
<p>Nomeie o arquivo como <code>javascript</code> e clique em Finalizar. O novo arquivo JavaScript aparecerá na janela Projetos, na pasta Páginas da Web.</p>
</li>
<li>
<p>Digite o código abaixo em <code>javascript.js</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">var req;
var isIE;

function init() {
    completeField = document.getElementById("complete-field");
}

function doCompletion() {
        var url = "autocomplete?action=complete&amp;amp;id=" + escape(completeField.value);
        req = initRequest();
        req.open("GET", url, true);
        req.onreadystatechange = callback;
        req.send(null);
}

function initRequest() {
    if (window.XMLHttpRequest) {
        if (navigator.userAgent.indexOf('MSIE') != -1) {
            isIE = true;
        }
        return new XMLHttpRequest();
    } else if (window.ActiveXObject) {
        isIE = true;
        return new ActiveXObject("Microsoft.XMLHTTP");
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>O código acima executa um verificação simples de compatibilidade do browser para o Firefox 3 e para o Internet Explorer versões 6 e 7). Se desejar incorporar um código mais robusto para problemas de compatibilidade, considere usar este <a href="http://www.quirksmode.org/js/detect.html">script de detecção de browser</a> disponível em <a href="http://www.quirksmode.org">http://www.quirksmode.org</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Volte para a página do índice e adicione uma referência ao arquivo JavaScript entre as tags <code>&lt;head&gt;</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;script type="text/javascript" src="javascript.js"&gt;&lt;/script&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Você pode alternar rapidamente entre as páginas abertas no Editor de Código-fonte, pressionando Ctrl-Tab.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Insira uma chamada a <code>init()</code> na tag de abertura <code>&lt;body&gt;</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">&lt;body *onload="init()"*&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Isso garante que <code>init()</code> seja chamada toda vez que a página for carregada.</p>
</div>
<div class="paragraph">
<p>A atribuição de <code>doCompletion()</code> é:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>criar um URL que contenha dados que possam ser utilizados pelo lado do servidor,</p>
</li>
<li>
<p>inicializar um objeto <code>XMLHttpRequest</code>, e</p>
</li>
<li>
<p>solicitar que o objeto <code>XMLHttpRequest</code> envie uma solicitação assíncrona para o servidor.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>O objeto <code>XMLHttpRequest</code> é o núcleo do Ajax e se tornou o padrão de fato para permitir que dados XML sejam passados assincronamente por HTTP. A interação <em>Assíncrona</em> implica que o browser pode continuar a processar eventos na página depois que a requisição tiver sido enviada. Os dados são passados em segundo plano, e podem ser carregados automaticamente na página sem exigir uma atualização da página.</p>
</div>
<div class="paragraph">
<p>Observe que o objeto <code>XMLHttpRequest</code> é realmente criado por <code>initRequest()</code>, que é chamada por <code>doCompletion()</code>. A função verifica se <code>XMLHttpRequest</code> pode ser entendido pelo browser e, se for o caso, cria um objeto <code>XMLHttpRequest</code>. Caso contrário, ela executa uma verificação em <code>ActiveXObject</code> (o <code>XMLHttpRequest</code> equivalente do Internet Explorer 6) e cria um <code>ActiveXObject</code>, se identificado.</p>
</div>
<div class="paragraph">
<p>Três parâmetros são especificados quando você cria um objeto <code>XMLHttpRequest</code>: um URL, o método HTTP (<code>GET</code> ou <code>POST</code>), e se a interação é assíncrona ou não. No exemplo acima, os parâmetros são:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>O URL <code>autocomplete</code>, e o texto digitado no <code>complete-field</code> pelo usuário:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">var url = "autocomplete?action=complete&amp;amp;id=" + escape(completeField.value);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>GET</code>, significando que as interações HTTP usam o método <code>GET</code>, e</p>
</li>
<li>
<p><code>true</code>, significando que a interação é assíncrona:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">req.open("GET", url, true);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se a interação for definida como assíncrona, uma função de chamada de retorno deve ser especificada. A função de chamada de retorno dessa interação é definida com a instrução:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">req.onreadystatechange = callback;</code></pre>
</div>
</div>
<div class="paragraph">
<p>e uma função <code>callback()</code> <a href="#callback">deve ser definida mais tarde</a>. A interação HTTP começa quando <code>XMLHttpRequest.send()</code> é chamada. Essa ação mapeia para a solicitação HTTP que é enviada para o servidor web no <a href="#flow-diagram">fluxograma</a> acima.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="serverside">Programando o Lado do Servidor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>O IDE oferece suporte abrangente para programação Web do lado do servidor. Embora isso inclua o suporte a editor básico para muitas linguagens de programação e de script populares, também inclui Web services, tais como SOAP, REST, SaaS e frameworks orientados a MVC, como JSF, Spring e Struts. Diversos plug-ins do NetBeans estão disponíveis no <a href="http://plugins.netbeans.org/">Portal de Plug-In do NetBeans</a> para frameworks orientados para Ajax, como <a href="https://developers.google.com/web-toolkit/">GWT</a> e <a href="http://struts.apache.org/2.x/">Struts2</a>.</p>
</div>
<div class="paragraph">
<p>A lógica de negócios da aplicação processa as solicitações, recuperando dados do armazenamento de dados e, em seguida, preparando e enviando a resposta. Isso é implementado aqui por meio de um servlet. Antes de começar a codificar o servlet, configure o armazenamento de dados e a funcionalidade necessários pelo servlet para acessar os dados.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#data">Criando o Armazenamento de Dados</a></p>
</li>
<li>
<p><a href="#servlet">Criando um Servlet</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_criando_o_armazenamento_de_dados">Criando o Armazenamento de Dados</h3>
<div class="paragraph">
<p>Para essa aplicação simples, você cria uma classe nomeada <code>ComposerData</code> que mantém os dados do composer utilizando um <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/util/HashMap.html">`HashMap`</a>. Um <code>HashMap</code> permite armazenar pares de itens vinculados em pares chave-valor. Você também pode criar uma classe <code>Composer</code> que permita ao servlet recuperar dados de entradas no <code>HashMap</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no nó do projeto na janela Projetos e selecione Novo &gt; Classe Java.</p>
</li>
<li>
<p>Nomeie a classe <code>ComposerData</code> e digite <code>com.ajax</code> no campo Pacote. Isso cria um novo pacote que contém a classe, assim como outras classes que serão criadas mais tarde.</p>
</li>
<li>
<p>Clique em Finalizar. A classe será criada e aberta no Editor de Código-fonte.</p>
</li>
<li>
<p>No Editor de Código-fonte, cole o seguinte código:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package com.ajax;

import java.util.HashMap;

/**
 *
 * @author nbuser
 */
public class ComposerData {

    private HashMap composers = new HashMap();

    public HashMap getComposers() {
        return composers;
    }

    public ComposerData() {

        composers.put("1", new Composer("1", "Johann Sebastian", "Bach", "Baroque"));
        composers.put("2", new Composer("2", "Arcangelo", "Corelli", "Baroque"));
        composers.put("3", new Composer("3", "George Frideric", "Handel", "Baroque"));
        composers.put("4", new Composer("4", "Henry", "Purcell", "Baroque"));
        composers.put("5", new Composer("5", "Jean-Philippe", "Rameau", "Baroque"));
        composers.put("6", new Composer("6", "Domenico", "Scarlatti", "Baroque"));
        composers.put("7", new Composer("7", "Antonio", "Vivaldi", "Baroque"));

        composers.put("8", new Composer("8", "Ludwig van", "Beethoven", "Classical"));
        composers.put("9", new Composer("9", "Johannes", "Brahms", "Classical"));
        composers.put("10", new Composer("10", "Francesco", "Cavalli", "Classical"));
        composers.put("11", new Composer("11", "Fryderyk Franciszek", "Chopin", "Classical"));
        composers.put("12", new Composer("12", "Antonin", "Dvorak", "Classical"));
        composers.put("13", new Composer("13", "Franz Joseph", "Haydn", "Classical"));
        composers.put("14", new Composer("14", "Gustav", "Mahler", "Classical"));
        composers.put("15", new Composer("15", "Wolfgang Amadeus", "Mozart", "Classical"));
        composers.put("16", new Composer("16", "Johann", "Pachelbel", "Classical"));
        composers.put("17", new Composer("17", "Gioachino", "Rossini", "Classical"));
        composers.put("18", new Composer("18", "Dmitry", "Shostakovich", "Classical"));
        composers.put("19", new Composer("19", "Richard", "Wagner", "Classical"));

        composers.put("20", new Composer("20", "Louis-Hector", "Berlioz", "Romantic"));
        composers.put("21", new Composer("21", "Georges", "Bizet", "Romantic"));
        composers.put("22", new Composer("22", "Cesar", "Cui", "Romantic"));
        composers.put("23", new Composer("23", "Claude", "Debussy", "Romantic"));
        composers.put("24", new Composer("24", "Edward", "Elgar", "Romantic"));
        composers.put("25", new Composer("25", "Gabriel", "Faure", "Romantic"));
        composers.put("26", new Composer("26", "Cesar", "Franck", "Romantic"));
        composers.put("27", new Composer("27", "Edvard", "Grieg", "Romantic"));
        composers.put("28", new Composer("28", "Nikolay", "Rimsky-Korsakov", "Romantic"));
        composers.put("29", new Composer("29", "Franz Joseph", "Liszt", "Romantic"));

        composers.put("30", new Composer("30", "Felix", "Mendelssohn", "Romantic"));
        composers.put("31", new Composer("31", "Giacomo", "Puccini", "Romantic"));
        composers.put("32", new Composer("32", "Sergei", "Rachmaninoff", "Romantic"));
        composers.put("33", new Composer("33", "Camille", "Saint-Saens", "Romantic"));
        composers.put("34", new Composer("34", "Franz", "Schubert", "Romantic"));
        composers.put("35", new Composer("35", "Robert", "Schumann", "Romantic"));
        composers.put("36", new Composer("36", "Jean", "Sibelius", "Romantic"));
        composers.put("37", new Composer("37", "Bedrich", "Smetana", "Romantic"));
        composers.put("38", new Composer("38", "Richard", "Strauss", "Romantic"));
        composers.put("39", new Composer("39", "Pyotr Il'yich", "Tchaikovsky", "Romantic"));
        composers.put("40", new Composer("40", "Guiseppe", "Verdi", "Romantic"));

        composers.put("41", new Composer("41", "Bela", "Bartok", "Post-Romantic"));
        composers.put("42", new Composer("42", "Leonard", "Bernstein", "Post-Romantic"));
        composers.put("43", new Composer("43", "Benjamin", "Britten", "Post-Romantic"));
        composers.put("44", new Composer("44", "John", "Cage", "Post-Romantic"));
        composers.put("45", new Composer("45", "Aaron", "Copland", "Post-Romantic"));
        composers.put("46", new Composer("46", "George", "Gershwin", "Post-Romantic"));
        composers.put("47", new Composer("47", "Sergey", "Prokofiev", "Post-Romantic"));
        composers.put("48", new Composer("48", "Maurice", "Ravel", "Post-Romantic"));
        composers.put("49", new Composer("49", "Igor", "Stravinsky", "Post-Romantic"));
        composers.put("50", new Composer("50", "Carl", "Orff", "Post-Romantic"));

    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Você observará que uma advertência será exibida na margem esquerda do editor porque a classe  <code>Composer</code>  não pode ser encontrada. Execute as etapas a seguir para criar a classe <code>Composer</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no nó do projeto na janela Projetos e selecione Novo &gt; Classe Java.</p>
</li>
<li>
<p>Nomeie a classe <code>Composer</code> e selecione <code>com.ajax</code> na lista drop-down no campo Pacote. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Quando você clica em Finalizar, o IDE cria a classe e abre o arquivo no Editor de Código-fonte.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>No Editor de Código-fonte, cole o seguinte código:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package com.ajax;

public class Composer {

    private String id;
    private String firstName;
    private String lastName;
    private String category;

    public Composer (String id, String firstName, String lastName, String category) {
        this.id = id;
        this.firstName = firstName;
        this.lastName = lastName;
        this.category = category;
    }

    public String getCategory() {
        return category;
    }

    public String getId() {
        return id;
    }

    public String getFirstName() {
        return firstName;
    }

    public String getLastName() {
        return lastName;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Depois que você cria a classe  <code>Composer</code> , se você observar a classe  <code>ComposerData</code>  no editor, poderá ver que as anotações de advertência não existem mais. Se ainda você vir as anotações de advertência no  <code>ComposerData</code>  você pode tentar resolver o erro adicionando as instruções de importação ausentes.</p>
</div>
</div>
<div class="sect2">
<h3 id="servlet">Criando um Servlet</h3>
<div class="paragraph">
<p>Crie um servlet para tratar o URL <code>autocomplete</code> que é recebido pela solicitação de entrada.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique com o botão direito do mouse no nó do projeto na janela Projetos e escolha Novo &gt; Servlet para abrir o assistente para Novo Servlet. (Escolha Outros e selecione Servlet na categoria da Web se Servlet não for exibido por default no menu pop-up).</p>
</li>
<li>
<p>Nomeie o servlet <code>AutoCompleteServlet</code> e selecione <code>com.ajax</code> na lista drop-down no campo Pacote. Clique em Próximo.
image::images/newservlet-name-location.png[]</p>
</li>
<li>
<p>No painel Configurar a Implantação do Servlet, altere o padrão do URL para <strong><code>/autocomplete</code></strong> para que ele corresponda ao URL que foi definido anteriormente no objeto <code>XMLHttpRequest</code>.
image::images/newservlet-configure-deployment.png[]</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Esse painel elimina a necessidade de adicionar manualmente esses detalhes no descritor de implantação.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>como opção, selecione "Adicionar informações do servlet ao descritor da implantação". Isso faz com que seu projeto seja o mesmo da amostra da qual fez download. Com versões posteriores do IDE, por default o servlet é registrado por uma anotação <code>@WebServlet</code>, em vez de um descritor da implantação. O projeto ainda funcionará se você usar a anotação <code>@WebServlet</code>, em vez de um descritor de implantação.</p>
</li>
<li>
<p>Clique em Finalizar. O servlet será criado e aberto no Editor de Código-fonte.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Os únicos métodos que você precisa substituir são <code>doGet()</code>, para definir como o servlet trataa solicitação <code>autocomplete</code> <code>GET</code>, e <code>init()</code>, que precisa iniciar um <code>ServletContext</code> de forma que o servlet possa acessar outras classes na aplicação, depois de ter sido posto em serviço.</p>
</div>
<div class="paragraph">
<p>Você pode substituir métodos de superclasses usando o menu pop-up Inserir Código do IDE. Implemente <code>init()</code> executando as etapas a seguir.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Coloque o seu cursor embaixo da declaração de classe <code>AutoCompleteServlet</code> no Editor de Código-fonte. Pressione Alt-Insert (Ctrl-I no Mac) para abrir o menu pop-up Gerar Código.
image::images/insert-code.png[title="Menu pop-up Inserir Código exibido no Editor de Código-fonte"]</p>
</li>
<li>
<p>Selecione Substituir Método. Na caixa de diálogo que é exibida, todas as classes que <code>AutoCompleteServlet</code> herda são exibidas. Expanda o nó GenericServlet e selecione <code>init(Servlet Config config)</code>.
image::images/new-override.png[title="A caixa de diálogo Substituir lista classes herdadas"]</p>
</li>
<li>
<p>Clique em OK. O método <code>init()</code> é adicionado no Editor de Código-fonte.</p>
</li>
<li>
<p>Adicione uma variável para um objeto <code>ServletContext</code> e modifique <code>init()</code> (alterações em <strong>negrito</strong>):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">*private ServletContext context;*

@Override
public void init(ServletConfig *config*) throws ServletException {
    *this.context = config.getServletContext();*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione uma instrução de importação para <code>ServletContext</code>. Você pode fazer isso clicando no ícone da lâmpada exibido na margem esquerda do Editor de Código-fonte
image::images/import-hint.png[title="Dicas de importação são exibidas na margem esquerda do Editor de Código-fonte"]</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>O método <code>doGet()</code> precisa fazer parsing do URL da solicitação, recuperar dados do armazenamento de dados e preparar uma resposta em formato XML. Note que a declaração do método foi gerada quando você criou a classe. Para exibi-la, pode ser necessário expandir métodos HttpServlet clicando no ícone de expansão (image::images/expand-icon.png[]) na margem esquerda.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione as declarações de variável a seguir embaixo da declaração da classe <code>AutocompleteServlet</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private ComposerData compData = new ComposerData();
private HashMap composers = compData.getComposers();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Isso cria um <code>HashMap</code> de todos os dados do composer, que é, em seguida, utilizado por <code>doGet()</code>.
2. Role para baixo para <code>doGet()</code> e implemente o método da seguinte forma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">@Override
public void doGet(HttpServletRequest request, HttpServletResponse response)
        throws IOException, ServletException {

    String action = request.getParameter("action");
    String targetId = request.getParameter("id");
    StringBuffer sb = new StringBuffer();

    if (targetId != null) {
        targetId = targetId.trim().toLowerCase();
    } else {
        context.getRequestDispatcher("/error.jsp").forward(request, response);
    }

    boolean namesAdded = false;
    if (action.equals("complete")) {

        // check if user sent empty string
        if (!targetId.equals("")) {

            Iterator it = composers.keySet().iterator();

            while (it.hasNext()) {
                String id = (String) it.next();
                Composer composer = (Composer) composers.get(id);

                if ( // targetId matches first name
                     composer.getFirstName().toLowerCase().startsWith(targetId) ||
                     // targetId matches last name
                     composer.getLastName().toLowerCase().startsWith(targetId) ||
                     // targetId matches full name
                     composer.getFirstName().toLowerCase().concat(" ")
                        .concat(composer.getLastName().toLowerCase()).startsWith(targetId)) {

                    sb.append("&lt;composer&gt;");
                    sb.append("&lt;id&gt;" + composer.getId() + "&lt;/id&gt;");
                    sb.append("&lt;firstName&gt;" + composer.getFirstName() + "&lt;/firstName&gt;");
                    sb.append("&lt;lastName&gt;" + composer.getLastName() + "&lt;/lastName&gt;");
                    sb.append("&lt;/composer&gt;");
                    namesAdded = true;
                }
            }
        }

        if (namesAdded) {
            response.setContentType("text/xml");
            response.setHeader("Cache-Control", "no-cache");
            response.getWriter().write("&lt;composers&gt;" + sb.toString() + "&lt;/composers&gt;");
        } else {
            //nothing to show
            response.setStatus(HttpServletResponse.SC_NO_CONTENT);
        }
    }
    if (action.equals("lookup")) {

        // put the target composer in the request scope to display
        if ((targetId != null) &amp;amp;&amp;amp; composers.containsKey(targetId.trim())) {
            request.setAttribute("composer", composers.get(targetId));
            context.getRequestDispatcher("/composer.jsp").forward(request, response);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Como pode ver neste servlet, não há nada exatamente novo que você precise aprender para escrever código do lado do servidor para processamento Ajax. O tipo de conteúdo da resposta precisa ser definido como <code>text/xml</code> para casos em que você deseje trocar documentos XML. Com o Ajax você também pode trocar texto simples ou até mesmo snippets de JavaScript, que podem ser avaliados ou executados pela função chamada de retorno no cliente. Observe também que alguns browsers podem armazenar no cache os resultados; portanto, talvez seja necessário definir o cabeçalho Cache-Control HTTP como <code>no-cache</code>.</p>
</div>
<div class="paragraph">
<p>Nesse exemplo, o servlet gera um documento XML que contém todos os composers com nome ou sobrenome começando com os caracteres digitados pelo usuário. Este documento mapeia para os dados XML ilustrados no <a href="#flow-diagram">fluxograma</a> acima. Aqui está um exemplo de um documento XML que é retornado para o objeto <code>XMLHttpRequest</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;composers&gt;
    &lt;composer&gt;
        &lt;id&gt;12&lt;/id&gt;
        &lt;firstName&gt;Antonin&lt;/firstName&gt;
        &lt;lastName&gt;Dvorak&lt;/lastName&gt;
    &lt;/composer&gt;
    &lt;composer&gt;
        &lt;id&gt;45&lt;/id&gt;
        &lt;firstName&gt;Aaron&lt;/firstName&gt;
        &lt;lastName&gt;Copland&lt;/lastName&gt;
    &lt;/composer&gt;
    &lt;composer&gt;
        &lt;id&gt;7&lt;/id&gt;
        &lt;firstName&gt;Antonio&lt;/firstName&gt;
        &lt;lastName&gt;Vivaldi&lt;/lastName&gt;
    &lt;/composer&gt;
    &lt;composer&gt;
        &lt;id&gt;2&lt;/id&gt;
        &lt;firstName&gt;Arcangelo&lt;/firstName&gt;
        &lt;lastName&gt;Corelli&lt;/lastName&gt;
    &lt;/composer&gt;
&lt;/composers&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Você pode utilizar o <a href="#httpMonitor">Monitor HTTP</a> do IDE para exibir os dados XML retornados ao concluir a aplicação.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="client2">Programando o Lado do Cliente: Parte 2</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Você deve definir a função de chamada de retorno para tratar a resposta do servidor, e adicionar qualquer funcionalidade necessária para refletir alterações na página exibida pelo usuário. Isso requer a modificação do HTML DOM. Você precisa criar páginas JSP para exibir os resultados de uma solicitação bem-sucedida ou as mensagens de erro de uma solicitação com falha. Em seguida, é possível criar uma folha de estilo simples para a apresentação.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#callback">Adicionando a Funcionalidade de Retorno de Chamada</a></p>
</li>
<li>
<p><a href="#htmldom">Atualizando o HTML DOM</a></p>
</li>
<li>
<p><a href="#displayresults">Exibindo os Resultados</a></p>
</li>
<li>
<p><a href="#stylesheet">Anexando uma Folha de Estilo</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_adicionando_a_funcionalidade_de_retorno_de_chamada">Adicionando a Funcionalidade de Retorno de Chamada</h3>
<div class="paragraph">
<p>A função de retorno de chamada é chamada assincronamente em pontos específicos durante a interação HTTP quando a propriedade <code>readyState</code> do objeto <code>XMLHttpRequest</code> é alterada. Na aplicação que está sendo construída, a função chamada de retorno é <code>callback()</code>. Você lembra que em <code>doCompletion()</code>, <code>callback</code> foi definido como a propriedade <code>XMLHttpRequest.onreadystatechange</code> para uma função. Agora, implemente a função de retorno de chamada da seguinte forma.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Abra <code>javascript.js</code> no Editor de Código-fonte e digite o código abaixo.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">function callback() {
    if (req.readyState == 4) {
        if (req.status == 200) {
            parseMessages(req.responseXML);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Um <code>readyState</code> de "4" significa a conclusão da interação HTTP. A API de <code>XMLHttpRequest.readState</code> indica que há 5 valores possíveis que podem ser definidos. São elas:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Valor <code>readyState</code></th>
<th class="tableblock halign-left valign-top">Definição do Status do Objeto</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">não inicializado</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">carregando</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">carregado</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">interativo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">completo</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Observe que a função <code>parseMessages()</code> somente é chamada quando o <code>XMLHttpRequest.readyState</code> é "4" e o <code>status</code> (a definição do código de status HTTP da solicitação) é "200", significando êxito. Você definirá <code>parseMessages()</code> em seguida em <a href="#htmldom">Atualizando o HTML DOM</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_atualizando_o_html_dom">Atualizando o HTML DOM</h3>
<div class="paragraph">
<p>A função <code>parseMessages()</code> trata os dados XML de entrada. Fazendo isso, ela conta com várias funções auxiliares, como <code>appendComposer()</code>, <code>getElementY()</code> e <code>clearTable()</code>. Você também deve introduzir novos elementos na página de índice, como uma segunda tabela HTML que serve como a caixa autocompletar, e os IDs dos elementos, para que eles possam ser referenciados em <code>javascript.js</code>. Finalmente, crie novas variáveis que correspondam aos IDs para os elementos na página do índice, inicialize-as na função <code>init()</code> implementada anteriormente e adicione alguma funcionalidade que seja necessária sempre que a página do índice for carregada.</p>
</div>
<div class="paragraph">
<p>*Observação: *As funções e elementos que você cria nas etapas seguintes funcionam de forma interdependente. Recomendamos que você percorra esta seção e, em seguida, examine o código quando tudo estiver no lugar.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Abra a página do índice no Editor de Código-fonte e digite o código abaixo para a segunda linha da tabela HTML que você criou anteriormente.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;tr&gt;
    *&lt;td id="auto-row" colspan="2"&gt;
        &lt;table id="complete-table" /&gt;
    &lt;/td&gt;*
&lt;/tr&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>A segunda linha da tabela contém outra tabela HTML. Essa tabela representa a caixa autocompletar que será utilizada para preencher os nomes do composer.
2. Abra <code>javascript.js</code> no Editor de Código-fonte e as três variáveis seguintes no início do arquivo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">var completeField;
var completeTable;
var autoRow;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione as seguintes linhas (em <strong>negrito</strong>) na função <code>init()</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">function init() {
    completeField = document.getElementById("complete-field");
    *completeTable = document.getElementById("complete-table");
    autoRow = document.getElementById("auto-row");
    completeTable.style.top = getElementY(autoRow) + "px";*
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Uma finalidade de <code>init()</code> é tornar os elementos que estão dentro da página de índice acessíveis para outras funções que modificarão o DOM da página de índice.
4. Adicione <code>appendComposer()</code> a <code>javascript.js</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">function appendComposer(firstName,lastName,composerId) {

    var row;
    var cell;
    var linkElement;

    if (isIE) {
        completeTable.style.display = 'block';
        row = completeTable.insertRow(completeTable.rows.length);
        cell = row.insertCell(0);
    } else {
        completeTable.style.display = 'table';
        row = document.createElement("tr");
        cell = document.createElement("td");
        row.appendChild(cell);
        completeTable.appendChild(row);
    }

    cell.className = "popupCell";

    linkElement = document.createElement("a");
    linkElement.className = "popupItem";
    linkElement.setAttribute("href", "autocomplete?action=lookup&amp;amp;id=" + composerId);
    linkElement.appendChild(document.createTextNode(firstName + " " + lastName));
    cell.appendChild(linkElement);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Essa função cria uma nova linha da tabela, insere um link em um criador utilizando os dados passados para a função por meio de seus três parâmetros e insere a linha no elemento <code>complete-table</code> da página de índice.
5. Adicione <code>getElementY()</code> a <code>javascript.js</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">function getElementY(element){

    var targetTop = 0;

    if (element.offsetParent) {
        while (element.offsetParent) {
            targetTop += element.offsetTop;
            element = element.offsetParent;
        }
    } else if (element.y) {
        targetTop += element.y;
    }
    return targetTop;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Essa função é aplicada para localizar a posição vertical do elemento pai. Isso é necessário porque a posição real do elemento, quando ele é exibido, frequentemente depende do tipo e da versão do browser. Note que o elemento <code>complete-table</code>, quando é exibido contendo nomes de criador, é deslocado para o lado direito inferior da tabela em que ele está. O posicionamento correto da altura é determinado por <code>getElementY()</code>.</p>
</div>
<div class="paragraph">
<p>*Observação: *Consulte <a href="http://www.quirksmode.org/js/findpos.html">esta explicação</a> de <code>offset</code> em <a href="http://www.quirksmode.org/">http://www.quirksmode.org/</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione <code>clearTable()</code> a <code>javascript.js</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">function clearTable() {
    if (completeTable.getElementsByTagName("tr").length &gt; 0) {
        completeTable.style.display = 'none';
        for (loop = completeTable.childNodes.length -1; loop &gt;= 0 ; loop--) {
            completeTable.removeChild(completeTable.childNodes[loop]);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Essa função define a exibição do elemento <code>complete-table</code> como "none" (ou seja, o torna invisível) e remove quaisquer entradas de nome de criador existentes que tenham sido criadas.
7. Modifique a função <code>callback()</code> para que chame <code>clearTable()</code> cada vez que novos dados forem recebidos do servidor. Quaisquer entradas do criador que já existam na caixa autocompletar serão, portanto, removidas, antes que esta seja preenchida com novas entradas.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">function callback() {

    *clearTable();*

    if (req.readyState == 4) {
        if (req.status == 200) {
            parseMessages(req.responseXML);
        }
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione <code>parseMessages()</code> a <code>javascript.js</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">function parseMessages(responseXML) {

    // no matches returned
    if (responseXML == null) {
        return false;
    } else {

        var composers = responseXML.getElementsByTagName("composers")[0];

        if (composers.childNodes.length &gt; 0) {
            completeTable.setAttribute("bordercolor", "black");
            completeTable.setAttribute("border", "1");

            for (loop = 0; loop &lt; composers.childNodes.length; loop++) {
                var composer = composers.childNodes[loop];
                var firstName = composer.getElementsByTagName("firstName")[0];
                var lastName = composer.getElementsByTagName("lastName")[0];
                var composerId = composer.getElementsByTagName("id")[0];
                appendComposer(firstName.childNodes[0].nodeValue,
                    lastName.childNodes[0].nodeValue,
                    composerId.childNodes[0].nodeValue);
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A função <code>parseMessages()</code> recebe como parâmetro uma representação de objeto do documento XML retornado pelo servlet <code>AutoComplete</code>. A função percorre programaticamente o documento XML, extraindo <code>firstName</code>, <code>lastName</code> e <code>id</code> de cada entrada e, em seguida, ela passa esses dados para <code>appendComposer()</code>. Isso resulta em uma atualização dinâmica do conteúdo do elemento <code>complete-table</code>. Por exemplo, uma entrada que é gerada e inserida em <code>complete-table</code> deve ter a seguinte aparência:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;tr&gt;
    &lt;td class="popupCell"&gt;
        &lt;a class="popupItem" href="autocomplete?action=lookup&amp;amp;id=12"&gt;Antonin Dvorak&lt;/a&gt;
    &lt;/td&gt;
&lt;/tr&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>A atualização dinâmica do elemento <code>complete-table</code> representa a etapa final do fluxo do processo de comunicação que acontece durante a comunicação por meio do Ajax. Essa atualização mapeia para os dados HTML e CSS sendo enviados para a apresentação no <a href="#flow-diagram">fluxograma</a> acima.</p>
</div>
</div>
<div class="sect2">
<h3 id="displayresults">Exibindo os Resultados</h3>
<div class="paragraph">
<p>Para exibir os resultados, você precisa de um arquivo JSP chamado <code>composers.jsp</code>. Esta página é chamada a partir do <code>AutoCompleteServlet</code> durante uma ação de busca. Você também precisa de um arquivo <code>error.jsp</code>, que é chamado a partir do <code>AutoCompleteServlet</code> se o composer não puder ser encontrado.</p>
</div>
<div class="paragraph">
<p><strong>Para exibir resultados e erros:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na janela Projetos, clique com o botão direito do mouse na pasta Páginas Web e selecione Novo &gt; JSP. O assistente Novo JSP será aberto.</p>
</li>
<li>
<p>No campo Nome do Arquivo, digite <code>composer</code>. No campo Arquivo Criado, você verá um caminho que termina em <code>/web/composer.jsp</code>.</p>
</li>
<li>
<p>Clique em Finalizar. O arquivo <code>composer.jsp</code> será aberto no editor. Aparecerá um nó para o arquivo na janela Projetos na pasta Páginas Web.</p>
</li>
<li>
<p>Substitua o código do placeholder no <code>composer.jsp</code> pelo seguinte código:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Composer Information&lt;/title&gt;

    &lt;link rel="stylesheet" type="text/css" href="stylesheet.css"&gt;
  &lt;/head&gt;
  &lt;body&gt;

    &lt;table&gt;
      &lt;tr&gt;
        &lt;th colspan="2"&gt;Composer Information&lt;/th&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;First Name: &lt;/td&gt;
        &lt;td&gt;${requestScope.composer.firstName}&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Last Name: &lt;/td&gt;
        &lt;td&gt;${requestScope.composer.lastName}&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;ID: &lt;/td&gt;
        &lt;td&gt;${requestScope.composer.id}&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Category: &lt;/td&gt;
        &lt;td&gt;${requestScope.composer.category}&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;

    &lt;p&gt;Go back to &lt;a href="index.html" class="link"&gt;application home&lt;/a&gt;.&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Observação.</strong> Você precisará alterar o link para voltar à página de índice, se sua página de índice for  <code>index.jsp</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Crie outro arquivo JSP na pasta Páginas Web do projeto. Nomeie o arquivo de <code>error.jsp</code>.</p>
</li>
<li>
<p>Substitua o código do placeholder no <code>error.jsp</code> pelo seguinte código:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;

&lt;html&gt;
    &lt;head&gt;
        &lt;link rel="stylesheet" type="text/css" href="stylesheet.css"&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
        &lt;title&gt;Seach Error&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h2&gt;Seach Error&lt;/h2&gt;

        &lt;p&gt;An error occurred while performing the search. Please try again.&lt;/p&gt;

        &lt;p&gt;Go back to &lt;a href="index.html" class="link"&gt;application home&lt;/a&gt;.&lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Observação.</strong> Você precisará alterar o link para voltar à página de índice, se sua página de índice for  <code>index.jsp</code> .</p>
</div>
</div>
<div class="sect2">
<h3 id="stylesheet">Anexando uma Folha de Estilo</h3>
<div class="paragraph">
<p>Nesse estágio, você concluiu todo o código necessário para a funcionalidade da aplicação. Para ver os resultados dos seus esforços, tente executar a aplicação agora.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na janela Projetos, clique com o botão direito do mouse no nó do projeto e selecione Executar. O projeto será recompilado e implantado no servidor de destino. Seu browser será aberto e você poderá ver a página de índice.
image::images/no-css.png[title="Implantação com sucesso sem folha de estilo"]</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Para adicionar uma folha de estilo à sua aplicação, basta criar um arquivo <code>.css</code> e vinculá-lo a partir da(s) página(s) da sua apresentação. Quando você trabalha em arquivos <code>.css</code>, o IDE oferece o suporte para autocompletar código. assim como as seguintes janelas, para ajudá-lo a gerar e editar regras de folhas de estilo:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Janela Estilos de CSS.</strong> A janela Estilos de CSS permite editar as declarações de regras de elementos e seletores HTML em um arquivo CSS.</p>
</li>
<li>
<p><strong>Caixa de diálogo Criar Regras CSS.</strong> A caixa de diálogo Criar Regras de CSS permite criar novas regras em uma folha de estilos de CSS.</p>
</li>
<li>
<p>*Caixa de diálogo Adicionar Propriedade de CSS.*A caixa de diálogo Adicionar Propriedade de CSS permite adicionar declarações a uma regra de CSS em uma folha de estilos, adicionando propriedades e valores.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Para adicionar uma folha de estilo à sua aplicação execute as etapas a seguir.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na janela Projetos, clique com o botão direito do mouse no nó Páginas Web e selecione Novo &gt; Folha de Estilo em Cascata (caso Folha de Estilo em Cascata não esteja listado, selecione Outro. Em seguida, escolha Folha de Estilo em Cascata na categoria Web no assistente Novo arquivo.)</p>
</li>
<li>
<p>No campo de texto Nome do Arquivo CSS, digite <strong><code>stylesheet</code></strong>. Clique em Finalizar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>O movo arquivo será criado e aberto no editor.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Digite as seguintes regras em <code>stylesheet.css</code>, no editor. Você pode utilizar o suporte à funcionalidade autocompletar código do IDE pressionando Ctrl-Espaço nos pontos em que desejar acionar sugestões.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">body {
   font-family: Verdana, Arial, sans-serif;
   font-size: smaller;
   padding: 50px;
   color: #555;
   width: 650px;
}

h1 {
   letter-spacing: 6px;
   font-size: 1.6em;
   color: #be7429;
   font-weight: bold;
}

h2 {
   text-align: left;
   letter-spacing: 6px;
   font-size: 1.4em;
   color: #be7429;
   font-weight: normal;
   width: 450px;
}

table {
   width: 550px;
   padding: 10px;
   background-color: #c5e7e0;
}

td {
   padding: 10px;
}

a {
  color: #be7429;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

.popupBox {
  position: absolute;
  top: 170px;
  left: 140px;
}

.popupCell {
   background-color: #fffafa;
}

.popupCell:hover {
  background-color: #f5ebe9;
}

.popupItem {
  color: #333;
  text-decoration: none;
  font-size: 1.2em;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Abra a janela Estilos de CSS escolhendo Janela &gt; Web &gt; Estilos CSS.
image::images/css-styles-window.png[title="Janela Estilos de CSS exibindo as propriedades de regra h1"]</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Você pode usar a janela Estilos de CSS para exibir rapidamente as propriedades e editar as regras de estilo. Quando você seleciona uma regra no painel superior da janela Estilo de CSS, pode ver as propriedades da regra no painel inferior. Você pode adicionar uma Regra de CSS à folha de estilos clicando no ícone Editar Regras de CSS (image::images/newcssrule.png[title="Ícone Nova Propriedade de CSS"]) na barra de ferramentas do painel superior. Você pode modificar as regras no painel inferior, editando a folha de propriedades, e adicionar propriedades clicando no ícone Adicionar Propriedade (image::images/newcssproperty.png[title="Ícone Nova Propriedade de CSS"]) na barra de ferramentas do painel inferior.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Alterne para a página no Editor de Código-fonte, e adicione uma referência à folha de estilo entre as tags <code>&lt;head&gt;</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">&lt;link rel="stylesheet" type="text/css" href="stylesheet.css"&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adicione a classe <code>popupBox</code> que está definida na folha de estilo ao elemento <code>complete-table</code> (alterações em <strong>negrito</strong>).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;tr&gt;
    &lt;td id="auto-row" colspan="2"&gt;
        &lt;table id="complete-table" *class="popupBox"* /&gt;
    &lt;/td&gt;
&lt;/tr&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>É possível usar o recurso autocompletar código no editor para ajudá-lo a selecionar a regra de estilo que você quer aplicar ao seletor.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/css-completion.png" alt="css completion">
</div>
<div class="title">Figure 7. Recurso autocompletar código no editor</div>
</div>
<div class="paragraph">
<p>Como indicado em <code>stylesheet.css</code>, esta regra posiciona o elemento <code>complete-table</code> para que seja exibido um pouco à direita de seu elemento pai.</p>
</div>
<div class="paragraph">
<p>Quando você salva a página de índice, a aplicação é automaticamente reimplantada no servidor. Se a página ainda estiver aberta no browser, você poderá recarregá-la para ver se ela agora é renderizada de acordo com as regras da folha de estilos de CSS.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="run">Executando o Projeto</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quando você executar a aplicação novamente, ela será exibida no browser utilizando a folha de estilo que acabou de ser criada. Toda vez que você digita um caractere, uma solicitação assíncrona é enviada para o servidor e retornada com dados XML que foram preparados por <code>AutoCompleteServlet</code>. Conforme você digita mais caracteres, o número de nomes de criador diminui para refletir a nova lista de correspondências.</p>
</div>
<div class="sect2">
<h3 id="httpMonitor">Utilizando o Monitor do Servidor HTTP</h3>
<div class="paragraph">
<p>Você pode utilizar o monitor do Servidor HTTP do IDE para verificar a comunicação HTTP que acontece quando as solicitações e as respostas são passadas entre o cliente e o servidor. O Monitor do Servidor HTTP exibe informações como cabeçalhos do cliente e do servidor, propriedades da sessão, detalhes do cookie, assim como parâmetros de solicitação.</p>
</div>
<div class="paragraph">
<p>Antes de começar a utilizar o monitor HTTP, você deve primeiro ativá-lo no servidor que está utilizando.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Abra a janela Servidores, selecionando Ferramentas &gt; Servidores no menu principal.</p>
</li>
<li>
<p>No painel esquerdo, selecione o servidor que está usando com o projeto. Em seguida, no painel direito, selecione a opção Ativar Monitor HTTP.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Observação:</strong> essa opção é exibida na guia Comum do GlassFish Server. Para Tomcat, ela reside na guia Conexão.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clique em Fechar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Se o servidor já estiver em execução, você precisará reiniciá-lo para permitir que as alterações tenham efeito. Você pode reiniciar o servidor, abrindo a janela Serviços (Janela &gt; Serviços) e, em seguida, clicando com o botão direito do mouse no servidor embaixo do nó Servidores e selecionando Reiniciar.</p>
</div>
<div class="paragraph">
<p>Agora, quando você executar a aplicação novamente, o monitor HTTP será aberto na região inferior do IDE. Você pode selecionar um registro no painel esquerdo e, em seguida, clicar nas guias na janela principal para exibir as informações sobre cada solicitação que é feita.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/http-monitor.png" alt="http monitor">
</div>
<div class="title">Figure 8. O monitor do Servidor HTTP é exibido no IDE</div>
</div>
<div class="paragraph">
<p>Você pode verificar os dados XML que são enviados do servidor como resultado da solicitação assíncrona feita quando um usuário indica um caractere no campo autocompletar.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na view em árvore do lado esquerdo do monitor HTTP, clique com o botão direito do mouse no registro de uma solicitação e selecione Reexecutar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A resposta será gerada em seu browser. Nesse caso, como a resposta consiste em dados XML, o browser exibirá os dados em seu visualizador XML nativo.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/xml-data.png" alt="xml data">
</div>
<div class="title">Figure 9. O monitor do Servidor HTTP é exibido no IDE</div>
</div>
</div>
<div class="sect2">
<h3 id="conclusion">Conclusão</h3>
<div class="paragraph">
<p>Isso conclui a Introdução ao Ajax. Esperamos que agora você saiba que o Ajax está simplesmente trocando informações por HTTP em segundo plano, e atualizando essa página dinamicamente, com base nos resultados.</p>
</div>
<div class="paragraph">
<p>Você talvez note que a aplicação que construiu tem vários problemas, como, por exemplo, nada acontece quando o nome de um criador é selecionado na caixa autocompletar! Você é bem-vindo a <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaScript%252FMyAjaxApp.zip">fazer download do projeto de solução</a> para ver como isso pode ser implementado utilizando tecnologia JSP. Além disso, talvez queira investigar a validação do lado do servidor que impede que um usuário solicite um nome que não existe no armazenamento de dados. Você pode aprender mais sobre essas técnicas e tecnologias, seguindo outros tutoriais na <a href="../../trails/java-ee.html">Trilha de Aprendizado do Java Web e do Java EE</a>.</p>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Introduction%20to%20Ajax%20(Java)">Envie-nos Seu Feedback</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="seeAlso">Consulte Também</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para obter mais informações sobre a tecnologia Ajax e Java em <a href="https://netbeans.org/">netbeans.org</a>, consulte os seguintes recursos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../../docs/web/js-toolkits-jquery.html">Usando jQuery para Melhorar a Aparência e o Uso de uma Página Web</a>. Demonstra como integrar o núcleo jQuery e bibliotecas UI em um projeto NetBeans.</p>
</li>
<li>
<p><a href="../../docs/web/js-toolkits-dojo.html">Conectando um Dojo Tree a uma ArrayList utilizando JSON</a>. Com base em um JavaOne Hands-On Lab, esse documento mostra como implementar um widget Dojo Tree em uma página web e permitir que o servidor responda a solicitações Tree no formato JSON.</p>
</li>
<li>
<p><a href="http://www.oracle.com/pls/topic/lookup?ctx=nb8000&amp;id=NBDAG2272">Criando Arquivos JavaScript</a> em <em>Desenvolvendo Aplicações com o NetBeans IDE</em></p>
</li>
<li>
<p><a href="quickstart-webapps-wicket.html">Introdução ao Wicket Web Framework</a>. Uma introdução para criar componentes reutilizáveis e aplicá-los a uma aplicação Web utilizando o framework Wicket.</p>
</li>
</ul>
</div>
</div>
</div>
            
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/incubator-netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="JIRA" href="https://issues.apache.org/jira/projects/NETBEANS/summary"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/incubator-netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/ajax-quickstart_pt_BR.asciidoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

        </div>
        

<div class='grid-container incubator-area' style='margin-top: 64px'>
    <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/">
                <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
            </a>
        </div>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/events/current-event.html">
               <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
            </a>
        </div>
    </div>
</div>
<footer>
    <div class="grid-container">
        <div class="grid-x grid-padding-x">
            <div class="large-auto cell">
                
                <h1>About</h1>
                <ul>
                    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                    <li><a href="https://www.apache.org/security/">Security</a></li>
                    <li><a href="https://incubator.apache.org/projects/netbeans.html">Incubation Status</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/community/index.html">Community</a></h1>
                <ul>
                    <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
                    <li><a href="/community/committer.html">Becoming a committer</a></li>
                    <li><a href="/community/events.html">NetBeans Events</a></li>
                    <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
                    <li><a href="/community/who.html">Who is who</a></li>
                    <li><a href="/community/nekobean.html">NekoBean</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/participate/index.html">Participate</a></h1>
                <ul>
                    <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
                    <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
                    <li><a href="/participate/netcat.html">NetCAT - Community Acceptance Testing</a></li>
                    <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/help/index.html">Get Help</a></h1>
                <ul>
                    <li><a href="/help/index.html#documentation">Documentation</a></li>
                    <li><a href="/help/getting-started.html">Platform videos</a></li>
                    <li><a href="/wiki/index.asciidoc">Wiki</a></li>
                    <li><a href="/help/index.html#support">Community Support</a></li>
                    <li><a href="/help/commercial-support.html">Commercial Support</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/download/nb100/nb100.html">Download</a></h1>
                <ul>
                    <li><a href="/download/index.html#releases">Releases</a></li>
                    <ul>
                        <li><a href="/download/nb100/nb100.html">Apache NetBeans 10.0</a></li>
                        <li><a href="/download/nb90/nb90.html">Apache NetBeans 9.0</a></li>
                    </ul>
                    <li><a href="/plugins/index.html">Plugins</a></li>
                    <li><a href="/download/index.html#source">Building from source</a></li>
                    <li><a href="/download/index.html#previous">Previous releases</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<div class='footer-disclaimer'>
    <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2019 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <p><a href="https://incubator.apache.org/" alt="Apache Incubator"><img src='/images/incubator_feather_egg_logo_bw_crop.png' title='Apache Incubator'></img></a></p>
        <div style='max-width: 40em; margin: 0 auto'>
            <p>Apache NetBeans is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</p>
            <p>Apache Incubator, Apache, Apache NetBeans, NetBeans, the Apache feather logo, the Apache NetBeans logo, and the Apache Incubator project logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
            <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
        </div>
        
    </div>
</div>



        <script src="/js/vendor/jquery-3.2.1.min.js"></script>
        <script src="/js/vendor/what-input.js"></script>
        <script src="/js/vendor/jquery.colorbox-min.js"></script>
        <script src="/js/vendor/foundation.min.js"></script>
        <script src="/js/netbeans.js"></script>
        <script>
            
            $(function(){ $(document).foundation(); });
        </script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        <script>
         $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
        </script>
        
    </body>
</html>
