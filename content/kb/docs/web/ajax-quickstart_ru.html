
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Введение в Ajax для веб-приложений Java</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Введение в Ajax для веб-приложений Java - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Введение в Ajax для веб-приложений Java">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">Введение в Ajax для веб-приложений Java</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/ajax-quickstart_ru.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#overview">Обзор приложения</a></li>
<li><a href="#client1">Программирование на стороне клиента: часть 1</a>
<ul class="sectlevel2">
<li><a href="#_работа_с_редактором_html">Работа с редактором HTML</a></li>
<li><a href="#javascript">Работа с редактором JavaScript</a></li>
</ul>
</li>
<li><a href="#serverside">Программирование на стороне сервера</a>
<ul class="sectlevel2">
<li><a href="#_создание_хранилища_данных">Создание хранилища данных</a></li>
<li><a href="#servlet">Создание сервлета</a></li>
</ul>
</li>
<li><a href="#client2">Программирование на стороне клиента: часть 2</a>
<ul class="sectlevel2">
<li><a href="#_добавление_функциональных_возможностей_обратного_вызова">Добавление функциональных возможностей обратного вызова</a></li>
<li><a href="#_обновление_модели_dom_html">Обновление модели DOM HTML</a></li>
<li><a href="#displayresults">Отображение результатов</a></li>
<li><a href="#stylesheet">Присоединение таблицы стилей</a></li>
</ul>
</li>
<li><a href="#run">Выполнение проекта</a>
<ul class="sectlevel2">
<li><a href="#httpMonitor">Использование средства наблюдения HTTP Server Monitor</a></li>
<li><a href="#conclusion">Заключение</a></li>
</ul>
</li>
<li><a href="#seeAlso">Дополнительные сведения</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>В этом документе содержится введение в Ajax и описываются некоторые из функций в IDE NetBeans, позволяющий сделать программирование более быстрым и более эффективным процессом при работе с технологиями, связанными с Ajax. На примере низкоуровневых функциональных возможностей Ajax продемонстрирована разработка простого приложения с функцией автозаполнения текстового поля. В документе использованы материалы статьи Грега Мюррея (Greg Murray) и демонстрационное приложение из руководства <a href="http://weblogs.java.net/blog/gmurray71/archive/2005/12/using_ajax_with_1.html">Использование Ajax при помощи технологии Java</a>.</p>
</div>
<div class="paragraph">
<p>Ajax – это аббревиатура, означающая "Асинхронный JavaScript и XML" (Asynchronous JavaScript and XML). Основное назначение Ajax состоит в предоставлении веб-приложению возможности эффективной обработки взаимодействия между пользователем и веб-страницей, при этом значительно снижаются требования к обновлению или полной перезагрузке страницы при каждом взаимодействии с пользователем. Такой подход предоставляет широкие возможности при использовании браузера (аналогичные возможностям настольного приложения или веб-приложения на основе подключаемого модуля). Обработка взаимодействия Ajax осуществляется асинхронно в фоновом режиме. Благодаря этому пользователь может продолжать работу со страницей. Взаимодействие Ajax инициируется посредством кода JavaScript. После выполнения взаимодействия Ajax код JavaScript обновляет исходный текст HTML для страницы. Изменения вносятся немедленно без необходимости обновления страницы. Взаимодействия Ajax могут использоваться для выполнения таких задач, как проверка правильности формата вводимых записей на основе серверной логики (непосредственно во время их ввода пользователем), извлечение подробных данных из сервера, динамическое обновление данных на странице и передача элементов форм страницы.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/netbeans-stamp-80-74-73.png" alt="netbeans stamp 80 74 73">
</div>
<div class="title">Figure 1. Содержимое этой страницы применимо к IDE NetBeans 7.2, 7.3, 7.4 и 8.0</div>
</div>
<div class="paragraph">
<p><strong>Для работы с этим учебным курсом требуются программное обеспечение и ресурсы, перечисленные ниже.</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Программное обеспечение или материал</th>
<th class="tableblock halign-left valign-top">Требуемая версия</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">IDE NetBeans, Java EE bundle</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.3, 7.4, 8.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Комплект для разработчика на языке Java (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 или 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://glassfish.java.net/">Сервер GlassFish</a>
<em>или</em>
<a href="http://tomcat.apache.org/index.html">Сервер Tomcat</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Source Edition 3.1.x или 4.x
_ _
, версия 7.x или 8.x</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Примечания</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Установка Java EE в IDE позволяет при необходимости установить сервер GlassFish и контейнер сервлетов Apache Tomcat.</p>
</li>
<li>
<p>При этом предполагается, что читатель обладает практическими знаниями в области различных используемых технологий (т.е. HTML, CSS, JavaScript, Java и JSP). В этом документе приведен обзор функциональных возможностей, предоставляемых кодом, однако он <em>не содержит</em> каких-либо пояснений относительно кода на более детальном уровне.</p>
</li>
<li>
<p>Если необходимо сравнить проект с работающим решением, можно <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaScript%252FMyAjaxApp.zip">загрузить демонстрационное приложение</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview">Обзор приложения</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Предположим, что существует веб-страница, на которой пользователь может выполнять поиск информации о композиторах. Эта страница содержит поле, в которое вводится имя композитора. В примере приложения для поля ввода может использоваться функция автозавершения. Другими словами, пользователь может ввести часть имени композитора, после чего веб-приложение предложит варианты полного имени, перечислив всех композиторов, чьи имена или фамилии начинаются с введенных символов. Таким образом, пользователь может не помнить полное имя композитора, однако функция автозавершения обеспечит быстрый интуитивный доступ к требуемой информации.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/sample-app.png" alt="sample app">
</div>
<div class="title">Figure 2. Образец приложения отображается в браузере</div>
</div>
<div class="paragraph">
<p>Реализация функции автозавершения в поле поиска может служить примером возможностей, предоставляемых Ajax. Ajax использует объект <code>XMLHttpRequest</code> для асинхронной передачи запросов и ответов между клиентом и сервером. На следующем рисунке представлена блок-схема операций связи, происходящих между клиентом и сервером.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ajax-process-flow.png" alt="ajax process flow">
</div>
<div class="title">Figure 3. Диаграма потоков процессов Ajax</div>
</div>
<div class="paragraph">
<p>Для описания потока операций на блок-схеме можно использовать следующие действия.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Пользователь инициирует событие, например, отпускает клавишу при наборе имени. Это приводит к вызову функции JavaScript, которая инициализирует объект <code>XMLHttpRequest</code>.</p>
</li>
<li>
<p>Объект <code>XMLHttpRequest</code> настроен с учетом параметра запроса, который включает идентификатор элемента управления, инициировавшего событие, а также произвольное значение, введенное пользователем. Затем объект <code>XMLHttpRequest</code> выполняет асинхронный запрос к веб-серверу.</p>
</li>
<li>
<p>На веб-сервере осуществляется обработка этого запроса с использованием соответствующего объекта, например сервлета или прослушивающего процесса. Из хранилища данных извлекаются необходимые данные и подготавливается ответ, содержащий данные в форме документа XML.</p>
</li>
<li>
<p>Наконец, объект <code>XMLHttpRequest</code> получает данные XML с использованием функции ответного вызова, выполняет их обработку и обновляет модель DOM (Document Object Model, объектная модель документов) HTML для отображения страницы, содержащей новые данные.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>В данном учебном курсе описан способ создания варианта автозаполнения путем выполнения потока операций процесса, показанного на рисунке выше. Сначала на стороне клиента создаются файлы для страницы представления данных и функции, необходимые для генерации объекта <code>XMLHttpRequest</code>. Затем выполняется настройка на стороне сервера, заключающаяся в создании хранилища данных и бизнес-логики с использованием технологий на основе Java. Наконец, на стороне клиента реализуется функция обратного вызова <code>callback()</code> и другие функциональные возможности JavaScript, необходимые для обновления DOM HTML.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="client1">Программирование на стороне клиента: часть 1</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Сначала необходимо создать новый проект веб-приложения в среде IDE. Среда IDE уже содержит встроенные шаблоны для различных типов проекта.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите команду "Файл" &gt; "Новый проект". В области "Категории" выберите "Java Web". В области "Projects" (Проекты) выберите "Web Application" (Веб-приложение) и нажмите кнопку "Next" (Далее).</p>
</li>
<li>
<p>На экране "Имя и расположение" введите <code>MyAjaxApp</code> в поле "Имя проекта". Поле "Project Location" позволяет указать местоположение проекта. Для всех остальных параметров примите значения по умолчанию и нажмите кнопку "Далее".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/java-name-location.png" alt="java name location">
</div>
<div class="title">Figure 4. Укажите имя проекта и местоположение проекта приложения</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>На панели "Сервер и параметры настройки" выберите сервер, на котором требуется выполнить развертывание приложения. В списке представлены только те серверы, которые зарегистрированы в среде IDE.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/java-server-settings.png" alt="java server settings">
</div>
<div class="title">Figure 5. Выберите сервер, на котором требуется выполнить развертывание приложения</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Подтвердите остальные значения по умолчанию и нажмите кнопку "Готово". Проект создается в файловой системе и открывается в среде IDE.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При создании веб-проектов на основе Java автоматически создается сценарий сборки <a href="http://ant.apache.org/">Ant</a>, отвечающий за компиляцию проекта, что позволяет немедленно развернуть и запустить его на сервере, зарегистрированном в среде IDE.</p>
</div>
<div class="paragraph">
<p>В редакторе исходного кода среды IDE создается и открывается страница ввода по умолчанию. В зависимости от целевого сервера эта страница ввода будет иметь вид <code>index.jsp</code> или <code>index.html</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/java-proj-win.png" alt="java proj win">
</div>
<div class="title">Figure 6. В окне 'Проекты' отображается проект MyAjaxApp</div>
</div>
<div class="paragraph">
<p>Перед написанием программы попробуйте запустить приложение в целях проверки правильности настройки взаимосвязи между средой IDE, сервером и браузером.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В окне "Проекты" щелкните правой кнопкой мыши узел проекта и выберите команду "Выполнить".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Приложение компилируется, сервер приложений запускается, после чего приложение развертывается на этом сервере и выполняется. IDE открывает браузер по умолчанию и отображает страницу ввода по умолчанию.</p>
</div>
<div class="sect2">
<h3 id="_работа_с_редактором_html">Работа с редактором HTML</h3>
<div class="imageblock">
<div class="content">
<img src="images/palette.png" alt="palette">
</div>
<div class="title">Figure 7. На палитре отображаются элементы HTML</div>
</div>
<div class="paragraph">
<p>Теперь, после выполнения проверки правильности настройки среды, можно приступить к преобразованию страницы-указателя в интерфейс автозавершения, который будет отображаться для пользователей.</p>
</div>
<div class="paragraph">
<p>Одним из преимуществ использования среды IDE является то, что используемый редактор обеспечивает возможность применения функции автозавершения кода, что позволяет опытным пользователям значительно увеличить свою производительность при написании кода. Редактор исходного кода среды IDE обеспечивает адаптацию к применяемой технологии благодаря чему при нажатии сочетания клавиш автозавершения кода CTRL+ПРОБЕЛ (при работе со страницей HTML) пользователю предлагаются варианты тегов HTML и атрибутов. Далее мы увидим, что то же самое справедливо и для других технологий, например, CSS и JavaScript.</p>
</div>
<div class="paragraph">
<p>Вторым важным преимуществом является возможность использования палитры в среде IDE. Эта палитра предоставляет удобные в работе шаблоны для элементов, часто используемых в технологиях программирования. Необходимо просто выбрать отдельный элемент и перетащить его в определенное место файла, открытого в редакторе исходного кода.</p>
</div>
<div class="paragraph">
<p>Для отображения крупных значков (как в примере) необходимо щелкнуть палитру правой кнопкой мыши и выбрать пункт "Отображать крупные значки".</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Измените содержимое тегов <code>&lt;title&gt;</code> и <code>&lt;h1&gt;`на`"Автоматическое завершение с использованием AJAX"</code> Для страницы-указателя создание какого-либо кода на стороне сервера не требуется, так что можно удалить строки, созданные по умолчанию. Теперь должна появиться страница-указатель, аналогичная представленной ниже.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;!DOCTYPE html&gt;

&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
        &lt;title&gt;Auto-Completion using AJAX&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Auto-Completion using AJAX&lt;/h1&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Для описания назначения текстового поля следует добавить соответствующий пояснительный текст. Непосредственно под тегами <code>&lt;h1&gt;</code> можно скопировать и вставить следующий текст:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;p&gt;This example shows how you can do real time auto-completion using Asynchronous
    JavaScript and XML (Ajax) interactions.&lt;/p&gt;

&lt;p&gt;In the form below enter a name. Possible names that will be completed are displayed
    below the form. For example, try typing in "Bach," "Mozart," or "Stravinsky,"
    then click on one of the selections to see composer details.&lt;/p&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте к странице форму HTML. Для этого можно использовать элементы, содержащиеся в палитре среды IDE. Если палитра не открыта, выберите в главном меню "Окно" &gt; "Палитра". Затем перейдите к узлу "Формы HTML", выберите элемент "Форма" и перетащите его на страницу под только что добавленные теги <code>&lt;p&gt;</code>. Появится диалоговое окно "Вставить форму". Введите следующее:</p>
<div class="ulist">
<ul>
<li>
<p>Действие: autocomplete</p>
</li>
<li>
<p>Method: GET;</p>
</li>
<li>
<p>Имя: autofillform</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/insert-form.png" alt="insert form">
</div>
<div class="title">Figure 8. Диалоговое окно 'Вставить форму'</div>
</div>
<div class="paragraph">
<p>Нажмите кнопку "ОК". Теги HTML <code>&lt;form&gt;</code> вставляются в страницу, содержащую указанные атрибуты. (Метод GET применяется по умолчанию, и, следовательно, не объявляется явно).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте к странице таблицу HTML. В категории палитры "HTML" выберите элемент "Таблица" и перетащите его непосредственно под теги <code>&lt;form&gt;</code>. Откроется диалоговое окно "Вставить таблицу". Введите следующее:</p>
<div class="ulist">
<ul>
<li>
<p>Строк: 2</p>
</li>
<li>
<p>Столбцов: 2</p>
</li>
<li>
<p>Размер границы : 0</p>
</li>
<li>
<p>Заполнение ячеек: 5</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/insert-table.png" alt="insert table">
</div>
<div class="title">Figure 9. Диалоговое окно 'Вставить таблицу'</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните правой кнопкой мыши редактор исходного кода и выберите команду "Форматировать". Последует выравнивание кода. Теперь форма должна выглядеть следующим образом:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;form name="autofillform" action="autocomplete"&gt;
  &lt;table border="0" cellpadding="5"&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;&lt;/th&gt;
        &lt;th&gt;&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;/td&gt;
        &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;/td&gt;
        &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;
&lt;/form&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В первый столбец первой строки таблицы введите следующий текст (изменения выделены <strong>полужирным шрифтом</strong>):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;td&gt;*&lt;strong&gt;Composer Name:&lt;/strong&gt;*&lt;/td&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Во второй столбец первой строки вместо перетаскивания поля "Ввод текста" из палитры введите указанный ниже код (изменения выделены <strong>полужирным</strong> шрифтом):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;td&gt;
    *&lt;input type="text"
        size="40"
        id="complete-field"
        onkeyup="doCompletion();"&gt;*
&lt;/td&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>При вводе кода можно использовать встроенную в среду IDE функцию автозавершения кода. Например, введите <code>&lt;i</code>, а затем нажмите CTRL+ПРОБЕЛ. Список предлагаемых вариантов выбора отображается под курсором, а в расположенном выше поле появляется описание выбранного элемента. Для получения возможных вариантов выбора при написании кода достаточно в любой момент нажать в редакторе исходного кода сочетание клавиш CTRL+ПРОБЕЛ. Кроме того, при наличии единственного возможного варианта выбора нажатие CTRL+ПРОБЕЛ приведет к автоматическому завершению кода с использованием элемента с этим именем.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/code-completion.png" alt="code completion">
</div>
<div class="title">Figure 10. Для вызова поддержки автозавершения кода и документации нажмите сочетание клавиш CTRL+ПРОБЕЛ в редакторе.</div>
</div>
<div class="paragraph">
<p>Атрибут <code>onkeyup</code>, введенный выше, указывает на функцию JavaScript с именем <code>doCompletion()</code>. Эта функция вызывается при каждом нажатии клавиши в текстовом поле формы и соответствует вызову JavaScript на приведенной выше <a href="#flow-diagram">блок-схеме</a> Ajax.</p>
</div>
</div>
<div class="sect2">
<h3 id="javascript">Работа с редактором JavaScript</h3>
<div class="paragraph">
<p>Редактор JavaScript в среде IDE предоставляет целый ряд расширенных возможностей редактирования, таких как интеллектуальное автозавершение кода, семантическое выделение, быстрое переименование, возможности переработки и многие другие функции.</p>
</div>
<div class="paragraph">
<p>Возможность автозавершения кода JavaScript автоматически предоставляется при кодировании в файлах <code>.js</code>, а также внутри тегов <code>&lt;script&gt;</code> и при работе с другими технологиями (например, HTML, RHTML, JSP, PHP). IDE может предоставить вам некоторые подсказки при редактировании кода JavaScript. Можно настроить наличие подсказок вариантов JavaScript, выбрав 'Сервис' &gt; 'Параметры' ('NetBeans' &gt; 'Предпочтения на Mac'), чтобы открыть окно 'Параметры' и выбрать язык JavaScript на вкладке 'Советы' в категории 'Редактор'. Также можно добавить собственные шаблоны кода JavaScript на вкладке 'Шаблоны кода' в окне 'Параметры'.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/javascript-options.png" alt="javascript options">
</div>
<div class="title">Figure 11. Параметры подсказки JavaScript в окне 'Параметры'</div>
</div>
<div class="paragraph">
<p>Добавьте файл JavaScript к приложению и выполните <code>doCompletion()</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В окне "Проекты" щелкните правой кнопкой мыши узел "Веб-страницы" и выберите "Создать &gt; Файл JavaScript". (Если файл JavaScript отсутствует в списке, выберите "Прочее". Затем выберите файл JavaScript из категории "Web" в мастере создания файла).</p>
</li>
<li>
<p>Задайте имя файла <code>javascript</code> и нажмите кнопку 'Готово'. Новый файл JavaScript отображается в окне 'Проекты' в папке 'Веб-страницы'.</p>
</li>
<li>
<p>Введите приведенный ниже код в файл <code>javascript.js</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">var req;
var isIE;

function init() {
    completeField = document.getElementById("complete-field");
}

function doCompletion() {
        var url = "autocomplete?action=complete&amp;amp;id=" + escape(completeField.value);
        req = initRequest();
        req.open("GET", url, true);
        req.onreadystatechange = callback;
        req.send(null);
}

function initRequest() {
    if (window.XMLHttpRequest) {
        if (navigator.userAgent.indexOf('MSIE') != -1) {
            isIE = true;
        }
        return new XMLHttpRequest();
    } else if (window.ActiveXObject) {
        isIE = true;
        return new ActiveXObject("Microsoft.XMLHTTP");
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>С помощью этого кода выполняется простая проверка совместимости веб-браузеров Firefox 3 и Internet Explorer версий 6 и 7). Если требуется добавить более надежный код, устраняющий ошибки совместимости, используйте <a href="http://www.quirksmode.org/js/detect.html">сценарий для определения браузера</a> с веб-сайта <a href="http://www.quirksmode.org">http://www.quirksmode.org</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Вернитесь к странице индекса и добавьте ссылку на файл JavaScript между тегами <code>&lt;head&gt;</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;script type="text/javascript" src="javascript.js"&gt;&lt;/script&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Для быстрого перехода между страницами, открытыми в редакторе исходного кода, можно воспользоваться сочетанием клавиш CTRL+TAB.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Вставьте вызов <code>init()</code> после открывающего тега <code>&lt;body&gt;</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;body *onload="init()"*&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Это обеспечит выполнение вызова <code>init()</code> при каждой загрузке страницы.</p>
</div>
<div class="paragraph">
<p>Роль <code>doCompletion()</code> состоит в следующем:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>создание URL-адреса к местоположению, содержащему данные, которые могут использоваться на стороне сервера;</p>
</li>
<li>
<p>инициализация объекта <code>XMLHttpRequest</code>;</p>
</li>
<li>
<p>запрос объекта <code>XMLHttpRequest</code> для передачи асинхронного запроса в сервер.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Объект <code>XMLHttpRequest</code> является основным объектом Ajax и своего рода фактическим стандартным решением для обеспечения асинхронной передачи данных XML по HTTP. <em>Асинхронное</em> взаимодействие подразумевает возможность продолжения обработки браузером событий на странице даже после передачи запроса. Данные передаются в фоновом режиме и могут автоматически загружаться на страницу без необходимости ее обновления.</p>
</div>
<div class="paragraph">
<p>Следует отметить, что объект <code>XMLHttpRequest</code> фактически создается с помощью функции <code>initRequest()</code>, которая вызывается функцией <code>doCompletion()</code>. Эта функция позволяет выполнять проверку возможности распознавания браузером запроса <code>XMLHttpRequest</code>, и – в случае положительного ответа – создавать объект <code>XMLHttpRequest</code>. В противном случае, с ее помощью выполняется проверка на <code>ActiveXObject</code> (<code>XMLHttpRequest</code> для Internet Explorer 6), и если результат идентификации является положительным, создается <code>ActiveXObject</code>.</p>
</div>
<div class="paragraph">
<p>При создании объекта необходимо определить три параметра <code>XMLHttpRequest</code>: URL-адрес, метод HTTP (<code>GET</code> или <code>POST</code>) и допустимость использования асинхронного взаимодействия. В вышеупомянутом примере эти параметры определяются следующим образом:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>URL-адрес <code>autocomplete</code> и текст, введенный пользователем в поле <code>complete-field</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">var url = "autocomplete?action=complete&amp;amp;id=" + escape(completeField.value);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>GET</code> означает, что взаимодействия HTTP используют метод <code>GET</code>;</p>
</li>
<li>
<p><code>true</code> означает, что взаимодействие является асинхронным:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">req.open("GET", url, true);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если взаимодействие определено как асинхронное, необходимо указать функцию обратного вызова. Функция обратного вызова для этого взаимодействия определяется при помощи следующего оператора:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">req.onreadystatechange = callback;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Затем следует определить функцию <code>callback()</code>. Взаимодействие HTTP инициируется при вызове <code>XMLHttpRequest.send()</code>. Это действие соответствует запросу HTTP, который передается на веб-сервер (см. представленную выше блок-схему).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="serverside">Программирование на стороне сервера</h2>
<div class="sectionbody">
<div class="paragraph">
<p>В среде IDE предусмотрена полная поддержка серверного веб-программирования. Наряду с базовой поддержкой редактором многих популярных языков программирования и написания сценариев, поддерживаются также веб-службы, такие как SOAP, REST, SaaS, а также платформы, ориентированные на MVC, например JSF, Spring и Struts. Несколько подключаемых модулей NetBeans доступны в <a href="http://plugins.netbeans.org/">портале подключаемых модулей NetBeans</a> для платформ под управлением Ajax, включая <a href="https://developers.google.com/web-toolkit/">GWT</a> и <a href="http://struts.apache.org/2.x/">Struts2</a>.</p>
</div>
<div class="paragraph">
<p>Бизнес-логика разрабатываемого приложения предполагает обработку запросов путем извлечения данных из хранилища данных, их последующую подготовку и передачу ответа. В данном случае этот принцип реализован с использованием сервлета. Перед началом написания кода сервлета необходимо настроить хранилище данных и функциональные возможности, требуемые для доступа к данным со стороны этого сервлета.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#data">Создание хранилища данных</a></p>
</li>
<li>
<p><a href="#servlet">Создание сервлета</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_создание_хранилища_данных">Создание хранилища данных</h3>
<div class="paragraph">
<p>Для данного простого приложения создается класс с именем <code>ComposerData</code>, в котором данные о композиторах содержатся в хранилище <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/util/HashMap.html">`HashMap`</a>. В <code>HashMap</code> можно сохранять пары связанных элементов в парах ключевых значений. Кроме того, следует создать класс <code>Composer</code>, который инициирует извлечение сервлетом данных из записей, содержащихся в хранилище <code>HashMap</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните правой кнопкой мыши узел проекта в окне "Проекты" и выберите команду "Создать" &gt; "Класс Java".</p>
</li>
<li>
<p>Дайте классу имя <code>ComposerData</code> и введите <code>com.ajax</code> в поле "Пакет". При этом создается новый пакет, в который будет включен этот класс, а также другие классы, которые будут созданы позже.</p>
</li>
<li>
<p>Нажмите кнопку "Завершить". Последует создание и открытие класса в редакторе исходного кода.</p>
</li>
<li>
<p>В редакторе исходного кода вставьте следующий код:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package com.ajax;

import java.util.HashMap;

/**
 *
 * @author nbuser
 */
public class ComposerData {

    private HashMap composers = new HashMap();

    public HashMap getComposers() {
        return composers;
    }

    public ComposerData() {

        composers.put("1", new Composer("1", "Johann Sebastian", "Bach", "Baroque"));
        composers.put("2", new Composer("2", "Arcangelo", "Corelli", "Baroque"));
        composers.put("3", new Composer("3", "George Frideric", "Handel", "Baroque"));
        composers.put("4", new Composer("4", "Henry", "Purcell", "Baroque"));
        composers.put("5", new Composer("5", "Jean-Philippe", "Rameau", "Baroque"));
        composers.put("6", new Composer("6", "Domenico", "Scarlatti", "Baroque"));
        composers.put("7", new Composer("7", "Antonio", "Vivaldi", "Baroque"));

        composers.put("8", new Composer("8", "Ludwig van", "Beethoven", "Classical"));
        composers.put("9", new Composer("9", "Johannes", "Brahms", "Classical"));
        composers.put("10", new Composer("10", "Francesco", "Cavalli", "Classical"));
        composers.put("11", new Composer("11", "Fryderyk Franciszek", "Chopin", "Classical"));
        composers.put("12", new Composer("12", "Antonin", "Dvorak", "Classical"));
        composers.put("13", new Composer("13", "Franz Joseph", "Haydn", "Classical"));
        composers.put("14", new Composer("14", "Gustav", "Mahler", "Classical"));
        composers.put("15", new Composer("15", "Wolfgang Amadeus", "Mozart", "Classical"));
        composers.put("16", new Composer("16", "Johann", "Pachelbel", "Classical"));
        composers.put("17", new Composer("17", "Gioachino", "Rossini", "Classical"));
        composers.put("18", new Composer("18", "Dmitry", "Shostakovich", "Classical"));
        composers.put("19", new Composer("19", "Richard", "Wagner", "Classical"));

        composers.put("20", new Composer("20", "Louis-Hector", "Berlioz", "Romantic"));
        composers.put("21", new Composer("21", "Georges", "Bizet", "Romantic"));
        composers.put("22", new Composer("22", "Cesar", "Cui", "Romantic"));
        composers.put("23", new Composer("23", "Claude", "Debussy", "Romantic"));
        composers.put("24", new Composer("24", "Edward", "Elgar", "Romantic"));
        composers.put("25", new Composer("25", "Gabriel", "Faure", "Romantic"));
        composers.put("26", new Composer("26", "Cesar", "Franck", "Romantic"));
        composers.put("27", new Composer("27", "Edvard", "Grieg", "Romantic"));
        composers.put("28", new Composer("28", "Nikolay", "Rimsky-Korsakov", "Romantic"));
        composers.put("29", new Composer("29", "Franz Joseph", "Liszt", "Romantic"));

        composers.put("30", new Composer("30", "Felix", "Mendelssohn", "Romantic"));
        composers.put("31", new Composer("31", "Giacomo", "Puccini", "Romantic"));
        composers.put("32", new Composer("32", "Sergei", "Rachmaninoff", "Romantic"));
        composers.put("33", new Composer("33", "Camille", "Saint-Saens", "Romantic"));
        composers.put("34", new Composer("34", "Franz", "Schubert", "Romantic"));
        composers.put("35", new Composer("35", "Robert", "Schumann", "Romantic"));
        composers.put("36", new Composer("36", "Jean", "Sibelius", "Romantic"));
        composers.put("37", new Composer("37", "Bedrich", "Smetana", "Romantic"));
        composers.put("38", new Composer("38", "Richard", "Strauss", "Romantic"));
        composers.put("39", new Composer("39", "Pyotr Il'yich", "Tchaikovsky", "Romantic"));
        composers.put("40", new Composer("40", "Guiseppe", "Verdi", "Romantic"));

        composers.put("41", new Composer("41", "Bela", "Bartok", "Post-Romantic"));
        composers.put("42", new Composer("42", "Leonard", "Bernstein", "Post-Romantic"));
        composers.put("43", new Composer("43", "Benjamin", "Britten", "Post-Romantic"));
        composers.put("44", new Composer("44", "John", "Cage", "Post-Romantic"));
        composers.put("45", new Composer("45", "Aaron", "Copland", "Post-Romantic"));
        composers.put("46", new Composer("46", "George", "Gershwin", "Post-Romantic"));
        composers.put("47", new Composer("47", "Sergey", "Prokofiev", "Post-Romantic"));
        composers.put("48", new Composer("48", "Maurice", "Ravel", "Post-Romantic"));
        composers.put("49", new Composer("49", "Igor", "Stravinsky", "Post-Romantic"));
        composers.put("50", new Composer("50", "Carl", "Orff", "Post-Romantic"));

    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Вы увидите, что в левом поле редактора выводится предупреждение о том, что не удается найти класс  <code>Composer</code> . Выполните следующие шаги для создания класса <code>Composer</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните правой кнопкой мыши узел проекта в окне "Проекты" и выберите команду "Создать" &gt; "Класс Java".</p>
</li>
<li>
<p>Дайте классу имя <code>Composer</code> и выберите <code>com.ajax</code> в раскрывающемся списке поля "Package". Нажмите кнопку "Завершить".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>После нажатия кнопки 'Готово' в IDE создается класс, а файл открывается в редакторе исходного кода.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В редакторе исходного кода вставьте следующий код:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package com.ajax;

public class Composer {

    private String id;
    private String firstName;
    private String lastName;
    private String category;

    public Composer (String id, String firstName, String lastName, String category) {
        this.id = id;
        this.firstName = firstName;
        this.lastName = lastName;
        this.category = category;
    }

    public String getCategory() {
        return category;
    }

    public String getId() {
        return id;
    }

    public String getFirstName() {
        return firstName;
    }

    public String getLastName() {
        return lastName;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>После создания класса  <code>Composer</code> , если посмотреть на класс  <code>ComposerData</code>  в редакторе, вы увидите, что предупреждения больше не отображаются. Если в  <code>ComposerData</code>  по-прежнему отображаются аннотации с предупреждениями, можно попытаться устранить ошибку путем добавления отсутствующих операторов импорта.</p>
</div>
</div>
<div class="sect2">
<h3 id="servlet">Создание сервлета</h3>
<div class="paragraph">
<p>Создайте сервлет для обработки URL-адреса <code>autocomplete</code>, получаемого при входящем запросе.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните правой кнопкой мыши узел проекта в окне 'Проекты' и выберите 'Создать' &gt; 'Сервлет', чтобы открыть мастер создания сервлетов. (Выберите 'Другой' и выберите 'Сервлет' в меню 'Веб-категория', если сервлет не отображается по умолчанию во всплывающем меню).</p>
</li>
<li>
<p>Дайте сервлету имя <code>AutoCompleteServlet</code> и выберите <code>com.ajax</code> в раскрывающемся списке поля "Package". Нажмите кнопку 'Далее'.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/newservlet-name-location.png" alt="newservlet name location">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>На панели 'Настройка развертывания сервлета' измените шаблон адреса URL <strong><code>/autocomplete</code></strong> таким образом, чтобы он соответствовал адресу URL, заданному ранее в объекте <code>XMLHttpRequest</code>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/newservlet-configure-deployment.png" alt="newservlet configure deployment">
</div>
</div>
<div class="paragraph">
<p>Использование этой панели позволяет пропустить этап добавления дополнительных сведений вручную к дескриптору развертывания.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>При желании выберите "Добавить информацию о сервлете в дескриптор развертывания". После выполнения этих действий созданный проект получится таким же, как загруженный пример. В последней версии среды IDE сервлет по умолчанию регистрируется аннотацией <code>@WebServlet</code> вместо регистрации в дескрипторе развертывания. Тем не менее, проект будет работать, если использовать аннотацию <code>@WebServlet</code> вместо дескриптора развертывания.</p>
</li>
<li>
<p>Нажмите кнопку "Завершить". Сервлет будет создан и открыт в редакторе исходного кода.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Единственными методами, которые следует переопределить, являются метод <code>doGet()</code> для определения обработки сервлетом запроса <code>autocomplete</code> <code>GET</code> и метод <code>init()</code>, который должен инициировать <code>ServletContext</code> для того, чтобы сервлет имел доступ к другим классам приложения после его запуска.</p>
</div>
<div class="paragraph">
<p>Существует возможность переопределения методов из родительских классов с помощью контекстного меню "Вставить код" в среде IDE. Реализуйте <code>init()</code> , выполнив следующие шаги.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Поместите курсор в нижней части объявления класса <code>AutoCompleteServlet</code> в редакторе исходного кода. Нажмите ALT+INS (CTRL+I в Mac ОS) для открытия контекстного меню "Создать код".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/insert-code.png" alt="insert code">
</div>
<div class="title">Figure 12. Всплывающее меню 'Вставить код' отображается в в редакторе исходного кода</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите команду "Переопределить метод". В появившемся диалоговом окне отображаются все родительские классы сервлета <code>AutoCompleteServlet</code>. Разверните узел GenericServlet и выберите <code>init(Servlet Config config)</code>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new-override.png" alt="new override">
</div>
<div class="title">Figure 13. В диалоговом окне 'Переопределить' указаны унаследованные классы</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "ОК". Метод <code>init()</code> добавится в редактор исходного кода.</p>
</li>
<li>
<p>Добавьте переменную для объекта <code>ServletContext</code> и измените метод <code>init()</code> (изменения выделены <strong>полужирным</strong> шрифтом):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">*private ServletContext context;*

@Override
public void init(ServletConfig *config*) throws ServletException {
    *this.context = config.getServletContext();*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте оператор импорта для объекта <code>ServletContext</code>. Это можно сделать, выбрав значок лампочки, который отображается на экране в левом поле редактора исходного кода.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/import-hint.png" alt="import hint">
</div>
<div class="title">Figure 14. Подсказки импорта отображаются в левом поле редактора исходного кода</div>
</div>
<div class="paragraph">
<p>Метод <code>doGet()</code> должен преобразовать URL-адрес запроса, извлечь данные из хранилища данных и подготовить ответ в формате XML. Следует отметить, что объявление метода было сгенерировано при создании класса. Для просмотра, возможно, потребуется расширить методы HttpServlet, щелкнув значок развертывания в левом поле (<span class="image"><img src="images/expand-icon.png" alt="expand icon"></span>).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте к классу следующие объявления переменных в нижней части объявления класса <code>AutocompleteServlet</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private ComposerData compData = new ComposerData();
private HashMap composers = compData.getComposers();</code></pre>
</div>
</div>
<div class="paragraph">
<p>При этом создается хранилище <code>HashMap</code>, включающее все данные о композиторах, которое затем используется методом <code>doGet()</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выполните прокрутку вниз до метода <code>doGet()</code> и реализуйте его следующим образом:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">@Override
public void doGet(HttpServletRequest request, HttpServletResponse response)
        throws IOException, ServletException {

    String action = request.getParameter("action");
    String targetId = request.getParameter("id");
    StringBuffer sb = new StringBuffer();

    if (targetId != null) {
        targetId = targetId.trim().toLowerCase();
    } else {
        context.getRequestDispatcher("/error.jsp").forward(request, response);
    }

    boolean namesAdded = false;
    if (action.equals("complete")) {

        // check if user sent empty string
        if (!targetId.equals("")) {

            Iterator it = composers.keySet().iterator();

            while (it.hasNext()) {
                String id = (String) it.next();
                Composer composer = (Composer) composers.get(id);

                if ( // targetId matches first name
                     composer.getFirstName().toLowerCase().startsWith(targetId) ||
                     // targetId matches last name
                     composer.getLastName().toLowerCase().startsWith(targetId) ||
                     // targetId matches full name
                     composer.getFirstName().toLowerCase().concat(" ")
                        .concat(composer.getLastName().toLowerCase()).startsWith(targetId)) {

                    sb.append("&lt;composer&gt;");
                    sb.append("&lt;id&gt;" + composer.getId() + "&lt;/id&gt;");
                    sb.append("&lt;firstName&gt;" + composer.getFirstName() + "&lt;/firstName&gt;");
                    sb.append("&lt;lastName&gt;" + composer.getLastName() + "&lt;/lastName&gt;");
                    sb.append("&lt;/composer&gt;");
                    namesAdded = true;
                }
            }
        }

        if (namesAdded) {
            response.setContentType("text/xml");
            response.setHeader("Cache-Control", "no-cache");
            response.getWriter().write("&lt;composers&gt;" + sb.toString() + "&lt;/composers&gt;");
        } else {
            //nothing to show
            response.setStatus(HttpServletResponse.SC_NO_CONTENT);
        }
    }
    if (action.equals("lookup")) {

        // put the target composer in the request scope to display
        if ((targetId != null) &amp;amp;&amp;amp; composers.containsKey(targetId.trim())) {
            request.setAttribute("composer", composers.get(targetId));
            context.getRequestDispatcher("/composer.jsp").forward(request, response);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Итак, на этом примере создания сервлета можно убедиться, что написание кода на стороне сервера для обработки с использованием Ajax не требует каких-либо новых знаний. Для случаев, когда требуется обмен документами XML, тип содержимого ответа должен иметь значение <code>text/xml</code>. Кроме того, Ajax позволяет осуществлять обмен простыми текстами или даже фрагментами JavaScript, которые могут анализироваться или выполняться с использованием функции обратного вызова на стороне клиента. Обратите внимание на то, что некоторые браузеры могут кэшировать результаты, следовательно, может потребоваться установка заголовка HTTP "Cache-Control" на <code>no-cache</code>.</p>
</div>
<div class="paragraph">
<p>В этом примере сервлет генерирует документ XML, в котором содержатся все композиторы, имя или фамилия которых начинается с введенных пользователем символов. Этот документ соответствует данным XML, описанным в приведенной выше блок-схеме. Ниже приведен пример документа XML, который возвращается в объект <code>XMLHttpRequest</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;composers&gt;
    &lt;composer&gt;
        &lt;id&gt;12&lt;/id&gt;
        &lt;firstName&gt;Antonin&lt;/firstName&gt;
        &lt;lastName&gt;Dvorak&lt;/lastName&gt;
    &lt;/composer&gt;
    &lt;composer&gt;
        &lt;id&gt;45&lt;/id&gt;
        &lt;firstName&gt;Aaron&lt;/firstName&gt;
        &lt;lastName&gt;Copland&lt;/lastName&gt;
    &lt;/composer&gt;
    &lt;composer&gt;
        &lt;id&gt;7&lt;/id&gt;
        &lt;firstName&gt;Antonio&lt;/firstName&gt;
        &lt;lastName&gt;Vivaldi&lt;/lastName&gt;
    &lt;/composer&gt;
    &lt;composer&gt;
        &lt;id&gt;2&lt;/id&gt;
        &lt;firstName&gt;Arcangelo&lt;/firstName&gt;
        &lt;lastName&gt;Corelli&lt;/lastName&gt;
    &lt;/composer&gt;
&lt;/composers&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>После завершения кода приложения можно воспользоваться функцией <a href="#httpMonitor">HTTP Monitor</a> среды IDE для просмотра возвращенных данных XML.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="client2">Программирование на стороне клиента: часть 2</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Теперь необходимо определить функцию обратного вызова для обработки ответа сервера и добавить все функциональные возможности, необходимые для отражения изменений на странице, которая просматривается пользователем. В этом случае потребуется внести изменения в модель DOM HTML. Необходимо создать JSP-страницы для отображения результатов успешного запроса или сообщений об ошибках запроса со сбоем. Можно затем создать простую таблицу стилей для презентации.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#callback">Добавление функциональных возможностей обратного вызова</a></p>
</li>
<li>
<p><a href="#htmldom">Обновление модели DOM HTML</a></p>
</li>
<li>
<p><a href="#displayresults">Отображение результатов</a></p>
</li>
<li>
<p><a href="#stylesheet">Присоединение таблицы стилей</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_добавление_функциональных_возможностей_обратного_вызова">Добавление функциональных возможностей обратного вызова</h3>
<div class="paragraph">
<p>Асинхронный вызов функции обратного вызова выполняется на определенных этапах взаимодействия HTTP – при изменении свойства <code>readyState</code> объекта <code>XMLHttpRequest</code>. В разрабатываемом приложении в качестве функции обратного вызова используется <code>callback()</code>. Следует помнить о том, что <code>callback</code> в <code>doCompletion()</code> была определена как свойство <code>XMLHttpRequest.onreadystatechange</code> для функции. Теперь можно реализовать функцию обратного вызова следующим образом.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте <code>javascript.js</code> в редакторе исходного кода и введите следующий код.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">function callback() {
    if (req.readyState == 4) {
        if (req.status == 200) {
            parseMessages(req.responseXML);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Значение "4" состояния <code>readyState</code> означает успешное выполнение взаимодействия HTTP. Интерфейс API для <code>XMLHttpRequest.readState</code> указывает на наличие 5 возможных значений, которые могут быть использованы при настройке. Это:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Значение <code>readyState</code></th>
<th class="tableblock halign-left valign-top">Определение состояния объекта</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">не инициализировано</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">загрузка</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">загружено</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">интерактивный режим</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">выполнено</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Обратите внимание, что функция <code>parseMessages()</code> вызывается, только если <code>XMLHttpRequest.readyState</code> находится в состоянии "4", а <code>status</code> – определение кода состояния HTTP запроса – имеет значение "200", что указывает на успешное выполнение. Метод ` parseMessages()`будет определен далее в разделе <a href="#htmldom">Обновление модели DOM HTML</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_обновление_модели_dom_html">Обновление модели DOM HTML</h3>
<div class="paragraph">
<p>Функция <code>parseMessages()</code> позволяет выполнять обработку входящих данных XML. При этом, в указанной функции используются несколько вспомогательных функций, например <code>appendComposer()</code>, <code>getElementY()</code> и <code>clearTable()</code>. Кроме того, необходимо ввести новые элементы для страницы-указателя, например, вторую таблицу HTML, которая служит в качестве поля автозавершения, и идентификаторы для элементов, обеспечивающие возможность вызова в <code>javascript.js</code>. Наконец, следует создать новые переменные, соответствующие идентификаторам элементов на странице индекса, инициализировать их в предварительно реализованной функции <code>init()</code> и добавить функциональность, которая требуется при каждой загрузке страницы индекса.</p>
</div>
<div class="paragraph">
<p><strong>Примечание.</strong> Функции и элементы, которые создаются в следующих действиях, являются взаимозависимыми. После выполнения рекомендаций, приведенных в этом разделе, необходимо выполнить тщательную проверку реализованного кода.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте страницу индекса в редакторе исходного кода и введите указанный ниже код во вторую строку предварительно созданной таблицы HTML.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;tr&gt;
    *&lt;td id="auto-row" colspan="2"&gt;
        &lt;table id="complete-table" /&gt;
    &lt;/td&gt;*
&lt;/tr&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Вторая строка таблицы содержит еще одну таблицу HTML. Эта таблица представляет поле автозавершения, используемое для автоматического ввода полных имен композиторов.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте <code>javascript.js</code> в редакторе исходного кода и добавьте к первому фрагменту файла три следующих переменных:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">var completeField;
var completeTable;
var autoRow;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте следующие строки (выделенные <strong>полужирным шрифтом</strong>) к функции <code>init()</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">function init() {
    completeField = document.getElementById("complete-field");
    *completeTable = document.getElementById("complete-table");
    autoRow = document.getElementById("auto-row");
    completeTable.style.top = getElementY(autoRow) + "px";*
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Одной из целей <code>init()</code> является предоставление доступа к элементам страницы индекса для других функций, используемых в целях изменения DOM страницы индекса.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте <code>appendComposer()</code> в <code>javascript.js</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">function appendComposer(firstName,lastName,composerId) {

    var row;
    var cell;
    var linkElement;

    if (isIE) {
        completeTable.style.display = 'block';
        row = completeTable.insertRow(completeTable.rows.length);
        cell = row.insertCell(0);
    } else {
        completeTable.style.display = 'table';
        row = document.createElement("tr");
        cell = document.createElement("td");
        row.appendChild(cell);
        completeTable.appendChild(row);
    }

    cell.className = "popupCell";

    linkElement = document.createElement("a");
    linkElement.className = "popupItem";
    linkElement.setAttribute("href", "autocomplete?action=lookup&amp;amp;id=" + composerId);
    linkElement.appendChild(document.createTextNode(firstName + " " + lastName));
    cell.appendChild(linkElement);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Эта функция позволяет создавать новую строку таблицы и вставлять в нее ссылку на композитора с использованием данных, передаваемых в функцию посредством соответствующих трех параметров, а затем вставлять эту строку в элемент <code>complete-table</code> страницы-указателя.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте <code>getElementY()</code> в <code>javascript.js</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">function getElementY(element){

    var targetTop = 0;

    if (element.offsetParent) {
        while (element.offsetParent) {
            targetTop += element.offsetTop;
            element = element.offsetParent;
        }
    } else if (element.y) {
        targetTop += element.y;
    }
    return targetTop;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Указанная функция применяется для определения вертикальной позиции исходного элемента. Это является необходимым, поскольку фактическое расположение элемента при его отображении часто зависит от типа и версии браузера. Следует отметить, что при отображении на экране элемент <code>complete-table</code>, содержащий имена композиторов, перемещается в нижнюю правую часть таблицы, в которой он расположен. Правильное расположение по высоте определяется <code>getElementY()</code>.</p>
</div>
<div class="paragraph">
<p><strong>Примечание.</strong> См. <a href="http://www.quirksmode.org/js/findpos.html">это описание</a> <code>смещения</code> в <a href="http://www.quirksmode.org/">http://www.quirksmode.org/</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте <code>clearTable()</code> в <code>javascript.js</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">function clearTable() {
    if (completeTable.getElementsByTagName("tr").length &gt; 0) {
        completeTable.style.display = 'none';
        for (loop = completeTable.childNodes.length -1; loop &gt;= 0 ; loop--) {
            completeTable.removeChild(completeTable.childNodes[loop]);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Эта функция позволяет скрывать элемент <code>complete-table</code> (т.е. делать его невидимым), но не удаляет какие-либо существующие записи имен композиторов, созданные ранее.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Для вызова <code>clearTable()</code> при каждом получении данных с сервера можно соответствующим образом изменить функцию <code>callback()</code>. Поэтому любые скомбинированные записи, существующие в окне автозавершения, удаляются до того, как выполняется заполнение новыми записями.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">function callback() {

    *clearTable();*

    if (req.readyState == 4) {
        if (req.status == 200) {
            parseMessages(req.responseXML);
        }
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте <code>parseMessages()</code> в <code>javascript.js</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">function parseMessages(responseXML) {

    // no matches returned
    if (responseXML == null) {
        return false;
    } else {

        var composers = responseXML.getElementsByTagName("composers")[0];

        if (composers.childNodes.length &gt; 0) {
            completeTable.setAttribute("bordercolor", "black");
            completeTable.setAttribute("border", "1");

            for (loop = 0; loop &lt; composers.childNodes.length; loop++) {
                var composer = composers.childNodes[loop];
                var firstName = composer.getElementsByTagName("firstName")[0];
                var lastName = composer.getElementsByTagName("lastName")[0];
                var composerId = composer.getElementsByTagName("id")[0];
                appendComposer(firstName.childNodes[0].nodeValue,
                    lastName.childNodes[0].nodeValue,
                    composerId.childNodes[0].nodeValue);
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Функция <code>parseMessages()</code> получает в качестве параметра объектное представление документа XML, возвращаемое сервлетом <code>AutoComplete</code>. С программной точки зрения, функция исследует документ XML и извлекает <code>firstName</code>, <code>lastName</code> и <code>id</code> каждой записи, а затем передает эти данные в <code>appendComposer()</code>. Это приводит к динамическому обновлению содержимого элемента <code>complete-table</code>. Например, запись, которая генерируется и вставляется в <code>complete-table</code>, может выглядеть следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;tr&gt;
    &lt;td class="popupCell"&gt;
        &lt;a class="popupItem" href="autocomplete?action=lookup&amp;amp;id=12"&gt;Antonin Dvorak&lt;/a&gt;
    &lt;/td&gt;
&lt;/tr&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Динамическое обновление элемента <code>complete-table</code> соответствует последнему этапу потока процесса передачи данных, который выполняется во время обмена данными на основе Ajax. Это обновление соответствует передаче данных HTML и CSS на страницу представления, как показано на приведенной выше <a href="#flow-diagram">блок-схеме</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="displayresults">Отображение результатов</h3>
<div class="paragraph">
<p>Для отображения результатов необходим файл JSP под названием <code>composers.jsp</code> Во время поиска эта страница вызывается из <code>AutoCompleteServlet</code>. Также понадобится файл <code>error.jsp</code>, который вызывается из`AutoCompleteServlet`, если композитор не был обнаружен.</p>
</div>
<div class="paragraph">
<p><strong>Для отображения результатов и ошибок:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В окне 'Проекты' щелкните правой кнопкой мыши папку 'Веб-страницы' приложения и выберите 'Создать' &gt; JSP. Откроется мастер создания JSP.</p>
</li>
<li>
<p>В поле "Имя файла" введите`composer` В поле "Созданный файл" должен появиться путь, который заканчивается файлом <code>/web/composer.jsp</code>.</p>
</li>
<li>
<p>Нажмите кнопку "Завершить". Файл <code>composer.jsp</code> открывается в редакторе. В папке веб-страниц в окне "Проекты" появляется путь к этому файлу.</p>
</li>
<li>
<p>Измените код заглушки в файле <code>composer.jsp</code> следующим кодом:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Composer Information&lt;/title&gt;

    &lt;link rel="stylesheet" type="text/css" href="stylesheet.css"&gt;
  &lt;/head&gt;
  &lt;body&gt;

    &lt;table&gt;
      &lt;tr&gt;
        &lt;th colspan="2"&gt;Composer Information&lt;/th&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;First Name: &lt;/td&gt;
        &lt;td&gt;${requestScope.composer.firstName}&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Last Name: &lt;/td&gt;
        &lt;td&gt;${requestScope.composer.lastName}&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;ID: &lt;/td&gt;
        &lt;td&gt;${requestScope.composer.id}&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Category: &lt;/td&gt;
        &lt;td&gt;${requestScope.composer.category}&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;

    &lt;p&gt;Go back to &lt;a href="index.html" class="link"&gt;application home&lt;/a&gt;.&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Примечание.</strong> Если страница индекса имеет вид  <code>index.jsp</code> , потребуется изменить ссылку для возврата на эту страницу.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Создайте еще один файл JSP в папке с веб-страницами проекта. Назовите файл <code>error.jsp</code>.</p>
</li>
<li>
<p>Измените код заглушки в файле <code>error.jsp</code> следующим кодом:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;!DOCTYPE html&gt;

&lt;html&gt;
    &lt;head&gt;
        &lt;link rel="stylesheet" type="text/css" href="stylesheet.css"&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
        &lt;title&gt;Seach Error&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h2&gt;Seach Error&lt;/h2&gt;

        &lt;p&gt;An error occurred while performing the search. Please try again.&lt;/p&gt;

        &lt;p&gt;Go back to &lt;a href="index.html" class="link"&gt;application home&lt;/a&gt;.&lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Примечание.</strong> Если страница индекса имеет вид  <code>index.jsp</code> , потребуется изменить ссылку для возврата на эту страницу.</p>
</div>
</div>
<div class="sect2">
<h3 id="stylesheet">Присоединение таблицы стилей</h3>
<div class="paragraph">
<p>На данном этапе создан весь код, необходимый для реализации функциональных возможностей приложения. Теперь для проверки результатов следует попытаться запустить приложение.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В окне "Проекты" щелкните правой кнопкой мыши узел проекта и выберите команду "Выполнить". Будет выполнена перекомпиляция проекта и его развертывание на целевом сервере. Откроется браузер, в котором отображается страница-указатель.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/no-css.png" alt="no css">
</div>
<div class="title">Figure 15. Успешное развертывание без таблицы стилей</div>
</div>
<div class="paragraph">
<p>Для добавления таблицы стилей к приложению создайте файл <code>.css</code> и создайте ссылку на него на страницах презентации. При работе с файлами <code>.css</code> IDE предоставляет поддержку функции автозавершения кода, а также следующие окна, которые используются для создания и изменения правил стилей.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Окно 'Стили CSS'.</strong> Окно стилей CSS позволяет редактировать объявления правил для элементов HTML и средств выбора в файле CSS.</p>
</li>
<li>
<p><strong>Диалоговое окно 'Создание правил CSS'.</strong> Диалоговое окно 'Создание правил CSS' позволяет создавать новые правила в таблице стилей CSS.</p>
</li>
<li>
<p>*Диалоговое окно 'Добавить свойство CSS'.*Диалоговое окно 'Добавить свойство CSS' позволяет добавлять объявления к правилу CSS в таблице стилей, добавляя свойства и значения.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Для добавления таблицы стилей к приложению выполните следующие действия.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В окне "Проекты" щелкните правой кнопкой мыши узел проекта и выберите "Создать &gt; Каскадная таблица стилей". Если пункт "Каскадная таблица стилей" отсутствует в списке, выберите "Прочие". Затем выберите "Каскадная таблица стилей" из категории "Web" в мастере создания файла.</p>
</li>
<li>
<p>В текстовом поле 'Имя файла CSS' введите <strong><code>stylesheet</code></strong>. Нажмите кнопку "Завершить".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Новый файл будет создан и открыт в редакторе.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Введите следующие правила <code>stylesheet.css</code> в редакторе. При необходимости просмотра предложений можно использовать поддержку автозавершения кода среды IDE путем нажатия CTRL+ПРОБЕЛ.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">body {
   font-family: Verdana, Arial, sans-serif;
   font-size: smaller;
   padding: 50px;
   color: #555;
   width: 650px;
}

h1 {
   letter-spacing: 6px;
   font-size: 1.6em;
   color: #be7429;
   font-weight: bold;
}

h2 {
   text-align: left;
   letter-spacing: 6px;
   font-size: 1.4em;
   color: #be7429;
   font-weight: normal;
   width: 450px;
}

table {
   width: 550px;
   padding: 10px;
   background-color: #c5e7e0;
}

td {
   padding: 10px;
}

a {
  color: #be7429;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

.popupBox {
  position: absolute;
  top: 170px;
  left: 140px;
}

.popupCell {
   background-color: #fffafa;
}

.popupCell:hover {
  background-color: #f5ebe9;
}

.popupItem {
  color: #333;
  text-decoration: none;
  font-size: 1.2em;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте окно стилей CSS, выбрав 'Окно' &gt; 'Web'&gt; 'Стили CSS'.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/css-styles-window.png" alt="css styles window">
</div>
<div class="title">Figure 16. Окно 'Стили CSS', в котором отображаются свойства правила h1</div>
</div>
<div class="paragraph">
<p>Можно использовать окно 'Стили CSS' для быстрого просмотра свойств и редактирования правил стилей. При выборе правила в верхней панели окна 'Стиль CSS' отображаются свойства правила в нижней панели. Можно добавить CSS правила к таблице стилей, нажав значок 'Изменить правила CSS' (<span class="image"><img src="images/newcssrule.png" alt="newcssrule" title="Значок 'Новое свойство CSS'"></span>) на панели инструментов в верхней панели. Можно изменять правила в нижней панели путем редактирования таблицы свойств и добавления свойств, щелкнув значок 'Добавить свойство' (<span class="image"><img src="images/newcssproperty.png" alt="newcssproperty" title="Значок 'Новое свойство CSS'"></span>) на панели инструментов в нижней панели.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Перейдите на страницу индекса в редакторе исходного кода и добавьте ссылку на страницу стилей между тегами <code>&lt;head&gt;</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;link rel="stylesheet" type="text/css" href="stylesheet.css"&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Добавьте класс <code>popupBox</code>, определенный в таблице стилей, к элементу <code>complete-table</code> (начертание изменится на <strong>жирное</strong>).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;tr&gt;
    &lt;td id="auto-row" colspan="2"&gt;
        &lt;table id="complete-table" *class="popupBox"* /&gt;
    &lt;/td&gt;
&lt;/tr&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Можно использовать функцию автозавершения кода в редакторе для выбора правила стиля, которое требуется применить к средству выбора.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/css-completion.png" alt="css completion">
</div>
<div class="title">Figure 17. Автозавершение кода CSS в редакторе</div>
</div>
<div class="paragraph">
<p>Как указано в <code>stylesheet.css</code>, согласно этому правилу элемент <code>complete-table</code> располагается таким образом, что отображается справа от родительского элемента.</p>
</div>
<div class="paragraph">
<p>При сохранении страницы индекса приложение автоматически повторно развертывается на сервере. Если страница все еще открыта в браузере, можно перезагрузить ее, чтобы увидеть, что страница теперь визуализируется в соответствии с правилами в таблице стилей CSS.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="run">Выполнение проекта</h2>
<div class="sectionbody">
<div class="paragraph">
<p>При повторном запуске приложения текст в браузере отображается с использованием только что созданной таблицы стилей. При каждом вводе символа на сервер передается асинхронный запрос, который возвращается с данными XML, подготовленными при помощи <code>AutoCompleteServlet</code>. При вводе последующих символов количество вариантов имен композиторов уменьшается, и на экране появляется новый список соответствий.</p>
</div>
<div class="sect2">
<h3 id="httpMonitor">Использование средства наблюдения HTTP Server Monitor</h3>
<div class="paragraph">
<p>Можно использовать средство наблюдения HTTP Server Monitor среды IDE для проверки взаимодействия с HTTP, которое заключается в передаче запросов и ответов между клиентским приложением и сервером. В HTTP Server Monitor отображается информация, например, заголовки клиентского приложения и сервера, свойства сеанса, подробные сведения о файлах cookie, а также параметры запроса.</p>
</div>
<div class="paragraph">
<p>Перед началом использования средства HTTP Monitor его следует сначала активировать на используемом сервере.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте окно "Серверы", выбрав в главном меню "Сервис" &gt; "Серверы".</p>
</li>
<li>
<p>На левой панели выберите сервер, который используется для проекта. Затем на правой панели выберите режим "Enable HTTP Monitor".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Примечание.</strong> Этот параметр отображается на вкладке 'Общие' для сервера GlassFish. На сервере Tomcat он расположен на вкладке "Соединение".</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите "Close" (Закрыть).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Если сервер уже запущен, необходимо перезапустить его для применения изменений. Сервер можно перезапустить, открыв окно 'Службы' (Window &gt; 'Службы'), то щелкните правой кнопкой мыши сервер ниже узла 'Серверы' и выберите 'Перезапуск'.</p>
</div>
<div class="paragraph">
<p>Теперь при повторном выполнении приложения в нижней области среды IDE откроется HTTP Monitor. Для просмотра информации относительно каждого запроса можно выбрать запись на левой панели, затем перейти на соответствующие вкладки в главном окне.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/http-monitor.png" alt="http monitor">
</div>
<div class="title">Figure 18. Монитор сервера HTTP отображается в среде IDE</div>
</div>
<div class="paragraph">
<p>Можно проверить данные XML, полученные от сервера в результате асинхронного запроса, переданного при вводе пользователем символа в поле автозавершения.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В представлении дерева на левой стороне монитора HTTP щелкните правой кнопкой мыши запись запроса и выберите 'Воспроизвести'.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ответ генерируется в браузере. В этом случае, поскольку ответ состоит из данных XML, данные в браузере отображаются с использованием собственной программы просмотра XML.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/xml-data.png" alt="xml data">
</div>
<div class="title">Figure 19. Монитор сервера HTTP отображается в среде IDE</div>
</div>
</div>
<div class="sect2">
<h3 id="conclusion">Заключение</h3>
<div class="paragraph">
<p>Это заключительный раздел руководства "Введение в Ajax". Авторы полагают, что к настоящему времени у пользователей сформировалось четкое представление о том, каким образом Ajax поддерживает обмен информацией по HTTP в фоновом режиме и выполняет динамическое обновление страницы на основе полученных результатов.</p>
</div>
<div class="paragraph">
<p>Следует отметить, что разработанное приложение имеет ряд недостатков, например, при выборе имени композитора из поля автозавершения пользователь не получает какого-либо результата. Для получения дополнительных сведений о реализации с использованием технологии JSP <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaScript%252FMyAjaxApp.zip">загрузите проект решения</a>. Кроме того, существует возможность выполнения проверки допустимости на стороне сервера в целях предотвращения запроса пользователем имени, не существующего в хранилище данных. Для более подробного изучения этих функций обратитесь к другим учебным курсам <a href="../../trails/java-ee.html">учебной карты по Java EE &amp;amp; Java Web</a>.</p>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Introduction%20to%20Ajax%20(Java)">Мы ждем ваших отзывов</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="seeAlso">Дополнительные сведения</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Дополнительные сведения о технологиях Ajax и Java приведены в следующих материалах на сайте <a href="https://netbeans.org/">www.netbeans.org</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../../docs/web/js-toolkits-jquery.html">Использование jQuery для улучшения внешнего вида веб-страницы и упрощения работы с ней</a>. Показывает способ интеграции ядра jQuery и библиотек пользовательского интерфейса в проект NetBeans.</p>
</li>
<li>
<p><a href="../../docs/web/js-toolkits-dojo.html">Подключение дерева Dojo к списку ArrayList с помощью JSON</a>. Данный документ основан на практическом примере JavaOne. В нем демонстрируются способы внедрения элемента оформления "Дерево Dojo" в веб-страницу и способы управления реакцией стороны сервера на запросы дерева в формате JSON.</p>
</li>
<li>
<p><a href="http://www.oracle.com/pls/topic/lookup?ctx=nb8000&amp;id=NBDAG2272">Создание файлов JavaScript</a> в документе <em>Разработка приложений в IDE NetBeans</em></p>
</li>
<li>
<p><a href="quickstart-webapps-wicket.html">Введение в веб-платформу Wicket</a>. Введение в процесс создания повторно используемых компонентов и применения их в веб-приложении на основе платформы Wicket.</p>
</li>
</ul>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/ajax-quickstart_ru.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
