
<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Создание приложения JavaServer Faces 2.x CRUD на основе базы данных</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Создание приложения JavaServer Faces 2.x CRUD на основе базы данных - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Создание приложения JavaServer Faces 2.x CRUD на основе базы данных">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
     <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet"> 
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
</head>


    <body>
        

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


        
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 12.3</h1>
            <p><a class="button success" href="/download/nb123/nb123.html">Find out more</a></p>
        </div>
    </div>
</section>

        <div class='grid-container main-content tutorial'>
            <h1 class="sect0">Создание приложения JavaServer Faces 2.x CRUD на основе базы данных</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://issues.apache.org/jira/projects/NETBEANS/issues">open a JIRA issue</a>, 
                     or <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/jsf20-crud_ru.asciidoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
            <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#createDB">Создание базы данных</a></li>
<li><a href="#examineDB">Изучение структуры базы данных</a></li>
<li><a href="#createProject">Создание проекта веб-приложения</a></li>
<li><a href="#generateEntity">Создание классов сущностей из базы данных</a></li>
<li><a href="#jsfPagesEntityClasses">Создание страниц JSF из классов сущностей</a></li>
<li><a href="#explore">Анализ приложения</a>
<ul class="sectlevel2">
<li><a href="#completedProject">Изучение выполненного проекта</a></li>
<li><a href="#populateDB">Заполнение базы данных с помощью сценария SQL</a></li>
<li><a href="#_Поддержка_баз_данных_netbeans">Поддержка баз данных NetBeans</a></li>
<li><a href="#editorSupport">Изучение поддержки редактора на страницах Facelets</a></li>
<li><a href="#dbIntegrity">Изучение целостности базы данных с проверкой поля</a></li>
<li><a href="#editEntity">Правка классов сущностей</a></li>
</ul>
</li>
<li><a href="#troubleshooting">Устранение проблем</a></li>
<li><a href="#seealso">Дополнительные сведения</a>
<ul class="sectlevel2">
<li><a href="#_Статьи_и_учебные_курсы_по_netbeans">Статьи и учебные курсы по NetBeans</a></li>
<li><a href="#_Внешние_ресурсы">Внешние ресурсы</a></li>
<li><a href="#_Блоги">Блоги</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>В этом учебном курсе описывается использование NetBeans IDE для создания веб-приложения, взаимодействующего с серверной базой данных. Приложение предоставляет возможность просмотра и изменения данных, содержащихся в базе данных, другими словами – функциональные возможности <em>CRUD</em> (Create, Read, Update, Delete – создание, чтение, обновление, удаление). Разрабатываемое приложение основывается на следующих технологиях.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JavaServer Faces (JSF) 2.x</strong> для веб-страниц внешнего интерфейса, обработки проверки и управления циклом "запрос-ответ".</p>
</li>
<li>
<p><strong>Интерфейс API сохранения состояния Java (Java Persistence API, JPA) 2.0</strong> с использованием EclipseLink для создания классов сущностей из базы данных и управления транзакциями. (EclipseLink является образцовой реализацией JPA и поставщиком сохранения состояния для сервера GlassFish по умолчанию).</p>
</li>
<li>
<p><strong>Enterprise JavaBeans (EJB) 3.1</strong> – предоставление компонентов EJB без сохранения состояния, которые имеют доступ к классам сущностей и содержат бизнес-логику для приложения.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>В среде IDE предоставляются два мастера для создания всех строк кода приложения. Первый – <a href="#generateEntity">мастер создания классов сущностей из базы данных</a>, позволяющий создавать классы сущностей из предоставленной базы данных. После создания классов сущностей используйте <a href="#jsfPagesEntityClasses">мастер создания страниц JSF из классов сущностей</a> для создания управляемых компонентов JSF и компонентов EJB для классов сущностей, а также набор страниц Facelets для обработки представления данных классов сущностей. Последний раздел руководства <a href="#explore">Анализ приложения</a> является дополнительным. В него включено множество упражнений, помогающих лучше понять приложение и ознакомиться со средой IDE.</p>
</div>
<div class="paragraph">
<p>Для работы с этим учебным курсом требуется программное обеспечение и материалы, перечисленные ниже.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Программное обеспечение или материал</th>
<th class="tableblock halign-left valign-top">Требуемая версия</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">IDE NetBeans</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.2, 7.3, 7.4, 8.0, пакет Java EE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Комплект для разработчика на языке Java (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 или 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://glassfish.dev.java.net/">GlassFish Server Open Source Edition 3.1.2.2</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.x, 4.x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fmysql-consult.zip">mysql-consult.zip</a> (MySQL)
<em>или</em>
<a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fjavadb-consult.zip">javadb-consult.zip</a> (JavaDB)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">неприменимо</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Примечания</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>В комплект Java EE в среде IDE NetBeans также входит сервер GlassFish - сервер, совместимый с Java EE 6, который требуется для этого учебного курса.</p>
</li>
<li>
<p>Для проекта решения в этом учебном курсе загрузите <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FConsultingAgencyJSF20.zip">ConsultingAgencyJSF20.zip</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="createDB">Создание базы данных</h2>
<div class="sectionbody">
<div class="paragraph">
<p>В целях этого руководства используется база данных консультационного агентства с именем <code>consult</code>. Эта база данных не входит в устанавливаемую среду IDE, поэтому перед изучением этого руководства необходимо создать базу данных.</p>
</div>
<div class="paragraph">
<p>База данных <code>consult</code> разработана для демонстрации области поддержки среды IDE для обработки различных структур баз данных. Таким образом, эта база данных не предназначена для использования в качестве рекомендуемого примера разработки базы данных или в качестве практической рекомендации. Тем не менее, в нее включено множество возможностей, которые потенциально требуются при разработке базы данных. Например, база данных <code>consult</code> содержит все возможные типы отношений, составные первичные ключи и многие другие типы данных. Подробный обзор структуры базы данных приведен в таблице ниже.</p>
</div>
<div class="paragraph">
<p><strong>Примечания:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>В данном учебном курсе используется сервер базы данных MySQL, однако для работы с этим учебным руководством можно также использовать сервер базы данных JavaDB. Чтобы создать базу данных в JavaDB, загрузите и извлеките архив <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fjavadb-consult.zip">javadb-consult.zip</a>. Архив содержит сценарии SQL для создания, удаления и заполнения базы данных <code>consult</code>.</p>
</li>
<li>
<p>Для получения дополнительной информации о настройке среды IDE для работы с MySQL см. учебный курс <a href="../ide/mysql.html">Подключение к базе данных MySQL</a>.</p>
</li>
<li>
<p>Дополнительные сведения о настройке среды IDE для работы с JavaDB приведены в учебном курсе <a href="../ide/java-db.html">Работа с базой данных Java DB (Derby)</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Сочетание MySQL с GlassFish:</strong></p>
</div>
<div class="paragraph">
<p>При использовании сервера баз данных MySQL и вместе с ним GlassFish версии 3 или Open Source Edition версии 3.0.1 необходимо убедиться, что база данных защищена паролем. (Дополнительную информацию можно получить в описании <a href="https://java.net/jira/browse/GLASSFISH-12221">Issue 12221</a> (проблема 12221) сервера GlassFish.) При использовании учетной записи MySQL <code>root</code> по умолчанию с пустым паролем с помощью командной строки можно установить другой пароль.</p>
</div>
<div class="paragraph">
<p>К примеру, чтобы установить пароль к <code><em>nbuser</em></code>, необходимо в командную строку ввести следующие команды.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">shell&gt; mysql -u root
mysql&gt; UPDATE mysql.user SET Password = PASSWORD('_nbuser_') WHERE User = 'root';
mysql&gt; FLUSH PRIVILEGES;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если в ответ получена ошибка &#8220;mysql: command not found&#8221; (mysql: не найдена команда), это означает, что команда <code>mysql</code> не была добавлена в переменную среды <code>PATH</code>. Вместо этого команду можно вызвать, выбрав полный путь к установочному каталогу MySQL <code>bin</code>. Например, если команда <code>mysql</code> находится на компьютере по пути <code>/usr/local/mysql/bin</code>, выберите следующее:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">shell&gt; /usr/local/mysql/bin/mysql -u root</code></pre>
</div>
</div>
<div class="paragraph">
<p>Дополнительные сведения приведены в официальном справочном руководстве по MySQL:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://dev.mysql.com/doc/refman/5.1/en/default-privileges.html">+Обеспечение защиты начальных счетов MySQL +</a></p>
</li>
<li>
<p><a href="http://dev.mysql.com/doc/refman/5.1/en/invoking-programs.html">4.2.1. Invoking MySQL Programs ("Вызов программ MySQL")</a></p>
</li>
<li>
<p><a href="http://dev.mysql.com/doc/refman/5.1/en/setting-environment-variables.html">4.2.4. Setting Environment Variables ("Настройка переменных среды")</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Для создания базы данных и подключения к ней из среды IDE выполните следующие действия.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Загрузите <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252Fmysql-consult.zip">mysql-consult.zip</a> и извлеките архив в локальную систему. В результате извлечения архива появятся сценарии SQL для создания и заполнения базы данных. Архив также содержит сценарии для перетаскивания таблиц.</p>
</li>
<li>
<p>В окне 'Службы' разверните узел Databases, щелкните правой кнопкой мыши узел MySQL и выберите 'Запустить сервер'.</p>
</li>
<li>
<p>Щелкните правой кнопкой мыши узел "MySQL Server" и выберите "Create Database".</p>
</li>
<li>
<p>В диалоговом окне "Создание базы данных MySQL" введите <strong>consult</strong> в поле "Имя базы данных". Нажмите кнопку "ОК". Под узлом "Базы данных" появится новый узел (<code>jdbc:mysql://localhost:3306/consult [корень в схеме по умолчанию]</code>).</p>
</li>
<li>
<p>Правой кнопкой мыши щелкните новый узел и выберите "Подключить".</p>
</li>
<li>
<p>В основном меню выберите "Файл &gt; Открыть файл" и перейдите к извлеченному файлу <code>mysql_create_.sql</code>. Нажмите кнопку Open ("Открыть"). Файл автоматически откроется в редакторе SQL.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/run-sql-script.png" alt="run sql script">
</div>
<div class="title">Figure 1. Откройте файлы SQL в редакторе IDE</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Убедитесь, что база данных <code>consult</code> выбрана в раскрывающемся списке "Соединение" на панели инструментов редактора SQL, затем нажмите кнопку 'Выполнить SQL' ( <span class="image"><img src="images/run-sql-btn.png" alt="run sql btn"></span> ).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>После нажатия кнопки "Запустить SQL" в окне вывода появятся следующие выходные данные.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/run-sql-output.png" alt="run sql output">
</div>
<div class="title">Figure 2. Окно вывода, в котором указываются сведения о выполнении SQL</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examineDB">Изучение структуры базы данных</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Чтобы убедиться в том, что таблицы созданы правильно, разверните узел "Таблицы" под узлом подключения к базе данных. В развернутом узле таблицы можно посмотреть столбцы, индексы и внешние ключи. Для просмотра дополнительных сведений о столбце щелкните правой кнопкой мыши и выберите 'Свойства'.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/services-window-tables.png" alt="services window tables">
</div>
<div class="title">Figure 3. В окне 'Службы' отображаются подключения к базам данных, таблицы, столбцы таблиц, индексы и внешние ключи</div>
</div>
<div class="paragraph">
<p><strong>Примечание.</strong> Если таблицы не отображаются в узле 'Таблицы', щелкните правой кнопкой мыши узел 'Таблицы' и выберите 'Обновить'.</p>
</div>
<div class="paragraph">
<p>Анализ структуры базы данных <code>consult</code> позволяет установить, что база данных содержит таблицы с множеством отношений и различными типами полей. При создании классов сущностей в базе данных в среде IDE автоматически создается соответствующий код для различных типов полей.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/diagram_consult.png" alt="diagram consult">
</div>
<div class="title">Figure 4. Диаграмма связей сущностей базы данных consult</div>
</div>
<div class="paragraph">
<p>В следующей таблице представлено описание таблиц, обнаруженных в базе данных <code>consult</code>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Таблица базы данных</th>
<th class="tableblock halign-left valign-top">Описание</th>
<th class="tableblock halign-left valign-top">Функции разработки</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Клиент консультационного агентства</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Несгенерированный составной первичный ключ (поля которого не являются частью внешнего ключа)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Сотрудник консультационного агентства, которого могут нанять клиенты на контрактной основе.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Включает в себя поле резюме типа LONG VARCHAR.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT_STATUS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Состояние консультанта в консультационном агентстве (пример возможных состояний: "Активно" и "Неактивно").</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Несгенерированный первичный ключ типа CHAR.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RECRUITER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Сотрудник консультационного агентства, ответственный за установление связи между клиентами и консультантами.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROJECT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Проект, под который клиент укомплектовывает штат консультантами консультационного агентства.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Несгенерированный составной первичный ключ, который содержит два поля, составляющие внешний ключ для таблицы CLIENT.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BILLABLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Количество часов, отработанных консультантом над проектом, которые консультационное агентство выставляет в счете на оплату соответствующему клиенту.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Включает в себя поле артефакта типа CLOB.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADDRESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Адрес для выставления счета клиенту.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROJECT_CONSULTANT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Таблица перекрестных ссылок, определяющая текущие присвоения консультантов проектам.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Перекрестные ссылки PROJECT и CONSULTANT, при этом последней соответствует составной первичный ключ.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>База данных <code>consult</code> имеет множество отношений. При создании классов сущностей из базы данных в среде IDE автоматически создаются свойства соответствующего типа Java на основе типа SQL столбцов. Следующая таблица описывает отношения сущностей для базы данных <code>consult</code> (обратные отношения не отображаются).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Сущность</th>
<th class="tableblock halign-left valign-top">Связанная сущность</th>
<th class="tableblock halign-left valign-top">Информация об отношениях</th>
<th class="tableblock halign-left valign-top">Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RECRUITER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">нулевое, "один к одному", с правкой вручную; нулевое, "один ко многим", если без правки.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT соответствует несколько RECRUITER, а RECRUITER соответствует нуль или один CLIENT (если без правки вручную).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADDRESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ненулевое, "один к одному".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT соответствует один ADDRESS, а ADDRESS соответствует нуль или один CLIENT.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROJECT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ненулевое, "один ко многим"; в сущности "Проект" значение поля клиента является частью первичного ключа проекта.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT соответствует несколько PROJECT, а PROJECT соответствует один CLIENT.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROJECT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"многие ко многим".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT соответствует несколько PROJECT, а PROJECT соответствует несколько CONSULTANT.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BILLABLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ненулевое, "один ко многим".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT соответствует несколько BILLABLE, а BILLABLE соответствует один CONSULTANT.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT_STATUS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ненулевое, "один ко многим".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT_STATUS соответствует несколько CONSULTANT, а CONSULTANT соответствует один CONSULTANT_STATUS.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RECRUITER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">нулевое, "один ко многим".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSULTANT соответствует нуль или одного RECRUITER, а RECRUITER соответствует несколько CONSULTANT.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BILLABLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROJECT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ненулевое, "один ко многим".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BILLABLE соответствует один PROJECT, а PROJECT соответствует несколько BILLABLE.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Теперь, после создания базы данных, можно создать веб-приложение и использовать мастер создания классов сущностей из базы данных для создания классов сущностей на основе таблиц баз данных.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="createProject">Создание проекта веб-приложения</h2>
<div class="sectionbody">
<div class="paragraph">
<p>В этом упражнении будет создан веб-проект и добавлена платформа JavaServer Faces к проекту. При создании проекта выбираем JavaServer Faces на панели "Платформы" мастера создания проекта.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите "Файл &gt; Новый проект" (CTRL+SHIFT+N; &amp;#8984+SHIFT+N в Mac ОС) в главном меню.</p>
</li>
<li>
<p>Выберите "Веб-приложение" в категории "Java Web". Нажмите кнопку "Далее".</p>
</li>
<li>
<p>Введите <code>ConsultingAgency</code> в качестве имени проекта и укажите местоположение проекта. Нажмите кнопку "Далее".</p>
</li>
<li>
<p>Укажите GlassFish в качестве сервера и Java 6 Web или Java EE 7 Web в качестве версии Java EE. Нажмите кнопку "Далее".</p>
</li>
<li>
<p>На панели "Платформы" выберите параметр JavaServer Faces. Нажмите кнопку "Завершить".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При нажатии кнопки "Готово" в среде IDE будет создан проект веб-приложения и открыт <code>index.xhtml</code> в редакторе.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="generateEntity">Создание классов сущностей из базы данных</h2>
<div class="sectionbody">
<div class="paragraph">
<p>После подключения к базе данных в среде IDE можно использовать мастер создания классов сущностей из базы данных для быстрого создания классов сущностей на основе таблиц в базе данных. В среде IDE можно создавать классы сущностей для каждой выбранной таблицы, а также создавать любые классы сущностей для соответствующих таблиц.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В окне 'Проекты' щелкните правой кнопкой мыши узел проекта <code>ConsultingAgency</code> и выберите 'Создать' &gt; 'Классы сущностей' в базе данных. Если данная команда отсутствует, выберите пункт "Прочие". После этого в мастере создания файла выберите категорию "Сохранение состояния", а затем - пункт "Классы сущностей из базы данных".</p>
</li>
<li>
<p>Для открытия диалогового окна "Создание источника данных" в раскрывающемся списке "Источник данных" выберите "Новый источник данных".</p>
</li>
<li>
<p>В поле "Имя JNDI" введите <code>jdbc/consult</code> и выберите подключение <code>jdbc:mysql://localhost:3306/consult</code> в списке "Подключение к базе данных".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/create-datasource.png" alt="create datasource">
</div>
<div class="title">Figure 5. Укажите имя JNDI и соединение с базой данных для создания источника данных</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "ОК" для закрытия диалогового окна и возврата в мастер. Таблицы базы данных <code>consult</code> выводятся в окне списка "Доступные таблицы".</p>
</li>
<li>
<p>Для выбора всех таблиц, имеющихся в базе данных, нажмите кнопку "Добавить все". Нажмите кнопку "Далее".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new-entities-wizard.png" alt="new entities wizard">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Введите <code>jpa.entities</code> в качестве имени пакета.</p>
</li>
<li>
<p>Убедитесь, что установлены оба флажка — и создания именованных запросов, и создания блоков сохранения состояния. Нажмите кнопку "Завершить".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При нажатии кнопки "Готово" среда IDE создает классы сущностей в пакете проекта <code>jpa.entities</code>.</p>
</div>
<div class="paragraph">
<p>При использовании мастера создания классов сущностей из базы данных в среде IDE проверяются отношения между таблицами базы данных. В окне 'Проекты' при развертывании узла проекта <code>jpa.entities</code> можно увидеть, что в IDE создан класс сущности для всех таблиц, кроме таблицы <code>PROJECT_CONSULTANT</code>. В среде IDE класс сущностей для таблицы <code>PROJECT_CONSULTANT</code> не создан, так как она является таблицей перекрестных ссылок.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/projects-window-entities.png" alt="projects window entities">
</div>
<div class="title">Figure 6. снимок окна 'Проекты', в котором отображаются созданные классы сущностей</div>
</div>
<div class="paragraph">
<p>В среде IDE также создано два дополнительных класса для таблиц с составными первичными ключами: <code>CLIENT</code> и <code>PROJECT</code>. К именам классов первичных ключей для этих таблиц (<code>ClientPK.java</code> и <code>ProjectPK.java</code>) добавлено <code>PK</code>.</p>
</div>
<div class="paragraph">
<p>При просмотре созданного кода для классов сущностей можно отметить, что мастером добавлены аннотации <code>@GeneratedValue</code> к автоматически созданным полям ID и аннотации <code>@Basic(optional = "false")</code> к полям в классах сущностей. На основе аннотаций <code>@Basic(optional = "false")</code> мастер создания страниц JSF из классов сущностей способен создавать код с блоками проверок для предотвращения нарушений в ненулевых столбцах для этих полей.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jsfPagesEntityClasses">Создание страниц JSF из классов сущностей</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Теперь, после создания классов сущностей, можно создать веб-интерфейс для отображения и изменения данных. Для создания страниц JavaServer Faces используется страницы JSF мастера создания классов сущностей. Код, созданный мастером, основан на аннотациях сохранения состояния, содержащихся в классах сущностей.</p>
</div>
<div class="paragraph">
<p>Для каждого класса сущностей мастер создает следующие файлы.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>сеансный компонент без сохранения состояния, расширяющий  <code>AbstractFacade.java</code></p>
</li>
<li>
<p>управляемый компонент JSF в контексте сеанса;</p>
</li>
<li>
<p>каталог, содержащий четыре файла Facelets возможностей CRUD (<code>Create.xhtml</code>, <code>Edit.xhtml</code>, <code>List.xhtml</code> и <code>View.xhtml</code>);</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Мастер также создает следующие файлы.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>класс  <code>AbstractFacade.java</code> , содержащий бизнес-логику для создания, извлечения, изменения и удаления экземпляров сущностей</p>
</li>
<li>
<p>служебные классы, используемые управляемыми компонентами JSF (<code>JsfUtil</code>, <code>PaginationHelper</code>);</p>
</li>
<li>
<p>набор свойств для локализованных сообщений и соответствующая запись в файле настройки Faces проекта (создается файл <code>faces-config.xml</code>, если он на данный момент отсутствует);</p>
</li>
<li>
<p>вспомогательные веб-файлы, включая стандартную таблицу стилей для отображения компонентов и файл шаблона Facelets.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Чтобы создать страницу JSF, выполните следующие действия:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В окне 'Проекты' щелкните правой кнопкой мыши узел проекта и выберите 'Создать' &gt; 'Страницы JSF' в 'Классы сущностей', чтобы открыть мастер. Если данная команда отсутствует, выберите пункт "Прочие". После этого в мастере создания файла выберите категорию "JavaServer Faces", затем "Страницы JSF из классов сущностей".)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>В окне "Доступные классы сущностей" выводится список из семи классов сущностей, имеющихся в этом проекте. В окне не выводятся встраиваемые классы (<code>ClientPK.java</code> и <code>ProjectPK.java</code>).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "Добавить все" для переноса всех классов в окно "Выбранные классы сущностей".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/newjsf-wizard.png" alt="newjsf wizard">
</div>
<div class="title">Figure 7. В мастере создания страниц JSF из классов сущностей отображаются все классы сущностей, содержащиеся в проекте</div>
</div>
<div class="paragraph">
<p>Нажмите кнопку "Далее".</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>На третьем экране мастера "Создание страниц JSF и классов" в поле "Пакет сеансного компонента JPA" введите <code>jpa.session</code>.</p>
</li>
<li>
<p>В поле "Пакет классов JSF" введите <code>jsf</code>.</p>
</li>
<li>
<p>В поле "Имя набора локализаций" введите &#8220;/resources/Bundle&#8221;. Будет создан пакет с именем <code>resources</code>, в который входит файл <code>Bundle.properties</code>. (Если поле оставить пустым, набор свойств будет создан в пакете проекта по умолчанию.)</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/newjsf-wizard2.png" alt="newjsf wizard2">
</div>
<div class="title">Figure 8. Укажите имена пакетов и папок для созданных файлов</div>
</div>
<div class="paragraph">
<p>Для оптимизации правил проекта в среде IDE настройте файлы, созданные в мастере. Для изменения шаблонов, используемых в мастере, щелкните ссылку "Настройка шаблона".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/customize-template.png" alt="customize template">
</div>
<div class="title">Figure 9. Настройка шаблонов для файлов, созданных мастером</div>
</div>
<div class="paragraph">
<p>В целом, для вызова и изменения всех шаблонов, поддерживаемых в среде IDE, используйте диспетчер шаблонов ("Сервис" &gt; "Шаблоны").</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "Завершить". В среде IDE создаются сеансные компоненты без сохранения состояния в пакете <code>jpa.session</code> и управляемые компоненты JSF в контексте сеанса в пакете <code>jsf</code>. Каждый сеансный компонент без сохранения состояния обрабатывает операции для соответствующего класса сущностей, включая создание, правку и удаление экземпляров класса сущностей, с помощью интерфейса Java Persistence API. Каждый управляемый компонент JSF реализует интерфейс <code>javax.faces.convert.Converter</code> и играет роль экземпляров преобразования соответствующего класса сущностей в объекты <code>String</code> и наоборот.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При развертывании узла "Веб-страницы" можно отметить, что в среде IDE была создана папка для каждого класса сущностей. Каждая папка содержит файлы <code>Create.xhtml</code>, <code>Edit.xhtml</code>, <code>List.xhtml</code> и <code>View.xhtml</code>. В среде IDE также изменен файл <code>index.xhtml</code> посредством вставки ссылок на каждую из страниц <code>List.xhtml</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/projects-jsfpages.png" alt="projects jsfpages">
</div>
<div class="title">Figure 10. Страницы Facelets для всех классов сущностей создаются мастером</div>
</div>
<div class="paragraph">
<p>Каждый управляемый компонент JSF относится к четырем соответствующим файлам Facelets и содержит код, вызывающий методы в соответствующем сеансном компоненте.</p>
</div>
<div class="paragraph">
<p>Разверните узел папки <code>resources</code> для поиска таблицы стилей по умолчанию <code>jsfcrud.css</code>, созданной в мастере. При открытии страницы приветствия приложения (<code>index.xhtml</code>) или файла шаблона Facelets (<code>template.xhtml</code>) в редакторе отобразится ссылка на таблицу стилей.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">&lt;h:outputStylesheet name="css/jsfcrud.css"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Файл шаблона Facelets используется в каждом из четырех файлов Facelets для каждого класса сущностей.</p>
</div>
<div class="paragraph">
<p>При развертывании узла "Пакеты с исходными файлами" отображаются сеансные компоненты, управляемые компоненты JSF, служебные классы и набор свойств, созданные мастером.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/projects-generated-classes70.png" alt="projects generated classes70">
</div>
<div class="title">Figure 11. снимок каталога 'Исходные пакеты' в окне 'Проекты', в котором отображаются созданные мастером классы сущностей</div>
</div>
<div class="paragraph">
<p>Также мастером был создан файл настройки Faces (<code>faces-config.xml</code>) для регистрации местоположения набора свойств. При развертывании узла "Файлы настройки" и открытии <code>faces-config.xml</code> в редакторе XML отобразится следующая запись.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;application&gt;
    &lt;resource-bundle&gt;
        &lt;base-name&gt;/resources/Bundle&lt;/base-name&gt;
        &lt;var&gt;bundle&lt;/var&gt;
    &lt;/resource-bundle&gt;
&lt;/application&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Кроме того, при развертывании нового пакета <code>resources</code> отображается файл <code>Bundle.properties</code>, содержащий сообщения для языка клиента по умолчанию. Сообщения произведены из свойств класса сущностей.</p>
</div>
<div class="paragraph">
<p>Для добавления нового комплекта свойств щелкните правой кнопкой файл <code>Bundle.properties</code> и выберите 'Настройка'. В диалоговом окне "Средство настройки" можно добавить к приложению новые локали.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="explore">Анализ приложения</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Теперь, при наличии в проекте классов сущностей, сеансных компонентов EJB для управления классами сущностей и внешнего интерфейса на основе JSF для отображения и изменения базы данных, попробуйте выполнить проект и посмотрите результаты.</p>
</div>
<div class="paragraph">
<p>Ниже приведены несколько коротких дополнительных упражнений, которые помогут лучше узнать приложение, а также возможности и функции среды IDE.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#completedProject">Изучение выполненного проекта</a></p>
</li>
<li>
<p><a href="#populateDB">Заполнение базы данных с помощью сценария SQL</a></p>
</li>
<li>
<p><a href="#editorSupport">Изучение поддержки редактора на страницах Facelets</a></p>
</li>
<li>
<p><a href="#dbIntegrity">Изучение целостности базы данных с проверкой поля</a></p>
</li>
<li>
<p><a href="#editEntity">Правка классов сущностей</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="completedProject">Изучение выполненного проекта</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Для запуска проекта щелкните правой кнопкой мыши узел проекта в окне 'Проекты' и выберите 'Запустить' или нажмите кнопку 'Запустить проект' ( <span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span> ) на главной панели инструментов.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При отображении страницы приветствия приложения выводится список ссылок, позволяющих просмотреть записи, которые включены в каждую таблицу базы данных.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/welcome-page-links.png" alt="welcome page links">
</div>
<div class="title">Figure 12. Ссылки для отображения содержимого баз данных для всех таблиц</div>
</div>
<div class="paragraph">
<p>После завершения выполнения всех шагов мастера создания страниц JSF из классов сущностей ссылки добавлены на страницу приветствия (<code>index.xhtml</code>). Они представлены в качестве точек входа на страницы Facelets, обеспечивающие функциональность CRUD в базе данных "Консультационное агентство".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;h:body&gt;
    Hello from Facelets
    &lt;h:form&gt;
        &lt;h:commandLink action="/address/List" value="Show All Address Items"/&gt;
    &lt;/h:form&gt;
    &lt;h:form&gt;
        &lt;h:commandLink action="/billable/List" value="Show All Billable Items"/&gt;
    &lt;/h:form&gt;
    &lt;h:form&gt;
        &lt;h:commandLink action="/client/List" value="Show All Client Items"/&gt;
    &lt;/h:form&gt;
    &lt;h:form&gt;
        &lt;h:commandLink action="/consultant/List" value="Show All Consultant Items"/&gt;
    &lt;/h:form&gt;
    &lt;h:form&gt;
        &lt;h:commandLink action="/consultantStatus/List" value="Show All ConsultantStatus Items"/&gt;
    &lt;/h:form&gt;
    &lt;h:form&gt;
        &lt;h:commandLink action="/project/List" value="Show All Project Items"/&gt;
    &lt;/h:form&gt;
    &lt;h:form&gt;
        &lt;h:commandLink action="/recruiter/List" value="Show All Recruiter Items"/&gt;
    &lt;/h:form&gt;
&lt;/h:body&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните ссылку &#8220;Показать все элементы консультантов&#8221;. При анализе приведенного выше кода можно отметить, что целевая страница – <code>/consultant/List.xhtml</code>. (В JSF 2.x расширение файла является предполагаемым из-за неявного перехода.)</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/empty-consultants-list.png" alt="empty consultants list">
</div>
<div class="title">Figure 13. Таблица 'Consultants' в настоящее вермя пуста</div>
</div>
<div class="paragraph">
<p>Текущая база данных не содержит данные примера. Данные можно добавить вручную посредством нажатия ссылки &#8220;Create New Consultant&#8221; и использования предоставленной веб-формы. При этом инициируется отображение страницы <code>/consultant/Create.xhtml</code>. Для заполнения таблиц данными примера также можно выполнить сценарий SQL в среде IDE. В следующих подразделах рассматриваются оба эти варианта.</p>
</div>
<div class="paragraph">
<p>Для возврата к списку ссылок на странице приветствия щелкните индексную ссылку. По ссылкам открывается представление данных, хранящихся в каждой таблице базы данных, и инициируется файл <code>List.xhtml</code> для каждой отображаемой папки сущностей. Как будет показано ниже, после внесения данных в таблицу появятся другие ссылки для каждой записи, с помощью которых можно просматривать (<code>View.xhtml</code>), править (<code>Edit.xhmtl</code>) и удалять данные отдельной записи таблицы.</p>
</div>
<div class="paragraph">
<p><strong>Примечание.</strong> Если при развертывании приложения произойдет ошибка, см. раздел <a href="#troubleshooting">устранение неполадок</a>. (См. также статью об устранении неполадок в разделе <a href="mysql-webapp.html#troubleshoot">Создание простого веб-приложения с помощью базы данных MySQL</a>.)</p>
</div>
</div>
<div class="sect2">
<h3 id="populateDB">Заполнение базы данных с помощью сценария SQL</h3>
<div class="paragraph">
<p>Запустите предоставленный сценарий, создающий данные примера для таблиц базы данных. Сценарий (<code>mysql_insert_data_consult.sql</code>) включен в файл ZIP "База данных консультационного агентства", который можно загрузить из <a href="#requiredSoftware">таблицы требуемого программного обеспечения</a>.</p>
</div>
<div class="paragraph">
<p>В зависимости от сервера базы данных, с которым вы работаете (MySQL или JavaDB), можно выполнить запуск предоставленного сценария, создающего данные примера для таблиц базы данных. Для MySQL таким сценарием является <code>mysql_insert_data_consult.sql</code>. Для JavaDB таким сценарием является <code>javadb_insert_data_consult.sql</code>. Оба сценария включены в соответствующие архивы, которые можно загрузить из <a href="#requiredSoftware">таблицы требуемого программного обеспечения</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите в основном меню "Файл" &gt; "Открыть файл", затем перейдите к папке сценария на компьютере. Нажмите кнопку Open ("Открыть"). Файл автоматически открывается в редакторе SQL среды IDE.</p>
</li>
<li>
<p>Убедитесь, что база данных <code>consult</code> выбрана в раскрывающемся списке "Соединение" на панели инструментов редактора SQL.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/run-sql-insert.png" alt="run sql insert">
</div>
<div class="title">Figure 14. Откройте сценарий в редакторе SQL в IDE</div>
</div>
<div class="paragraph">
<p>Щелкните правой кнопкой мыши в редакторе и выберите 'Запустить оператор' или нажмите кнопку 'Запустить SQL' ( <span class="image"><img src="images/run-sql-btn.png" alt="run sql btn"></span> ). Результаты выполнения сценария отображаются в окне вывода.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Перезапустите сервер приложений GlassFish. Это необходимо для перезагрузки и кэширования новых данных при помощи сервера, содержащихся в базе данных <code>consult</code>. Чтобы это сделать, перейдите на вкладку 'Сервер GlassFish' в окне вывода (на вкладке 'Сервер GlassFish' отображается журнал сервера). Затем нажмите кнопку 'Перезапустить сервер' в левом поле ( <span class="image"><img src="images/glassfish-restart.png" alt="glassfish restart"></span> ). Сервер остановится, затем перезапустится.</p>
</li>
<li>
<p>Выполните проект еще раз и щелкните ссылку &#8220;Показать все элементы консультантов&#8221;. Теперь можно заметить, что список больше не пуст.</p>
</li>
</ol>
</div>
<div class="openblock">
<div class="content">
<div class="imageblock left">
<div class="content">
<a class="image" href="images/consultants-list.png"><img src="images/consultants-list-small.png" alt="consultants list small"></a>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_Поддержка_баз_данных_netbeans">Поддержка баз данных NetBeans</h3>
<div class="paragraph">
<p>Можно использовать средство просмотра для таблиц базы данных в среде IDE, чтобы отображать и изменять данные таблиц, управляемые непосредственно в базе данных. Например, щелкните правой кнопкой мыши таблицу <code>consultant</code> в окне 'Службы' и выберите 'Просмотреть данные'.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/view-data.png" alt="view data">
</div>
<div class="title">Figure 15. В контекстном меню таблиц баз данных выберите 'Просмотреть данные'</div>
</div>
<div class="paragraph">
<p>Запрос SQL, который используется для выполнения действий, отображается в верхней части редактора, а графическое представление таблицы помещено ниже.</p>
</div>
<div class="openblock feature">
<div class="content">
<div class="imageblock left">
<div class="content">
<a class="image" href="images/view-data-table.png"><img src="images/view-data-table-small.png" alt="view data table small"></a>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Дважды щелкните ячейки таблицы для выполнения внутристрочных изменений данных. Щелкните значок 'Фиксировать записи' ( <span class="image"><img src="images/commit-records-icon.png" alt="commit records icon"></span> ) для фиксации изменений базы данных.</p>
</div>
<div class="paragraph">
<p>Графическое представление обеспечивает большую функциональность. Дополнительные сведения см. в разделе <a href="../../docs/ide/database-improvements-screencast.html">Поддержка баз данных в IDE NetBeans</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="editorSupport">Изучение поддержки редактора на страницах Facelets</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте страницу <code>/consultant/List.xhtml</code> в редакторе. В строке 8 указывается, что визуализация страницы зависит от файла <code>template.xhtml</code> Facelets.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">&lt;ui:composition template="/template.xhtml"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы отобразить номера строк, щелкните правой кнопкой мыши на левой границе редактора и выберите 'Показать номера строк'.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>С помощью диалогового окна "Переход к файлу" в среде IDE откройте файл <code>template.xhtml</code>. Нажмите сочетание клавиш ALT+SCHIFT+O (CTRL+SHIFT+O в Mac), затем введите <code>template</code>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/go-to-file.png" alt="go to file">
</div>
<div class="title">Figure 16. С помощью диалогового окна &quot;Переход к файлу&quot; быстро откройте файлы проекта</div>
</div>
<div class="paragraph">
<p>Нажмите кнопку "ОК" (или нажмите ENTER).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В шаблоне применяются теги <code>&lt;ui:insert&gt;</code> для вставки содержимого из других файлов в заголовок и тело. Установите курсор на тег <code>&lt;ui:insert&gt;</code>, затем нажмите сочетание клавиш CTRL+ПРОБЕЛ для вызова всплывающего окна документации.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/doc-popup.png" alt="doc popup">
</div>
<div class="title">Figure 17. Нажмите сочетание клавиш CTRL+ПРОБЕЛ для вызова всплывающего окна документации в тегах Facelets</div>
</div>
<div class="paragraph">
<p>Для вызова всплывающего окна документации можно нажать сочетание клавиш CTRL+ПРОБЕЛ, установив курсор на тегах JSF и соответствующих атрибутах. Отображаемая документация взята из описаний, предоставленных в официальной <a href="http://javaserverfaces.java.net/nonav/docs/2.1/vdldocs/facelets/index.html">Документации о библиотеке тегов JSF</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Вернитесь к файлу <code>List.xhtml</code> (нажмите CTRL+TAB). Теги <code>&lt;ui:define&gt;</code> используются для определения содержимого, которое применяется в заголовке и теле шаблона. Этот шаблон используется для всех четырех файлов Facelets (<code>Create.xhtml</code>, <code>Edit.xhtml</code>, <code>List.xhtml</code> и <code>View.xhtml</code>), созданных для каждого класса сущностей.</p>
</li>
<li>
<p>Установите курсор на одном из выражений на языке выражений, используемых для локализованных сообщений, содержащихся в файле <code>Bundle.properties</code>. Для просмотра локализованного сообщения нажмите сочетание клавиш CTRL+ПРОБЕЛ.</p>
</li>
</ol>
</div>
<div class="openblock">
<div class="content">
<div class="imageblock left">
<div class="content">
<a class="image" href="images/localized-messages.png"><img src="images/localized-messages-small.png" alt="localized messages small"></a>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>На приведенном выше изображении можно заметить, что выражение на языке выражений разрешено в списке &#8220;List&#8221;, который применяется для заголовка шаблона и проверяется из отображаемой в браузере страницы.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выполните прокрутку до конца файла и найдите код для ссылки <code>Create New Consultant</code> (строка 92). Это выглядит следующим образом:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">&lt;h:commandLink action="#{consultantController.prepareCreate}" value="#{bundle.ListConsultantCreateLink}"/&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Для вызова всплывающего окна документации нажмите сочетание клавиш CTRL+ПРОБЕЛ на атрибуте <code>action</code> для <code>commandLink</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Атрибут <code>action</code> указывает на метод, обрабатывающий запрос при щелчке ссылки в браузере. Предоставлена следующая документация:</p>
</div>
<div class="paragraph">
<p><em>Компонент MethodExpression определяет вызываемую операцию приложения при его активации пользователем. Выражение должно определять общедоступный метод, который не принимает параметры и возвращает объект (метод toString() которого вызывается для получения логического результата), передаваемый в NavigationHandler для этого приложения.</em>
Другими словами, значение <code>action</code> обычно относится к методу в управляемом компоненте JSF, который имеет значение <code>String</code>. Затем строка используется в <code>NavigationHandler</code> JSF для передачи запроса в соответствующее представление. Проверка этого осуществляется при выполнении следующих действий.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Установите курсор на <code>consultantController</code> и нажмите сочетание клавиш CTRL+ПРОБЕЛ. Функция автозавершения кода в редакторе указывает на то, что <code>consultantController</code> является управляемым компонентом JSF.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/code-completion-managed-bean.png" alt="code completion managed bean">
</div>
<div class="title">Figure 18. Автозавершение кода обеспечено для управляемых компонентов JSF</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Переместите курсор на <code>prepareCreate</code> и нажмите сочетание клавиш CTRL+ПРОБЕЛ. При вызове функции автозавершения кода выводится список методов, содержащихся в управляемом компоненте <code>ConsultantController</code>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/code-completion-properties.png" alt="code completion properties">
</div>
<div class="title">Figure 19. Автозавершение кода обеспечено для методов классов</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите CTRL (&amp;#8984 в Mac), затем наведите указатель мыши на <code>prepareCreate</code>. Будет создана ссылка, с помощью которой можно перейти непосредственно к методу <code>prepareCreate()</code> в управляемом компоненте <code>ConsultantController</code>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/editor-navigation.png" alt="editor navigation">
</div>
<div class="title">Figure 20. Используйте навигацию в редакторе для быстрого перехода по исходному коду</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните ссылку и просмотрите метод <code>prepareCreate()</code> (отображаемый ниже).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public String prepareCreate() {
    current = new Consultant();
    selectedItemIndex = -1;
    return "Create";
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Метод возвращает <code>Create</code>. Метод <code>NavigationHandler</code> собирает информацию в фоновом режиме и применяет строку <code>Create</code> в пути для открытия представления, отправленного в ответ на запрос: <code>/consultant/<strong>Create</strong>.xhtml</code>. (В JSF 2.x расширение файла является предполагаемым из-за неявного перехода.)</p>
</div>
</div>
<div class="sect2">
<h3 id="dbIntegrity">Изучение целостности базы данных с проверкой поля</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>На <a href="#consultantsList">странице "Consultants List"</a> в браузере щелкните ссылку &#8220;Create New Consultant&#8221;. Как показано в предыдущем подразделе, это инициирует визуализацию страницы <code>/consultant/Create.xhtml</code>.</p>
</li>
<li>
<p>Введите в форму следующие подробные сведения. На данный момент оставьте оба поля <code>RecruiterId</code> и <code>StatusId</code> пустыми.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Поле</th>
<th class="tableblock halign-left valign-top">Значение</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Id консультанта</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Эл. почта</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:jack.smart@jsfcrudconsultants.com">jack.smart@jsfcrudconsultants.com</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Пароль</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jack.smart</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Почасовая ставка</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">75</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Оплачиваемая почасовая ставка</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Дата принятия на работу</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">07/22/2008</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Резюме</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">У меня большой опыт работы консультантом. Примите меня на эту должность, и вы не разочаруетесь!</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RecruiterId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">StatusId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
</tr>
</tbody>
</table>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "Сохранить". При подобном заполнении поле <code>StatusId</code> будет отмечено ошибкой проверки.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/create-new-consultant.png" alt="create new consultant">
</div>
<div class="title">Figure 21. Введите в форму образец данных</div>
</div>
<div class="paragraph">
<p>Почему это произошло? Повторно проверьте <a href="#er-diagram">диаграмму "сущность/отношение" для базы данных консультационного агентства</a>. Как указано выше в <a href="#relationships">таблице связей</a>, в таблицах <code>CONSULTANT</code> и <code>CONSULTANT_STATUS</code> совместно используется ненулевое отношение "один ко многим". Поэтому каждая запись в таблице <code>CONSULTANT</code> должна содержать ссылку на запись в таблице <code>CONSULTANT_STATUS</code>. Это отмечено во внешнем ключе <code>consultant_fk_consultant_status</code>, который имеет ссылки на две таблицы.</p>
</div>
<div class="paragraph">
<p>Внешние ключи, хранящиеся в таблицах, можно просмотреть посредством развертывания узла "Внешние ключи" таблицы в окне "Службы" (CTRL+5; &amp;#8984+5 на компьютере Mac).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/consultant-fk.png" alt="consultant fk">
</div>
<div class="title">Figure 22. Проверьте атрибуты внешних ключей в окне 'Службы'</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Для устранения ошибки проверки выберите <code>entity.ConsultantStatus[statusId=A]</code> в раскрывающемся списке <code>StatusId</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*Примечание. *Поле <code>RecruiterId</code> можно оставить пустым. Как указано на <a href="#er-diagram">диаграмме "сущность/отношение" для базы данных</a>, между таблицами <code>CONSULTANT</code> и <code>RECRUITER</code> существует нулевое отношение "один ко многим", что означает, что создавать отношение между записями в таблице <code>CONSULTANT</code> с записью <code>RECRUITER</code> не требуется.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "Сохранить". На экран выводится сообщение об успешном сохранении записи consultant. При щелчке ссылки <code>Show All Consultant Items</code> в таблице появится новая запись.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Как правило, на созданных страницах Facelets отображаются ошибки вводимой пользователем информации:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>пустые поля для ненулевых ячеек таблицы;</p>
</li>
<li>
<p>изменения данных, которые нельзя изменять (например, первичные ключи);</p>
</li>
<li>
<p>вставка данных неверного типа;</p>
</li>
<li>
<p>изменения данных, когда представление пользователя больше не синхронизируется с базой данных.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="editEntity">Правка классов сущностей</h3>
<div class="paragraph">
<p>В предыдущем подразделе был показан не совсем интуитивно понятный параметр <code>entity.ConsultantStatus[statusId=A]</code> в раскрывающемся списке <code>StatusId</code>. Необходимо учитывать, что текст, отображаемый для каждой позиции в этом раскрывающемся списке, является строковым представлением каждой обнаруженной сущности <code>ConsultantStatus</code> (т.е., вызывается метод <code>toString()</code> класса сущностей).</p>
</div>
<div class="paragraph">
<p>В этом подразделе описаны способы использования автозавершения кода в редакторе, документация и поддержка функции переходов, чтобы сделать такой вывод. Кроме того, подготовка наиболее интуитивно понятного сообщения для раскрывающегося списка.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте в редакторе файл <code>/consultant/Create.xhtml</code>. Это форма "Create New Consultant", отображаемая в браузере. Выполните прокрутку вниз до кода раскрывающегося списка <code>StatusId</code> (выделено ниже <strong>жирным шрифтом</strong>).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">    &lt;h:outputLabel value="#{bundle.CreateConsultantLabel_resume}" for="resume" /&gt;
    &lt;h:inputTextarea rows="4" cols="30" id="resume" value="#{consultantController.selected.resume}" title="#{bundle.CreateConsultantTitle_resume}" /&gt;
    *&lt;h:outputLabel value="#{bundle.CreateConsultantLabel_statusId}" for="statusId" /&gt;
    &lt;h:selectOneMenu id="statusId" value="#{consultantController.selected.statusId}" title="#{bundle.CreateConsultantTitle_statusId}" required="true" requiredMessage="#{bundle.CreateConsultantRequiredMessage_statusId}"&gt;
        &lt;f:selectItems value="#{consultantStatusController.itemsAvailableSelectOne}"/&gt;
    &lt;/h:selectOneMenu&gt;*
    &lt;h:outputLabel value="#{bundle.CreateConsultantLabel_recruiterId}" for="recruiterId" /&gt;
    &lt;h:selectOneMenu id="recruiterId" value="#{consultantController.selected.recruiterId}" title="#{bundle.CreateConsultantTitle_recruiterId}" &gt;
        &lt;f:selectItems value="#{recruiterController.itemsAvailableSelectOne}"/&gt;
    &lt;/h:selectOneMenu&gt;
&lt;/h:panelGrid&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Проверьте атрибут <code>value</code>, применяемый к тегу <code>&lt;f:selectItems&gt;</code>. Атрибут <code>value</code> определяет текст, отображаемый для каждой позиции в раскрывающемся списке.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Нажмите сочетание клавиш CTRL+ПРОБЕЛ, установив курсор на <code>itemsAvailableSelectOne</code>. Автозавершение кода в редакторе указывает, что метод <code>getItemsAvailableSelectOne()</code> для <code>ConsultantStatusController</code> возвращает массив объектов <code>SelectItem</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/code-completion-returned-object.png" alt="code completion returned object">
</div>
<div class="title">Figure 23. Автозавершение кода отображает возвращаемые классы для методов</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите CTRL (&amp;#8984 в Mac), затем наведите указатель мыши на <code>itemsAvailableSelectOne</code>. Создается ссылка, позволяющая переходить непосредственно к методу <code>getItemsAvailableSelectOne()</code> в исходном коде сущностей <code>ConsultantStatus</code>. Щелкните эту ссылку.</p>
</li>
<li>
<p>Установите курсор на значении возврата <code>SelectItem[]</code> в сигнатуре метода и нажмите сочетание клавиш CTRL+ПРОБЕЛ для вызова всплывающего окна документации.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/documentation-select-item.png" alt="documentation select item">
</div>
<div class="title">Figure 24. Для вызова поддержки документации нажмите сочетание клавиш CTRL+ПРОБЕЛ.</div>
</div>
<div class="paragraph">
<p>Щелкните значок веб-браузера ( <span class="image"><img src="images/web-browser-icon.png" alt="web browser icon"></span> ) в окне документации, чтобы открыть Javadoc во внешнем веб-браузере.</p>
</div>
<div class="paragraph">
<p>Итак, класс <code>SelectItem</code> относится к инфраструктуре JSF. Компонент <code>UISelectOne</code>, как упоминалось в документации, представлен тегом <code>&lt;h:selectOneMenu&gt;</code> из разметки, проверенной выше в <a href="#markup">Шаге 1</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите CTRL (&amp;#8984 в Mac), затем наведите указатель мыши на <code>findAll()</code>. Появится всплывающее окно, отображающее сигнатуру метода.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/method-signature.png" alt="method signature">
</div>
<div class="title">Figure 25. Просмотрите всплывающее окно сигнатур методов в редакторе</div>
</div>
<div class="paragraph">
<p>Здесь можно отметить, что <code>ejbFacade.findAll()</code> возвращает <code>List</code> объектов <code>ConsultantStatus</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Перейдите к <code>JsfUtil.getSelectItems</code>. Наведите указатель мыши на <code>getSelectItems</code> и нажмите CTRL (&amp;#8984 на компьютере Mac), затем щелкните появившуюся ссылку.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*Примечание. *Помните, что <code>JsfUtil</code> является одним из классов служебных программ, созданных при завершении <a href="#jsfPagesEntityClasses">страниц JSF из мастера классов логических объектов</a>.</p>
</div>
<div class="paragraph">
<p>Этот метод организует цикл по списку сущностей (т.е., по списку <code>List</code> объектов <code>ConsultantStatus</code>) и создает <code>SelectItem</code> для каждой позиции. Как показано ниже (<strong>выделено жирным шрифтом</strong>), каждая позиция <code>SelectItem</code> создана с помощью объекта сущностей и <em>метки</em> объекта.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public static SelectItem[] getSelectItems(List&lt;?&gt; entities, boolean selectOne) {
    int size = selectOne ? entities.size() + 1 : entities.size();
    SelectItem[] items = new SelectItem[size];
    int i = 0;
    if (selectOne) {
        items[0] = new SelectItem("", "---");
        i++;
    }
    *for (Object x : entities) {
        items[i++] = new SelectItem(x, x.toString());
    }*
    return items;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Эта метка создана с помощью метода <code>toString()</code> сущностей и является представлением объекта, отображаемым в этом ответе. (См. определение документации Javadoc для конструктора <code>SelectItem(значение java.lang.Object, метка java.lang.String)</code>.)</p>
</div>
<div class="paragraph">
<p>После проверки того, что методом <code>toString()</code> сущности является метод, отображаемый в браузере при просмотре позиций в раскрывающемся списке, измените метод <code>ConsultantStatus</code> <code>toString()</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте класс сущностей <code>ConsultantStatus</code> в редакторе. Измените метод <code>toString</code> для возврата <code>statusId</code> и <code>description</code>. Это свойства записей, соответствующие двум столбцам таблицы <code>CONSULTANT_STATUS</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public String toString() {
    return *statusId + ", " + description;*
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выполните проект еще раз. При отображении в браузере страницы приветствия щелкните ссылку <code>Show All Consultant Items</code>, затем нажмите <code>Create New Consultant</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Просмотрите раскрывающийся список <code>StatusId</code>. Теперь на экран будет выведен идентификатор состояния и описание записи, содержащейся в таблице <code>CONSULTANT_STATUS</code> базы данных.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/drop-down.png" alt="drop down">
</div>
<div class="title">Figure 26. В раскрывающемся списке StatusId отображаются элементы в соответствии с методом toString() сущности ConsultantStatus</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="troubleshooting">Устранение проблем</h2>
<div class="sectionbody">
<div class="paragraph">
<p>В зависимости от конфигурации при развертывании приложения на сервере может произойти ошибка. В этом случае в окне "Результаты" отображается следующее сообщение.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">GlassFish Server 4 is running.
In-place deployment at /MyDocuments/ConsultingAgency/build/web
GlassFish Server 4, deploy, null, false
/MyDocuments/ConsultingAgency/nbproject/build-impl.xml:1045: The module has not been deployed.
See the server log for details.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Основная причина таких ошибок - проблемы при создании ресурсов JDBC на сервере. В этом случае на вкладке "Журнал сервера" в окне "Результаты" может отобразиться следующее или аналогичное сообщение.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Severe:   Exception while preparing the app : Invalid resource : jdbc/consult__pm
com.sun.appserv.connectors.internal.api.ConnectorRuntimeException: Invalid resource : jdbc/consult__pm</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если вкладка "Журнал сервера" отсутствует, ее можно добавить. Для этого щелкните правой кнопкой мыши узел GlassFish Server в окне "Службы" и выберите "Просмотр журнала доменного сервера".</p>
</div>
<div class="paragraph">
<p>Для этого приложения требуются два ресурса JDBC:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ресурс JDBC или источник данных. Поиск ресурса JDBC в приложении осуществляется посредством поиска JNDI. Если посмотреть на элемент постоянного соединения (<code>persistence.xml</code>), можно увидеть, что имя JNDI для источника данных JTA этого приложения - <code>jdbc/consult</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ресурс JDBC определяет текущий пул соединений, используемый приложением.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Пул соединений JDBC. Пул соединений определяет параметры подключения к базе данных, в том числе местоположение, имя пользователя и пароль. Для данного приложения используется пул соединений <code>consultPool</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ресурс JDBC и пул соединений указываются в файле <code>glassfish-resources.xml</code>. Чтобы открыть файл <code>glassfish-resources.xml</code> в редакторе, разверните узел "Ресурсы сервера" в окне "Проекты" и дважды щелкните этот файл. Файл имеет примерно следующий вид.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE resources PUBLIC "-//GlassFish.org//DTD GlassFish Application Server 3.1 Resource Definitions//EN" "http://glassfish.org/dtds/glassfish-resources_1_5.dtd"&gt;
&lt;resources&gt;
  &lt;jdbc-connection-pool allow-non-component-callers="false" associate-with-thread="false" connection-creation-retry-attempts="0" connection-creation-retry-interval-in-seconds="10" connection-leak-reclaim="false" connection-leak-timeout-in-seconds="0" connection-validation-method="auto-commit" datasource-classname="com.mysql.jdbc.jdbc2.optional.MysqlDataSource" fail-all-connections="false" idle-timeout-in-seconds="300" is-connection-validation-required="false" is-isolation-level-guaranteed="true" lazy-connection-association="false" lazy-connection-enlistment="false" match-connections="false" max-connection-usage-count="0" max-pool-size="32" max-wait-time-in-millis="60000" name="consultPool" non-transactional-connections="false" ping="false" pool-resize-quantity="2" pooling="true" res-type="javax.sql.DataSource" statement-cache-size="0" statement-leak-reclaim="false" statement-leak-timeout-in-seconds="0" statement-timeout-in-seconds="-1" steady-pool-size="8" validate-atmost-once-period-in-seconds="0" wrap-jdbc-objects="false"&gt;
    &lt;property name="serverName" value="localhost"/&gt;
    &lt;property name="portNumber" value="3306"/&gt;
    &lt;property name="databaseName" value="consult"/&gt;
    &lt;property name="User" value="root"/&gt;
    &lt;property name="Password" value="nb"/&gt;
    &lt;property name="URL" value="jdbc:mysql://localhost:3306/consult?zeroDateTimeBehavior=convertToNull"/&gt;
    &lt;property name="driverClass" value="com.mysql.jdbc.Driver"/&gt;
  /&lt;jdbc-connection-pool&gt;
  &lt;jdbc-resource enabled="true" jndi-name="jdbc/consult" object-type="user" pool-name="consultPool"/&gt;
/&lt;resources&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Как видите, указанный в файле <code>glassfish-resources.xml</code> ресурс JDBC <code>jdbc/consult</code> определяет <code>consultPool</code> как имя пула соединений. Также здесь видны свойства <code>consultPool</code>. Для данного приложения в файле <code>glassfish-resources.xml</code> указан только один источник данных и только один пул соединений. Иногда возникает необходимость указать дополнительные ресурсы, например, временное хранилище данных, используемое только для разработки или тестирования.</p>
</div>
<div class="paragraph">
<p>Если ресурс JDBC и пул соединений не созданы на сервере автоматически при запуске приложения, их можно создать вручную в консоли администрирования GlassFish.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Если файл <code>glassfish-resources.xml</code> еще не открыт, откройте его в редакторе.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Для создания ресурса JDBC и пула соединений потребуются значения свойств, указанные в файле <code>glassfish-resources.xml</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните правой кнопкой мыши узел GlassFish Server в окне "Службы" и выберите пункт меню "Открыть консоль администрирования домена". Консоль GlassFish откроется в браузере.</p>
</li>
<li>
<p>На панели "Общие задачи" в консоли GlassFish разверните узел <strong>JDBC</strong>, а также узлы <strong>Ресурсы JDBC</strong> и <strong>Пулы соединений JDBC</strong>.</p>
</li>
</ol>
</div>
<div class="openblock">
<div class="content">
<div class="imageblock left">
<div class="content">
<a class="image" href="images/gf-admin-console-lg.png"><img src="images/gf-admin-console-sm.png" alt="gf admin console sm"></a>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>В консоли отображаются текущие ресурсы JDBC, зарегистрированные на сервере. Если в списке под узлом JDBC на панели навигации "Общие задачи" отсутствуют ресурсы <code>jdbc/consult</code> и <code>consultPool</code>, их необходимо создать. Некоторые ресурсы JDBC , созданные по умолчанию при установке сервера, отображаются в виде дочерних узлов.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите узел <strong>Пулы соединений JDBC</strong>, затем в разделе "Новый пул соединений JDBC" нажмите "Создать".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gf-new-jdbc-pool1.png" alt="gf new jdbc pool1" width="Новый пул соединений JDBC" в консоли администрирования GlassFish"">
</div>
<div class="title">Figure 27. Раздел </div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Укажите <strong>consultPool</strong> в качестве имени пула, выберите <strong>javax.sql.ConnectionPoolDataSource</strong> в списке "Тип ресурса", затем выберите <strong>MySql</strong> в списке "Поставщик драйверов базы данных". Нажмите кнопку "Далее".</p>
</li>
<li>
<p>На экране 2 укажите значения свойств <strong>URL</strong>, <strong>имя пользователя</strong> и <strong>пароль</strong>, найденные в файле. Нажмите "Готово".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gf-new-jdbc-pool2.png" alt="gf new jdbc pool2" width="Новый пул соединений JDBC" в консоли администрирования GlassFish"">
</div>
<div class="title">Figure 28. Панель </div>
</div>
<div class="paragraph">
<p>Значения свойств можно найти в файле <code>glassfish-resources.xml</code>.</p>
</div>
<div class="paragraph">
<p>При нажатии на кнопку "Готово" на сервере создается новый пул соединений, и под узлом "Пулы соединений JDBC" в консоли появляется соответствующий узел.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите узел <strong>Ресурсы JDBC</strong> на панели навигации "Общие задачи" и нажмите "Создать".</p>
</li>
<li>
<p>Укажите <strong>jdbc/consult</strong> в качестве имени JNDI и выберите <strong>consultPool</strong> в списке "Имя пула". Нажмите OK.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gf-new-jdbc-resource.png" alt="gf new jdbc resource" width="Новый ресурс JDBC" в консоли администрирования GlassFish"">
</div>
<div class="title">Figure 29. Раздел </div>
</div>
<div class="paragraph">
<p>При нажатии на кнопку "Готово" на сервере создается новый ресурс JDBC, и под узлом "Ресурсы JDBC" в консоли появляется соответствующий узел.</p>
</div>
<div class="paragraph">
<p>В окне "Службы" в IDE раскройте узел "Ресурсы", находящийся под узлом GlassFish Server, и убедитесь, что в IDE добавлены новые ресурсы. Возможно, для отображения изменений потребуется обновить представление (щелкните правой кнопкой мыши узел "Ресурсы" и выберите "Обновить").</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gf-services-jdbc-resources.png" alt="gf services jdbc resources" width="Службы" в IDE"">
</div>
<div class="title">Figure 30. Ресурсы JDBC в окне </div>
</div>
<div class="paragraph">
<p>Другие советы по устранению проблем с MySQL и IDE см. в следующих документах:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Учебный курс <a href="../ide/mysql.html">Подключение к базе данных MySQL</a>.</p>
</li>
<li>
<p>Статья об устранении неполадок в разделе <a href="mysql-webapp.html#troubleshoot">Создание простого веб-приложения с помощью базы данных MySQL</a>
<a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Creating%20a%20JSF%202.0%20CRUD%20Application">Отправить отзыв по этому учебному курсу</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="seealso">Дополнительные сведения</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Подробнее о JSF 2.x см. в следующих ресурсах.</p>
</div>
<div class="sect2">
<h3 id="_Статьи_и_учебные_курсы_по_netbeans">Статьи и учебные курсы по NetBeans</h3>
<div class="ulist">
<ul>
<li>
<p><a href="jsf20-intro.html">Введение в JavaServer Faces 2.x в IDE NetBeans</a></p>
</li>
<li>
<p><a href="jsf20-support.html">Поддержка JSF 2.x в IDE NetBeans</a></p>
</li>
<li>
<p><a href="../../samples/scrum-toys.html">Scrum Toys – полный пример приложения JSF 2.0</a></p>
</li>
<li>
<p><a href="../javaee/javaee-gettingstarted.html">Начало работы с приложениями Java EE</a></p>
</li>
<li>
<p><a href="../../trails/java-ee.html">Учебная карта по Java EE и Java Web</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_Внешние_ресурсы">Внешние ресурсы</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.oracle.com/technetwork/java/javaee/javaserverfaces-139869.html">Технология JavaServer Faces</a> (официальная домашняя страница)</p>
</li>
<li>
<p><a href="http://jcp.org/aboutJava/communityprocess/final/jsr314/index.html">Спецификация JSR 314 для JavaServer Faces 2.0</a></p>
</li>
<li>
<p>Глава <a href="http://docs.oracle.com/javaee/7/tutorial/doc/jsf-intro.htm">Технология JavaServer Faces</a> в учебном курсе по Java EE 7</p>
</li>
<li>
<p><a href="http://javaserverfaces.dev.java.net/">GlassFish Project Mojarra</a> (официальный пример реализации JSF 2.х)</p>
</li>
<li>
<p><a href="http://forums.oracle.com/forums/forum.jspa?forumID=982">Интернет-форум OTN: JavaServer Faces</a></p>
</li>
<li>
<p><a href="http://www.jsfcentral.com/">JSF Central</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_Блоги">Блоги</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.java.net/blogs/edburns/">Эд Бернс (Ed Burns)</a></p>
</li>
<li>
<p><a href="http://www.java.net/blogs/driscoll/">Джим Дрисколл (Jim Driscoll)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
            
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="JIRA" href="https://issues.apache.org/jira/projects/NETBEANS/summary"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/jsf20-crud_ru.asciidoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

        </div>
        

<div class='grid-container incubator-area' style='margin-top: 64px'>
    <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/">
                <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
            </a>
        </div>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/events/current-event.html">
               <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
            </a>
        </div>
    </div>
</div>
<footer>
    <div class="grid-container">
        <div class="grid-x grid-padding-x">
            <div class="large-auto cell">
                
                <h1><a href="/about/index.html">About</a></h1>
                <ul>
                    <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
                    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                    <li><a href="https://www.apache.org/security/">Security</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/community/index.html">Community</a></h1>
                <ul>
                    <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
                    <li><a href="/community/committer.html">Becoming a committer</a></li>
                    <li><a href="/community/events.html">NetBeans Events</a></li>
                    <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/participate/index.html">Participate</a></h1>
                <ul>
                    <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
                    <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
                    <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/help/index.html">Get Help</a></h1>
                <ul>
                    <li><a href="/help/index.html#documentation">Documentation</a></li>
                    <li><a href="/wiki/index.asciidoc">Wiki</a></li>
                    <li><a href="/help/index.html#support">Community Support</a></li>
                    <li><a href="/help/commercial-support.html">Commercial Support</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/download/nb110/nb110.html">Download</a></h1>
                <ul>
                    <li><a href="/download/index.html">Releases</a></li>                    
                    <li><a href="/plugins/index.html">Plugins</a></li>
                    <li><a href="/download/index.html#source">Building from source</a></li>
                    <li><a href="/download/index.html#previous">Previous releases</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<div class='footer-disclaimer'>
    <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2020 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
            <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
            <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
        </div>
        
    </div>
</div>



        <script src="/js/vendor/jquery-3.2.1.min.js"></script>
        <script src="/js/vendor/what-input.js"></script>
        <script src="/js/vendor/jquery.colorbox-min.js"></script>
        <script src="/js/vendor/foundation.min.js"></script>
        <script src="/js/netbeans.js"></script>
        <script>
            
            $(function(){ $(document).foundation(); });
        </script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        <script>
         $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
        </script>
        
    </body>
</html>
