
<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Введение в JavaServer Faces 2.x</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Введение в JavaServer Faces 2.x - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, Введение в JavaServer Faces 2.x">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
     <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet"> 
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
</head>


    <body>
        

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


        
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 12.4</h1>
            <p><a class="button success" href="/download/nb124/nb124.html">Find out more</a></p>
        </div>
    </div>
</section>

        <div class='grid-container main-content tutorial'>
            <h1 class="sect0">Введение в JavaServer Faces 2.x</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://issues.apache.org/jira/projects/NETBEANS/issues">open a JIRA issue</a>, 
                     or <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/jsf20-intro_ru.asciidoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
            <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#support">Добавление поддержки JSF 2.x к веб-приложениям</a></li>
<li><a href="#managedBean">Создание управляемого компонента</a>
<ul class="sectlevel2">
<li><a href="#usingManagedBean">Использование мастера создания управляемого компонента</a></li>
<li><a href="#creatingConstructor">Создание конструктора</a></li>
<li><a href="#addingProperties">Добавление свойств</a></li>
</ul>
</li>
<li><a href="#wire">Установление связи между управляемым компонентом и страницами</a>
<ul class="sectlevel2">
<li><a href="#index">index.xhtml</a></li>
<li><a href="#response">response.xhtml</a></li>
</ul>
</li>
<li><a href="#template">Применение шаблона Facelets</a>
<ul class="sectlevel2">
<li><a href="#templateFile">Создание файла шаблона Facelets</a></li>
<li><a href="#templateClient">Создание файлов клиента шаблона</a></li>
</ul>
</li>
<li><a href="#seealso">Дополнительные сведения</a>
<ul class="sectlevel2">
<li><a href="#_статьи_и_учебные_курсы_по_netbeans">Статьи и учебные курсы по NetBeans</a></li>
<li><a href="#_внешние_ресурсы">Внешние ресурсы</a></li>
<li><a href="#_блоги">Блоги</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>JavaServer Faces (JSF) - это платформа разработки интерфейса пользователя для веб-приложений Java. Она призвана значительно упростить процесс создания и поддержки приложений, работающих на сервере приложений Java и визуализирующих свои пользовательские интерфейсы на целевом клиенте. JSF обеспечивает простоту использования благодаря целому ряду факторов:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>упрощает формирование пользовательского интерфейса из набора повторно используемых компонентов пользовательского интерфейса;</p>
</li>
<li>
<p>упрощает перенос данных приложения в пользовательский интерфейс и из него;</p>
</li>
<li>
<p>помогает управлять состоянием пользовательского интерфейса при запросах к серверу;</p>
</li>
<li>
<p>предоставляет простую модель установления связи между созданными клиентом событиями и кодом приложения на стороне сервера;</p>
</li>
<li>
<p>упрощает сборку и повторное использование компонентов пользовательского интерфейса.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Подробное описание платформы JSF приведено в <a href="http://docs.oracle.com/javaee/7/tutorial/doc/jsf-develop.htm">учебном курсе по Java EE 7, Глава 12. Разработка по технологии JavaServer Faces</a>.</p>
</div>
<div class="paragraph">
<p>В этом учебном курсе описывается применение поддержки JSF 2.x к веб-приложениям с помощью IDE NetBeans. Сначала необходимо добавить поддержку платформы JSF 2.x к базовому веб-приложению, а затем приступить к выполнения следующих задач:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>создать управляемый компонент JSF для обработки данных запроса,</p>
</li>
<li>
<p>подключить управляемый компонент к веб-страницам приложения и</p>
</li>
<li>
<p>преобразовать веб-страницы в файлы шаблонов Facelets.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>IDE NetBeans обеспечивает долгосрочную поддержку для JavaServer Faces. Начиная с редакции JSF 2.0 и Java EE 6, IDE NetBeans обеспечивает поддержку для JSF 2.0 и JSF 2.1. Подробнее см. в разделе <a href="jsf20-support.html">Поддержка JSF 2.x в IDE NetBeans</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/netbeans-stamp-80-74-73.png" alt="netbeans stamp 80 74 73">
</div>
<div class="title">Figure 1. Содержимое этой страницы применимо к IDE NetBeans 7.2, 7.3, 7.4 и 8.0</div>
</div>
<div class="paragraph">
<p>Для работы с этим учебным курсом требуются программное обеспечение и материалы, перечисленные ниже.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Программное обеспечение или материал</th>
<th class="tableblock halign-left valign-top">Требуемая версия</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">IDE NetBeans</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.2, 7.3, 7.4, 8.0, пакет Java EE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Комплект для разработчика на языке Java (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 или 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://glassfish.dev.java.net/">Сервер GlassFish</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Source Edition 3.x или 4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FjsfDemo.zip">Проект веб-приложения `jsfDemo`</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">неприменимо</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Примечания</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>В комплект Java в среде IDE NetBeans также входит сервер GlassFish - сервер, совместимый с Java EE, который требуется для этого учебного курса.</p>
</li>
<li>
<p>Для сравнения проекта с рабочим решением загрузите <a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FjsfDemoCompleted.zip">выполненный демонстрационный проект</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="support">Добавление поддержки JSF 2.x к веб-приложениям</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Начните работу с открытия <a href="#requiredSoftware">проекта веб-приложения <code>jsfDemo</code></a> в среде IDE. После открытия проекта в среде IDE в него можно добавить поддержку платформы с помощью окна "Свойства" в проекте.</p>
</div>
<div class="paragraph">
<p>IDE также позволяет создавать новые проекты с поддержкой JSF 2.x. Подробнее см. раздел <a href="jsf20-support.html#creatingSupport">Создание нового проекта с поддержкой JSF 2.x</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку 'Открыть проект' ( <span class="image"><img src="images/open-project-btn.png" alt="open project btn"></span> ) на главной панели инструментов IDE или нажмите Ctrl-Shift-O (⌘-Shift-O в Mac).</p>
</li>
<li>
<p>В диалоговом окне "Открытие проекта" перейдите к папке на компьютере, в которой хранится разархивированный файл учебного проекта. Выберите его, а затем для открытия проекта в среде IDE нажмите кнопку "Открыть проект".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Примечание.</strong> При открытии проекта NetBeans может быть отображен запрос на разрешение ссылки на библиотеки JUnit, если при установке IDE не был установлен подключаемый модуль JUnit.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выполните проект и посмотрите, как он выглядит в браузере. Либо щелкните правой кнопкой мыши узел проекта <code>jsfDemo</code> в окне 'Проекты' и выберите 'Запустить' или нажмите кнопку 'Запустить проект' ( <span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span> ) на главной панели инструментов. Проект запакован и разворачивается на сервере GlassFish, а в браузере открывается страница приветствия(<code>index.xhtml</code>).</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/run-project.png" alt="run project">
</div>
<div class="title">Figure 2. Запустите проект, чтобы просмотреть его в браузере.</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "Отправить". Страница ответа (<code>response.xhtml</code>) отображается следующим образом:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/response.png" alt="response">
</div>
<div class="title">Figure 3. Страницы приветствия и отклика в настоящее время являются статическими страницами</div>
</div>
<div class="paragraph">
<p>В настоящее время страницы приветствия и отклика являются статическими, и совместно с файлом <code>stylesheet.css</code> и изображением <code>duke.png</code> они являются единственными файлами приложений, доступными из браузера.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В окне 'Проекты' (Ctrl-1; ⌘ -1 в Mac) щелкните правой кнопкой мыши узел проекта и выберите 'Свойства', чтобы открыть окно 'Свойства проекта'.</p>
</li>
<li>
<p>Выберите категорию 'Платформы', а затем нажмите кнопку 'Добавить'.</p>
</li>
<li>
<p>Выберите 'JavaServer Faces' в диалоговом окне 'Добавление платформы'. Нажмите кнопку 'ОК'.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/add-framework.png" alt="add framework">
</div>
<div class="title">Figure 4. Добавление поддержки JSF к существующему проекту</div>
</div>
<div class="paragraph">
<p>После выбора "JavaServer Faces" станут доступными различные параметры настройки. На вкладке 'Библиотеки' вы можете указать, как проект обращается к библиотекам JSF 2.x. Доступная версия JSF будет зависеть от версии IDE и сервера GlassFish. По умолчанию используются библиотеки, поставляемые с сервером (сервером GlassFish). Тем не менее, в IDE также входят библиотеки JSF 2.x. (Можно выбрать параметр "Зарегистрированные библиотеки", если их необходимо использовать в проекте).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/libraries-tab.png" alt="libraries tab">
</div>
<div class="title">Figure 5. Укажите доступ к библиотекам JSF 2.x</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите вкладку "Настройка". Можно указать способ регистрации сервлета Faces в дескрипторе развертывания проекта. Также можно указать, нужно ли в проекте использовать страницы Facelets или JSP.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jsf-configuration.png" alt="jsf configuration">
</div>
<div class="title">Figure 6. Укажите параметры сервлета Faces и предпочитаемый язык</div>
</div>
<div class="paragraph">
<p>Вы также можете легко настроить проект для использования различных наборов компонентов JSF на вкладке 'Компоненты'. Чтобы использовать набор компонентов, нужно загрузить необходимые библиотеки и использовать диспетчер Ant Library для создания новой библиотеки с библиотеками наборов компонентов.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jsf-components.png" alt="jsf components">
</div>
<div class="title">Figure 7. Укажите параметры сервлета Faces и предпочитаемый язык</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "ОК" для подтверждения изменений и закройте окно "Свойства проекта".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>После добавления поддержки JSF к проекту дескриптор развертывания <code>web.xml</code> изменяется и выглядит следующим образом. (Изменения <strong>выделены полужирным шрифтом</strong>.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"&gt;
    *&lt;context-param&gt;
        &lt;param-name&gt;javax.faces.PROJECT_STAGE&lt;/param-name&gt;
        &lt;param-value&gt;Development&lt;/param-value&gt;
    &lt;/context-param&gt;
    &lt;servlet&gt;
        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;javax.faces.webapp.FacesServlet&lt;/servlet-class&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/faces/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;*
    &lt;welcome-file-list&gt;
        &lt;welcome-file&gt;*faces/*index.xhtml&lt;/welcome-file&gt;
    &lt;/welcome-file-list&gt;
&lt;/web-app&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Важно!</strong> Убедитесь, что файл <code>web.xml</code> содержит только одну запись <code>&lt;welcome-file&gt;</code> с компонентом &#8216;faces/&#8217;, как показано в примере. Это обеспечивает передачу страницы приветствия проекта (<code>index.xhtml</code>) через сервлет Faces перед ее отображением в браузере. Это необходимо для верного отображения компонентов библиотек тегов Facelets.</p>
</div>
<div class="paragraph">
<p>Сервлет Faces регистрируется в проекте, и теперь страница приветствия <code>index.xhtml</code> при запросе передается через сервлет Faces. Кроме того, обратите внимание, что добавлена запись для параметра контекста <code>PROJECT_STAGE</code>. При установке значения этого параметра на &#8220;Development&#8221; предоставляется полезная информация во время отладки приложения. См.  <a href="http://blogs.oracle.com/rlubke/entry/jsf_2_0_new_feature2">http://blogs.oracle.com/rlubke/entry/jsf_2_0_new_feature2</a> для получения дополнительной информации.</p>
</div>
<div class="paragraph">
<p>Для просмотра библиотек JSF разверните узел "Библиотеки" проекта в окне "Проекты". Если используются библиотеки по умолчанию, включенные в GlassFish Server 3.1.2 или GlassFish Server 4, под узлом сервера GlassFish отображается <code>javax.faces.jar</code>. (Если вы используете старую версию GlassFish, вы увидите библиотеки <code>jsf-api.jar</code> и <code>jsf-impl.jar</code>, а не <code>javax.faces.jar</code>.)</p>
</div>
<div class="paragraph">
<p>Поддержка JSF в среде IDE 2.x включает в себя в первую очередь большое количество мастеров для JSF, а также специальные функциональные возможности, предоставляемые редактором Facelets. Эти функциональные возможности описаны ниже. Подробнее см. в разделе <a href="jsf20-support.html">Поддержка JSF 2.x в IDE NetBeans</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="managedBean">Создание управляемого компонента</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Управляемые компоненты JSF для обработки данных пользователя и сохранения их между запросами. Управляемый компонент – это <a href="http://en.wikipedia.org/wiki/Plain_Old_Java_Object">POJO</a> (простой объект Java), который используется для сохранения данных и управляется контейнером (например, сервером GlassFish) с помощью платформы JSF.</p>
</div>
<div class="paragraph">
<p>Компонент POJO по существу является классом Java, который содержит публичный безаргументный конструктор и соответствует правилам присвоения имен <a href="http://download.oracle.com/javase/tutorial/javabeans/">JavaBeans</a> для свойств.</p>
</div>
<div class="paragraph">
<p>При просмотре <a href="#staticPage">статической страницы</a>, полученной в результате выполнения проекта, пользователю необходим механизм, который проверяет введенное пользователем число на соответствие текущему выбранному числу и возвращает представление, соответствующее полученному результату. Чтобы создать управляемый компонент для этих целей, используйте <a href="jsf20-support.html#managedBean">Мастер создания управляемого компонента</a> среды IDE. Страницы Facelets, создаваемые в следующем разделе, должны иметь доступ к числу, вводимому пользователем, и к сгенерированному ответу. Для упрощения добавьте свойства <code>userNumber</code> и <code>response</code> к управляемому компоненту.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#usingManagedBean">Использование мастера создания управляемого компонента</a></p>
</li>
<li>
<p><a href="#creatingConstructor">Создание конструктора</a></p>
</li>
<li>
<p><a href="#addingProperties">Добавление свойств</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="usingManagedBean">Использование мастера создания управляемого компонента</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В окне 'Проекты' щелкните правой кнопкой мыши узел проекта <code>jsfDemo</code> и выберите 'Создать' &gt; 'Управляемый компонент JSF'. (Если "Управляемый компонент" отсутствует, выберите "Другие". Затем выберите параметр "Управляемый компонент JSF" в категории "JavaServer Faces". Нажмите кнопку "Далее".</p>
</li>
<li>
<p>В мастере введите следующее:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Имя класса:</strong> UserNumberBean;</p>
</li>
<li>
<p><strong>Пакет:</strong> guessNumber;</p>
</li>
<li>
<p><strong>Имя:</strong> UserNumberBean</p>
</li>
<li>
<p><strong>Контекст:</strong> сеанс</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/managed-bean.png" alt="managed bean">
</div>
<div class="title">Figure 8. Используйте мастер управляемых компонентов JSF для создания нового управляемого компонента</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "Завершить". Класс <code>UserNumberBean</code> будет создан и открыт в редакторе. Обратите внимание на следующие аннотации (<strong>выделено полужирным шрифтом</strong>):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package guessNumber;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;

/**
 *
 * @author nbuser
 */
*@ManagedBean(name="UserNumberBean")
@SessionScoped*
public class UserNumberBean {

    /** Creates a new instance of UserNumberBean */
    public UserNumberBean() {
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Поскольку вы используете JSF 2.x, можно объявить все относящиеся к JSF компоненты с помощью аннотаций. В предыдущих версиях их необходимо было объявлять в файле настройки Faces (<code>faces-config.xml</code>).</p>
</div>
<div class="paragraph">
<p><span class="tips">Для просмотра документации Javadoc по всем аннотациям JSF 2.1 обратитесь к <a href="http://javaserverfaces.java.net/nonav/docs/2.1/managed-bean-javadocs/index.html">Спецификации аннотации управляемого компонента Faces</a>.</span></p>
</div>
</div>
<div class="sect2">
<h3 id="creatingConstructor">Создание конструктора</h3>
<div class="paragraph">
<p>Конструктор <code>UserNumberBean</code> должен создавать случайное число от 0 до 10 и сохранять его в переменной экземпляра. Таким образом частично формируется бизнес-логика для приложения.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Определите конструктор для класса <code>UserNumberBean</code>. Введите следующий код (изменения выделены <strong>полужирным шрифтом</strong>).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class UserNumberBean {

    *Integer randomInt;*

    /** Creates a new instance of UserNumberBean */
    public UserNumberBean() {
        *link:http://docs.oracle.com/javase/7/docs/api/java/util/Random.html[+Random+] randomGR = new Random();
        randomInt = new Integer(randomGR.link:http://docs.oracle.com/javase/7/docs/api/java/util/Random.html#nextInt%28int%29[+nextInt+](10));
        System.out.println("Duke's number: " + randomInt);*
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Вышеуказанный код создает случайное число от 0 до 10 и записывает это число в протокол сервера.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Исправьте операторы импорта. Для этого щелкните метку4 подсказки ( <span class="image"><img src="images/hint-icon.png" alt="hint icon"></span> ), которая отображается на левой границе редактора, затем выберите параметр для импорта <code>java.util.Random</code> в класс.</p>
</li>
<li>
<p>Повторно запустите проект (нажмите кнопку 'Запустить проект' ( <span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span> ) или нажмите F6; fn-F6 в Mac). При выполнении проекта файл протокола сервера автоматически открывается в окне вывода.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/output1.png" alt="output1">
</div>
<div class="title">Figure 9. Файл журнала сервера автоматически открывается в окне вывода.</div>
</div>
<div class="paragraph">
<p>Обратите внимание на то, что в окне вывода не отображается "`Номер Дюка: <code>" (как указывалось в конструкторе). Объект `UserNumberBean</code> не создан, так как по умолчанию в JSF используется <em>"ленивое" создание экземпляра</em>. Таким образом, компоненты в определенных контекстах создаются и инициализируются, только если они необходимы в приложении.</p>
</div>
<div class="paragraph">
<p>Состояния <a href="http://javaserverfaces.java.net/nonav/docs/2.1/managed-bean-javadocs/index.html">Документации Javadoc по аннотации `@ManagedBean`</a>:</p>
</div>
<div class="paragraph">
<p><em>Если атрибут <code>eager()</code> имеет значение <code>true</code>, а значением <code>managed-bean-scope</code> является "application", то в среде выполнения при запуске приложения должен быть создан экземпляр этого класса. Создание и сохранение экземпляра должно осуществляться до обслуживания запросов. Если атрибут _eager</em> не указан либо имеет значение <code>false</code> или элементу <code>managed-bean-scope</code> не присвоено значение "приложение", по умолчанию происходит "ленивое" создание экземпляра и контекстное сохранение управляемого компонента._</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Поскольку класс <code>UserNumberBean</code> входит в контекст сеанса, реализуется интерфейс <code>Serializable</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@ManagedBean(name="UserNumberBean")
@SessionScoped
public class UserNumberBean *implements Serializable* {</code></pre>
</div>
</div>
<div class="paragraph">
<p>Используйте метку подсказки ( <span class="image"><img src="images/hint-icon.png" alt="hint icon"></span> ) для импорта <code>java.io.Serializable</code> в класс.</p>
</div>
</div>
<div class="sect2">
<h3 id="addingProperties">Добавление свойств</h3>
<div class="paragraph">
<p>Страницы Facelets, создаваемые в следующем разделе, должны иметь доступ к числу, вводимому пользователем, и к сгенерированному ответу. Для упрощения этого добавьте свойства <code>userNumber</code> и <code>response</code> к классу.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Начните с объявления <code>Integer</code> с именем <code>userNumber</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@ManagedBean(name="UserNumberBean")
@SessionScoped
public class UserNumberBean implements Serializable {

    Integer randomInt;
    *Integer userNumber;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните правой кнопкой мыши в редакторе и выберите команду "Вставить код" (ALT+INS; CTRL+I на компьютере Mac). Выберите методы получения и установки.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/getter-setter.png" alt="getter setter">
</div>
<div class="title">Figure 10. Используйте IDE для создания методов доступа для свойств</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите параметр <code>userNumber</code>: <code>Integer</code>. Нажмите кнопку "Создать".</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/generate-getters-setters.png" alt="generate getters setters">
</div>
<div class="title">Figure 11. Используйте IDE для создания методов доступа для свойств</div>
</div>
<div class="paragraph">
<p>Обратите внимание на то, что методы <code>getUserNumber()</code> и <code>setUserNumber(Integer userNumber)</code> добавлены в класс.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Создайте свойство <code>response</code>. Объявите <code>String</code> с именем <code>response</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@ManagedBean(name="UserNumberBean")
@SessionScoped
public class UserNumberBean implements Serializable {

    Integer randomInt;
    Integer userNumber;
    *String response;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Создайте метод получения для <code>response</code>. (Для этого приложения не требуется метод установки). Для создания кода шаблона в среде IDE можно использовать всплывающее окно "Создание кода", упомянутое выше в действии 2. Однако в целях изучения данного руководства просто вставьте нижеуказанный метод в класс.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">public String getResponse() {
    if ((userNumber != null) &amp;amp;&amp;amp; (userNumber.link:http://download.oracle.com/javase/6/docs/api/java/lang/Integer.html#compareTo(java.lang.Integer)[+compareTo+](randomInt) == 0)) {

        //invalidate user session
        FacesContext context = FacesContext.getCurrentInstance();
        HttpSession session = (HttpSession) context.getExternalContext().getSession(false);
        session.invalidate();

        return "Yay! You got it!";
    } else {

        return "&lt;p&gt;Sorry, " + userNumber + " isn't it.&lt;/p&gt;"
                + "&lt;p&gt;Guess again...&lt;/p&gt;";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Вышеуказанный метод выполняет две функции.
1. Тестирует введенное пользователем число (<code>userNumber</code>) на равенство случайному числу, сгенерированному для сеанса (<code>randomInt</code>), и возвращает соответствующий ответ <code>String</code>.
2. Определяет пользовательский сеанс как недействительный, если пользователь ввел правильное число (т.е., если <code>userNumber</code> равно <code>randomInt</code>). Это необходимо для того, чтобы новое сгенерированное число побудило пользователя сыграть еще раз.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Щелкните правой кнопкой мыши в области редактора и выберите команду "Исправить операторы импорта" (ALT+SHIFT+I; &amp;#8984+SHIFT+I на компьютере Mac). Параметры импорта автоматически создаются для:</p>
<div class="ulist">
<ul>
<li>
<p><code>javax.servlet.http.HttpSession</code></p>
</li>
<li>
<p><code>javax.faces.context.FacesContext</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Можно нажать сочетание клавиш CTRL+ПРОБЕЛ на элементах в редакторе для вызова предложений автозавершения кода и поддержки документации. Нажмите сочетание клавиш CTRL+ПРОБЕЛ, установив курсор на <code>FacesContext</code>, для просмотра описания класса из документации Javadoc.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/documentation-support.png" alt="documentation support">
</div>
<div class="title">Figure 12. Для вызова поддержки автозавершения кода и документации нажмите сочетание клавиш CTRL+ПРОБЕЛ.</div>
</div>
<div class="paragraph">
<p>Щелкните значок веб-браузера ( <span class="image"><img src="images/web-browser-icon.png" alt="web browser icon"></span> ) в окне документации, чтобы открыть Javadoc во внешнем веб-браузере.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="wire">Установление связи между управляемым компонентом и страницами</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Одной из первичных целей JSF является отмена необходимости записывать шаблонный код для управления объектами <a href="#pojo">POJO</a> и их взаимодействием с видами приложений. Пример этого был приведен в предыдущем разделе, в котором JSF создал объект <code>UserNumberBean</code> при выполнении приложения. Это представление называется <a href="http://martinfowler.com/articles/injection.html">Инверсия управления</a> (IoC). Оно позволяет контейнеру принимать на себя ответственность за управление частями приложения, иначе разработчику потребовалось бы написать код с повторениями.</p>
</div>
<div class="paragraph">
<p>В предыдущем разделе был создан управляемый компонент, генерирующий случайное число от 0 до 10. Также было создано два свойства <code>userNumber</code> и <code>response</code>, представляющие соответственно пользовательский ввод числа и ответ на вопрос пользователя.</p>
</div>
<div class="paragraph">
<p>В этом разделе показаны способы использования <code>UserNumberBean</code> и его свойств на веб-страницах. JSF позволяет это сделать с помощью языка выражения. Язык выражения используется для привязки значений свойств к компонентам пользовательского интерфейса JSF, содержащихся на веб-страницах приложений. В этом разделе также показано, как можно воспользоваться внутренними функциями навигации JSF 2.x для перемещения между индексом и страницами ответов.</p>
</div>
<div class="paragraph">
<p>Эта поддержка в среде IDE обеспечивается с помощью функции автозавершения кода и средств документации, которые вызываются нажатием сочетания клавиш CTRL+ПРОБЕЛ, когда курсор установлен на каком-либо элементе в редакторе.</p>
</div>
<div class="paragraph">
<p>Начните с внесения изменений в <code>index.xhtml</code>, затем измените <code>response.xhtml</code>. На обеих страницах замените элементы формы HTML их эквивалентами JSF, поскольку они определены в <a href="http://javaserverfaces.java.net/nonav/docs/2.1/vdldocs/facelets/index.html">библиотеке тегов HTML для JSF</a>. Затем используйте язык выражений JSF для привязки значений свойств к выбранным компонентам пользовательского интерфейса.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#index">index.xhtml</a></p>
</li>
<li>
<p><a href="#response">response.xhtml</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="index">index.xhtml</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте страницу <code>index.xhtml</code> в редакторе. Дважды щелкните узел <code>index.xhtml</code> в окне "Проекты" или нажмите сочетание клавиш ALT+SHIFT+O для открытия диалогового окна "Переход к файлу".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Как индекс, так и страницы ответов уже содержат компоненты пользовательского интерфейса JSF, необходимые для этого упражнения. Просто раскомментируйте их и закомментируйте элементы HTML, используемые в настоящий момент.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Закомментируйте элемент формы HTML. Для этого выделите элемент формы HTML, как показано на изображении ниже, затем нажмите CTRL+/ (&amp;#8984+/ на компьютере Mac).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*Примечание. *Для выделения воспользуйтесь функцией перетаскивания в редакторе с помощью мыши или с помощью клавиатуры удерживайте клавишу Shift и используйте клавиши со стрелками.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/comment-out.png" alt="comment out">
</div>
<div class="title">Figure 13. Выделите код, затем нажмите Ctrl-/ для закомментирования кода</div>
</div>
<div class="paragraph">
<p>Для переключения комментариев нажмите сочетание клавиш CTRL+/ (&amp;#8984+/ на компьютере Mac). Эту комбинацию клавиш также можно использовать для других типов файлов, например, Java и CSS.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Раскомментируйте компонент формы HTML для JSF. Выделите этот компонент, как показано на рисунке ниже, затем нажмите CTRL+/ (&amp;#8984+/ на компьютере Mac).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Примечание.</strong> Возможно, вам придется нажать Ctrl-/ дважды, чтобы раскомментировать код.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/comment.png" alt="comment">
</div>
<div class="title">Figure 14. Выделите закомментированный код, затем нажмите Ctrl-/ для удаления комментария</div>
</div>
<div class="paragraph">
<p>После того как компонент формы HTML для JSF раскомментирован, в редакторе будет указано, что теги <code>&lt;h:form&gt;</code>, <code>&lt;h:inputText&gt;</code> и <code>&lt;h:commandButton&gt;</code> не объявлены.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/undeclared-component.png" alt="undeclared component">
</div>
<div class="title">Figure 15. Редактор обеспечивает сообщения об ошибках для необъявленных компонентов</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Для объявления этих компонентов используйте автозавершение кода IDE, чтобы добавить пространство имен библиотеки тегов в тег <code>&lt;html&gt;</code> страницы. Наведите курсор на любой из необъявленных тегов, нажмите Alt-Enter и нажмите Enter, чтобы добавить предложенные библиотеки тегов. (При наличии нескольких параметров перед нажатием клавиши ВВОД убедитесь, что выбран тег, отображаемый в редакторе.) Пространство имен библиотеки тегов HTML для JSF добавляется к тегу <code>&lt;html&gt;</code> (<strong>выделено ниже полужирным шрифтом</strong>), и указания на ошибки исчезают.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Примечание.</strong> Если в IDE нет возможности добавить библиотеку тегов, потребуется вручную изменить элемент  <code>&lt;html&gt;</code> .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;html xmlns="http://www.w3.org/1999/xhtml"
      *xmlns:h="http://xmlns.jcp.org/jsf/html"*&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Используйте язык выражения JSF для привязки свойства <code>userNumber</code> для <code>UserNumberBean</code> к компоненту <code>inputText</code>. Атрибут <code>value</code> используется для указания текущего значения визуализируемого компонента. Введите в код, отображаемый ниже <strong>полужирным шрифтом</strong>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;h:form&gt;
    &lt;h:inputText id="userNumber" size="2" maxlength="2" *value="#{UserNumberBean.userNumber}"* /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>В языке выражения JSF используется синтаксис <code>#{}</code>. Внутри этих парных символов указывается имя требуемого управляемого компонента и его свойство, разделенные точкой (<code>.</code>). Теперь при отправке данных формы на сервер значение автоматически сохраняется в свойстве <code>userNumber</code> с помощью метода установки свойств (<code>setUserNumber()</code>). Кроме того, если страница запрошена и значение для <code>userNumber</code> уже установлено, значение автоматически отображается в визуализированном компоненте <code>inputText</code>. Дополнительные сведения приведены в <a href="http://docs.oracle.com/javaee/7/tutorial/doc/jsf-develop001.htm#BNAQP">Руководстве по Java EE 7. Глава 12.1.2 Использование языка выражений для создания ссылок на управляемые сеансные объекты</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Укажите адресата для запроса, который вызывается при нажатии кнопки формы. В HTML-версии формы это возможно выполнить с помощью атрибута <code>action</code> тега <code>&lt;form&gt;</code>. С помощью JSF можно использовать атрибут <code>action</code> для <code>commandButton</code>. Кроме того, благодаря внутренней функции навигации JSF 2.x вам нужно только указать имя конечного файла без расширения.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Введите код, отображаемый ниже <strong>полужирным шрифтом</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;h:form&gt;
    &lt;h:inputText id="userNumber" size="2" maxlength="2" value="#{UserNumberBean.userNumber}" /&gt;
    &lt;h:commandButton id="submit" value="submit" *action="response"* /&gt;
&lt;/h:form&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>В среде выполнения JSF осуществляется поиск файла с именем <code>response</code>. Предполагается, что расширение файла такое же, как у файла, из которого произошел запрос (<code>index*.xhtml*</code>), и поиск файла <code>response.xhtml</code> выполняется в папке исходного файла (т.е. в корневом веб-узле).</p>
</div>
<div class="paragraph">
<p>*Примечание. *JSF 2.x позволяет упростить разработку. При использовании JSF 1.2 для этого проекта необходимо объявить правило перехода в файле настройки Faces. Объявление правила может выглядеть следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;navigation-rule&gt;
    &lt;from-view-id&gt;/index.xhtml&lt;/from-view-id&gt;

    &lt;navigation-case&gt;
        &lt;from-outcome&gt;response&lt;/from-outcome&gt;
        &lt;to-view-id&gt;/response.xhtml&lt;/to-view-id&gt;
    &lt;/navigation-case&gt;
&lt;/navigation-rule&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Нижеприведенные действия с 7 по 12 являются дополнительными. Если необходимо выполнить быструю сборку проекта, сразу перейдите к <a href="#response"><code>response.xhtml</code></a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Протестируйте, выполняется ли вызов метода <code>setUserNumber()</code> вышеуказанным выражением на языке выражения при обработке запроса. Для выполнения этого используйте отладчик Java среды IDE.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Переключите на класс <code>UserNumberBean</code> (нажмите сочетание клавиш CTRL+TAB и выберите из списка файл). Установите точку останова в сигнатуре метода <code>setUserNumber()</code>. Это можно сделать, щелкнув мышкой в области левого поля. Появится красный значок, указывающий, что точка останова метода установлена.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/set-breakpoint.png" alt="set breakpoint">
</div>
<div class="title">Figure 16. Щелкните левую границу редактора для задания точек останова</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку 'Отладка проекта' (<span class="image"><img src="images/breakpoint-btn.png" alt="breakpoint btn"></span>) на главной панели инструментов IDE. Начинается сеанс отладки, и в браузере открывается страница приветствия проекта.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Примечания.</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Вам может быть предложено подтвердить порт сервера для отладки приложений.</p>
</li>
<li>
<p>Если появится диалоговое окно 'Отладить проект', выберите опцию по умолчанию 'Java на стороне сервера' и нажмите кнопку 'Отладка'.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В браузере введите номер в форму и нажмите кнопку "Отправить".</p>
</li>
<li>
<p>Вернитесь в среду IDE и проверьте класс <code>UserNumberBean</code>. Отладчик приостановлен в методе <code>setUserNumber()</code>.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debugger-suspended.png" alt="debugger suspended">
</div>
<div class="title">Figure 17. Выполняется приостановка отладчика в соответствии с точками останова</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте окно "Переменные отладчика" (выберите "Окно" &gt; "Отладка &gt; "Переменные" или нажмите сочетание клавиш CTRL+SHIFT+1). На экран будут выведены значения переменных для точки, в которой приостановлен отладчик.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/variables-window.png" alt="variables window">
</div>
<div class="title">Figure 18. Отслеживание значений переменных с помощью окна 'Переменные отладчика'</div>
</div>
<div class="paragraph">
<p>На приведенном выше изображении значение &#8220;4&#8221; предоставлено для переменной <code>userNumber</code> в сигнатуре <code>setUserNumber()</code>. (Число 4 введено в форму.) &#8220;this&#8221; относится к объекту <code>UserNumberBean</code>, созданному для пользовательского сеанса. Далее можно отметить, что значение свойства <code>userNumber</code> в настоящий момент равно <code>null</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>На панели отладчика нажмите кнопку 'Вход в' ( <span class="image"><img src="images/step-into-btn.png" alt="step into btn"></span> ). Отладчик выполняет обработку строки, на которой он в настоящий момент приостановлен. Происходит обновление окна "Переменные" с указанием выполненных изменений.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/variables-window2.png" alt="variables window2">
</div>
<div class="title">Figure 19. Окно переменных обновляется при переходе по коду</div>
</div>
<div class="paragraph">
<p>Теперь свойству <code>userNumber</code> присвоено значение, введенное в форме.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выберите Отладка&gt; Завершить сеанс отладки (Shift-F5; Shift-Fn-F5 на Mac) из главного меню, чтобы остановить отладчик.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="response">response.xhtml</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте страницу <code>response.xhtml</code> в редакторе. В окне "Проекты" дважды щелкните узел <code>response.xhtml</code> или нажмите сочетание клавиш ALT+SHIFT+O для открытия диалогового окна "Переход к файлу".</p>
</li>
<li>
<p>Закомментируйте элемент формы HTML. Выделите открывающий и закрывающий теги HTML <code>&lt;form&gt;</code> и код между ними, затем нажмите CTRL+/ (&amp;#8984+/ на компьютере Mac).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*Примечание: * Для выделения воспользуйтесь функцией перетаскивания в редакторе с помощью мыши или с помощью клавиатуры удерживайте клавишу Shift и используйте клавиши со стрелками.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Раскомментируйте компонент формы HTML для JSF. Выделите открывающий и закрывающий теги <code>&lt;h:form&gt;</code> и код между ними, затем нажмите CTRL+/ (&amp;#8984+/ на компьютере Mac).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>На данном этапе, код между тегами <code>&lt;body&gt;</code> выглядит следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;body&gt;
    &lt;div id="mainContainer"&gt;

        &lt;div id="left" class="subContainer greyBox"&gt;

            &lt;h4&gt;[ response here ]&lt;/h4&gt;

            &lt;!--&lt;form action="index.xhtml"&gt;

                &lt;input type="submit" id="backButton" value="Back"/&gt;

            &lt;/form&gt;--&gt;

            &lt;h:form&gt;

                &lt;h:commandButton id="backButton" value="Back" /&gt;

            &lt;/h:form&gt;

        &lt;/div&gt;

        &lt;div id="right" class="subContainer"&gt;

            &lt;img src="duke.png" alt="Duke waving" /&gt;
             &lt;!--&lt;h:graphicImage url="/duke.png" alt="Duke waving" /&gt;--&gt;

        &lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>После того как компонент формы HTML для JSF раскомментирован, в редакторе будет указано, что теги <code>&lt;h:form&gt;</code> и <code>&lt;h:commandButton&gt;</code> не объявлены.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Для объявления этих компонентов используйте автозавершение кода IDE, чтобы добавить пространство имен библиотеки тегов в тег <code>&lt;html&gt;</code> страницы.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Используйте поддержку автозавершения кода в редакторе для добавления необходимых пространств имен JSF к файлу. При выборе тега JSF или Facelets через автозавершение кода происходит автоматическое добавление требуемого пространства имен к корневому элементу документа. Подробнее см. в разделе <a href="jsf20-support.html#facelets">Поддержка JSF 2.x в IDE NetBeans</a>.</p>
</div>
<div class="paragraph">
<p>Установите курсор на один из необъявленных тегов и нажмите сочетание клавиш CTRL+ПРОБЕЛ. Предложения автозавершения кода и отображения поддержки документации.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/code-completion2.png" alt="code completion2">
</div>
<div class="title">Figure 20. Для вызова рекомендаций по автозавершению кода и всплывающего окна документации</div>
</div>
<div class="paragraph">
<p>Нажмите ENTER. (При наличии нескольких параметров перед нажатием клавиши ВВОД убедитесь, что выбран тег, отображаемый в редакторе.) Пространство имен библиотеки тегов HTML для JSF добавляется к тегу <code>&lt;html&gt;</code> (<strong>выделено ниже полужирным шрифтом</strong>), и указания на ошибки исчезают.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;html xmlns="http://www.w3.org/1999/xhtml"
      *xmlns:h="http://xmlns.jcp.org/jsf/html"*&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Укажите адресата для запроса, который вызывается при нажатии пользователем кнопки формы. Кнопку необходимо установить так, чтобы при ее нажатии пользователь возвращался на страницу-указатель. Для этого следует использовать атрибут <code>action</code> для <code>commandButton</code>. Введите в код, отображаемый <strong>полужирным шрифтом</strong>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;h:form&gt;

    &lt;h:commandButton id="backButton" value="Back" *action="index"* /&gt;

&lt;/h:form&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Примечание. * При вводе <code>action="index"</code> пользователи в работе зависят от функции явной навигации в JSF. При нажатии кнопки формы в среде выполнения JSF осуществляется поиск файла с именем <code>index</code>. Предполагается, что расширение файла такое же, как у файла, от которого был направлен запрос (<code>response</strong>.xhtml*</code>), и поиск файла <code>index.xhtml</code> выполняется в папке исходного файла (т.е. в корневом веб-узле).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Замените статический текст "[здесь ответ]" значением свойства <code>response</code> для <code>UserNumberBean</code>. Для этого используйте язык выражения JSF. Введите следующее (<strong>выделено полужирным шрифтом</strong>).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;div id="left" class="subContainer greyBox"&gt;

    &lt;h4&gt;*&lt;h:outputText value="#{UserNumberBean.response}"/&gt;*&lt;/h4&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Запустите проект (нажмите кнопку 'Запустить проект' ( <span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span> ) или нажмите F6; fn-F6 в Mac). При появлении в браузере страницы приветствия введите номер и нажмите <code>submit</code>. Страница ответа будет отображаться следующим образом (выводится на экран, если введен неправильный номер).</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/response2.png" alt="response2">
</div>
<div class="title">Figure 21. Просмотрит текущее состояния проекта в браузере</div>
</div>
<div class="paragraph">
<p>Две ошибки в текущем состоянии страницы ответа:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Теги HTML <code>&lt;p&gt;</code> отображаются в ответном сообщении.</p>
</li>
<li>
<p>Кнопка "Назад" не отображается в правильном местоположении. (Сравните с <a href="#originalVersion">исходной версией</a>.)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При выполнении следующих двух шагов эти ошибки устраняются.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Установите атрибут <code>escape</code> тега <code>&lt;h:outputText&gt;</code> на <code>false</code>. Установите курсор между <code>outputText</code> и <code>value</code>, вставьте пробел и нажмите сочетание клавиш CTRL+ПРОБЕЛ для вызова автозавершения кода. Прокрутите вниз для выбора атрибута <code>escape</code> и проверки документации.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/escape-false.png" alt="escape false">
</div>
<div class="title">Figure 22. Нажмите Ctrl-Пробел для просмотра возможных значений атрибутов и документации</div>
</div>
<div class="paragraph">
<p>Как указано в документации, значение <code>escape</code> установлено по умолчанию на <code>true</code>. Это означает, что символы, которые стандартно анализируются как html, включены в строку, как указано выше. Установка значения на <code>false</code> означает, что символы, анализируемые как HTML, можно визуализировать как HTML.</p>
</div>
<div class="paragraph">
<p>Нажмите ENTER, затем в качестве значения введите <code>false</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;h4&gt;&lt;h:outputText *escape="false"* value="#{UserNumberBean.response}"/&gt;&lt;/h4&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Установите атрибут <code>prependId</code> тега <code>&lt;h:form&gt;</code> на <code>false</code>. Установите курсор сразу после &#8220;m&#8221; в <code>&lt;h:form&gt;</code> и вставьте пробел, затем нажмите сочетание клавиш CTRL+ПРОБЕЛ для вызова автозавершения кода. Прокрутите вниз для выбора атрибута <code>prependId</code> и проверки документации. Затем нажмите ENTER и в качестве значения введите <code>false</code>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;h:form *prependId="false"*&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>В JSF применяются внутренние идентификаторы для отслеживания компонентов пользовательского интерфейса. В текущем примере при проверке исходного кода визуализируемой страницы отображается следующее:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;form id="j_idt5" name="j_idt5" method="post" action="/jsfDemo/faces/response.xhtml" enctype="application/x-www-form-urlencoded"&gt;
&lt;input type="hidden" name="j_idt5" value="j_idt5" /&gt;
    &lt;input *id="j_idt5:backButton"* type="submit" name="j_idt5:backButton" value="Back" /&gt;
    &lt;input type="hidden" name="javax.faces.ViewState" id="javax.faces.ViewState" value="7464469350430442643:-8628336969383888926" autocomplete="off" /&gt;
&lt;/form&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Идентификатором элемента формы является <code>j_idt5</code>, и этот идентификатор <em>предшествует</em> идентификатору кнопки "Назад", включенной в форму (<strong>выделено полужирным шрифтом</strong> в приведенном выше примере). Поскольку кнопка "Назад" зависит от правила стиля <code>#backButton</code> (определенного в <code>stylesheet.css</code>), это правило становится блокированным, если идентификатор JSF предшествует идентификатору кнопки. Этого можно избежать, если для <code>prependId</code> установить значение <code>false</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Повторно запустите проект (нажмите кнопку 'Запустить проект' ( <span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span> ) или нажмите F6; fn-F6 в Mac). Введите число на странице приветствия, затем нажмите кнопку "Отправить". Теперь на странице ответа отображается ответное сообщение без тегов <code>&lt;p&gt;</code>, и кнопка "Назад" размещена правильно.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/response3.png" alt="response3">
</div>
<div class="title">Figure 23. Просмотрит текущее состояния проекта в браузере</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "Назад". Поскольку текущее значение свойства <code>userNumber</code> для <code>UserNumberBean</code> привязано к компоненту <code>inputText</code> JSF, ранее введенное число теперь отображается в текстовом поле.</p>
</li>
<li>
<p>Проверьте протокол сервера в окне вывода среды IDE (CTRL+4; &amp;#8984+4 на компьютере Mac) для определения правильного загаданного числа.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Если по каким-то причинам просмотреть протокол сервера невозможно, откройте его посредством переключения на окно "Службы" (CTRL+5; &amp;#8984+5 на компьютере Mac) и развертывания узла "Серверы". Затем щелкните правой кнопкой мыши сервер GlassFish, на котором развернут проект и выберите 'Просмотреть журнал сервера'. Если номер не отображается в журнале сервера, попробуйте повторно выполнить сборку приложения, щелкнув правой кнопкой мыши узел проекта и выбрав 'Очистка и сборка'.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Введите правильное число и нажмите кнопку "Отправить". В приложении происходит сравнение введенного числа с текущим сохраненным числом и выводится соответствующее сообщение.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/yay.png" alt="yay">
</div>
<div class="title">Figure 24. При вводе соответствующего числа отображается правильный отклик</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите еще раз кнопку "Назад". Обратите внимание на то, что ранее введенное число более не отображается в текстовом поле. Следует помнить о том, что метод <code>getResponse()</code> для <code>UserNumberBean</code> <a href="#getResponse">определяет текущий пользовательский сеанс как недействительный</a> при угадывании правильного числа.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="template">Применение шаблона Facelets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Facelets сегодня является стандартной технологией отображения для JSF 2.x. Facelets - это облегченная платформа шаблонов, которая поддерживает все компоненты JSF пользовательского интерфейса и используется для построения и визуализации дерева компонентов JSF для просмотра приложений. Кроме того, эта технология обеспечивает поддержку разработки при возникновении ошибок языка выражений за счет возможности проверять трассировку стека, дерево компонентов и контекстные переменные.</p>
</div>
<div class="paragraph">
<p>Хотя, возможно, вы об этом не задумывались, файлы <code>index.xhtml</code> и <code>response.xhtml</code>, с которыми вы работаете в этом руководстве, являются страницами Facelets. Страницы Facelets имеют расширение <code>.xhtml</code> и, поскольку вы работаете в проекте JSF 2.x (библиотеки JSF 2.x включают в себя файлы JAR Facelets), эти представления способны надлежащим образом визуализировать дерево компонентов JSF.</p>
</div>
<div class="paragraph">
<p>Целью этого раздела является знакомство с созданием шаблона Facelets. Для проектов с несколькими представлениями зачастую полезно применять файл шаблона, определяющего структуру и внешний вид для нескольких представлений. При обслуживании запросов приложение вставляет динамически подготовленное содержимое во временный файл и отправляет результат обратно клиенту. Хотя данный проект имеет только два представления (страницу приветствия и страницу ответа), можно легко отметить, что большая часть содержимого в них дублируется. Это дублированное содержимое можно перенести в шаблон Facelets и создать файлы клиента шаблона для обработки содержимого, которое является специфичным для страницы приветствия и страницы ответа.</p>
</div>
<div class="paragraph">
<p>В среде IDE существует <a href="jsf20-support.html#faceletsTemplate">мастер создания шаблона Facelets</a> для создания шаблонов Facelets и мастер создания клиента шаблона Facelets для создания файлов, зависящих от шаблона. В этом разделе описано использование этих мастеров.</p>
</div>
<div class="paragraph">
<p><strong>Примечание.</strong> IDE также предоставляет мастер страниц JSF, что позволяет создавать индивидуальные страницы Facelets для проекта. Подробнее см. в разделе <a href="jsf20-support.html#jsfPage">Поддержка JSF 2.x в IDE NetBeans</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#templateFile">Создание файла шаблона Facelets</a></p>
</li>
<li>
<p><a href="#templateClient">Создание файлов клиента шаблона</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="templateFile">Создание файла шаблона Facelets</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Создайте файл шаблона Facelets. Нажмите сочетание клавиш CTRL+N (&amp;#8984+N на компьютере Mac) для открытия мастера создания файлов. Выберите категорию "JavaServer Faces", затем "Шаблон Facelets". Нажмите кнопку "Далее".</p>
</li>
<li>
<p>В поле "Имя файла" введите <code>template</code>.</p>
</li>
<li>
<p>Выберите один из восьми стилей размещения и нажмите кнопку "Готово". (Вы будете использовать существующую таблицу стилей, так что не имеет значения, какой стиль вы выберете.)</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/layout-style.png" alt="layout style">
</div>
<div class="title">Figure 25. Мастер шаблонов Facelets позволяет сделать выбор из распространенных стилей компоновки</div>
</div>
<div class="paragraph">
<p>Мастером будут созданы файл <code>template.xhtml</code> и сопутствующие таблицы стилей на основе выбора, которые будут помещены в папку <code>resources</code> &gt; <code>css</code> в корневом веб-узле проекта.</p>
</div>
<div class="paragraph">
<p>После завершения выполнения мастера в редакторе открывается файл шаблона. Для просмотра шаблона в браузере, щелкните правой кнопкой мыши в редакторе и выберите 'Просмотр'.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Проверьте разметку файла шаблона. Обратите внимание на следующие моменты.</p>
<div class="ulist">
<ul>
<li>
<p>Библиотека тегов <code>facelets</code> объявлена в теге <code>&lt;html&gt;</code> страницы. Библиотека тегов имеет префикс <code>ui</code>.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;html xmlns="http://www.w3.org/1999/xhtml"
      *xmlns:ui="http://xmlns.jcp.org/jsf/facelets"*
      xmlns:h="http://xmlns.jcp.org/jsf/html"&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>На странице Facelets используются теги <code>&lt;h:head&gt;</code> и <code>&lt;h:body&gt;</code> вместо тегов HTML <code>&lt;head&gt;</code> и <code>&lt;body&gt;</code>. При использовании этих тегов у Facelets появляется возможность создания дерева компонентов, которое включает в себя всю страницу.</p>
</li>
<li>
<p>Страница ссылается на таблицы стилей, которые также создаются при завершении выполнения мастера.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;h:head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
    *&lt;link href="./resources/css/default.css" rel="stylesheet" type="text/css" /&gt;*
    *&lt;link href="./resources/css/cssLayout.css" rel="stylesheet" type="text/css" /&gt;*
    &lt;title&gt;Facelets Template&lt;/title&gt;
&lt;/h:head&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Теги <code>&lt;ui:insert&gt;</code> используются в теле страницы для каждого раздела, связанного с выбранным стилем размещения. Каждый тег <code>&lt;ui:insert&gt;</code> имеет атрибут <code>name</code>, определяющий раздел. Например:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;div id="top"&gt;
    *&lt;ui:insert name="top"&gt;Top&lt;/ui:insert&gt;*
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Повторно проверьте страницу <a href="#staticPage">приветствия</a> и страницу <a href="#responsePage">ответа</a>. Содержимым, которое изменяется на этих страницах, является только заголовок и текст в сером квадрате. Следовательно, шаблон может включать в себя все остальное содержимое.</p>
</li>
<li>
<p>Замените все содержимое файла шаблона содержимым, приведенным ниже.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;?xml version='1.0' encoding='UTF-8' ?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"&gt;

    &lt;h:head&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
        &lt;link href="css/stylesheet.css" rel="stylesheet" type="text/css" /&gt;

        &lt;title&gt;&lt;ui:insert name="title"&gt;Facelets Template&lt;/ui:insert&gt;&lt;/title&gt;
    &lt;/h:head&gt;

    &lt;h:body&gt;

        &lt;div id="left"&gt;
            &lt;ui:insert name="box"&gt;Box Content Here&lt;/ui:insert&gt;
        &lt;/div&gt;

    &lt;/h:body&gt;

&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Приведенный выше код реализует следующие изменения.
* Файл <code>stylesheet.css</code> проекта заменяет ссылки на таблицу стилей шаблона, созданные в мастере.
* Все теги <code>&lt;ui:insert&gt;</code> (вместе с тегами <code>&lt;div&gt;</code>) удаляются за исключением одного с именем <code>box</code>.
* В теги <code>&lt;ui:insert&gt;</code> вставляется заголовок страницы с именем <code>title</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Скопируйте в шаблон соответствующий код из файла <code>index.xhtml</code> или файла <code>response.xhtml</code>. Добавьте содержимое, отображаемое ниже <strong>полужирным шрифтом</strong>, в теги <code>&lt;h:body&gt;</code> файла шаблона.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;h:body&gt;
    *&lt;div id="mainContainer"&gt;*
        &lt;div id="left" *class="subContainer greyBox"*&gt;
            &lt;ui:insert name="box"&gt;Box Content Here&lt;/ui:insert&gt;
        &lt;/div&gt;
        *&lt;div id="right" class="subContainer"&gt;
            &lt;img src="duke.png" alt="Duke waving" /&gt;
        &lt;/div&gt;
    &lt;/div&gt;*
&lt;/h:body&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выполните проект. При открытии страницы приветствия в браузере измените URL-адрес на следующий:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">http://localhost:8080/jsfDemo/faces/template.xhtml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Файл шаблона отображается следующим образом:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/facelets-template.png" alt="facelets template">
</div>
<div class="title">Figure 26. Просмотрите шаблон Facelets в браузере</div>
</div>
<div class="paragraph">
<p>Теперь проект включает в себя файл шаблона, предоставляющий внешний вид и структуру всех представлений. Теперь можно создавать файлы клиента для вызова шаблона.</p>
</div>
</div>
<div class="sect2">
<h3 id="templateClient">Создание файлов клиента шаблона</h3>
<div class="paragraph">
<p>Создайте файлы клиента шаблона для страниц приветствия и ответа. Укажите имя файла клиента шаблона для страницы приветствия <code>greeting.xhtml</code>. Для страницы ответа – файл <code>response.xhtml</code>.</p>
</div>
<div class="sect3">
<h4 id="_greeting_xhtml">greeting.xhtml</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите сочетание клавиш CTRL+N (⌘-N на компьютере Mac) для открытия мастера создания файлов. Выберите категорию "JavaServer Faces", затем "Клиент шаблона Facelets". Нажмите кнопку "Далее".</p>
</li>
<li>
<p>В поле "Имя файла" введите <code>greeting</code>.</p>
</li>
<li>
<p>Нажмите кнопку "Обзор" рядом с полем "Шаблон", затем в открывшемся диалоговом окне перейдите к файлу <code>template.xhtml</code>, созданному в предыдущем разделе.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/template-client.png" alt="template client">
</div>
<div class="title">Figure 27. Мастер создания клиентов шаблона Facelets</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Нажмите кнопку "Завершить". Будет создан новый файл клиента шаблона <code>greeting.xhtml</code>, который откроется в редакторе.</p>
</li>
<li>
<p>Проверьте разметку. Обратите внимание на содержимое, выделенное <strong>полужирным шрифтом</strong>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"&gt;

    &lt;body&gt;

        &lt;ui:composition *template="./template.xhtml"*&gt;

            &lt;ui:define *name="title"*&gt;
                title
            &lt;/ui:define&gt;

            &lt;ui:define *name="box"*&gt;
                box
            &lt;/ui:define&gt;

        &lt;/ui:composition&gt;

    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Файл клиента шаблона ссылается на шаблон с помощью атрибута <code>template</code> тега <code>&lt;ui:composition&gt;</code>. Поскольку шаблон содержит теги <code>&lt;ui:insert&gt;</code> для <code>title</code> и <code>box</code>, клиент шаблона содержит теги <code>&lt;ui:define&gt;</code> для этих двух имен. Содержимое, указываемое в тегах <code>&lt;ui:define&gt;</code>, - это содержимое, вставляемое в шаблон в тегах <code>&lt;ui:insert&gt;</code> соответствующего имени.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Укажите <code>greeting</code> в качестве заголовка файла. Внесите следующее изменение, выделенное <strong>полужирным шрифтом</strong>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;ui:define name="title"&gt;
    *Greeting*
&lt;/ui:define&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Перейдите к файлу <code>index.xhtml</code> (нажмите CTRL+TAB) и скопируйте содержимое, которое обычно появляется в сером квадрате, выведенном на визуализируемой странице. Затем обратно переключитесь на файл <code>greeting.xhtml</code> и вставьте его в файл клиента шаблона. (Изменения <strong>выделены полужирным шрифтом</strong>.)</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;ui:define name="box"&gt;
    *&lt;h4&gt;Hi, my name is Duke!&lt;/h4&gt;

    &lt;h5&gt;I'm thinking of a number

        &lt;br/&gt;
        between
        &lt;span class="highlight"&gt;0&lt;/span&gt; and
        &lt;span class="highlight"&gt;10&lt;/span&gt;.&lt;/h5&gt;

    &lt;h5&gt;Can you guess it?&lt;/h5&gt;

    &lt;h:form&gt;
        &lt;h:inputText size="2" maxlength="2" value="#{UserNumberBean.userNumber}" /&gt;
        &lt;h:commandButton id="submit" value="submit" action="response" /&gt;
    &lt;/h:form&gt;*
&lt;/ui:define&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Объявите библиотеку тегов HTML JSF для файла. Установите курсор на один из тегов, помеченных флагом ошибки (любой тег с префиксом &#8220;h&#8221;), и нажмите сочетание клавиш CTRL+ПРОБЕЛ. Затем выберите тег из списка предложений автозавершения кодов. Пространство имен библиотеки тегов добавляется к тегу <code>&lt;html&gt;</code> файла (выделено ниже <strong>полужирным шрифтом</strong>), и указания на ошибки исчезают.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      *xmlns:h="http://xmlns.jcp.org/jsf/html"*&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>При установке курсора после &#8220;m&#8221; в <code>&lt;h:form&gt;</code> и нажатии сочетания клавиш CTRL+ПРОБЕЛ к файлу автоматически добавляется пространство имен. Если при нажатии сочетания клавиш CTRL+ПРОБЕЛ доступен только один логический параметр, он немедленно применяется к файлу. Библиотека тегов JSF автоматически объявляется при вызове автозавершения кода в тегах.</p>
</div>
</div>
<div class="sect3">
<h4 id="_response_xhtml">response.xhtml</h4>
<div class="paragraph">
<p>Поскольку проект уже содержит файл с именем <code>response.xhtml</code> и известно, как теперь должен выглядеть файл клиента шаблона, измените существующий файл <code>response.xhtml</code>, чтобы получить соответствующий файл клиента шаблона. (В целях данного руководства просто скопируйте и вставьте предоставленный код.)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Откройте файл <code>response.xhtml</code> в редакторе. (Если он уже открыт, нажмите CTRL+TAB и выберите его). Замените содержимое всего файла нижеприведенным кодом.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version='1.0' encoding='UTF-8' ?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"&gt;

    &lt;body&gt;

        &lt;ui:composition template="./template.xhtml"&gt;

            &lt;ui:define name="title"&gt;
                Response
            &lt;/ui:define&gt;

            &lt;ui:define name="box"&gt;
                &lt;h4&gt;&lt;h:outputText escape="false" value="#{UserNumberBean.response}"/&gt;&lt;/h4&gt;

                &lt;h:form prependId="false"&gt;

                    &lt;h:commandButton id="backButton" value="Back" action="greeting" /&gt;

                &lt;/h:form&gt;
            &lt;/ui:define&gt;

        &lt;/ui:composition&gt;

    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Обратите внимание на то, что файл идентичен файлу <code>greeting.xhtml</code>, за исключением содержимого, указанного в тегах <code>&lt;ui:define&gt;</code> для <code>title</code> и <code>box</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>В дескрипторе развертывания <code>web.xml</code> проекта измените запись файла приветствия таким образом, чтобы при запуске приложения открывалась страница, представленная файлом <code>greeting.xhtml</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>В окне 'Проекты' дважды щелкните 'Файлы конфигурации' &gt; <code>web.xml</code>, чтобы открыть его в редакторе. На вкладке "Страницы" измените поле "Файлы приветствия" на <code>faces/greeting.xhtml</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/welcome-files.png" alt="welcome files">
</div>
<div class="title">Figure 28. Измените запись 'Файлы приветствия' в дескрипторе развертывания</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Выполните проект и посмотрите, как он выглядит в браузере. Нажмите F6 (fn-F6 в Mac) или нажмите кнопку 'Запустить проект'( <span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span> ) на главной панели инструментов. Проект будет развернут на сервере GlassFish и открыт в браузере.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>При использовании шаблона Facelets и файлов клиента шаблона поведение приложения не меняется. Выделив повторяющийся код на страницах приветствия и ответа приложения, можно уменьшить размер приложения и устранить возможность написания повторяющегося кода, если впоследствии будут добавляться другие страницы. Это позволяет сделать разработку более эффективной и упростить управление при работе с большими проектами.</p>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Introduction%20to%20JSF%202.0">Отправить отзыв по этому учебному курсу</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="seealso">Дополнительные сведения</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Подробнее о JSF 2.x см. в следующих ресурсах.</p>
</div>
<div class="sect2">
<h3 id="_статьи_и_учебные_курсы_по_netbeans">Статьи и учебные курсы по NetBeans</h3>
<div class="ulist">
<ul>
<li>
<p><a href="jsf20-support.html">Поддержка JSF 2.x в IDE NetBeans</a></p>
</li>
<li>
<p><a href="jsf20-crud.html">Создание приложения JavaServer Faces 2.x CRUD на основе базы данных</a></p>
</li>
<li>
<p><a href="../../samples/scrum-toys.html">Scrum Toys – полный пример приложения JSF 2.0</a></p>
</li>
<li>
<p><a href="../javaee/javaee-gettingstarted.html">Начало работы с приложениями Java EE</a></p>
</li>
<li>
<p><a href="../../trails/java-ee.html">Учебная карта по Java EE и Java Web</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_внешние_ресурсы">Внешние ресурсы</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.oracle.com/technetwork/java/javaee/javaserverfaces-139869.html">Технология JavaServer Faces</a> (официальная домашняя страница)</p>
</li>
<li>
<p><a href="http://jcp.org/aboutJava/communityprocess/final/jsr314/index.html">Спецификация JSR 314 для JavaServer Faces 2.0</a></p>
</li>
<li>
<p><a href="http://docs.oracle.com/javaee/7/tutorial/doc/jsf-develop.htm">Учебный курс по Java EE 7. Глава 12. Разработка по технологии JavaServer Faces</a></p>
</li>
<li>
<p><a href="http://javaserverfaces.dev.java.net/">GlassFish Project Mojarra</a> (официальный пример реализации JSF 2.х)</p>
</li>
<li>
<p><a href="http://forums.oracle.com/forums/forum.jspa?forumID=982">Интернет-форум OTN: JavaServer Faces</a></p>
</li>
<li>
<p><a href="http://www.jsfcentral.com/">JSF Central</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_блоги">Блоги</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.java.net/blogs/edburns/">Эд Бернс (Ed Burns)</a></p>
</li>
<li>
<p><a href="http://www.java.net/blogs/driscoll/">Джим Дрисколл (Jim Driscoll)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
            
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="JIRA" href="https://issues.apache.org/jira/projects/NETBEANS/summary"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/jsf20-intro_ru.asciidoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

        </div>
        

<div class='grid-container incubator-area' style='margin-top: 64px'>
    <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/">
                <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
            </a>
        </div>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/events/current-event.html">
               <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
            </a>
        </div>
    </div>
</div>
<footer>
    <div class="grid-container">
        <div class="grid-x grid-padding-x">
            <div class="large-auto cell">
                
                <h1><a href="/about/index.html">About</a></h1>
                <ul>
                    <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
                    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                    <li><a href="https://www.apache.org/security/">Security</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/community/index.html">Community</a></h1>
                <ul>
                    <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
                    <li><a href="/community/committer.html">Becoming a committer</a></li>
                    <li><a href="/community/events.html">NetBeans Events</a></li>
                    <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/participate/index.html">Participate</a></h1>
                <ul>
                    <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
                    <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
                    <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/help/index.html">Get Help</a></h1>
                <ul>
                    <li><a href="/help/index.html#documentation">Documentation</a></li>
                    <li><a href="/wiki/index.asciidoc">Wiki</a></li>
                    <li><a href="/help/index.html#support">Community Support</a></li>
                    <li><a href="/help/commercial-support.html">Commercial Support</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/download/nb110/nb110.html">Download</a></h1>
                <ul>
                    <li><a href="/download/index.html">Releases</a></li>                    
                    <li><a href="/plugins/index.html">Plugins</a></li>
                    <li><a href="/download/index.html#source">Building from source</a></li>
                    <li><a href="/download/index.html#previous">Previous releases</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<div class='footer-disclaimer'>
    <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2020 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
            <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
            <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
        </div>
        
    </div>
</div>



        <script src="/js/vendor/jquery-3.2.1.min.js"></script>
        <script src="/js/vendor/what-input.js"></script>
        <script src="/js/vendor/jquery.colorbox-min.js"></script>
        <script src="/js/vendor/foundation.min.js"></script>
        <script src="/js/netbeans.js"></script>
        <script>
            
            $(function(){ $(document).foundation(); });
        </script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        <script>
         $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
        </script>
        
    </body>
</html>
