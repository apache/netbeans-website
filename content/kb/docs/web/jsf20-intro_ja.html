
<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>JavaServer Faces 2.x入門</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="JavaServer Faces 2.x入門 - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, JavaServer Faces 2.x入門">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
     <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet"> 
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
</head>


    <body>
        

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


        
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 13</h1>
            <p><a class="button success" href="/download/nb13/nb13.html">Download</a></p>
        </div>
    </div>
</section>

        <div class='grid-container main-content tutorial'>
            <h1 class="sect0">JavaServer Faces 2.x入門</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://issues.apache.org/jira/projects/NETBEANS/issues">open a JIRA issue</a>, 
                     or <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/jsf20-intro_ja.asciidoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
            <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#support">WebアプリケーションへのJSF 2.xサポートの追加</a></li>
<li><a href="#managedBean">管理対象Beanの作成</a>
<ul class="sectlevel2">
<li><a href="#usingManagedBean">管理対象Beanウィザードの使用</a></li>
<li><a href="#creatingConstructor">コンストラクタの作成</a></li>
<li><a href="#addingProperties">プロパティの追加</a></li>
</ul>
</li>
<li><a href="#wire">ページへの管理対象Beanの接続</a>
<ul class="sectlevel2">
<li><a href="#index">index.xhtml</a></li>
<li><a href="#response">response.xhtml</a></li>
</ul>
</li>
<li><a href="#template">Faceletsテンプレートの適用</a>
<ul class="sectlevel2">
<li><a href="#templateFile">Faceletsテンプレート・ファイルの作成</a></li>
<li><a href="#templateClient">テンプレート・クライアント・ファイルの作成</a></li>
</ul>
</li>
<li><a href="#seealso">関連項目</a>
<ul class="sectlevel2">
<li><a href="#_netbeansの記事およびチュートリアル">NetBeansの記事およびチュートリアル</a></li>
<li><a href="#_外部リソース">外部リソース</a></li>
<li><a href="#_ブログ">ブログ</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>JavaServer Faces (JSF)は、Java Webアプリケーション用のユーザー・インタフェース(UI)フレームワークです。これは、Javaアプリケーション・サーバー上で実行され、UIをターゲット・クライアントにレンダリングするアプリケーションの記述と維持にかかる負荷を大幅に軽減するように設計されています。JSFは、次のような方法で使いやすさを実現します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>再利用可能なUIコンポーネントのセットからUIを簡単に構築できる</p>
</li>
<li>
<p>UIとの間でアプリケーション・データの移行を簡素化</p>
</li>
<li>
<p>サーバー・リクエスト間でのUIの状態管理を支援</p>
</li>
<li>
<p>クライアントが生成したイベントをサーバー側アプリケーション・コードに記述するための簡易モデルを提供</p>
</li>
<li>
<p>カスタムUIコンポーネントを簡単にビルドして再利用できる</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>JSFフレームワークの詳細は、<a href="http://docs.oracle.com/javaee/7/tutorial/doc/jsf-develop.htm">Java EE 7チュートリアル、第12章のJavaServer Facesテクノロジを使用した開発</a>を参照してください。</p>
</div>
<div class="paragraph">
<p>このチュートリアルでは、NetBeans IDEを使用してJSF 2.xサポートをWebアプリケーションに適用する方法を説明します。最初にJSF 2.xフレームワーク・サポートを基本的なWebアプリケーションに追加してから、次のタスクの実行に進みます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>リクエスト・データを処理するJSF管理対象Beanの作成</p>
</li>
<li>
<p>管理対象BeanをアプリケーションのWebページに記述</p>
</li>
<li>
<p>WebページをFaceletsテンプレート・ファイルに変換</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>NetBeans IDEは、JavaServer Facesのサポートを長期にわたって提供してきました。JSF 2.0およびJava EE 6のリリース以降、NetBeans IDEはJSF 2.0およびJSF 2.1のサポートを提供してきました。詳細は、<a href="jsf20-support.html">NetBeans IDEでのJSF 2.xのサポート</a>を参照してください。</p>
</div>
<div class="paragraph">
<p>このチュートリアルを完了するには、次のソフトウェアとリソースが必要です。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ソフトウェアまたはリソース</th>
<th class="tableblock halign-left valign-top">必須バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">NetBeans IDE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.2、7.3、7.4、8.0、Java EEバンドル版</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java Development Kit (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7または8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://glassfish.dev.java.net/">GlassFishサーバー</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Source Edition 3.xまたは4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FjsfDemo.zip">`jsfDemo` Webアプリケーション・プロジェクト</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">n/a</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>*注意: *</p>
</div>
<div class="ulist">
<ul>
<li>
<p>NetBeans IDEのJavaバンドル版には、このチュートリアルに必要な、Java EE準拠サーバーのGlassFishサーバーも含まれています。</p>
</li>
<li>
<p>プロジェクトを、正常に機能するソリューションと比較するには、<a href="https://netbeans.org/projects/samples/downloads/download/Samples%252FJavaEE%252FjsfDemoCompleted.zip">完成したサンプル・プロジェクト</a>をダウンロードします。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="support">WebアプリケーションへのJSF 2.xサポートの追加</h2>
<div class="sectionbody">
<div class="paragraph">
<p>まず、IDEで<a href="#requiredSoftware"><code>jsfDemo</code> Webアプリケーション・プロジェクト</a>を開きます。IDEでプロジェクトが開いたら、プロジェクトの「プロパティ」ウィンドウを使用して、フレームワーク・サポートを追加できます。</p>
</div>
<div class="paragraph">
<p>IDEで、JSF 2.xをサポートする新しいプロジェクトを作成することもできます。詳細は、<a href="jsf20-support.html#creatingSupport">JSF 2.xサポートを含む新しいプロジェクトの作成</a>を参照してください。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>IDEのメイン・ツールバーで「プロジェクトを開く」(<span class="image"><img src="images/open-project-btn.png" alt="open project btn"></span>)ボタンをクリックするか、[Ctrl]-[Shift]-[O] (Macの場合は[⌘]-[Shift]-[O])を押します。</p>
</li>
<li>
<p>「プロジェクトを開く」ダイアログで、展開したチュートリアル・プロジェクトを格納した場所に移動します。選択して「プロジェクトを開く」をクリックし、IDEで開きます。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*注意:*IDEのインストール時にJUnitプラグインをインストールしていない場合は、NetBeansプロジェクトを開くときにJUnitライブラリへの参照を解決するよう求められることがあります。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>プロジェクトを実行して、ブラウザでどのように表示されるかを確認します。「プロジェクト」ウィンドウで「<code>jsfDemo</code>」プロジェクト・ノードを右クリックして「実行」を選択するか、メイン・ツールバーの「プロジェクトの実行」(<span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span>)ボタンをクリックします。プロジェクトがパッケージ化されてGlassFishサーバーにデプロイされ、ブラウザが開いて開始ページ(<code>index.xhtml</code>)が表示されます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/run-project.png" alt="run project">
</div>
<div class="title">Figure 1. プロジェクトを実行してブラウザで表示</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「送信」ボタンをクリックします。レスポンス・ページ(<code>response.xhtml</code>)が次のように表示されます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/response.png" alt="response">
</div>
<div class="title">Figure 2. 現在静的なページである開始ページとレスポンス・ページ</div>
</div>
<div class="paragraph">
<p>現在、開始ページとレスポンス・ページは静的なページで、`stylesheet.css`ファイルと`duke.png`イメージがあり、ブラウザからアクセスできる唯一のアプリケーション・ファイルです。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「プロジェクト」ウィンドウ([Ctrl]-[1]、Macの場合は[⌘]-[1])で、プロジェクト・ノードを右クリックし、「プロパティ」を選択して、「プロジェクト・プロパティ」ウィンドウを開きます。</p>
</li>
<li>
<p>「フレームワーク」カテゴリを選択し、「追加」ボタンをクリックします。</p>
</li>
<li>
<p>「フレームワークの追加」ダイアログ・ボックスで、「JavaServer Faces」を選択します。「OK」をクリックします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/add-framework.png" alt="add framework">
</div>
<div class="title">Figure 3. 既存のプロジェクトへのJSFサポートの追加</div>
</div>
<div class="paragraph">
<p>JavaServer Facesを選択すると、様々な構成オプションが使用可能になります。「ライブラリ」タブで、プロジェクトがJSF 2.xライブラリにアクセスする方法を指定できます。使用可能なJSFバージョンは、IDEとGlassFishサーバーのバージョンによって異なります。デフォルト・オプションでは、サーバー(GlassFishサーバー)に含まれているライブラリを使用します。ただし、IDEではJSF 2.xライブラリもバンドルされます。プロジェクトで登録されているライブラリを使用する場合は、「登録されているライブラリ」オプションを選択できます。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/libraries-tab.png" alt="libraries tab">
</div>
<div class="title">Figure 4. JSF 2.xライブラリへのアクセスの指定</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「構成」タブをクリックします。Facesサーブレットをプロジェクトのデプロイメント・ディスクリプタにどのように登録するかを指定できます。また、プロジェクトでFaceletsまたはJSPページを使用するかどうかを示すこともできます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jsf-configuration.png" alt="jsf configuration">
</div>
<div class="title">Figure 5. Facesサーブレット・オプションと優先言語の指定</div>
</div>
<div class="paragraph">
<p>プロジェクトで使用する様々なJSFコンポーネント・スイートを「コンポーネント」タブで簡単に構成することもできます。コンポーネント・スイートを使用するには、必要なライブラリをダウンロードし、Antライブラリ・マネージャを使用して、コンポーネント・スイートのライブラリを含む新しいライブラリを作成する必要があります。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/jsf-components.png" alt="jsf components">
</div>
<div class="title">Figure 6. Facesサーブレット・オプションと優先言語の指定</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「OK」をクリックして変更を確定し、「プロジェクト・プロパティ」ウィンドウを終了します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>プロジェクトにJSFサポートを追加すると、プロジェクトの`web.xml`デプロイメント・ディスクリプタが変更されて次のようになります。変更場所は*太字*で示されています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"&gt;
    *&lt;context-param&gt;
        &lt;param-name&gt;javax.faces.PROJECT_STAGE&lt;/param-name&gt;
        &lt;param-value&gt;Development&lt;/param-value&gt;
    &lt;/context-param&gt;
    &lt;servlet&gt;
        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;javax.faces.webapp.FacesServlet&lt;/servlet-class&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/faces/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;*
    &lt;welcome-file-list&gt;
        &lt;welcome-file&gt;*faces/*index.xhtml&lt;/welcome-file&gt;
    &lt;/welcome-file-list&gt;
&lt;/web-app&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>*重要: *例に示すように、<code>web.xml`に</code>&lt;welcome-file&gt;`エントリが1つのみ含まれ、このエントリに'`faces/<code>'が含まれていることを確認します。これにより、プロジェクトの開始ページ(`index.xhtml</code>)が、Facesサーブレットを介してブラウザに表示されるようになります。Faceletsタグ・ライブラリ・コンポーネントが正しくレンダリングされるようにするには、この処理が必要です。</p>
</div>
<div class="paragraph">
<p>Facesサーブレットがプロジェクトに登録され、<code>index.xhtml`開始ページをリクエストすると、ページはFacesサーブレットを介して渡されるようになります。また、`PROJECT_STAGE`コンテキスト・パラメータのエントリも追加されています。このパラメータを「`Development</code>」に設定すると、アプリケーションをデバッグするときに有用な情報が提供されます。参照:  詳細は、<a href="http://blogs.oracle.com/rlubke/entry/jsf_2_0_new_feature2">http://blogs.oracle.com/rlubke/entry/jsf_2_0_new_feature2</a>。</p>
</div>
<div class="paragraph">
<p>JSFライブラリを見つけるには、「プロジェクト」ウィンドウでプロジェクトの「ライブラリ」ノードを展開します。GlassFish Server 3.1.2またはGlassFish Server 4に含まれているデフォルトのライブラリを使用している場合、これは「GlassFish Server」ノードに表示される`javax.faces.jar`です。(古いバージョンのGlassFishを使用している場合は、`jsf-api.jar`および`jsf-impl.jar`ライブラリが`javax.faces.jar`のかわりに表示されます。)</p>
</div>
<div class="paragraph">
<p>IDEのJSF 2.xサポートには、主にJSF固有の多数のウィザード、およびFaceletsエディタで提供される特別な機能が含まれています。これらの機能については、以降の手順で説明します。詳細は、<a href="jsf20-support.html">NetBeans IDEでのJSF 2.xのサポート</a>を参照してください。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="managedBean">管理対象Beanの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JSFの管理対象Beanを使用して、ユーザー・データを処理し、リクエスト間でそれを保持することができます。管理対象Beanは、データの格納に使用できる<a href="http://en.wikipedia.org/wiki/Plain_Old_Java_Object">POJO</a> (プレーン・オールドJavaオブジェクト)です。これは、JSFフレームワークを使用してGlassFishサーバーなどのコンテナで管理されます。</p>
</div>
<div class="paragraph">
<p>POJOは基本的に、publicで引数のないコンストラクタを格納し、プロパティが<a href="http://download.oracle.com/javase/tutorial/javabeans/">JavaBeans</a>命名規則に準拠するJavaクラスです。</p>
</div>
<div class="paragraph">
<p>プロジェクトを実行して生成された<a href="#staticPage">静的ページ</a>を見ると、ユーザーが入力した数値が現在選択されている数値と一致するかどうか、また、この結果に適した表示が返されるかどうかを判断する機構が必要です。IDEの<a href="jsf20-support.html#managedBean">管理対象Beanウィザード</a>を使用して、この目的に応じた管理対象Beanを作成します。次の項で作成するFaceletsページは、ユーザーが入力する数値と生成されたレスポンスにアクセスする必要があります。これを有効にするには、`userNumber`および`response`プロパティを管理対象Beanに追加します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#usingManagedBean">管理対象Beanウィザードの使用</a></p>
</li>
<li>
<p><a href="#creatingConstructor">コンストラクタの作成</a></p>
</li>
<li>
<p><a href="#addingProperties">プロパティの追加</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="usingManagedBean">管理対象Beanウィザードの使用</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「プロジェクト」ウィンドウで「<code>jsfDemo</code>」プロジェクト・ノードを右クリックし、「新規」&gt;「JSF管理対象Bean」を選択します。(「管理対象Bean」が表示されない場合は、「その他」を選択します。次に、「JavaServer Faces」カテゴリから「JSF管理対象Bean」オプションを選択します。「次」をクリックします。)</p>
</li>
<li>
<p>ウィザードで、次の情報を入力します。</p>
<div class="ulist">
<ul>
<li>
<p><strong>クラス名:</strong> UserNumberBean</p>
</li>
<li>
<p><strong>パッケージ:</strong> guessNumber</p>
</li>
<li>
<p><strong>名前:</strong> UserNumberBean</p>
</li>
<li>
<p><strong>スコープ:</strong> session</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/managed-bean.png" alt="managed bean">
</div>
<div class="title">Figure 7. JSF管理対象Beanウィザードを使用した新しい管理対象Beanの作成</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「終了」をクリックします。`UserNumberBean`クラスが生成され、エディタで開かれます。次の注釈(*太字*で表示)を確認します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package guessNumber;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;

/**
 *
 * @author nbuser
 */
*@ManagedBean(name="UserNumberBean")
@SessionScoped*
public class UserNumberBean {

    /** Creates a new instance of UserNumberBean */
    public UserNumberBean() {
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>ここではJSF 2.xを使用しているため、注釈を使用して、JSF固有のコンポーネントをすべて宣言できます。以前のバージョンでは、Faces構成ファイル(<code>faces-config.xml</code>)で宣言する必要がありました。</p>
</div>
<div class="paragraph">
<p><span class="tips">すべてのJSF 2.1注釈を確認するには、<a href="http://javaserverfaces.java.net/nonav/docs/2.1/managed-bean-javadocs/index.html">Faces管理対象Beanの注釈の仕様</a>を参照してください。</span></p>
</div>
</div>
<div class="sect2">
<h3 id="creatingConstructor">コンストラクタの作成</h3>
<div class="paragraph">
<p>`UserNumberBean`コンストラクタは、0から10の間のランダムな数値を生成し、インスタンス変数に格納します。これが、アプリケーションのビジネス・ロジックの一部を形成します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>`UserNumberBean`クラスのコンストラクタを定義します。次のコードを入力します(変更箇所は*太字*で表示)。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class UserNumberBean {

    *Integer randomInt;*

    /** Creates a new instance of UserNumberBean */
    public UserNumberBean() {
        *link:http://docs.oracle.com/javase/7/docs/api/java/util/Random.html[+Random+] randomGR = new Random();
        randomInt = new Integer(randomGR.link:http://docs.oracle.com/javase/7/docs/api/java/util/Random.html#nextInt%28int%29[+nextInt+](10));
        System.out.println("Duke's number: " + randomInt);*
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>このコードは0から10の間のランダムな数値を生成し、その数値をサーバー・ログに出力します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>インポートを修正します。そのためには、エディタの左マージンに表示されるヒント・バッチ(<span class="image"><img src="images/hint-icon.png" alt="hint icon"></span>)をクリックし、`java.util.Random`をクラスにインポートするオプションを選択します。</p>
</li>
<li>
<p>プロジェクトを再度実行します(「プロジェクトの実行」(<span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span>)ボタンをクリックするか、[F6] (Macの場合は[fn]-[F6])を押します)。プロジェクトを実行すると、サーバーのログ・ファイルが「出力」ウィンドウに自動的に開かれます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/output1.png" alt="output1">
</div>
<div class="title">Figure 8. 「出力」ウィンドウにサーバーのログ・ファイルが自動的に開きます。</div>
</div>
<div class="paragraph">
<p>コンストラクタで示されるように、出力には`Duke&#8217;s number: `が表示されません。`UserNumberBean`オブジェクトは作成されませんでした。これは、JSFがデフォルトで_遅延インスタンス化_を使用するためです。つまり、特定のスコープ内のBeansは、アプリケーションで必要とされたときにのみ作成され、インスタンス化されます。</p>
</div>
<div class="paragraph">
<p><a href="http://javaserverfaces.java.net/nonav/docs/2.1/managed-bean-javadocs/index.html">`@ManagedBean`注釈用のJavadoc</a>には、次のように記載されています。</p>
</div>
<div class="paragraph">
<p><em>`eager()`属性の値が`true`で、`managed-bean-scope`の値がapplicationの場合は、アプリケーションの開始時にランタイムがこのクラスをインスタンス化する必要があります。このインスタンス化とインスタンスの格納は、他のリクエストを処理する前に実行される必要があります。_eager_の値が指定されていないか`false`の場合、または`managed-bean-scope`がapplication以外の場合は、デフォルトの「遅延」インスタンス化と管理対象Beanのスコープ指定記憶域が生じます。</em></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>`UserNumberBean`はセッション・スコープ指定されているため、`Serializable`インタフェースを実装させます。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@ManagedBean(name="UserNumberBean")
@SessionScoped
public class UserNumberBean *implements Serializable* {</code></pre>
</div>
</div>
<div class="paragraph">
<p>ヒント・バッジ(<span class="image"><img src="images/hint-icon.png" alt="hint icon"></span>)を使用して、`java.io.Serializable`をクラスにインポートします。</p>
</div>
</div>
<div class="sect2">
<h3 id="addingProperties">プロパティの追加</h3>
<div class="paragraph">
<p>次の項で作成するFaceletsページは、ユーザーが入力する数値と生成されたレスポンスにアクセスする必要があります。これを容易にするため、`userNumber`および`response`プロパティをクラスに追加します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>まず、`userNumber`という名前の`Integer`を宣言します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@ManagedBean(name="UserNumberBean")
@SessionScoped
public class UserNumberBean implements Serializable {

    Integer randomInt;
    *Integer userNumber;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>エディタ内で右クリックし、「コードを挿入」を選択します([Alt]-[Insert]、Macの場合は[Ctrl]-[I])。取得メソッドおよび設定メソッドを選択します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/getter-setter.png" alt="getter setter">
</div>
<div class="title">Figure 9. IDEを使用した、プロパティのアクセッサ・メソッドの生成</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「<code>userNumber</code>: <code>Integer</code>」オプションを選択します。「生成」をクリックします。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/generate-getters-setters.png" alt="generate getters setters">
</div>
<div class="title">Figure 10. IDEを使用した、プロパティのアクセッサ・メソッドの生成</div>
</div>
<div class="paragraph">
<p>`getUserNumber()`および`setUserNumber(Integer userNumber)`メソッドがクラスに追加されます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>`response`プロパティを作成します。`response`という名前の`String`を宣言します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@ManagedBean(name="UserNumberBean")
@SessionScoped
public class UserNumberBean implements Serializable {

    Integer randomInt;
    Integer userNumber;
    *String response;*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>`response`の取得メソッドを作成します。(このアプリケーションでは設定メソッドは必要ありません。)前出のステップ2で示したIDEの「コードを生成」ポップアップを使用して、テンプレート・コードを生成することもできます。ただし、このチュートリアルでは、単純に次のメソッドをクラスに貼り付けます。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">public String getResponse() {
    if ((userNumber != null) &amp;amp;&amp;amp; (userNumber.link:http://download.oracle.com/javase/6/docs/api/java/lang/Integer.html#compareTo(java.lang.Integer)[+compareTo+](randomInt) == 0)) {

        //invalidate user session
        FacesContext context = FacesContext.getCurrentInstance();
        HttpSession session = (HttpSession) context.getExternalContext().getSession(false);
        session.invalidate();

        return "Yay! You got it!";
    } else {

        return "&lt;p&gt;Sorry, " + userNumber + " isn't it.&lt;/p&gt;"
                + "&lt;p&gt;Guess again...&lt;/p&gt;";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>このメソッドでは2つの関数が実行されます。
1. ユーザーが入力した数値(<code>userNumber</code>)がセッション用に生成されたランダムな数値(<code>randomInt</code>)と等しいかどうか、および`String`レスポンスが返されるかどうかがテストされます。
2. ユーザーが正しい数値を推測した場合(たとえば`userNumber`と`randomInt`が正しい場合)、ユーザー・セッションは無効化されます。ユーザーが再度操作する場合に新しい数値が生成されるようにするには、この処理が必要です。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>エディタを右クリックし、「インポートを修正」を選択します([Alt]-[Shift]-[I]、Macの場合は[⌘]-[Shift]-[I])。次の項目用に、インポート文が自動的に作成されます。</p>
<div class="ulist">
<ul>
<li>
<p><code>javax.servlet.http.HttpSession</code></p>
</li>
<li>
<p><code>javax.faces.context.FacesContext</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>エディタ内の項目上で[Ctrl]-[Space]を押すと、コード補完による候補とドキュメント・サポートを呼出しできます。`FacesContext`で[Ctrl]-[Space]を押して、Javadocのクラス説明を表示します。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/documentation-support.png" alt="documentation support">
</div>
<div class="title">Figure 11. [Ctrl]-[Space]の押下によるコード補完とドキュメント・サポートの呼出し</div>
</div>
<div class="paragraph">
<p>ドキュメント・ウィンドウの「Webブラウザ」(<span class="image"><img src="images/web-browser-icon.png" alt="web browser icon"></span>)アイコンをクリックし、外部WebブラウザでJavadocを開きます。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="wire">ページへの管理対象Beanの接続</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JSFの主な目的の1つは、<a href="#pojo">POJO</a>およびPOJOとアプリケーションのビューとの相互作用を管理するために、ボイラープレート・コードを記述する必要性を除去することです。前の項で、アプリケーションを実行したときにJSFが`UserNumberBean`オブジェクトをインスタンス化したのがこの例です。この概念は<a href="http://martinfowler.com/articles/injection.html">制御の反転</a> (IoC)と呼ばれ、コンテナがアプリケーションの一部を管理できるようにするものです。これがない場合、開発者は反復的なコードを記述する必要があります。</p>
</div>
<div class="paragraph">
<p>前の項では、0から10の間のランダムな数値を生成する管理対象Beanを作成しました。また、ユーザーが入力する数値を表す`userNumber`プロパティと、ユーザーの推測に対するレスポンスを表す`response`プロパティも作成しました。</p>
</div>
<div class="paragraph">
<p>この項では、`UserNumberBean`とそのプロパティをWebページで使用する方法について説明します。JSFでは、式言語(EL)を使用して実行できます。式言語を使用して、アプリケーションのWebページに含まれているJSFのUIコンポーネントにプロパティ値をバインドします。この項では、JSF 2.xの暗黙的なナビゲーション機能を活用してindexページとresponseページとの間を移動する方法も説明します。</p>
</div>
<div class="paragraph">
<p>IDEには、エディタ内の項目上で[Ctrl]-[Space]を押すことによって呼出しできる、コード補完とドキュメント機能によるサポートも用意されています。</p>
</div>
<div class="paragraph">
<p>まず`index.xhtml`を変更してから、`response.xhtml`を変更します。両方のページで、HTMLフォーム要素を、<a href="http://javaserverfaces.java.net/nonav/docs/2.1/vdldocs/facelets/index.html">JSF HTMLタグ・ライブラリ</a>で定義されているJSFの対応する要素で置き換えます。次に、JSF式言語を使用して、プロパティ値と選択したUIコンポーネントをバインドします。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#index">index.xhtml</a></p>
</li>
<li>
<p><a href="#response">response.xhtml</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="index">index.xhtml</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>エディタで`index.xhtml`ページを開きます。「プロジェクト」ウィンドウで「<code>index.xhtml</code>」ノードをダブルクリックするか、[Alt]-[Shift]-[O]を押して「ファイルに移動」ダイアログを使用します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>indexページとresponseページの両方に、ここで必要なJSF UIコンポーネントがすでに含まれています。それらをコメント解除し、現在使用しているHTML要素をコメントアウトします。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>HTMLフォーム要素をコメントアウトします。これを行うには、次のイメージのHTMLフォーム要素を強調表示し、[Ctrl]-[/] (Macの場合は[⌘]-[/])を押します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*注意: *強調表示するには、マウスを使用してエディタ内でクリックしてドラッグするか、キーボードを使用して、[Shift]を押しながら矢印キーを押します。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/comment-out.png" alt="comment out">
</div>
<div class="title">Figure 12. コードを強調表示した後の[Ctrl]-[/]の押下によるコードのコメントアウト</div>
</div>
<div class="paragraph">
<p>[Ctrl]-[/] (Macの場合は[⌘]-[/])を使用して、エディタ内のコメントを切り替えます。JavaやCSSなど、他のファイル・タイプにこのキーボード・ショートカットを適用することもできます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>JSF HTMLフォーム・コンポーネントをコメント解除します。次のイメージに示すように、コンポーネントを強調表示して[Ctrl]-[/] (Macの場合は[⌘]-[/])を押します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*注意:*コードのコメントを外すには[Ctrl]-[/]を2回押すことが必要な場合があります。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/comment.png" alt="comment">
</div>
<div class="title">Figure 13. コメントアウトされたコードを強調表示した後の[Ctrl]-[/]の押下によるコメント解除</div>
</div>
<div class="paragraph">
<p>JSF HTMLフォーム・コンポーネントをコメント解除すると、<code>&lt;h:form&gt;</code>、<code>&lt;h:inputText&gt;`および</code>&lt;h:commandButton&gt;`タグが宣言されていないことがエディタに表示されます。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/undeclared-component.png" alt="undeclared component">
</div>
<div class="title">Figure 14. エディタに表示された、宣言されていないコンポーネントに関するエラー・メッセージ</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>これらのコンポーネントを宣言するには、IDEのコード補完を使用して、タグ・ライブラリ名前空間をページの`&lt;html&gt;`タグに追加します。宣言されていないいずれかのタグにカーソルを置き、[Alt]-[Enter]を押して提案されるタグ・ライブラリを追加します。(複数のオプションがある場合は、エディタに表示されているタグを選択してから[Enter]を押してください。)JSF HTMLタグ・ライブラリ名前空間が`&lt;html&gt;`タグ(次に*太字*で表示)に追加され、エラー表示が消えます。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*注意:*IDEでタグ・ライブラリを追加するオプションが表示されない場合、 <code>&lt;html&gt;</code> 要素を手動で変更する必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;html xmlns="http://www.w3.org/1999/xhtml"
      *xmlns:h="http://xmlns.jcp.org/jsf/html"*&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>JSF式言語を使用して、`UserNumberBean`の`userNumber`プロパティを`inputText`コンポーネントにバインドします。`value`属性は、レンダリングされたコンポーネントの現在の値を指定するために使用できます。次の*太字*で表示されているコードを入力します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;h:form&gt;
    &lt;h:inputText id="userNumber" size="2" maxlength="2" *value="#{UserNumberBean.userNumber}"* /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>JSF式言語では`#{}`構文を使用します。これらの区切り文字内で、管理対象Beanの名前と、適用するBeanプロパティを、ドット(<code>.</code>)で区切って指定します。これで、フォーム・データがサーバーに送られると、プロパティの設定メソッド(<code>setUserNumber()</code>)を使用して、値が自動的に`userNumber`プロパティに保存されます。また、ページがリクエストされて`userNumber`の値がすでに設定されている場合、レンダリングされる`inputText`コンポーネントに値が自動的に表示されます。詳細は、<a href="http://docs.oracle.com/javaee/7/tutorial/doc/jsf-develop001.htm#BNAQP">Java EE 7チュートリアル: 12.1.2項の式言語を使用した管理対象Beanの参照</a>を参照してください。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>フォーム・ボタンをクリックして呼び出されたリクエストの宛先を指定します。フォームのHTMLバージョンでは、`&lt;form&gt;`タグの`action`属性を使用してこれを実行できました。JSFの場合は、`commandButton`の`action`属性を使用できます。また、JSF 2.xの暗黙的なナビゲーション機能により、宛先のファイルの名前を指定するのみで済みます。ファイル拡張子は不要です。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>次の*太字*で表示されているコードを入力します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;h:form&gt;
    &lt;h:inputText id="userNumber" size="2" maxlength="2" value="#{UserNumberBean.userNumber}" /&gt;
    &lt;h:commandButton id="submit" value="submit" *action="response"* /&gt;
&lt;/h:form&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>JSFランタイムは、<code>response`という名前のファイルを検索します。リクエスト元のファイル(`index*.xhtml*</code>)で使用されているのと同じファイル拡張子であると想定し、元のファイルと同じディレクトリ内(webrootなど)で`response.xhtml`ファイルを探します。</p>
</div>
<div class="paragraph">
<p><strong>注意:</strong> JSF 2.xは、開発者のタスクを容易にすることを目的としています。このプロジェクトでJSF 1.2を使用している場合は、Faces構成ファイルでナビゲーション・ルールを次のように宣言する必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;navigation-rule&gt;
    &lt;from-view-id&gt;/index.xhtml&lt;/from-view-id&gt;

    &lt;navigation-case&gt;
        &lt;from-outcome&gt;response&lt;/from-outcome&gt;
        &lt;to-view-id&gt;/response.xhtml&lt;/to-view-id&gt;
    &lt;/navigation-case&gt;
&lt;/navigation-rule&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>以降のステップ7から12は、オプションです。プロジェクトをすばやくビルドする場合は、<a href="#response"><code>response.xhtml</code></a>に進みます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>前出のEL式でリクエストを処理するときに`setUserNumber()`メソッドが実際にコールされるかどうかをテストします。これを行うには、IDEのJavaデバッガを使用します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>`UserNumberBean`クラスに切り替えます([Ctrl]-[Tab]を押し、一覧からファイルを選択します。)`setUserNumber()`メソッドの署名にブレークポイントを設定します。これを行うには、左マージンをクリックします。赤のバッジが表示され、メソッドのブレークポイントが設定されたことを示します。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/set-breakpoint.png" alt="set breakpoint">
</div>
<div class="title">Figure 15. エディタの左マージンのクリックによるブレークポイントの設定</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>IDEのメイン・ツールバーにある「プロジェクトをデバッグ」(<span class="image"><img src="images/breakpoint-btn.png" alt="breakpoint btn"></span>)ボタンをクリックします。デバッグ・セッションが開始され、プロジェクトの開始ページがブラウザに表示されます。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>注意:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>アプリケーションのデバッグ用のサーバー・ポートの確認を求められることがあります。</p>
</li>
<li>
<p>「プロジェクトをデバッグ」ダイアログが表示されたら、デフォルトのサーバー側Javaオプションを選択して、「デバッグ」をクリックします。</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ブラウザで、フォームに数値を入力し、「送信」ボタンをクリックします。</p>
</li>
<li>
<p>IDEに切り替え、`UserNumberBean`クラスを確認します。デバッガが`setUserNumber()`メソッド内で一時停止されています。</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debugger-suspended.png" alt="debugger suspended">
</div>
<div class="title">Figure 16. ブレークポイントによるデバッガの一時停止</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>デバッガの「変数」ウィンドウを開きます(「ウィンドウ」&gt;「デバッグ」&gt;「変数」を選択するか、[Ctrl]-[Shift]-[1]を押します)。デバッガが一時停止されている場所の変数値が表示されます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/variables-window.png" alt="variables window">
</div>
<div class="title">Figure 17. デバッガの「変数」ウィンドウを使用した変数値のモニター</div>
</div>
<div class="paragraph">
<p>前出のイメージでは、<code>setUserNumber()`署名の`userNumber`変数に、値`4`が指定されています。(数値4がフォームに入力されたため。)「`this</code>」は、ユーザー・セッション用に作成された`UserNumberBean`オブジェクトを参照します。その下にある`userNumber`プロパティの値は、現在`null`と表示されています。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>デバッガのツールバーで、「ステップ・イン」(<span class="image"><img src="images/step-into-btn.png" alt="step into btn"></span>)ボタンをクリックします。デバッガは、現在一時停止されている行を実行します。「変数」ウィンドウがリフレッシュされ、実行による変更が表示されます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/variables-window2.png" alt="variables window2">
</div>
<div class="title">Figure 18. コードのステップ実行時の「変数」ウィンドウのリフレッシュ</div>
</div>
<div class="paragraph">
<p>`userNumber`プロパティは、フォームに入力された値に設定されます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>メイン・メニューから「デバッグ」→「デバッガ・セッションを終了」([Shift]-[F5]、Macでは[Shift]-[Fn]-[F5])を選択して、デバッガを停止します。</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="response">response.xhtml</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>エディタで`response.xhtml`ページを開きます。「プロジェクト」ウィンドウで「<code>response.xhtml</code>」ノードをダブルクリックするか、[Alt]-[Shift]-[O]を押して「ファイルに移動」ダイアログを使用します。</p>
</li>
<li>
<p>HTMLフォーム要素をコメントアウトします。HTML`&lt;form&gt;`の開始タグと終了タグ、およびそれらのタグ間にあるコードを強調表示し、[Ctrl]-[/] (Macの場合は[⌘]-[/])を押します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*注意: *強調表示するには、マウスを使用してエディタ内でクリックしてドラッグするか、キーボードを使用して、[Shift]を押しながら矢印キーを押します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>JSF HTMLフォーム・コンポーネントをコメント解除します。`&lt;h:form&gt;`の開始タグと終了タグ、およびそれらのタグ間にあるコードを強調表示し、[Ctrl]-[/] (Macの場合は[⌘]-[/])を押します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>この時点では、`&lt;body&gt;`タグ間のコードは次のようになります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;body&gt;
    &lt;div id="mainContainer"&gt;

        &lt;div id="left" class="subContainer greyBox"&gt;

            &lt;h4&gt;[ response here ]&lt;/h4&gt;

            &lt;!--&lt;form action="index.xhtml"&gt;

                &lt;input type="submit" id="backButton" value="Back"/&gt;

            &lt;/form&gt;--&gt;

            &lt;h:form&gt;

                &lt;h:commandButton id="backButton" value="Back" /&gt;

            &lt;/h:form&gt;

        &lt;/div&gt;

        &lt;div id="right" class="subContainer"&gt;

            &lt;img src="duke.png" alt="Duke waving" /&gt;
             &lt;!--&lt;h:graphicImage url="/duke.png" alt="Duke waving" /&gt;--&gt;

        &lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>JSF HTMLフォーム・コンポーネントをコメント解除すると、エディタに`&lt;h:form&gt;`と`&lt;h:commandButton&gt;`タグが宣言されていないことが表示されます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>これらのコンポーネントを宣言するには、IDEのコード補完を使用して、タグ・ライブラリ名前空間をページの`&lt;html&gt;`タグに追加します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>エディタのコード補完サポートを使用して、必要なJSF名前空間をファイルに追加します。コード補完を使用してJSFまたはFaceletsタグを選択すると、必要な名前空間が自動的にドキュメントのルート要素に追加されます。詳細は、<a href="jsf20-support.html#facelets">NetBeans IDEでのJSF 2.xのサポート</a>を参照してください。</p>
</div>
<div class="paragraph">
<p>宣言されていない任意のタグの上にカーソルを置き、[Ctrl]-[Space]を押します。コード補完による候補とドキュメント・サポートが表示されます。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/code-completion2.png" alt="code completion2">
</div>
<div class="title">Figure 19. [Ctrl]-[Space]の押下によるコード補完の候補とドキュメント・ポップアップ・ウィンドウの呼出し</div>
</div>
<div class="paragraph">
<p>[Enter]を押します。(複数のオプションがある場合は、エディタに表示されているタグを選択してから[Enter]を押してください。)JSF HTMLタグ・ライブラリ名前空間が`&lt;html&gt;`タグ(次に*太字*で表示)に追加され、エラー表示が消えます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;html xmlns="http://www.w3.org/1999/xhtml"
      *xmlns:h="http://xmlns.jcp.org/jsf/html"*&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>フォーム・ボタンをクリックして呼び出されたリクエストの宛先を指定します。ユーザーがボタンをクリックするとindexページに戻るように、ボタンを設定します。これを行うには、`commandButton`の`action`属性を使用します。*太字*で表示されているコードを入力します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;h:form&gt;

    &lt;h:commandButton id="backButton" value="Back" *action="index"* /&gt;

&lt;/h:form&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>注意:</strong> 「<code>action="index"</code>」と入力すると、JSFの暗黙的なナビゲーション機能に依存することになります。ユーザーがフォーム・ボタンをクリックすると、JSFランタイムは`index`という名前のファイルを検索します。リクエスト元のファイル(<code>response*.xhtml*</code>)で使用されているのと同じファイル拡張子であると想定し、元のファイルと同じディレクトリ内(webrootなど)で`index.xhtml`ファイルを探します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>静的テキスト「[response here]」を、`UserNumberBean`の`response`プロパティの値で置き換えます。これを行うには、JSF式言語を使用します。次の*太字*で示したコードを入力します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;div id="left" class="subContainer greyBox"&gt;

    &lt;h4&gt;*&lt;h:outputText value="#{UserNumberBean.response}"/&gt;*&lt;/h4&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>プロジェクトを実行します(「プロジェクトの実行」(<span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span>)ボタンをクリックするか、[F6] (Macの場合は[fn]-[F6])を押します)。ブラウザに開始ページが表示されたら、数値を入力して「<code>送信</code>」をクリックします。次のようなレスポンス・ページが表示されます(正しい数値を推測しなかった場合)。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/response2.png" alt="response2">
</div>
<div class="title">Figure 20. ブラウザでのプロジェクトの現在のステータスの表示</div>
</div>
<div class="paragraph">
<p>レスポンス・ページの現在の状態に、2つの間違いがあります。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Html`&lt;p&gt;`タグが、レスポンス・メッセージ内に表示されています。</p>
</li>
<li>
<p>「戻る」ボタンが正しい位置に表示されていません。(<a href="#originalVersion">元のバージョン</a>と比較。)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>次の2つの手順で、これらの間違いを修正します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>`&lt;h:outputText&gt;`タグの`escape`属性を`false`に設定します。カーソルを`outputText`と`value`の間に置き、スペースを挿入してから[Ctrl]-[Space]を押して、コード補完を呼び出します。下にスクロールして`escape`属性を選択し、ドキュメントを確認します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/escape-false.png" alt="escape false">
</div>
<div class="title">Figure 21. [Ctrl]-[Space]の押下による考えられる属性値とドキュメントの表示</div>
</div>
<div class="paragraph">
<p>ドキュメントで示されるように、`escape`の値はデフォルトで`true`に設定されます。つまり、前出に示すように、通常はhtmlとして解析される文字がすべて文字列に含まれます。値を`false`に設定すると、htmlとして解析できるすべての文字を、そのようにレンダリングできます。</p>
</div>
<div class="paragraph">
<p>[Enter]を押し、値として「<code>false</code>」と入力します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;h4&gt;&lt;h:outputText *escape="false"* value="#{UserNumberBean.response}"/&gt;&lt;/h4&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>&lt;h:form&gt;`タグの`prependId`属性を`false`に設定します。カーソルを</code>&lt;h:form&gt;`の「<code>m</code>」のすぐ後に置き、スペースを入力してから[Ctrl]-[Space]を押して、コード補完を呼び出します。下にスクロールして`prependId`属性を選択し、ドキュメントを確認します。次に[Enter]を押し、値として「<code>false</code>」と入力します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;h:form *prependId="false"*&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>JSFは内部IDを適用して、UIコンポーネントをトラックします。現在の例で、レンダリングされたページのソース・コードを調べると、次のように表示されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;form id="j_idt5" name="j_idt5" method="post" action="/jsfDemo/faces/response.xhtml" enctype="application/x-www-form-urlencoded"&gt;
&lt;input type="hidden" name="j_idt5" value="j_idt5" /&gt;
    &lt;input *id="j_idt5:backButton"* type="submit" name="j_idt5:backButton" value="Back" /&gt;
    &lt;input type="hidden" name="javax.faces.ViewState" id="javax.faces.ViewState" value="7464469350430442643:-8628336969383888926" autocomplete="off" /&gt;
&lt;/form&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>フォーム要素のIDは`j_idt5`です。このIDは、フォームに含まれている「戻る」ボタンのIDに付加されます(*太字*で表示)。「戻る」ボタンは`#backButton`スタイル・ルール(`stylesheet.css`で定義)に依存するため、JSFのIDが付加されると、このルールが妨げられます。これを回避するには、`prependId`を`false`に設定します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>プロジェクトを再度実行します(「プロジェクトの実行」(<span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span>)ボタンをクリックするか、[F6] (Macの場合は[fn]-[F6])を押します)。開始ページに数値を入力し、「送信」をクリックします。レスポンス・ページに`&lt;p&gt;`タグのないレスポンス・メッセージが表示され、「戻る」ボタンが正しい位置に配置されます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/response3.png" alt="response3">
</div>
<div class="title">Figure 22. ブラウザでのプロジェクトの現在のステータスの表示</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「戻る」ボタンをクリックします。`UserNumberBean`の`userNumber`プロパティの現在の値はJSF`inputText`コンポーネントにバインドされているため、前に入力した数値がテキスト・フィールドに表示されます。</p>
</li>
<li>
<p>IDEの「出力」ウィンドウでサーバー・ログを確認し([Ctrl]-[4]、Macの場合は[⌘]-[4])、正しい推測値を判断します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>なんらかの理由でサーバー・ログが表示されない場合は、「サービス」ウィンドウに切り替え([Ctrl]-[5]、Macの場合は[⌘]-[5])、「サーバー」ノードを展開します。次に、プロジェクトがデプロイされているGlassFishサーバーを右クリックし、「サーバー・ログを表示」を選択します。サーバー・ログに数値が見つけることができない場合は、プロジェクト・ノードを右クリックし、「消去してビルド」を選択して、アプリケーションを再ビルドしてみてください。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>正しい数値を入力し、「送信」をクリックします。アプリケーションは、入力された数値を現在保存されている数値と比較し、適切なメッセージを表示します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/yay.png" alt="yay">
</div>
<div class="title">Figure 23. 一致する数値を入力すると正しいレスポンスが表示される</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「戻る」ボタンをもう一度クリックします。前に入力した数値はテキスト・フィールドに表示されていません。`UserNumberBean`の`getResponse()`メソッドは、正しい数値が推測されると<a href="#getResponse">現在のユーザー・セッションを無効にします</a>。</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="template">Faceletsテンプレートの適用</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Faceletsは、JSF 2.xの標準表示テクノロジになりました。Faceletsは、すべてのJSF UIコンポーネントをサポートする軽量テンプレート作成フレームワークで、アプリケーション・ビュー用のJSFコンポーネント・ツリーをビルドおよびレンダリングするのに使用されます。また、ユーザーがスタック・トレース、コンポーネント・ツリー、およびスコープ指定された変数を確認できるようにすることで、ELエラー発生時の開発サポートを提供します。</p>
</div>
<div class="paragraph">
<p>チュートリアルでこれまでに操作してきた`index.xhtml`および`response.xhtml`ファイルは、Faceletsページです。Faceletsページでは`.xhtml`拡張子が使用されます。また、JSF 2.xプロジェクトで作業しているため(JSF 2.xライブラリにはFacelets JARファイルが含まれる)、ビューではJSFコンポーネント・ツリーを適切にレンダリングできました。</p>
</div>
<div class="paragraph">
<p>この項は、Faceletsのテンプレート作成に慣れることを目的としています。多くのビューを含むプロジェクトの場合、複数のビューの構造および外観を定義するテンプレート・ファイルを適用すると便利なことがよくあります。アプリケーションでは、リクエストをサービスするときに、動的に用意されたコンテンツをテンプレート・ファイルに挿入し、結果をクライアントに送り返します。このプロジェクトに含まれているビューは2つ(開始ページとレスポンス・ページ)のみですが、これらのビューには重複するコンテンツが多数含まれています。重複するコンテンツをFaceletsテンプレートにまとめて、テンプレート・クライアント・ファイルを作成し、開始ページとレスポンス・ページに固有のコンテンツを処理することができます。</p>
</div>
<div class="paragraph">
<p>IDEには、Faceletsテンプレートを作成するための<a href="jsf20-support.html#faceletsTemplate">Faceletsテンプレート・ウィザード</a>と、テンプレートに依存するファイルを作成するためのFaceletsテンプレート・クライアント・ウィザードが用意されています。この項では、これらのウィザードを使用します。</p>
</div>
<div class="paragraph">
<p><strong>注意:</strong> IDEには、プロジェクト用に個々のFaceletsページを作成するための、JSFページ・ウィザードも用意されています。詳細は、<a href="jsf20-support.html#jsfPage">NetBeans IDEでのJSF 2.xのサポート</a>を参照してください。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#templateFile">Faceletsテンプレート・ファイルの作成</a></p>
</li>
<li>
<p><a href="#templateClient">テンプレート・クライアント・ファイルの作成</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="templateFile">Faceletsテンプレート・ファイルの作成</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Faceletsテンプレート・ファイルを作成します。[Ctrl]-[N] (Macの場合は[⌘]-[N])を押して、ファイル・ウィザードを開きます。「JavaServer Faces」カテゴリを選択し、「Faceletsテンプレート」を選択します。「次」をクリックします。</p>
</li>
<li>
<p>ファイル名として「<code>template</code>」と入力します。</p>
</li>
<li>
<p>8つのレイアウト・スタイルから任意のスタイルを選択し、「終了」をクリックします。(既存のスタイル・シートを使用するので、どのレイアウト・スタイルを選択してもかまいません。)</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/layout-style.png" alt="layout style">
</div>
<div class="title">Figure 24. Faceletsテンプレート・ウィザードでの一般的なレイアウト・スタイルからの選択</div>
</div>
<div class="paragraph">
<p>ウィザードで、選択に基づいて`template.xhtml`ファイルおよび付属するスタイル・シートが生成され、プロジェクトのwebroot内の「<code>resources</code>」&gt;「<code>css</code>」フォルダに置かれます。</p>
</div>
<div class="paragraph">
<p>ウィザードが完了すると、テンプレート・ファイルがエディタに開かれます。ブラウザでこのテンプレートを表示するには、エディタ内を右クリックし、「表示」を選択します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>テンプレート・ファイルのマークアップを確認します。次の点を確認します。</p>
<div class="ulist">
<ul>
<li>
<p><code>facelets`タグ・ライブラリがページの</code>&lt;html&gt;`タグ内で宣言されています。タグ・ライブラリに接頭辞`ui`があります。</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;html xmlns="http://www.w3.org/1999/xhtml"
      *xmlns:ui="http://xmlns.jcp.org/jsf/facelets"*
      xmlns:h="http://xmlns.jcp.org/jsf/html"&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Faceletsページで、htmlの`&lt;head&gt;`および`&lt;body&gt;`タグではなく、<code>&lt;h:head&gt;`および</code>&lt;h:body&gt;`タグが使用されています。Faceletsは、これらのタグを使用することによって、ページ全体にわたるコンポーネント・ツリーを構築できます。</p>
</li>
<li>
<p>ページは、ウィザードの完了時に作成されたスタイル・シートを参照します。</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;h:head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
    *&lt;link href="./resources/css/default.css" rel="stylesheet" type="text/css" /&gt;*
    *&lt;link href="./resources/css/cssLayout.css" rel="stylesheet" type="text/css" /&gt;*
    &lt;title&gt;Facelets Template&lt;/title&gt;
&lt;/h:head&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;ui:insert&gt;`タグは、選択したレイアウト・スタイルに関連付けられているすべての区画のページ本体で使用されます。それぞれの</code>&lt;ui:insert&gt;`タグには、区画を識別する`name`属性があります。例:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;div id="top"&gt;
    *&lt;ui:insert name="top"&gt;Top&lt;/ui:insert&gt;*
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#staticPage">開始</a>ページと<a href="#responsePage">レスポンス</a>・ページを再度確認します。2つのページ間で異なるコンテンツは、グレーの四角形の中にあるタイトルとテキストのみです。そのため、テンプレートで残りのすべてのコンテンツを提供できます。</p>
</li>
<li>
<p>テンプレート・ファイルのすべてのコンテンツを、次のコンテンツに置き換えます。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;?xml version='1.0' encoding='UTF-8' ?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"&gt;

    &lt;h:head&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
        &lt;link href="css/stylesheet.css" rel="stylesheet" type="text/css" /&gt;

        &lt;title&gt;&lt;ui:insert name="title"&gt;Facelets Template&lt;/ui:insert&gt;&lt;/title&gt;
    &lt;/h:head&gt;

    &lt;h:body&gt;

        &lt;div id="left"&gt;
            &lt;ui:insert name="box"&gt;Box Content Here&lt;/ui:insert&gt;
        &lt;/div&gt;

    &lt;/h:body&gt;

&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>このコードによって、次の変更が実装されます。
* プロジェクトの`stylesheet.css`ファイルによって、ウィザードで作成されたテンプレート・スタイル・シート参照が置き換えられます。
* <code>&lt;ui:insert&gt;`タグ(およびそれらに含まれる</code>&lt;div&gt;`タグ)が、<code>box`という名前のものを除き、すべて除去されます。
* ページ・タイトルを囲んで</code>&lt;ui:insert&gt;`タグ・ペアが配置され、`title`という名前が付けられています。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>該当するコードを、<code>index.xhtml`または`response.xhtml`ファイルからテンプレートにコピーします。次に*太字*で示されているコンテンツを、テンプレート・ファイルの</code>&lt;h:body&gt;`タグに追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="html">&lt;h:body&gt;
    *&lt;div id="mainContainer"&gt;*
        &lt;div id="left" *class="subContainer greyBox"*&gt;
            &lt;ui:insert name="box"&gt;Box Content Here&lt;/ui:insert&gt;
        &lt;/div&gt;
        *&lt;div id="right" class="subContainer"&gt;
            &lt;img src="duke.png" alt="Duke waving" /&gt;
        &lt;/div&gt;
    &lt;/div&gt;*
&lt;/h:body&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>プロジェクトを実行します。ブラウザで開始ページが開いたら、URLを次のように変更します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">http://localhost:8080/jsfDemo/faces/template.xhtml</code></pre>
</div>
</div>
<div class="paragraph">
<p>テンプレート・ファイルが次のように表示されます。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/facelets-template.png" alt="facelets template">
</div>
<div class="title">Figure 25. ブラウザでのFaceletsテンプレートの表示</div>
</div>
<div class="paragraph">
<p>これで、プロジェクトには、すべてのビューの外観と構造を定義するテンプレート・ファイルが作成されました。ここで、テンプレートを呼び出すクライアント・ファイルを作成できます。</p>
</div>
</div>
<div class="sect2">
<h3 id="templateClient">テンプレート・クライアント・ファイルの作成</h3>
<div class="paragraph">
<p>開始ページおよびレスポンス・ページ用のテンプレート・クライアント・ファイルを作成します。開始ページのテンプレート・クライアント・ファイルには、`greeting.xhtml`という名前を付けます。レスポンス・ページのファイルには、`response.xhtml`という名前を付けます。</p>
</div>
<div class="sect3">
<h4 id="_greeting_xhtml">greeting.xhtml</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>[Ctrl]-[N] (Macの場合は[⌘]-[N])を押して、新規ファイル・ウィザードを開きます。「JavaServer Faces」カテゴリを選択し、「Faceletsテンプレート・クライアント」を選択します。「次」をクリックします。</p>
</li>
<li>
<p>ファイル名として「<code>greeting</code>」と入力します。</p>
</li>
<li>
<p>「テンプレート」フィールドの横にある「参照」ボタンをクリックし、表示されたダイアログを使用して、前の項で作成した`template.xhtml`ファイルに移動します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/template-client.png" alt="template client">
</div>
<div class="title">Figure 26. Faceletsテンプレート・クライアント・ウィザード</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>「終了」をクリックします。新しいテンプレート・クライアント・ファイル`greeting.xhtml`が生成され、エディタに表示されます。</p>
</li>
<li>
<p>マークアップを確認します。*太字*で強調表示されているコンテンツを確認してください。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"&gt;

    &lt;body&gt;

        &lt;ui:composition *template="./template.xhtml"*&gt;

            &lt;ui:define *name="title"*&gt;
                title
            &lt;/ui:define&gt;

            &lt;ui:define *name="box"*&gt;
                box
            &lt;/ui:define&gt;

        &lt;/ui:composition&gt;

    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>テンプレート・クライアント・ファイルは、<code>&lt;ui:composition&gt;`タグの`template`属性を使用して、テンプレートを参照します。テンプレートには`title`および`box`の</code>&lt;ui:insert&gt;`タグが含まれているため、このテンプレート・クライアントには、これらの2つの名前の`&lt;ui:define&gt;`タグが含まれます。<code>&lt;ui:define&gt;`タグの間で指定するコンテンツは、テンプレートの対応する名前の</code>&lt;ui:insert&gt;`タグの間に挿入されるコンテンツです。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ファイルのタイトルとして「<code>greeting</code>」を指定します。次に*太字*で示す変更を加えます。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;ui:define name="title"&gt;
    *Greeting*
&lt;/ui:define&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>`index.xhtml`ファイルに切り替え([Ctrl]-[Tab])、表示されるページで、通常はグレーの四角形内に表示されるコンテンツをコピーします。`greeting.xhtml`に切り替え、テンプレート・クライアント・ファイルに貼り付けます。変更場所は*太字*で示されています。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;ui:define name="box"&gt;
    *&lt;h4&gt;Hi, my name is Duke!&lt;/h4&gt;

    &lt;h5&gt;I'm thinking of a number

        &lt;br/&gt;
        between
        &lt;span class="highlight"&gt;0&lt;/span&gt; and
        &lt;span class="highlight"&gt;10&lt;/span&gt;.&lt;/h5&gt;

    &lt;h5&gt;Can you guess it?&lt;/h5&gt;

    &lt;h:form&gt;
        &lt;h:inputText size="2" maxlength="2" value="#{UserNumberBean.userNumber}" /&gt;
        &lt;h:commandButton id="submit" value="submit" action="response" /&gt;
    &lt;/h:form&gt;*
&lt;/ui:define&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ファイルのJSF HTMLタグ・ライブラリを宣言します。エラーのフラグが付いているタグ(「<code>h</code>」接頭辞を使用するタグ)にカーソルを置き、[Ctrl]-[Space]を押します。コード補完による候補の一覧から、タグを選択します。タグ・ライブラリ名前空間がファイルの`&lt;html&gt;`タグ(*太字*で表示)に追加され、エラー表示が消えます。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      *xmlns:h="http://xmlns.jcp.org/jsf/html"*&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>&lt;h:form&gt;`の「`m</code>」の後にカーソルを置き、[Ctrl]-[Space]を押すと、名前空間が自動的にファイルに追加されます。[Ctrl]-[Space]を押したときに使用可能な論理オプションが1つのみの場合は、それがすぐにファイルに適用されます。タグ上でコード補完を呼び出すときに、JSFタグ・ライブラリが自動的に宣言されます。</p>
</div>
</div>
<div class="sect3">
<h4 id="_response_xhtml">response.xhtml</h4>
<div class="paragraph">
<p>プロジェクトには`response.xhtml`という名前のファイルがすでに含まれており、テンプレート・クライアント・ファイルの内容もわかっているので、既存の`response.xhtml`を変更して、テンプレート・クライアント・ファイルにします。(このチュートリアルでは、提供されているコードをコピーして貼り付けます。)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>エディタで`response.xhtml`を開きます。(すでに開かれている場合は、[Ctrl]-[Tab]を押して選択します。)ファイル全体のコンテンツを、次のコードで置き換えます。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version='1.0' encoding='UTF-8' ?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"&gt;

    &lt;body&gt;

        &lt;ui:composition template="./template.xhtml"&gt;

            &lt;ui:define name="title"&gt;
                Response
            &lt;/ui:define&gt;

            &lt;ui:define name="box"&gt;
                &lt;h4&gt;&lt;h:outputText escape="false" value="#{UserNumberBean.response}"/&gt;&lt;/h4&gt;

                &lt;h:form prependId="false"&gt;

                    &lt;h:commandButton id="backButton" value="Back" action="greeting" /&gt;

                &lt;/h:form&gt;
            &lt;/ui:define&gt;

        &lt;/ui:composition&gt;

    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>title`および`box`の</code>&lt;ui:define&gt;`タグ間で指定されているコンテンツを除き、ファイルは`greeting.xhtml`と同じになります。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>プロジェクトの`web.xml`デプロイメント・ディスクリプタで、アプリケーションを実行したときに`greeting.xhtml`ページが開かれるように、開始ファイルのエントリを変更します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>「プロジェクト」ウィンドウで「構成ファイル」&gt;「<code>web.xml</code>」をダブルクリックして、エディタで開きます。「ページ」タブで「開始ファイル」フィールドを「<code>faces/greeting.xhtml</code>」に変更します。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/welcome-files.png" alt="welcome files">
</div>
<div class="title">Figure 27. デプロイメント・ディスクリプタでの「開始ファイル」エントリの変更</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>プロジェクトを実行して、ブラウザでどのように表示されるかを確認します。[F6] (Macの場合は[fn]-[F6])を押すか、メイン・ツールバーの「プロジェクトの実行」(<span class="image"><img src="images/run-project-btn.png" alt="run project btn"></span>)ボタンをクリックします。プロジェクトがGlassFishサーバーにデプロイされ、ブラウザで開かれます。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Faceletsテンプレートおよびテンプレート・クライアント・ファイルを使用して、アプリケーションは以前とまったく同じように動作します。アプリケーションの開始ページとレスポンス・ページで重複しているコードを取り除くことによって、アプリケーションのサイズを小さくするとともに、後でページが追加されたときに重複したコードを記述することがなくなりました。これにより、大規模なプロジェクトで作業するときに、開発作業が効率化され、管理が容易になります。</p>
</div>
<div class="paragraph">
<p><a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Introduction%20to%20JSF%202.0">このチュートリアルに関するご意見をお寄せください</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="seealso">関連項目</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JSF 2.xの詳細は、次のリソースを参照してください。</p>
</div>
<div class="sect2">
<h3 id="_netbeansの記事およびチュートリアル">NetBeansの記事およびチュートリアル</h3>
<div class="ulist">
<ul>
<li>
<p><a href="jsf20-support.html">NetBeans IDEでのJSF 2.xのサポート</a></p>
</li>
<li>
<p><a href="jsf20-crud.html">データベースからのJavaServer Faces 2.x CRUDアプリケーションの生成</a></p>
</li>
<li>
<p><a href="../../samples/scrum-toys.html">Scrum Toys - JSF 2.0の完全版サンプル・アプリケーション</a></p>
</li>
<li>
<p><a href="../javaee/javaee-gettingstarted.html">Java EEアプリケーションの開始</a></p>
</li>
<li>
<p><a href="../../trails/java-ee.html">Java EEおよびJava Webの学習</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_外部リソース">外部リソース</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.oracle.com/technetwork/java/javaee/javaserverfaces-139869.html">JavaServer Facesテクノロジ</a> (公式ホーム・ページ)</p>
</li>
<li>
<p><a href="http://jcp.org/aboutJava/communityprocess/final/jsr314/index.html">JSR 314 JavaServer Faces 2.0の仕様</a></p>
</li>
<li>
<p><a href="http://docs.oracle.com/javaee/7/tutorial/doc/jsf-develop.htm">Java EE 7チュートリアル、第12章のJavaServer Facesテクノロジを使用した開発</a></p>
</li>
<li>
<p><a href="http://javaserverfaces.dev.java.net/">GlassFishプロジェクトMojarra</a> (JSF 2.xの公式リファレンス実装)</p>
</li>
<li>
<p><a href="http://forums.oracle.com/forums/forum.jspa?forumID=982">OTNディスカッション・フォーラム: JavaServer Faces</a></p>
</li>
<li>
<p><a href="http://www.jsfcentral.com/">JSF Central</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_ブログ">ブログ</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.java.net/blogs/edburns/">Ed Burns</a></p>
</li>
<li>
<p><a href="http://www.java.net/blogs/driscoll/">Jim Driscoll</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
            
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="JIRA" href="https://issues.apache.org/jira/projects/NETBEANS/summary"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/web/jsf20-intro_ja.asciidoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

        </div>
        

<div class='grid-container incubator-area' style='margin-top: 64px'>
    <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/">
                <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
            </a>
        </div>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/events/current-event.html">
               <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
            </a>
        </div>
    </div>
</div>
<footer>
    <div class="grid-container">
        <div class="grid-x grid-padding-x">
            <div class="large-auto cell">
                
                <h1><a href="/about/index.html">About</a></h1>
                <ul>
                    <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
                    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                    <li><a href="https://www.apache.org/security/">Security</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/community/index.html">Community</a></h1>
                <ul>
                    <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
                    <li><a href="/community/committer.html">Becoming a committer</a></li>
                    <li><a href="/community/events.html">NetBeans Events</a></li>
                    <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/participate/index.html">Participate</a></h1>
                <ul>
                    <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
                    <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
                    <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/help/index.html">Get Help</a></h1>
                <ul>
                    <li><a href="/help/index.html#documentation">Documentation</a></li>
                    <li><a href="/wiki/index.asciidoc">Wiki</a></li>
                    <li><a href="/help/index.html#support">Community Support</a></li>
                    <li><a href="/help/commercial-support.html">Commercial Support</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/download/nb110/nb110.html">Download</a></h1>
                <ul>
                    <li><a href="/download/index.html">Releases</a></li>                    
                    <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
                    <li><a href="/download/index.html#source">Building from source</a></li>
                    <li><a href="/download/index.html#previous">Previous releases</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<div class='footer-disclaimer'>
    <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2020 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
            <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
            <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
        </div>
        
    </div>
</div>



        <script src="/js/vendor/jquery-3.2.1.min.js"></script>
        <script src="/js/vendor/what-input.js"></script>
        <script src="/js/vendor/jquery.colorbox-min.js"></script>
        <script src="/js/vendor/foundation.min.js"></script>
        <script src="/js/netbeans.js"></script>
        <script>
            
            $(function(){ $(document).foundation(); });
        </script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        <script>
         $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
        </script>
        
    </body>
</html>
