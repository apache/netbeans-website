
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>在 NetBeans IDE 中调试多线程应用程序</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="在 NetBeans IDE 中调试多线程应用程序 - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans, Tutorials, 在 NetBeans IDE 中调试多线程应用程序">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 16</h1>
            <p><a class="button success" href="/download/nb16/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">在 NetBeans IDE 中调试多线程应用程序</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/java/debug-multithreaded_zh_CN.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_下载样例项目">下载样例项目</a></li>
<li><a href="#_打开项目">打开项目</a>
<ul class="sectlevel2">
<li><a href="#_运行_gallery_项目">运行 Gallery 项目</a></li>
<li><a href="#_运行_deadlock_项目">运行 Deadlock 项目</a></li>
</ul>
</li>
<li><a href="#_调试样例项目">调试样例项目</a>
<ul class="sectlevel2">
<li><a href="#_挂起线程">挂起线程</a></li>
<li><a href="#_切换线程">切换线程</a></li>
<li><a href="#_检测死锁">检测死锁</a></li>
</ul>
</li>
<li><a href="#_另请参见">另请参见</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>本文档将介绍如何使用 NetBeans IDE 中的 "Debugging"（调试）窗口调试多线程应用程序。本教程还将演示如何使用 IDE 检测应用程序中的死锁。</p>
</div>
<div class="paragraph">
<p>"Debugging"（调试）窗口将与调试会话、应用程序线程和线程调用堆栈相关的消息都集成到了一个窗口中，这种方式简化了调试过程。通过 "Debugging"（调试）窗口，您可以很方便地看到各个应用程序线程的状态，并可挂起和恢复会话中的任意线程。</p>
</div>
<div class="paragraph">
<p>本教程将使用两个样例项目来演示如何使用 "Debugging"（调试）窗口。要完成本教程，您必须先下载 Gallery 和 Deadlock 项目。</p>
</div>
<div class="paragraph">
<p>观看<a href="debug-multithreaded-screencast.html">在 NetBeans IDE 中调试多线程应用程序的视频</a>。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/netbeans-stamp-80-74-73.png" alt="netbeans stamp 80 74 73">
</div>
<div class="title">Figure 1. 此页上的内容适用于 NetBeans IDE 7.2、7.3、7.4 和 8.0</div>
</div>
<div class="paragraph">
<p><strong>要学习本教程，您需要具备以下软件和资源。</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">软件或资源</th>
<th class="tableblock halign-left valign-top">要求的版本</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/downloads/index.html">NetBeans IDE</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.2, 7.3, 7.4, 8.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java 开发工具包 (JDK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">版本 7 或 8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org/projects/samples/downloads/download/Samples/Java/debugging-samples.zip">Gallery 项目和 Deadlock 项目</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> </p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_下载样例项目">下载样例项目</h2>
<div class="sectionbody">
<div class="paragraph">
<p>您可以采用下列方法下载本教程中使用的样例项目。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>下载<a href="https://netbeans.org/projects/samples/downloads/download/Samples/Java/debugging-samples.zip">已完成项目的 zip 档案文件</a>。</p>
</li>
<li>
<p>通过执行以下步骤从 NetBeans 样例检出项目源代码：</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>从主菜单中选择 "Team"（团队开发）&gt; "Subversion" &gt; "Checkout"（检出）。</p>
</li>
<li>
<p>在 "Checkout"（检出）对话框中，输入以下资源库 URL：
 <code><a href="https://svn.netbeans.org/svn/samples~samples-source-code" class="bare">https://svn.netbeans.org/svn/samples~samples-source-code</a></code>
单击 "Next"（下一步）。</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>单击 "Browse"（浏览）以打开 "Browse Repository Folders"（浏览资源库文件夹）对话框。</p>
</li>
<li>
<p>展开根节点，然后选择 <strong>samples/java/debugging-samples</strong>。单击 "OK"（确定）。</p>
</li>
<li>
<p>指定用于存储源代码的本地文件夹（本地文件夹必须为空）。</p>
</li>
<li>
<p>单击 "Finish"（完成）。</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>单击 "Finish"（完成），此时 IDE 会将本地文件夹初始化为 Subversion 资源库，并检出项目源代码。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在完成检出操作后将会显示一个对话框，在该对话框中单击 "Open Project"（打开项目）。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>*注：*有关使用 Subversion 检出源的详细信息，请参见 <a href="../ide/subversion.html">NetBeans IDE 中的 Subversion 指南</a>中有关<a href="../ide/subversion.html#settingUp">设置 Subversion</a> 的部分。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_打开项目">打开项目</h2>
<div class="sectionbody">
<div class="paragraph">
<p>在本教程中，您将使用两个应用程序来演示 IDE 如何为多线程应用程序的调试提供支持。在本练习中，您将在 IDE 中打开两个项目，然后运行它们。运行这两个项目后，您将对每个项目进行测试。</p>
</div>
<div class="sect2">
<h3 id="_运行_gallery_项目">运行 Gallery 项目</h3>
<div class="paragraph">
<p>Gallery 应用程序是一个简单的 Java Swing 应用程序，它可以播放动画图像。该应用程序有两个按钮，您可以使用这两个按钮来添加和删除动画图像。在本练习中，您将运行 Gallery 应用程序。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>将 <a href="https://netbeans.org/projects/samples/downloads/download/Samples/Java/debugging-samples.zip">+ <code>debugging-samples.zip</code> +</a> 档案下载并解压缩到您的本地系统。</p>
</li>
<li>
<p>从主菜单中选择 "File"（文件）&gt; "Open"（打开）。</p>
</li>
<li>
<p>找到并选择 debugging-samples 目录中的 Gallery 项目。单击 "Open"（打开）。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>单击 "Open"（打开）之后，IDE 将在 "Projects"（项目）窗口中打开并显示该项目。如果在 "Projects"（项目）窗口中展开该节点，您可以看到该项目是一个简单的 Java Swing 应用程序。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>右键单击该项目节点并选择 "Run"（运行）以启动 Gallery 应用程序。</p>
</li>
<li>
<p>在 Gallery 应用程序中，单击 "More"（更多）可添加图像，单击 "Less"（更少）可删除图像。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debugging-gallery-app.png" alt="debugging gallery app">
</div>
<div class="title">Figure 2. Gallery 应用程序</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>关闭 Gallery 应用程序窗口。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Gallery 项目是一个简单的多线程应用程序，在本教程中，您将对其进行调试。</p>
</div>
</div>
<div class="sect2">
<h3 id="_运行_deadlock_项目">运行 Deadlock 项目</h3>
<div class="paragraph">
<p>Deadlock 应用程序包含一个  <code>main</code>  方法，该方法可启动一个运行时长为 500000 毫秒的线程。 <code>main</code>  方法将启动两个线程，这两个线程在完成时会向 "Output"（输出）窗口输出消息。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>从主菜单中选择 "File"（文件）&gt; "Open"（打开）。</p>
</li>
<li>
<p>找到并选择 debugging-samples 目录中的 Deadlock 项目。单击 "Open"（打开）。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>单击 "Open"（打开）之后，IDE 将在 "Projects"（项目）窗口中打开并显示该项目。如果在 "Projects"（项目）窗口中展开该节点，您可以看到该项目是一个简单的 Java 应用程序。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>右键单击该项目节点并选择 "Run"（运行）以启动 Deadlock 应用程序。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>单击 "Run"（运行）之后，"Output"（输出）窗口将打开并显示以下输出。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">run:
Application started
MyThread2 successfully finished.
MyThread1 successfully finished</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>等待应用程序正常结束（五分钟）。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>当 Deadlock 应用程序结束时，您将在 "Output"（输出）窗口中看到以下内容。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Main thread finished</code></pre>
</div>
</div>
<div class="paragraph">
<p>Deadlock 项目是一个简单的 Java 应用程序，它有两个线程。在调试该应用程序时，您将创建一个死锁，使用该死锁来说明 IDE 如何帮助您检测死锁。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_调试样例项目">调试样例项目</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gallery 项目是一个简单的 Java Swing 应用程序，它可以播放动画图像。在该应用程序中，您可以通过单击按钮来添加和删除图像。单击 "More"（更多）按钮将启动一个新线程，该线程将显示一个图像并实现该图像的动画效果。单击 "Less"（更少）按钮将停止最近的线程，停止动画并删除图像。</p>
</div>
<div class="sect2">
<h3 id="_挂起线程">挂起线程</h3>
<div class="paragraph">
<p>在本练习中，您将开始调试 Gallery 应用程序，并添加一些图像以启动一些应用程序线程。启动调试会话之后，IDE 将在左侧窗格中打开 "Debugging"（调试）窗口。"Debugging"（调试）窗口显示会话中的线程列表。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在 "Projects"（项目）窗口中右键单击 Gallery 项目，然后选择 "Debug"（调试）。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>单击 "Debug"（调试）之后，IDE 将启动 Gallery 应用程序并打开默认的调试窗口。IDE 会自动在主窗口的左侧打开 "Debugging"（调试）窗口，并在 "Output"（输出）窗口中打开调试器控制台。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在 Gallery 应用程序中单击 "More"（更多）三次以启动显示动画图像的三个线程。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>查看 "Debugging"（调试）窗口，您可看到为每个动画都启动了一个新线程。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debugging-start.png" alt="debugging start" width="Debugging"（调试）窗口"">
</div>
<div class="title">Figure 3. </div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>通过单击 "Debugging"（调试）窗口中线程右侧的 "'Suspend thread"（挂起线程）按钮挂起两个线程。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>当线程挂起之后，该线程的图标会相应变化以指示新的状态。您可以展开线程节点查看线程的调用堆栈。您可以右键单击 "Debugging"（调试）窗口中的条目以打开一个带调试命令的弹出式菜单。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debugging-start-suspend.png" alt="debugging start suspend" width="Debugging"（调试）窗口"">
</div>
<div class="title">Figure 4. 具有两个已挂起线程的 </div>
</div>
<div class="paragraph">
<p>查看 Gallery 应用程序，可看到在您挂起线程后，这些线程的动画停止了。</p>
</div>
<div class="paragraph">
<p>使用 "Debugging"（调试）窗口，您可以快速查看和更改会话中的线程状态。默认情况下，"Debugging"（调试）窗口在窗口的右侧显示 "Resume"（恢复）和 "Suspend"（挂起）按钮。您可以使用 "Debugging"（调试）窗口底部的工具栏隐藏这两个按钮，还可以进一步对 "Debugging"（调试）窗口的显示进行定制。如果您在运行多个调试会话，则可以使用 "Debugging"（调试）窗口顶部的下拉列表选择要在窗口中显示哪个线程。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debugging-window-toolbar.png" alt="debugging window toolbar" width="Debugging"（调试）窗口工具栏"">
</div>
<div class="title">Figure 5. </div>
</div>
</div>
<div class="sect2">
<h3 id="_切换线程">切换线程</h3>
<div class="paragraph">
<p>本练习展示了在您对某个应用程序进行单步调试期间如果另一个应用程序线程遇到断点将发生的情况。在本练习中，您将设置一个方法断点，并启动对应用程序的单步调试。在您对应用程序进行单步调试时，您还将启动一个新的线程，该线程也将遇到断点。当新线程遇到断点时，IDE 会在 "Debugging"（调试）窗口中显示通知，以告诉您所发生的情况。然后，您可以在线程之间进行切换。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在 Gallery 应用程序窗口中，单击 "Less"（更少）或 "More"（更多），直至只有两个或三个动画显示在该窗口中。</p>
</li>
<li>
<p>在 IDE 的 "Projects"（项目）窗口中展开  <code>gallery</code>  包，并双击  <code>Gallery.java</code>  以在编辑器中打开该文件。</p>
</li>
<li>
<p>通过单击第 175 行的左旁注，在  <code>run</code>  方法的开头中的  <code>Gallery.java</code>  中插入一个方法断点。</p>
</li>
<li>
<p>在 Gallery 应用程序中单击 "More"（更多）以启动一个将遇到该方法断点的新线程。</p>
</li>
<li>
<p>单击 "Step Over"（步过）（F8 键），开始逐步执行方法，直到程序计数器到达第 191 行为止。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>单步调试该方法时，您可以看到编辑器旁注中的程序计数器指示了您的位置。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在 Gallery 应用程序中单击 "More"（更多）以启动一个将遇到该方法断点的新线程。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>当新线程遇到方法断点时，"Debugging"（调试）窗口中会显示一个 "New Breakpoint Hit"（遇到新断点）通知，告诉您在单步调试该方法时另一个线程遇到了断点。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debugging-newbreakpointhit.png" alt="debugging newbreakpointhit">
</div>
<div class="title">Figure 6. 遇到新断点通知</div>
</div>
<div class="paragraph">
<p>当您单步调试某个线程时如果另一个线程遇到了断点，IDE 会让您选择是切换到另一个线程还是继续单步调试当前的线程。您可以单击 "New Breakpoint Hit"（遇到新断点）通知中的箭头按钮切换到遇到断点的线程。您随时都可以通过在通知窗口中选择新线程来切换到新线程。单步调试当前断点线程将继续当前线程，但其他应用程序线程的状态保持不变。</p>
</div>
<div class="paragraph">
<p>*注：*在 "Debugging"（调试）窗口中，使用旁注中的绿色栏指示当前线程 (Thread_Jirka)。因为遇到断点而调用通知的线程 (Thread_Roman) 由一个黄色条指示，该线程图标表示线程因一个断点而挂起。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debugging-current-suspended.png" alt="debugging current suspended">
</div>
<div class="title">Figure 7. 遇到新断点通知</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>单击 "New Breakpoint Hit"（遇到新断点）通知中的箭头可从当前线程切换到新线程 (Thread_Roman)。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>切换到新线程后，您可以看到以下变化：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>程序计数器的位置移动到了新的当前线程 (Thread_Roman) 的第 175 行。</p>
</li>
<li>
<p>现在，可以在第 191 行的旁注中看到一个 "suspended thread"（挂起的线程）标注，表示一个线程 (Thread_Jirka) 在该行挂起。</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debugging-editor-suspendedannot.png" alt="debugging editor suspendedannot">
</div>
<div class="title">Figure 8. 显示调试标注的编辑器</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>多次单击 "Step Over"（步过）以单步调试新的当前线程 (Thread_Roman)。</p>
</li>
<li>
<p>右键单击编辑器旁注中的 "suspended thread"（挂起的线程）标注并选择 "Set as Current Thread"（设置为当前线程）&gt; "Thread_Jirka" 切换回挂起的线程。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debugging-editor-setcurrent.png" alt="debugging editor setcurrent" width="Set as Current Thread"（设置为当前线程）弹出窗口的编辑器"">
</div>
<div class="title">Figure 9. 显示 </div>
</div>
<div class="paragraph">
<p>此外，您也可以调用 "Current Thread Chooser"（当前线程选择器）（Alt+Shift+T 组合键；在 Mac 上为 Ctrl+Shift+T 组合键）并切换到应用程序的任意线程。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debugging-thread-chooser.png" alt="debugging thread chooser">
</div>
<div class="title">Figure 10. Gallery 应用程序</div>
</div>
<div class="paragraph">
<p>当您切换回 Thread_Jirka 时，"suspended thread"（挂起的线程）标注将出现在 Thread_Roman 挂起时所处的行旁边。您可以通过单击 "Debugging"（调试）窗口中的 "Resume"（恢复）来恢复 Thread_Roman。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debugging-editor-suspendedannot2.png" alt="debugging editor suspendedannot2">
</div>
<div class="title">Figure 11. 显示调试标注的编辑器</div>
</div>
<div class="paragraph">
<p>使用 "Debugging"（调试）窗口，您可以非常精确地查看和控制线程状态。调试器对应用程序线程进行管理以简化调试工作流并防止调试进程造成死锁。在本练习中，在 IDE 中调试应用程序时，您看到了以下行为。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>当某个线程遇到一个断点时，只有该断点线程将被挂起。</p>
</li>
<li>
<p>在单步调试应用程序时，如果应用程序的其他线程遇到断点，当前线程不受影响。</p>
</li>
<li>
<p>单步调试仅会继续执行当前线程。单步调试完成时，只有当前线程将被挂起。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>现在可以退出 Gallery 应用程序。在下一个练习中，您将测试 Deadlock 应用程序并使用 IDE 来帮助您检测死锁。</p>
</div>
</div>
<div class="sect2">
<h3 id="_检测死锁">检测死锁</h3>
<div class="paragraph">
<p>IDE 可以自动在所有挂起的线程间搜索死锁，因而可以帮助您识别潜在的死锁情况。检测到死锁后，IDE 会在 "Debugging"（调试）窗口中显示一个通知并标识出所涉及的线程。</p>
</div>
<div class="paragraph">
<p>为了演示 IDE 的死锁检测，您将在调试器中运行一个样例项目 Deadlock 并制造一种死锁情况。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>展开  <code>myapplication</code>  包并在源代码编辑器中打开  <code>Thread1.java</code>  和  <code>Thread2.java</code> 。</p>
</li>
<li>
<p>在  <code>Thread1.java</code>  的第 20 行和  <code>Thread2.java</code>  的第 20 行分别设置一个断点。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>要设置断点，请在源代码编辑器中单击您要设置断点的行旁边的旁注。断点标注将出现在旁注中该行的左侧。打开 "Breakpoints"（断点）窗口（Alt-Shift-5 组合键；在 Mac 上为 Ctrl+Shift+5 组合键），可以看到已经设置并启用了两个断点。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debug-deadlock-setbkpt.png" alt="debug deadlock setbkpt">
</div>
<div class="title">Figure 12. 显示在第 20 行设置断点的编辑器</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在 "Projects"（项目）窗口中右键单击 Deadlock 项目，然后选择 "Debug"（调试）。</p>
<div class="literalblock">
<div class="content">
<pre>``main``  方法将运行两个线程，这两个线程都将在其中一个断点处挂起。您可以在 "Debugging"（调试）窗口中看到由断点挂起的线程。</pre>
</div>
</div>
</li>
<li>
<p>在 "Debugging"（调试）窗口中，可以通过单击挂起的线程右侧的 "Resume"（恢复）按钮来恢复挂起的线程（ <code>MyThread1</code>  和  <code>MyThread2</code> ）。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debug-deadlock-resume.png" alt="debug deadlock resume" width="Debugging"（调试）窗口中挂起的线程"">
</div>
<div class="title">Figure 13. 恢复 </div>
</div>
<div class="paragraph">
<p>恢复线程  <code>MyThread1</code>  和  <code>MyThread2</code>  将造成死锁状况。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>从主菜单中选择 "Debug\Check for Deadlock"（调试\检查死锁）可检查挂起的线程以查找死锁。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/debug-deadlock-detected.png" alt="debug deadlock detected" width="Debugging"（调试）窗口中挂起的线程"">
</div>
<div class="title">Figure 14. 恢复 </div>
</div>
<div class="paragraph">
<p>如果您在应用程序中检测到死锁，则 "Debugging"（调试）窗口中会出现一条消息告诉您有关死锁的情况。您可以看到，在 "Debugging"（调试）窗口的左侧旁注中，死锁由红色条指示。</p>
</div>
<div class="paragraph">
<p>本教程对 IDE 中的一些调试功能进行了初步介绍。使用 "Debugging"（调试）窗口，您在调试应用程序时可以很方便地挂起和恢复线程。在调试多线程应用程序时，这非常有用。</p>
</div>
<div class="paragraph">
<p><a href="https://netbeans.org/about/contact_form.html?to=3&amp;subject=Feedback:%20Debugging%20Multithreaded%20Applications">发送有关此教程的反馈意见</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_另请参见">另请参见</h2>
<div class="sectionbody">
<div class="paragraph">
<p>有关在 NetBeans IDE 中开发和测试 Java 应用程序的更多信息，请参见以下资源：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>演示：<a href="debug-multithreaded-screencast.html">在 NetBeans IDE 中调试多线程应用程序</a></p>
</li>
<li>
<p>演示：<a href="debug-stepinto-screencast.html">NetBeans 调试器中的可视“步入”操作</a></p>
</li>
<li>
<p>演示：<a href="debug-deadlock-screencast.html">使用 NetBeans 调试器进行死锁检测</a></p>
</li>
<li>
<p>演示：<a href="debug-evaluator-screencast.html">在 NetBeans 调试器中使用代码片段计算器</a></p>
</li>
<li>
<p><a href="../../trails/java-se.html">基本 IDE 和 Java 编程学习资源</a></p>
</li>
<li>
<p><a href="junit-intro.html">编写 JUnit 测试</a></p>
</li>
<li>
<p><a href="profiler-intro.html">分析 Java 应用程序简介</a></p>
</li>
</ul>
</div>
</div>
</div>
      
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/kb/docs/java/debug-multithreaded_zh_CN.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2022 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
