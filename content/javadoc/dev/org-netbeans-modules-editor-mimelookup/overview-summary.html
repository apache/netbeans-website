<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>Overview (MIME Lookup API)</title>
<link rel="stylesheet" type="text/css" href="javadoc.css" title="Style">
<script type="text/javascript" src="script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Overview (MIME Lookup API)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li class="navBarCell1Rev">Overview</li>
<li>Package</li>
<li>Class</li>
<li>Use</li>
<li><a href="overview-tree.html">Tree</a></li>
<li><a href="deprecated-list.html">Deprecated</a></li>
<li><a href="index-files/index-1.html">Index</a></li>
<li><a href="help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">org.netbeans.modules.editor.mimelookup/1 1.43 </div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev</li>
<li>Next</li>
</ul>
<ul class="navList">
<li><a href="index.html?overview-summary.html" target="_top">Frames</a></li>
<li><a href="overview-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 class="title">MIME Lookup API<br/><span style='font-style:normal; font-size:medium; font-weight:normal; background-color:#ffffff;'><a href='http://wiki.netbeans.org/API_Stability#Official' target='_blank'>Official</a></span></h1>
</div>
<div class="header">
<div class="subTitle">
<div class="block">

It consists of

    
MimeLookupAPI in <code>org.netbeans.api.editor.mimelookup</code>

    
MimeLookupSPI in <code>org.netbeans.spi.editor.mimelookup</code>


</div>
</div>
<p>See: <a href="#overview.description">Description</a></p>
</div>
<div class="contentContainer">
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="MIME Lookup API table, listing packages, and an explanation">
<caption><span>MIME Lookup API</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Package</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="org/netbeans/api/editor/mimelookup/package-summary.html">org.netbeans.api.editor.mimelookup</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="org/netbeans/spi/editor/mimelookup/package-summary.html">org.netbeans.spi.editor.mimelookup</a></td>
<td class="colLast">
<div class="block">The SPI allows registering providers of mime type specific <code>Lookup</code>s.</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="contentContainer"><a name="overview.description">
<!--   -->
</a>
<div class="block"><p>

It consists of
<ul>
    
<li>MimeLookupAPI in <code>org.netbeans.api.editor.mimelookup</code>
</li>
    
<li>MimeLookupSPI in <code>org.netbeans.spi.editor.mimelookup</code>
</li>

</ul>


<p>API contains only two classes:</p>

1. org.netbeans.api.editor.mimelookup.MimeLookup with public methods:
<ul>
    
<li> 
<code> static MimeLookup getMimeLookup(String mime) </code> - gets mime specific lookup. </li>
    
<li> 
<code> static Lookup getLookup(MimePath mimePath) </code> - gets the lookup for the particular mime-path.</li>
    
<li> 
<code> MimeLookup childLookup(String mime) </code> - gets mime specific child (embeded) lookup. The method was deprecated in favour of 
        static Lookup getLookup(MimePath mimePath) </li>
    
<li> 
<code> Object lookup(Class clazz) </code> - Look up an object matching a given interface. </li>
    
<li> 
<code> Result lookup(Lookup.Template template) </code> - The general lookup method. Callers can get list of all instances and classes
         that match the given <code>template</code> and attach a listener to
         this be notified about changes. </li>

</ul>

<br>
2. org.netbeans.api.editor.mimelookup.MimePath with public methods:
<ul>
    
<li> 
<code> static MimePath get(String mimeType) </code> - gets root mime-path for the given mime-type. </li>
    
<li> 
<code> static MimePath get(MimePath prefix, String mimeType) </code> - gets mime-path corresponding to the mime-type used in the given context
      mime-path.</li>
    
<li> 
<code> static MimePath parse(String path) </code> - parses the given mime-path string
      e.g. "text/x-jsp/text/x-java" and get the corresponding mime-path. </li>
    
<li> 
<code> String getPath() </code> - gets string path represented by this mime-path. </li>
    
<li> 
<code> int size() </code> -gets total number of mime-types in the mime-path. </li>
    
<li> 
<code> String getMimeType(int index) </code> - gets mime type of this mime-path at the given index. </li>
    
<li> 
<code> MimePath getPrefix(int size) </code> - returns prefix mime-path with the given number of mime-type components
      ranging from zero till the size of this mime-path. </li>

</ul>

<br>

<br>

<code>MimeLookup</code> is represented via ProxyLookup that collects registered lookups. Particular lookups, 
responsible for looking up their objects can be registered using interface <code>MimeDataProvider</code> into default lookup
by META-INF/services registration. Previously used registration via interface <code> MimeLookupInitializer</code> was deprecated.<p></p>
In addition to this basic registration, xml layer folder registration is also available. 
It is provided by registering implemented interface <code>Class2LayerFolder</code> into default lookup
 via META-INF/services registration.
This approach provides a mapping of class to specific subfolder. 
Using this mapping one can achieve the convenient way of using <code>MimeLookup</code> e.g.
<p>

<code>
    MimeLookup.getMimeLookup("text/x-java").lookup(FoldManagerFactory.class);
</code>

</p>

<p>
   Using this, an instance of FoldManagerFactory is retrieved from the folder with path 
   "Editors/text/x-java/FoldManager" provided that FoldManagerFactory.class is registered to
   a subfolder "FoldManager" via <code>Class2LayerFolder</code> registration.
</p>

<p></p>
There <code>InstanceProvider</code> can be used if there are files
of various types in the layer folder that need additional handling
before becoming and instance of certain class.
For more details look at use case of PopupActions creation.

<p>
The Javadoc documentation can be generated by using
</p>

<pre xml:space="preserve">
    cd /cvs/editor/mimelookup
    ant javadoc
</pre>


</p>
<h3>What is New (see <a href="apichanges.html">all changes</a>)?</h3>
<ul>

         
<!--Search for dates that are later or equal to 1997-09-01 in
          .-->
<!--Checking date 2013-2-27 with count of newer 0--><!--year ok-->
<li>Feb 27 '13 <a href="apichanges.html#MimePath.inherited">Access to parent MIME type and all included paths</a>
<p>
                
<p>
                    
<code>getIncludedPaths</code> can be now used to compute all MimePaths that should
                    be considered for the content. In the past, reflection was used to access this functionality.
                </p>
                
<p>
                    
<code>getInheritedType</code> provides generalized or parent MIME type for the content, 
                    which allows to search settings (services) fallbacks.
                </p>
            
</p>
</li>
<!--Checking date 2010-10-4 with count of newer 1--><!--year ok-->
<li>Oct 4 '10 <a href="apichanges.html#Class2LayerFolder.deprecated">Class2LayerFolder Deprecated and not used</a>
<p>
                
<code>Class2LayerFolder</code> has been deprecated and is ignored.
            </p>
</li>
<!--Checking date 2010-10-4 with count of newer 1--><!--year ok-->
<li>Oct 4 '10 <a href="apichanges.html#MimeLookupRegistration">@MimeLocation, @MimeRegistration and @MimeRegistrations added</a>
<p>
                Added <code>@MimeLocation</code>, <code>@MimeRegistration</code> and <code>@MimeRegistrations</code>
                that allow to register services to the MimeLookup.
            </p>
</li>
<!--Checking date 2007-9-18 with count of newer 3--><!--year ok-->
<li>Sep 18 '07 <a href="apichanges.html#MimeLookup.getLookup-mimePath-as-String-added">MimeLookup.getLookup(String mimePath) method added</a>
<p>
                
<code>MimeLookup.getLookup(String mimePath)</code> converts
                the (usually held) string mimePath to the <code>MimePath</code>
                object automatically.
            </p>
</li>
<!--Checking date 2007-6-28 with count of newer 4--><!--year ok-->
<li>Jun 28 '07 <a href="apichanges.html#MimePath.validate.added">MimePath.validate methods added</a>
<p>
                The <code>validate(CharSequence path)</code> and 
                <code>validate(CharSequence type, CharSequence subtype)</code> methods
                were added to the <code>MimePath</code> class to allow validating
                mime paths and mime type components.
            </p>
</li>
</ul>
<h3>Use Cases</h3>
<answer id="arch-usecases">


<h5>Per mime-type operation</h5>
Operation of the editor module must be parametrized by the type of the file
being edited. In the past the operation was parametrized by the class
of the editor kit but that did not show up as being useful enough.
<br>
It is more practical to use a string-based parametrization concretely
the mime-type. Anyone can then easily register an additional functionality
for the editor because it's just enough to know the right mime-type and the type
of the functionality class to be implemented and the xml layer folder
where the class should be registered.


<h5>Provide list of instances as lookup result</h5>
On the modules' implementation side the registered functionality 
must be retrieved somehow. It's necessary to instantiate the registered objects
and react to module enabling/disabling which can affect validity of the registered objects.
<br>
As the most convenient solution appears to use
<code>org.openide.util.Lookup</code> allowing to provide
the registered instances as a <code>Lookup.Result</code>
allowing to listen for changes (e.g. caused by the module enabling/disabling).
<br>
This resulted into creation of <code>class MimeLookup extends Lookup</code> containing
<code>static MimeLookup getMimeLookup(String mimeType)</code>.


<h5>Nested mime-types</h5>
On the lexical level the document can contain nested languages.
<br>
For example JSP document can contain pieces of java code which can further contain
javadoc comment tokens with nested javadoc language.
<br>
The nested languages should allow for special settings
such as fonts and colors of nested syntax coloring but even
things like actions that would be active in the nested document section.
<br>
This resulted into creation of
<code>static Lookup getLookup(MimePath mimePath)</code> method in <code>MimeLookup</code>. 


<h5>Known clients summary</h5>

<b>Fold Manager Factories</b>

<br>
The editor/fold module expects to find the registered
fold manager factories (<code>org.netbeans.spi.editor.fold.FoldManagerFactory</code> classes).
<br>

<br>

<b>Completion Providers</b>

<br>
The editor/completion module expects to find the registered
completion providers (<code>org.netbeans.spi.editor.completion.CompletionProvider</code> classes).
<br>

<br>

<b>Editor Context Menu Actions</b>

<br>
The editor module expects to find the registered
popup menu actions (<code>javax.swing.Action</code> classes or names of actions
(i.e. value of Action.NAME attribute) present in editor kit e.g. "goto-source").
<br>

<br>

<b>Side Bars</b>

<br>
The editor/lib module expects to find factories for components to be placed on the 
sides of the editor component (<code>org.netbeans.editor.SideBarFactory</code> classes).
<br>

<br>

<b>Hyperlink Providers</b>

<br>
The editor/lib module expects to find hyperlink providers that allow connecting
an open document with some other documents (<code>org.netbeans.lib.editor.hyperlink.spi.HyperlinkProvider</code> classes).
<br>

<br>

<b>Code Template Processors</b>

<br>
The editor/codetemplates module expects to find factories for code template processors
(<code>org.netbeans.lib.editor.codetemplates.spi.CodeTemplateProcessorFactory</code> classes).
<br>

<br>

<b>Hints Providers</b>

<br>
The editor/hints module expects to find editor hints providers
(<code>org.netbeans.modules.editor.hints.spi.HintsProvider</code> classes).


<br>

<br>

<br>

<b>
API Use Cases
</b>

<hr>


<h5>Find class instances for the given mime-type</h5>

An API method
<p></p>

<code>
MimeLookup lookup = MimeLookup.getMimeLookup("text/x-java");
</code>

<p></p>
can be used for getting the mime specific lookup. Having this we can lookup class
 or template:
<p></p>

<code>
    Object obj = lookup.lookup(LookedUpClass.class);
</code>

<p></p>
or
<p></p>

<code>
    Lookup.Result result = lookup.lookup(new Lookup.Template(LookedUpClass.class));
</code>



<h5>Getting embeded mime-type specific Lookup</h5>
As an example a jsp scriptlet is used. Scriptlet in fact consists of parent "text/x-jsp" mime-type and
embeded "text/x-java" mime-type. To obtain a scriptlet lookup firstly we need to get a MimePath and then
get appropriate lookup:

<p></p>

<pre xml:space="preserve">
    MimePath scriptletPath = MimePath.parse("text/x-jsp/text/x-java");
    Lookup lookup = MimeLookup.getLookup(scriptletPath);
</pre>




<br>

<b>
SPI Use Cases
</b>

<hr>


<h5>Providing implemented MimeLookupInitializer</h5>
It is the general way of adding mime specific object into the <code>MimeLookup</code>. Implementation of <code>MimeLookupInitializer</code> should be created and
            registered to default lookup via <code>META-INF/services</code> registration.
For details, please look at the simplified 
<code>TestMimeLookupInitializer</code> 
            in <code>mimelookup/test/unit</code> or <code>LayerMimeLookupInitializer</code>.
<b> Usage of MimeLookupInitializer is deprecated, please use MimeDataProvider instead in similar way </b>



</answer>
<h3>Exported Interfaces</h3>
          
                This table lists all of the module exported APIs 
                with 
                defined stability classifications. It is generated
                based on answers to questions about the architecture 
                of the module. <a href="architecture-summary.html">Read them all</a>...

                
                <a name="group-java">
<h5>Group of java interfaces</h5>
</a>
<table cellpadding="1" cellspacing="0" border="0" class="tablebg" width="100%">
<tr>
<td>
<table border="0" cellpadding="3" cellspacing="1" width="100%">
<tr class="tablersh">
<td align="CENTER" width="25%"><span class="titlectable">Interface Name</span></td><td align="CENTER" width="10%"><span class="titlectable">In/Out</span></td><td align="CENTER" width="10%"><span class="titlectable">Stability</span></td><td align="CENTER"><span class="titlectable">Specified in What Document?</span></td>
</tr>
<tr class="tabler">
<td>MimeLookupAPI</td><td>Exported</td><td><a href="http://wiki.netbeans.org/API_Stability#Official">Official</a></td><td><a name="java-MimeLookupAPI"></a></td>
</tr>
<tr class="tabler">
<td>MimeLookupSPI</td><td>Exported</td><td><a href="http://wiki.netbeans.org/API_Stability#Official">Official</a></td><td><a name="java-MimeLookupSPI"></a></td>
</tr>
</table>
</td>
</tr>
</table>
<p></p>
<a name="group-systemproperty">
<h5>Group of systemproperty interfaces</h5>
</a>
<table cellpadding="1" cellspacing="0" border="0" class="tablebg" width="100%">
<tr>
<td>
<table border="0" cellpadding="3" cellspacing="1" width="100%">
<tr class="tablersh">
<td align="CENTER" width="25%"><span class="titlectable">Interface Name</span></td><td align="CENTER" width="10%"><span class="titlectable">In/Out</span></td><td align="CENTER" width="10%"><span class="titlectable">Stability</span></td><td align="CENTER"><span class="titlectable">Specified in What Document?</span></td>
</tr>
</table>
</td>
</tr>
</table>
<p></p>
<h3>Implementation Details</h3>
<h5>Where are the sources for the module?</h5>
    Sources can be found in editor/mimelookup module.
 <p>The default answer to this question is:<!--If you do not want default answer to be generated you can use <defaultanswer generate='none' /> here--><br>
<p>
<p>
            The sources for the module are in the
            <a href="http://hg.netbeans.org/" shape="rect">NetBeans Mercurial repositories</a>.
        </p>
</p>
</p>
<h5>What do other modules need to do to declare a dependency on this one, in addition to or instead of a plain module dependency?</h5>
Nothing.
<p>
                Read more about the implementation in the <a href="architecture-summary.html">answers to 
                architecture questions</a>.
            </p></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li class="navBarCell1Rev">Overview</li>
<li>Package</li>
<li>Class</li>
<li>Use</li>
<li><a href="overview-tree.html">Tree</a></li>
<li><a href="deprecated-list.html">Deprecated</a></li>
<li><a href="index-files/index-1.html">Index</a></li>
<li><a href="help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">org.netbeans.modules.editor.mimelookup/1 1.43 </div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev</li>
<li>Next</li>
</ul>
<ul class="navList">
<li><a href="index.html?overview-summary.html" target="_top">Frames</a></li>
<li><a href="overview-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><span class="footnote"></span><!-- See javadoc.css for timestamp information --></small></p>
</body>
</html>
