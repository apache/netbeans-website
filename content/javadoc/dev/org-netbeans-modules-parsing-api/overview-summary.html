<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>Overview (Parsing API)</title>
<link rel="stylesheet" type="text/css" href="javadoc.css" title="Style">
<script type="text/javascript" src="script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Overview (Parsing API)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li class="navBarCell1Rev">Overview</li>
<li>Package</li>
<li>Class</li>
<li>Use</li>
<li><a href="overview-tree.html">Tree</a></li>
<li><a href="deprecated-list.html">Deprecated</a></li>
<li><a href="index-files/index-1.html">Index</a></li>
<li><a href="help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">org.netbeans.modules.parsing.api/1 9.10.0 8</div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev</li>
<li>Next</li>
</ul>
<ul class="navList">
<li><a href="index.html?overview-summary.html" target="_top">Frames</a></li>
<li><a href="overview-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 class="title">Parsing API<br/><span style='font-style:normal; font-size:medium; font-weight:normal; background-color:#ffffff;'><a href='http://wiki.netbeans.org/API_Stability#Stable' target='_blank'>Stable</a></span></h1>
</div>
<div class="header">
<p>See: <a href="#overview.description">Description</a></p>
</div>
<div class="contentContainer">
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Parsing API table, listing packages, and an explanation">
<caption><span>Parsing API</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Package</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="org/netbeans/modules/parsing/api/package-summary.html">org.netbeans.modules.parsing.api</a></td>
<td class="colLast">
<div class="block">Support for calling of high priority parser based user tasks in multi
    language environment.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="org/netbeans/modules/parsing/spi/package-summary.html">org.netbeans.modules.parsing.spi</a></td>
<td class="colLast">
<div class="block">Supports registration and automatic scheduling of various parser based tasks.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="org/netbeans/modules/parsing/spi/support/package-summary.html">org.netbeans.modules.parsing.spi.support</a></td>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="contentContainer"><a name="overview.description">
<!--   -->
</a>
<div class="block"><p>
  
<p>
    Parsing API defines contract between parsers registerred 
    for diferent languages and the rest of IDE. It is language neutral 
    and it supports language embeddings. 
  </p>
  
<p>
      The basic Parsing API constructs are Source, Snapshot and Embedding. 
      <a href="org/netbeans/modules/parsing/api/Source.html" shape="rect">Source</a>
      identificates some concrete file or document. There is always at most 
      one Source for one FileObject.
      <a href="org/netbeans/modules/parsing/api/Snapshot.html" shape="rect">Snapshot</a>
      represents some concrete content of Source, and it is immutable. And
      <a href="org/netbeans/modules/parsing/api/Embedding.html" shape="rect">Embedding</a>
      represents some part of Snapshot written in different language. Embedding 
      can contain some virtual code that is not contained in outside language too.
      Content of Embedding is represented by Snapshot and it can contain another
      Embeddings, so embeddings are recursive.
  </p>
  
<p>
      Parser is represented by abstract class called 
      <a href="org/netbeans/modules/parsing/spi/Parser.html" shape="rect">Parser</a>.
      The only way how to register a new parser for some concrete mime type 
      is to implement 
      <a href="org/netbeans/modules/parsing/spi/ParserFactory.html" shape="rect">ParserFactory</a>, 
      and register it in your manifest file in folder called 
      <code>"Editors/" + mimeType</code>. A new instance of Parser is always 
      created for some concrete Snapshot, or collection of Snapshots. One 
      instance of parser can be reused for more Snapshots created from the same 
      Source. Result of parsing (AST, syntax errors, semantic information) is
      represented by 
      <a href="org/netbeans/modules/parsing/spi/Parser.Result.html" shape="rect">Parser.Result</a>
      class. Parser creates a new instance of Parser.Result for each Task. 
      Following example shows how to integrate parser to the NetBeans using
      Parsing API:
      
  </p>
      
<pre xml:space="preserve">
      class FooParserFactory extends ParserFactory {
      
          public Parser createParser (
              Collection&lt;Snapshot&gt; snapshots
          ) {
              return new FooParser ();
          }
          
          private static class FooParser extends Parser {
          
              private boolean         cancelled = false;
              private AST             ast;
              
              public void parse (
                  Snapshot            snapshot, 
                  Task                task, 
                  SchedulerEvent      event
              ) throws ParseException {
                  cancelled = false;
                  for (...) {
                      // parsing snapshot.getText ();
                      if (cancelled) return;
                  }
                  ast = ...;
              }
              
              public abstract Result getResult (
                  Task                task,
                  SchedulerEvent      event
              ) throws ParseException {
                  return new FooResult (ast);
              }

              public void cancel () {
                  cancelled = true;
              }

              public void addChangeListener (
                  ChangeListener      changeListener
              ) {
              }

              public void removeChangeListener (
                  ChangeListener      changeListener
              ) {
              }
          }
          
          public static class FooResult extends Result {
            
              private AST           ast;
              private boolean       valid = true;
              
              FooResult (
                  AST               ast
              ) {
                  this.ast = ast;
              }
              
              public AST getAST () {
                  if (!valid) throw new InvalidResultException ();
                  return ast;
              }
              
              public void invalidate () {
                  valid = false;
                  ast = null;
              }
          }
      }
      </pre>
  
<p>
    Parsing API defines two basic kinds of 
    <a href="org/netbeans/modules/parsing/api/Task.html" shape="rect">Task</a>s. High priority 
    UserTasks and SchedulerTasks.
  </p>
  
<p>
    Execution of UserTask is synchnonous and it stops execution of all other 
    tasks. There are two types of UserTask. Simple 
    <a href="org/netbeans/modules/parsing/api/UserTask.html" shape="rect">UserTask</a>
    that supports some computations based on one block code written in one language. 
    And MultiLanguageUserTask (???) that supports scanning of all blocks of code 
    written in different languages embedded in one Source.
  </p>
  
<p>
    User of Parsing API can register various implementations of 
    <a href="org/netbeans/modules/parsing/spi/SchedulerTask.html" shape="rect">SchedulerTask</a> 
    for any language. Each SchedulerTask is registered for some specific 
    <a href="org/netbeans/modules/parsing/spi/Scheduler.html" shape="rect">Scheduler</a>.
    Scheduler defines when task shoud be started (for example
    when current editor is changed, when some nodes are selected in Project View, or
    when cursor position is changed). 
  </p>
  
<p>
    There are two specific tasks that can define language 
    embedding. So task implementator can recognize blocks of embedded languages.
    
    Parsing API contains support for high priority 
    <a href="index.html">ParsingAPI</a>
  
</p>
  
<p>
      
  
</p>
 
</p>
<h3>What is New (see <a href="apichanges.html">all changes</a>)?</h3>
<ul>

         
<!--Search for dates that are later or equal to 1997-09-01 in
          .-->
<!--Checking date 2014-7-7 with count of newer 0--><!--year ok-->
<li>Jul 7 '14 <a href="apichanges.html#SuspendStatus.isSuspendSupported">Added <code>SuspendStatus.isSuspendSupported</code></a>
<p>
              Added <code>SuspendStatus.isSuspendSupported</code> which test if active indexing task
              supports suspending.
          </p>
</li>
<!--Checking date 2014-7-7 with count of newer 0--><!--year ok-->
<li>Jul 7 '14 <a href="apichanges.html#QuerySupport.per-project-roots">Added <code>QuerySupport.findRoots</code> mapping class paths roots by projects.</a>
<p>
              Added <code>QuerySupport.findRoots</code> mapping class paths roots by projects.
          </p>
</li>
<!--Checking date 2014-6-18 with count of newer 2--><!--year ok-->
<li>Jun 18 '14 <a href="apichanges.html#Source.Context.Lookup">Source provides access to Lookup</a>
<p>
              
<p>
                  In the presence of multiple scopes or users, the parsing system needs
                  to access the proper context even though the work is done by different 
                  threads. It also has to propagate the proper context back to the user
                  tasks.
              </p>
              
<p>
                  Source can now be created with a Lookup that provides such proper context,
                  or automatically uses Lookup.getDefault if no explicit Lookup is given.
              </p>
          
</p>
</li>
<!--Checking date 2014-6-13 with count of newer 3--><!--year ok-->
<li>Jun 13 '14 <a href="apichanges.html#QuerySupport.Query.file">Added <code>QuerySupport.Query.file</code> factory for query searching index documents created for given file.</a>
<p>
              Added <code>QuerySupport.Query.file</code> factory for query searching index documents created for given file.
          </p>
</li>
<!--Checking date 2014-5-6 with count of newer 4--><!--year ok-->
<li>May 6 '14 <a href="apichanges.html#Parsing.Netbeans.Cleanup">Parsing API cleaned up from IDE dependencies</a>
<p>
              
<p>
                The Parsing API dependended on Windows System, Editor Registry, Data Systems and other IDE artifacts. All those
                dependencies were externalized as 'private SPIs' in the package <code>org.netbeans.modules.parsing.impspi</code>.
                The implementation that uses the other NetBeans IDE APIs resides in module <code>parsing.nb</code>.
                No API change was done, but the execution now relies on a proper binding to be present in the running application
                or a testsuite.
              </p>
              
<p>
                Basic testing environment was provided in unit tests, which implements basic of the externalized functions. However
                if a test need to check reparsing after document change, or data object change. Full implementation may be needed -
                the implementor can use a <code>test-dependency</code> to the <code>org.netbeans.modules.parsing.nb</code> module.
              </p>
<!--              <p>
                  Please refer to the <a href="http://netbeans.apache.org/javadoc/dev/org-netbeans-modules-parsing-nb/apichanges.html">API Changes document</a>
                  of the new module for entries related to moved classes.
              </p>-->
          
</p>
</li>
<!--Checking date 2014-5-2 with count of newer 5--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2014-4-20 with count of newer 6--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2013-8-19 with count of newer 7--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2013-5-10 with count of newer 8--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2013-5-2 with count of newer 9--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2013-3-18 with count of newer 10--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2012-9-16 with count of newer 11--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2012-2-17 with count of newer 12--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2012-1-26 with count of newer 13--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2011-11-29 with count of newer 14--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2011-11-10 with count of newer 15--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2011-3-28 with count of newer 16--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2011-1-24 with count of newer 17--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2010-10-18 with count of newer 18--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2010-1-26 with count of newer 19--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2010-1-21 with count of newer 20--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2010-1-18 with count of newer 21--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-10-1 with count of newer 22--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-9-7 with count of newer 23--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-9-1 with count of newer 24--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-8-24 with count of newer 25--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-8-19 with count of newer 26--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-8-12 with count of newer 27--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-7-3 with count of newer 28--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-6-23 with count of newer 29--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-6-10 with count of newer 30--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-5-21 with count of newer 31--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-4-20 with count of newer 32--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-4-15 with count of newer 33--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-4-2 with count of newer 34--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-3-27 with count of newer 35--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-3-27 with count of newer 35--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-3-2 with count of newer 37--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-3-1 with count of newer 38--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-2-26 with count of newer 39--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-2-25 with count of newer 40--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-2-20 with count of newer 41--><!--Skipped as the amount of changes is too big-->
<!--Checking date 2009-1-1 with count of newer 42--><!--Skipped as the amount of changes is too big-->
</ul>
<h3>Use Cases</h3>
<answer id="arch-usecases">
    
<ol>
        
<li>Parsing API Client can always ask for parser result. 
        This direct call has top level priority (stops all other requests). 
        Its designed to support direct user to IDE interaction 
        (like request for code completion) that have to be as 
        fast as possible. Such type of task is called UserTask. 
        This approach is used not only for parsing of file currently 
        edited in Editor, but it supports Refactoring too.</li>

        
<li>Parsing API Implementation listens on various changes in IDE 
        (typing in the current document, cursor movements, switching 
        of editor tabs, changes of classpath). These changes affects parse 
        tree of the current document, and various visualisation features 
        based on parser results (text coloring, hints, error stripe). 
        Parsing API Client can register some tasks that should run when 
        such change is done (Task). Implemementation of Parsing API than 
        calls all such registerred tasks. These calls has lower priority than
        UserTasks, and they should not block user interaction with IDE 
        (typing in editor).</li>

        
<li>Parsing API defines how to recognize embedded languages. It should
        be possible to create snapshot of some file, call some recognizers that
        finds blocks of embedded languages and run different parsers for embedded blocks.
        It should be able to use the same parser for top level language and any
        embedded block of code written in the same language. Embedding recognizer 
        can add some virtual code (code that does not exists in top level source) 
        to the embedded block. There should be some support for translation 
        of offsets between top level source and virtual source generated 
        for embedded piece of code.</li>
    
</ol>
 
</answer>
<h3>Exported Interfaces</h3>
          
                This table lists all of the module exported APIs 
                with 
                defined stability classifications. It is generated
                based on answers to questions about the architecture 
                of the module. <a href="architecture-summary.html">Read them all</a>...

                
                <a name="group-java">
<h5>Group of java interfaces</h5>
</a>
<table cellpadding="1" cellspacing="0" border="0" class="tablebg" width="100%">
<tr>
<td>
<table border="0" cellpadding="3" cellspacing="1" width="100%">
<tr class="tablersh">
<td align="CENTER" width="25%"><span class="titlectable">Interface Name</span></td><td align="CENTER" width="10%"><span class="titlectable">In/Out</span></td><td align="CENTER" width="10%"><span class="titlectable">Stability</span></td><td align="CENTER"><span class="titlectable">Specified in What Document?</span></td>
</tr>
<tr class="tabler">
<td>ParsingAPI</td><td>Exported</td><td><a href="http://wiki.netbeans.org/API_Stability#Stable">Stable</a></td><td><a name="java-ParsingAPI"><a href="index.html">index.html</a>
<p></p>
</a></td>
</tr>
</table>
</td>
</tr>
</table>
<p></p>
<a name="group-logger">
<h5>Group of logger interfaces</h5>
</a>
<table cellpadding="1" cellspacing="0" border="0" class="tablebg" width="100%">
<tr>
<td>
<table border="0" cellpadding="3" cellspacing="1" width="100%">
<tr class="tablersh">
<td align="CENTER" width="25%"><span class="titlectable">Interface Name</span></td><td align="CENTER" width="10%"><span class="titlectable">In/Out</span></td><td align="CENTER" width="10%"><span class="titlectable">Stability</span></td><td align="CENTER"><span class="titlectable">Specified in What Document?</span></td>
</tr>
<tr class="tabler">
<td>org.netbeans.ui.indexing</td><td>Exported</td><td><a href="http://wiki.netbeans.org/API_Stability#Devel">Under Development</a></td><td><a name="logger-org.netbeans.ui.indexing">
<p></p>
    Since version 1.47 the <code>RepositorUpdater</code> cooperates with <!-- XXX link to http://netbeans.apache.org/javadoc/dev/org-netbeans-modules-uihandler/overview-summary.html not OK from a stable API -->UI Gestures Collector
    by sending following messages to the <code>org.netbeans.ui.indexing</code> <a href="http://download.oracle.com/javase/8/docs/api/java/util/logging/Logger.html" shape="rect">logger</a>:
    <ul>
        
<li>
<b>INDEXING_STARTED</b> - message about a start of indexing (up to date check). Arguments:
            <ul>
                
<li>{0}: Long - the time from the last indexing</li>
            
</ul>
        
</li>
        
<li>
<b>INDEXING_FINISHED</b> - message about an end of indexing (up to date check). Arguments:
            <ul>
                
<li>{0}: Long - the time of indexing</li>
                
<li>For each indexer following 3 records are logged<ul>
                    
<li>{1}: String - name of indexer</li>
                    
<li>{2}: Integer - indexer invocation count</li>
                    
<li>{3}: Integer - indexing time spent in given indexer</li>
                    
</ul>
                
</li>
            
</ul>
        
</li>
    
</ul>
  
<p></p>
</a></td>
</tr>
</table>
</td>
</tr>
</table>
<p></p>
<h3>Implementation Details</h3>
<h5>Where are the sources for the module?</h5>
  
<p>
<p>
            The sources for the module are in the
            <a href="http://hg.netbeans.org/" shape="rect">NetBeans Mercurial repositories</a>.
        </p>
</p>
 
<h5>What do other modules need to do to declare a dependency on this one, in addition to or instead of a plain module dependency?</h5>
  
<p>
   XXX no answer for deploy-dependencies
  </p>
 
<p>
                Read more about the implementation in the <a href="architecture-summary.html">answers to 
                architecture questions</a>.
            </p></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li class="navBarCell1Rev">Overview</li>
<li>Package</li>
<li>Class</li>
<li>Use</li>
<li><a href="overview-tree.html">Tree</a></li>
<li><a href="deprecated-list.html">Deprecated</a></li>
<li><a href="index-files/index-1.html">Index</a></li>
<li><a href="help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">org.netbeans.modules.parsing.api/1 9.10.0 8</div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev</li>
<li>Next</li>
</ul>
<ul class="navList">
<li><a href="index.html?overview-summary.html" target="_top">Frames</a></li>
<li><a href="overview-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><span class="footnote"></span><!-- See javadoc.css for timestamp information --></small></p>
</body>
</html>
