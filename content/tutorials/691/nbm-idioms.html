
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>NetBeans APIs in a Nutshell</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NetBeans APIs in a Nutshell - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans Platform, Platform Tutorials, NetBeans APIs in a Nutshell">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">NetBeans APIs in a Nutshell</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/691/nbm-idioms.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
        <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_filesystems">FileSystems</a>
<ul class="sectlevel2">
<li><a href="#_differences_between_java_io_file_and_fileobjects">Differences Between <code>java.io.File</code> and `FileObject`s</a></li>
<li><a href="#_what_filesystems_are_used_for">[[What FileSystems Are Used For]]</a></li>
</ul>
</li>
<li><a href="#_xml_layers">XML Layers</a>
<ul class="sectlevel2">
<li><a href="#_providing_java_objects_through_module_layers">Providing Java Objects through Module Layers</a></li>
<li><a href="#_hiding_files_in_the_system_filesystem">Hiding Files in the System Filesystem</a></li>
<li><a href="#_the_system_filesystem_is_read_write">The System Filesystem is Read-Write</a></li>
</ul>
</li>
<li><a href="#_dataloaders_and_dataobjects">[[DataLoaders and DataObjects]]</a>
<ul class="sectlevel2">
<li><a href="#_using_dataobjects">[[Using `DataObject`s]]</a></li>
<li><a href="#_putting_it_together_why_instance_files_work">Putting it Together: Why <code>.instance</code> Files Work</a></li>
</ul>
</li>
<li><a href="#_nodes_the_presentation_layer">Nodes: The Presentation Layer</a>
<ul class="sectlevel2">
<li><a href="#_nodes_dataobjects_and_lookup_patterns">Nodes, DataObjects and lookup Patterns</a></li>
</ul>
</li>
<li><a href="#_lookup">Lookup</a>
<ul class="sectlevel2">
<li><a href="#_the_default_lookup">The Default Lookup</a></li>
</ul>
</li>
<li><a href="#_summary">Summary</a></li>
<li><a href="#_interconverting_between_files_dataobjects_fileobjects_and_nodes">Interconverting between Files, DataObjects, FileObjects and Nodes</a></li>
<li><a href="#_other_things_worth_mentioning">Other Things Worth Mentioning&#8230;&#8203;</a>
<ul class="sectlevel2">
<li><a href="#_explorer_views">Explorer Views</a></li>
<li><a href="#_the_window_system">The Window System</a></li>
</ul>
</li>
<li><a href="#_when_youre_wondering_where_something_is_implemented">When You&#8217;re Wondering Where Something is Implemented</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This overview will quickly familiarize you with how NetBeans modules interact with the NetBeans Platform and with each other. It is not intended as a comprehensive document—the  <a href="http://bits.netbeans.org/dev/javadoc/index.html">NetBeans API List</a>, the  <a href="https://netbeans.apache.org/kb/docs/platform.html">NetBeans Platform Learning Trail</a>, and the video series " <a href="https://netbeans.apache.org/tutorials/nbm-10-top-apis.html">Top 10 NetBeans APIs</a>" go into greater detail—but should serve as a guide to understanding the basic concepts of NetBeans module development.</p>
</div>
<div class="paragraph">
<p>A key thing to understanding the NetBeans Platform is to realize that very often the same API or infrastructure does double-duty—playing one role in dealing with the user&#8217;s files on disk, and another role when it comes to configuration information and runtime data. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A  <a href="http://bits.netbeans.org/dev/javadoc/org-openide-filesystems/org/openide/filesystems/FileSystem.html">FileSystem</a> represents the user&#8217;s files, but the  <a href="https://netbeans.apache.org/tutorials/nbm-glossary.html">System Filesystem</a> represents the IDE&#8217;s configuration data.</p>
</li>
<li>
<p>A  <a href="http://bits.netbeans.org/dev/javadoc/org-openide-loaders/org/openide/loaders/DataObject.html">DataObject</a> represents the parsed content of a Java or other file, but DataObjects also are used to instantiate a Java object installed by a module.</p>
</li>
<li>
<p>` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-util/org/openide/util/Lookup.html#getDefault()">Lookup.getDefault()</a>` is the way you access global services and singletons, but you also call ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-nodes/org/openide/nodes/Node.html#getLookup()">Node.getLookup()</a>` to find services specific to an individual file or object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is this reuse that has led some to say the NetBeans APIs are confusing, and it is the purpose of this overview to rapidly familiarize you with what these things are and how they are used in both roles.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_filesystems"><a href="http://bits.netbeans.org/dev/javadoc/">FileSystems</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In NetBeans 3.x, adding items to the classpath was accomplished by "mounting" FileSystems - a FileSystem had a root directory and everything under it amounted to a virtual namespace in which files lived.</p>
</div>
<div class="paragraph">
<p>Since NetBeans 4.0, the "mounting" is gone, and FileSystems are not a concept that users are exposed to in the UI - but the infrastructure behind FileSystems - ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-filesystems/org/openide/filesystems/FileSystem.html">org.openide.filesystems.FileSystem</a>` is alive and well under the hood. In coding NetBeans modules, you will typically interact with instances of ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-filesystems/org/openide/filesystems/FileObject.html">org.openide.filesystems.FileObject</a><code>, not ` <a href="https://docs.oracle.com/javase/1.5.0/docs/api/java/io/File.html">java.io.File</a></code>.</p>
</div>
<div class="sect2">
<h3 id="_differences_between_java_io_file_and_fileobjects">Differences Between <code>java.io.File</code> and `FileObject`s</h3>
<div class="paragraph">
<p>The main differences between them are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You get FileObjects from a FileSystem, rather than create them with a constructor.</p>
</li>
<li>
<p>Typically you don&#8217;t have FileObjects which represent something that doesn&#8217;t exist (as you can with <code>new File ("some/place/that/doesnt/exist")</code>).</p>
</li>
<li>
<p>You can listen for changes on FileObjects, including listening on folders for changes that happen anywhere underneath them</p>
</li>
<li>
<p>FileObjects don&#8217;t necessarily represent actual files on disk</p>
</li>
<li>
<p>FileObjects can have <em>attributes</em> which are essentially key-value pairs that can be associated with a file. An attribute might be a string, or a serialized object (note that use of attributes on user files on disk is discouraged as of NetBeans 4.0, but they are still commonly used in configuration files).</p>
</li>
<li>
<p>The path separator for FileObjects is always <code>/</code>, no conversions with File.separator are needed</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_what_filesystems_are_used_for">[[What FileSystems Are Used For]]</h3>
<div class="paragraph">
<p>FileSystems are used in two basic but very distinct ways in NetBeans. The first is representing the user&#8217;s files on disk. To get a FileObject for some path in NetBeans, just call, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">FileObject root = FileUtil.getConfigFile("myFolder").getFileObject("myFile.txt");</code></pre>
</div>
</div>
<div class="paragraph">
<p>The ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-filesystems/org/openide/filesystems/Repository.html">Repository</a>` is the master registry of all filesystems NetBeans knows about. In 4.0, it is the contents of the user&#8217;s hard drive(s).</p>
</div>
<div class="paragraph">
<p>The second usage is to represent configuration data - this is the "System Filesystem", which is where modules can install their files. Folders in the System Filesystem act as "extension points" - there are some which have predefined meanings (for example, NetBeans' main menu is a tree of folders you will place special "files" into to add menu items); modules are free to create their own folders and do as they wish with the contents.</p>
</div>
<div class="paragraph">
<p>How does all this work? Well, once you have the concept of a virtualized <code>FileSystem</code> full of <code>FileObject`s, it&#8217;s relatively easy to imagine a `FileSystem</code> which took several other <code>FileSystems</code> as arguments, and presented a merged view of the sub-filesystems as if all the data lived in one tree.</p>
</div>
<div class="paragraph">
<p>Add into this the notion that the "files" in a <code>FileSystem</code> don&#8217;t actually have to be physical files on disk at all - anything that can be made to walk and talk like a file will do. So you could have an XML "filesystem" where the contents of files lived in an XML document, not a bunch of files on disk.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_xml_layers">XML Layers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>That is what the NetBeans Platform does: Each module can define an XML "layer" file, which contains some virtual "files" and folders that are merged into the System Filesystem. In this way modules add their configuration data to the system. And because the System Filesystem is composed from discrete XML fragments from modules, when a module is disabled or unloaded, its XML layer is simply removed. `FileObject`s for the various folders that had files removed from them fire changes indicating some files were deleted, so the UI can get rid of any objects that represented the now-unloaded module&#8217;s files. This is why you can uninstall and reload modules at runtime.</p>
</div>
<div class="paragraph">
<p>In its jar manifest, a module will contain a line such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">OpenIDE-Module-Layer: org/netbeans/modules/mymodule/layer.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a pointer to an XML file inside the module jar (meaning that you simply create this file somewhere in your sources so it will be compiled into the jar when your module is built). In its simplest form, that could contain something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;filesystem&gt;
  &lt;folder name="myFolder"&gt;
    &lt;file name="myFile.txt" url="resources/aTextFile.txt"/&gt;
  &lt;/folder&gt;

&lt;/filesystem&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>url</code> attribute is important: It says where the contents of <code>myFile.txt</code> lives in the module&#8217;s jar file. This path is relative to the location of the layer file. So, if the layer file is <code>org/netbeans/modules/mymodule/layer.xml</code>, then in the module jar there should also be a text file <code>org/netbeans/modules/mymodule/resources/aTextFile.txt</code>. When some code requests an <code>InputStream</code> for <code>myFolder/myFile.txt</code>, that text file in the module jar is what will actually be read.</p>
</div>
<div class="paragraph">
<p>Of course, this particular fragment doesn&#8217;t do much of anything, but it is useful to illustrate what can be done here. Since <code>myFolder</code> has no predefined purpose to NetBeans, it is up to the module defining that folder to do something with its contents. But one could imagine a module that provided <code>myFolder</code>, let other modules add more files to that folder, and provided one menu item for each file, letting the user view them.</p>
</div>
<div class="paragraph">
<p>Accessing this file programmatically is quite simple:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">  FileObject myFile = FileUtil.getConfigFile("myFolder").getFileObject("myFile.txt");
  InputStream in = myFile.getInputStream();
  //...do something with it</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_providing_java_objects_through_module_layers">Providing Java Objects through Module Layers</h3>
<div class="paragraph">
<p>Just being able to install text files isn&#8217;t terribly interesting. Where the system of layers gets its power is in the ability to make files act as factories for Java objects. This is made possible using the same infrastructure that recognizes user data on disk, which will be discussed in more detail in <a href="#loaders">the section on Loaders</a>. Effectively, there is a specific file-extension registered in the system, <code>.instance</code> which identifies a file that actually represents a Java object and can create the actual object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;filesystem&gt;
  &lt;folder name="Menu"&gt;
    &lt;folder name="File"&gt;
      &lt;file name="org-netbeans-modules-mymodule-MyAction.instance"/&gt;
    &lt;/folder&gt;

  &lt;/folder&gt;
&lt;/filesystem&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above module layer actually adds a Swing Action (implemented by the class <code>org.netbeans.modules.mymodule.MyAction</code>) into the File menu on the main menu bar in NetBeans. The NetBeans core defines the folder <code>Menu</code>; the <code>core/ui</code> defines common menus that are in NetBeans, and provides the infrastructure that listens on these folders and keeps the GUI up-to-date if things are added or removed. Toolbars work in a similar fashion, as do many other things in NetBeans.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hiding_files_in_the_system_filesystem">Hiding Files in the System Filesystem</h3>
<div class="paragraph">
<p>The System Filesystem also allows one module to remove what another module adds. The semantics are extremely simple - for example, if you wanted to delete the File menu in NetBeans when your module is enabled, simply put the following into your module layer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;filesystem&gt;
  &lt;folder name="Menu"&gt;
    &lt;folder name="File_hidden"/&gt;
  &lt;/folder&gt;

&lt;/filesystem&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To make this work, modules can, in their manifest, request to be installed only after another module is installed - thus there is a defined stacking order to module layers.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_system_filesystem_is_read_write">The System Filesystem is Read-Write</h3>
<div class="paragraph">
<p>If it were all just static XML fragments, it wouldn&#8217;t be possible to actually store configuration changes the user has made - but of course, this is possible. Recall that we have the notion of a filesystem composed of merging multiple other filesystems - and that we know that we have an implementation of <code>FileSystem</code> over actual files on disk, which is how a user&#8217;s data files are accessed.</p>
</div>
<div class="paragraph">
<p>The top layer to the system filesystem is the <code>config/</code> subdirectory of the user&#8217;s settings directory - typically this lives in the user&#8217;s home directory under the directory <code>.netbeans</code>. So when a user makes changes (like rearranging menu items), the diff of the changes is written to disk in the settings directory; since this layer lives at the top of the stack, whatever changes are there (such as hiding files, as discussed above), override anything a module has in its layer file.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dataloaders_and_dataobjects">[[DataLoaders and DataObjects]]</h2>
<div class="sectionbody">
<div class="paragraph">
<p>` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-loaders/org/openide/loaders/DataObject.html">DataObject</a>` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-loaders/org/openide/loaders/DataObject.html">s</a> are wrappers for <code>FileObjects</code>. A FileObject simply represents a file-like entity; <code>DataObject`s are the level at which the system understands what the contents of a file are. So a module that implements handling for a particular file type provides its own subclass of `DataObject</code> and a factory which can create an instance of that DataObject type when it is passed a <code>FileObject</code>. <code>DataObjects</code> are what provide programmatic access to the contents of a file - such as parsing a file and providing a model for its content.</p>
</div>
<div class="paragraph">
<p>The factory for these objects, which a module installs, is called a ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-loaders/org/openide/loaders/DataLoader.html">DataLoader</a>`. It is declared directly in the module&#8217;s manifest:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Name: org/netbeans/modules/povray/PovDataLoader.class
OpenIDE-Module-Class: Loader</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example of how to write a DataLoader can be found in the  <a href="nbm-filetype.html">NetBeans DataLoader Module Tutorial</a>. DataLoaders typically register themselves to support specific file extensions or mime types.</p>
</div>
<div class="paragraph">
<p>Unless you are writing support for a language or file-type, typically you will be using, not creating, <code>DataObject`s. Getting the DataObject for a file is simple: Just call ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-loaders/org/openide/loaders/DataObject.html#find(org.openide.filesystems.FileObject)">DataObject.find(someFileObject)</a></code>.</p>
</div>
<div class="sect2">
<h3 id="_using_dataobjects">[[Using `DataObject`s]]</h3>
<div class="paragraph">
<p><code>DataObject`s don&#8217;t do a lot in and of themselves - that is, it is almost always a mistake to be casting a DataObject as a particular subclass. The way to do most interesting interaction with DataObjects is via the method ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-loaders/org/openide/loaders/DataObject.html#getCookie(java.lang.Class)">getCookie()</a></code>. The pattern, which we will see in more detail in the section on <a href="#lookup"><code>Lookup</code></a> is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">OpenCookie open = someDataObject.getCookie (OpenCookie.class);
open.open();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above code will actually open a file in the editor. The key here is that, rather than providing programmatic access to a file&#8217;s content as a bunch of instance methods on itself (which would quickly lead to a tangled mess of inheritance issues), you <em>ask</em> a <code>DataObject</code> for an instance of some known interface that does what you need. This is accomplished by passing a <code>Class</code> object to <code>getCookie()</code>, which will return that object if possible, or <code>null</code> if not.</p>
</div>
<div class="paragraph">
<p>As another example, determining if an opened file has unsaved changes is as simple as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">boolean needsSaving = someDataObject.getCookie (SaveCookie.class) != null;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Modules can provide their own public interfaces, and make instances of those objects available via <code>getCookie()</code>. So, for example, a <code>DataObject</code> for an XML file might make a DOM tree or some other structural representation of the file available via <code>getCookie()</code> for other modules to use to manipulate the file&#8217;s contents. Some common interfaces modules will typically use via <code>getCookie()</code> can be found in the package ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-nodes/org/openide/cookies/package-summary.html">org.openide.cookies</a>`.</p>
</div>
<div class="paragraph">
<p>Note that the term "cookie" in this context has nothing to do with the web browser concept of cookies.</p>
</div>
</div>
<div class="sect2">
<h3 id="_putting_it_together_why_instance_files_work">Putting it Together: Why <code>.instance</code> Files Work</h3>
<div class="paragraph">
<p>To illustrate the power of loaders and <code>DataObjects</code>, recall that loaders are registered against a file type. And recall that modules can install actual Java objects via <code>.instance</code> files. What&#8217;s going on here?</p>
</div>
<div class="paragraph">
<p>What is actually happening is that the very same infrastructure (<code>DataLoader`s) that lets NetBeans recognize a user&#8217;s `.java</code> file on disk and create an appropriate <code>DataObject</code> is what recognizes <code>.instance</code> files - after all, the System Filesystem is a filesystem too. There is simply a <code>DataLoader</code> registered in the system that claims all files with the <code>.instance</code> extension.</p>
</div>
<div class="paragraph">
<p>Under the hood, what&#8217;s really happening is that the <code>DataObject</code> for a <code>.instance</code> file provides an ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-nodes/org/openide/cookies/InstanceCookie.html">InstanceCookie</a>`. So to get the actual object in question manually, you would do something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">FileObject file = Repository.getDefault().getDefaultFileSystem().findResource (
    "someFolder/com-foo-mymodule-MyClass.instance");

DataObject dob = DataObject.find (file);
InstanceCookie cookie = (InstanceCookie) dob.getCookie (InstanceCookie.class);
MyClass theInstance = (MyClass) cookie.instanceCreate();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_nodes_the_presentation_layer">Nodes: The Presentation Layer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You&#8217;ve probably noticed that there are quite a few tree components in NetBeans - the Files and Projects tabs, and others. The  <a href="http://bits.netbeans.org/dev/javadoc/org-openide-nodes/org/openide/nodes/doc-files/api.html">Nodes API</a> is what provides the contents to those trees. Think of `DataObject`s as being the data model; a Node is where interacting with the user comes in.</p>
</div>
<div class="paragraph">
<p>A ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-nodes/org/openide/nodes/Node.html">Node</a>` provides human-visible things like an icon and a (possibly localized) display name to DataObjects. And a Node provides a list of ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-awt/org/openide/awt/Actions.html">Actions</a>` that can appear in a popup menu for that node.</p>
</div>
<div class="paragraph">
<p>`Node`s define <em>context</em> for NetBeans - at any given moment, there is usually one or more <em>activated nodes</em> which determine what menu and toolbar actions are enabled - they are the clue to the rest of the system as to what the user is doing. Each UI component (such as the Files tab or the Editor) provides an array of `Node`s which are activated - selected. In a tree component, it is rather obvious how this works; but even when editing in the editor, the activated node triggers what actions are enabled, depending on where the caret is - if the caret is inside the body of a method, the activated node is actually the same node you would find if you expanded the structure tree of that java class in the Projects tab.</p>
</div>
<div class="paragraph">
<p>So, to get the <code>Node</code> corresponding to a <code>DataObject</code>, simply call <code>someDataObject. <a href="http://bits.netbeans.org/dev/javadoc/org-openide-loaders/org/openide/loaders/DataObject.html#getNodeDelegate()">getNodeDelegate()</a></code>.</p>
</div>
<div class="sect2">
<h3 id="_nodes_dataobjects_and_lookup_patterns">Nodes, DataObjects and lookup Patterns</h3>
<div class="paragraph">
<p><code>Node`s use the same pattern as `DataObject</code> - they have a <code>getCookie()</code> method that can be used as described above. <code>Node`s that represent `DataObject`s will typically delegate to their `DataObject&#8217;s `getCookie()</code> method.</p>
</div>
<div class="paragraph">
<p>With <code>Node</code>, it is common to see a second form of this call: <code>Node. <a href="http://bits.netbeans.org/dev/javadoc/org-openide-nodes/org/openide/nodes/Node.html#getLookup()">getLookup()</a>. <a href="http://bits.netbeans.org/dev/javadoc/org-openide-util/org/openide/util/Lookup.html#lookup(java.lang.Class)">lookup (SomeClass.class)</a></code>. The latter is a newer idiom, which will eventually replace <code>getCookie()</code> in both <code>Node`s and `DataObject`s. The specific reason is that `getCookie()</code> requires that the returned object implement an empty marker interface, <code>Node.Cookie</code>, which unnecessarily limits what can be returned by <code>getCookie()</code>. The only thing you need to remember is that the two are functionally equivalent, and in new code, use <code>getLookup().lookup()</code> where possible. There is further discussion of what <code>Lookup</code> is <a href="#lookup">below</a>.</p>
</div>
<div class="paragraph">
<p>Note that all `Node`s do not represent `DataObject`s - the Nodes API is useful in and of itself for creating tree like hierarchies.</p>
</div>
<div class="paragraph">
<p>There are a number of UI components that can represent a tree of nodes as trees, combo boxes, lists, etc. - so typically when one needs to display a UI with a list or tree in it, the natural choice is to use the Nodes API, and simply create the appropriate component and set the root node appropriately.</p>
</div>
<div class="paragraph">
<p>A key thing to remember is that Nodes are intended as a presentation layer for an underlying data model (which might be files on disk, or whatever you want). If you find you&#8217;re putting a lot of logic into your <code>Node</code> subclass, consider that your model is what needs enhancing - `Node`s should be lightweight and simple, and the model should do the heavy lifting.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lookup">Lookup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-util/org/openide/util/Lookup.html">org.openide.util.Lookup</a>` is NetBeans' form of  <a href="http://www.martinfowler.com/articles/injection.html">dependency injection</a>. As with `DataObject`s and `FileObject`s, it has two common usages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Local lookup</em> - asking an object for an instance of some interface, as we saw above with <code>Node.getLookup().lookup (SomeClass.class)</code></p>
</li>
<li>
<p><em>Global lookup</em> - services - often singleton instances of some class - can be registered into the <em>default lookup</em>.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_the_default_lookup">The Default Lookup</h3>
<div class="paragraph">
<p>The default lookup is an instance of <code>Lookup</code> returned by calling <code>Lookup.getDefault()</code>. The OpenAPIs define a number of abstract service classes which allow you to get an instance of some object that is of general use - for example, ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-util/org/openide/ErrorManager.html">org.openide.ErrorManager</a><code>, used to log errors and exceptions, or ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-dialogs/org/openide/DialogDisplayer.html">org.openide.DialogDisplayer</a></code>, which displays dialogs to the user. These are typically things that there only needs to be one of in the system, so they are effectively singleton objects. To get an instance of <code>ErrorManager</code>, you could do as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">ErrorManager err = (ErrorManager) Lookup.getDefault().lookup (ErrorManager.class);
err.log ("log message");</code></pre>
</div>
</div>
<div class="paragraph">
<p>In practice this code is a little clunky to ask people to write all the time, so most such abstract classes will have their own method <code>getDefault()</code> implemented as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public abstract class MyService {
   public static MyService getDefault() {
      MyService result = (MyService) Lookup.getDefault().lookup (MyService.class);
      if (result == null) {
         result = new TrivialImplementationOfMyService();
      }
      return result;
   }

   public abstract void doSomething (...);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Modules can register their own objects into the default lookup in one of two ways - via the Java  <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/jar/jar.html#Provider%20Configuration%20File"> provider extension mechanism</a> - putting a file into the <code>META-INF/services</code> directory of their module jar, or by putting a <code>.instance</code> file in the <code>Services</code> folder of the System Filesystem.</p>
</div>
<div class="paragraph">
<p>The preferred mechanism is the provider extension mechanism, and doing this is extremely simple: To provide your own implementation of ErrorManager, for example, simply create two folders under the <code>src/</code> folder of your module: <code>META-INF/services</code>. In the <code>services/</code> folder, put a file called <code>org.openide.ErrorManager</code>. That file will contain one line of text - the name of the class in your module that should be used - e.g. <code>com.mymodule.MyLog4JErrorManager</code>.</p>
</div>
<div class="paragraph">
<p>While we won&#8217;t go into this in detail here, it is also possible to register multiple instances of an interface into the default lookup, retrieve all of them and even listen for changes on the result of that query.</p>
</div>
<div class="paragraph">
<p>A very thorough discussion of <code>Lookup</code> can be found  <a href="http://openide.netbeans.org/lookup/">here</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary">Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The salient points to remember are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FileObjects wrap files (and sometimes other things)</p>
</li>
<li>
<p>DataObjects wrap FileObjects and understand what&#8217;s in a file</p>
</li>
<li>
<p>You typically don&#8217;t call methods on a DataObject, you ask it for objects via <code>getCookie()</code></p>
</li>
<li>
<p>Configuration information is just another filesystem you can get DataObjects out of</p>
</li>
<li>
<p>Nodes wrap DataObjects and provide human-displayable information - actions, icons, names</p>
</li>
<li>
<p>Nodes are a presentation layer, not the place to put lots of logic</p>
</li>
<li>
<p>Lookup is how you get globally registered services</p>
</li>
<li>
<p>Lookup is also how you ask individual objects (Nodes, DataObjects, Projects) for the objects that do real work</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interconverting_between_files_dataobjects_fileobjects_and_nodes">Interconverting between Files, DataObjects, FileObjects and Nodes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Very often you may be integrating an external tool that wants to be passed instances of <code>java.io.File</code>; also there are many cases where you need to interconvert between the various types NetBeans offers which in some way or other represent files. Here are the typical ways to interconvert between all of the above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Find a file on disk
FileObject f = Repository.getDefault().getDefaultFilesystem().getRoot().getFileObject("some/folder/someFile.txt");
 or if something passes you a File...
FileObject f = FileUtil.toFileObject (new File("some/folder/someFile.txt"))

Turn a FileObject into a File (may fail for virtual filesystems)
File f = FileUtil.toFile (someFileObject)

Get the DataObject for a FileObject

DataObject obj = DataObject.find (someFileObject)

Get the FileObject a DataObject represents
FileObject file = someDataObject.getPrimaryFile()

Get the Node that represents a FileObject
Node n = someDataObject.getNodeDelegate()

Get the DataObject a Node represents (if any)
DataObject obj = (DataObject) someNode.getLookup().lookup(DataObject.class)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_other_things_worth_mentioning">Other Things Worth Mentioning&#8230;&#8203;</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Below we go through two other critical pieces of NetBeans APIs which complete the basic picture of things modules typically interact with; they don&#8217;t have the type of dual-use issues that the previous topics do, but are included for completeness.</p>
</div>
<div class="sect2">
<h3 id="_explorer_views">Explorer Views</h3>
<div class="paragraph">
<p><code>Node`s provide a hierarchy of objects; the Explorer API provides Swing UI components that display a `Node</code> and its children. There are a large variety of Explorer view classes which can variously represent a hierarchy of <code>Node`s as a `JList</code>, a <code>JMenu</code>, a <code>JComboBox</code>, a <code>JTree</code>, a JTable and more. Typically when you want to display some hierarchical data structure in NetBeans, you locate or implement the appropriate Node, create an appropriate Explorer component for it, and set the Explorer view&#8217;s root node to be the node you want to display.</p>
</div>
<div class="paragraph">
<p>In older versions of NetBeans, the place where the Files and Projects tabs live was a separate window with the title "Explorer" - you will see the phrase "open in the Explorer" in older documentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_window_system">The Window System</h3>
<div class="paragraph">
<p>The API of the Window System is found in ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-windows/org/openide/windows/package-summary.html">org.openide.windows</a><code>. A basic overview is that in NetBeans, you don&#8217;t deal with `JFrame`s or `JDialog`s - rather, you supply components which are displayed, and NetBeans window management system decides where and how they appear in terms of top-level frames. The main thing to know is that all components in NetBeans are subclasses or usages of ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-windows/org/openide/windows/TopComponent.html">org.openide.windows.TopComponent</a></code>. <code>TopComponent</code> has relatively self-explanatory methods such as ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-windows/org/openide/windows/TopComponent.html#open()">open()</a>` and ` link:http://bits.netbeans.org/dev/javadoc/org-openide-windows/org/openide/windows/TopComponent.html#requestActive()<code class="requestActive()">. `TopComponent`s live in <em>docking modes</em> (the somewhat confusingly named ` <a href="http://bits.netbeans.org/dev/javadoc/org-openide-windows/org/openide/windows/Mode.html">org.openide.windows.Mode</a></code>). A <code>Mode</code> is a container for multiple <code>TopComponents</code> - a thing that has Tabs. <code>Mode</code> itself is not a GUI component, it is an abstract class that acts as a controller.</p>
</div>
<div class="paragraph">
<p><code>TopComponents</code> can be instantiated and opened on the fly, but typically a module installs its UI components via several XML files inside its jar file and pointers to those files in the module&#8217;s XML layer file. Fairly comprehensive examples of usage can be found in the NetBeans source base in <code>platform/samples/window-system-*/</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_when_youre_wondering_where_something_is_implemented">When You&#8217;re Wondering Where Something is Implemented</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes you just want to go read the code - but it&#8217;s a jungle of jars out there. Here are some of the things people often want to track down - the locations are the actual directories in a checkout of NetBeans sources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Where are the standard menus defined?</strong> - core/ui</p>
</li>
<li>
<p><strong>Where is dialog and windowing handled?</strong> - core/windows</p>
</li>
<li>
<p><strong>Where is the tab control NetBeans uses for tabs?</strong> - core/swing/tabcontrol</p>
</li>
<li>
<p><strong>What sets the fonts for NetBeans?</strong> - core/swing/plaf</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="http://netbeans.apache.org/community/mailing-lists.html">Send Us Your Feedback</a></p>
</div>
</div>
</div>
        
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/691/nbm-idioms.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
