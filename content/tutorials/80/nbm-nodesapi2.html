
<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>NetBeans Nodes API Tutorial</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NetBeans Nodes API Tutorial - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans Platform, Platform Tutorials, NetBeans Nodes API Tutorial">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
     <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet"> 
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
</head>


    <body>
        

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


        
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 12.4</h1>
            <p><a class="button success" href="/download/nb124/nb124.html">Find out more</a></p>
        </div>
    </div>
</section>

        <div class='grid-container main-content tutorial'>
            <h1 class="sect0">NetBeans Nodes API Tutorial</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://issues.apache.org/jira/projects/NETBEANS/issues">open a JIRA issue</a>, 
                     or <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/80/nbm-nodesapi2.asciidoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
            <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_creating_a_node_subclass">Creating a Node subclass</a></li>
<li><a href="#_enhancing_display_names_with_html">Enhancing Display Names with HTML</a></li>
<li><a href="#_providing_icons">Providing Icons</a></li>
<li><a href="#_actions_and_nodes">Actions and Nodes</a></li>
<li><a href="#_presenters">Presenters</a></li>
<li><a href="#_properties_and_the_property_sheet">Properties and the Property Sheet</a></li>
<li><a href="#_read_write_properties">Read-Write Properties</a></li>
<li><a href="#_grouping_property_sets">Grouping Property Sets</a></li>
<li><a href="#_general_property_sheet_caveats">General Property Sheet Caveats</a></li>
<li><a href="#_review_of_concepts">Review of Concepts</a></li>
<li><a href="#_next_steps">Next Steps</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial shows how to make use of some of the features of the Nodes API in NetBeans. It shows how to do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Decorate Nodes with icons</p>
</li>
<li>
<p>Use HTML markup to enhance how Nodes are displayed</p>
</li>
<li>
<p>Create properties for display in the property sheet</p>
</li>
<li>
<p>Provide Actions from Nodes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This tutorial is intended as a follow-on to the  <a href="nbm-selection-1.html">NetBeans Selection Management Tutorial</a>, which covers how <code>Lookup</code> is used in managing selection in the NetBeans windowing system, and its  <a href="nbm-selection-2.html">follow-on tutorial</a> which demonstrates how to use the Nodes API in managing selection.</p>
</div>
<div class="paragraph">
<p>As its basis, this tutorial uses the source code created in the first tutorial and enhanced further in the second. If you have not yet done these tutorials, it is recommended to do them first.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are using an earlier version of Apache NetBeans, see  <a href="74/nbm-nodesapi2.html">the previous version of this document</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For troubleshooting purposes, you are welcome to download the  <a href="http://web.archive.org/web/20170409072842/http://java.net/projects/nb-api-samples/show/versions/8.0/tutorials/selection-management/3-of-4/EventManager">completed tutorial source code</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_node_subclass">Creating a Node subclass</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As mentioned in the  <a href="nbm-selection-2.html">previous tutorial</a>, Nodes are <em>presentation objects</em>. That means that they are not a data model themselves—rather, they are a presentation layer for an <em>underlying data model</em>. In the Projects or Files windows in the NetBeans IDE, you can see `Node`s used in a case where the underlying data model is files on disk. In the Services window in the IDE, you can see them used in a case where the underlying objects are configurable aspects of NetBeans runtime environment, such as available application servers and databases.</p>
</div>
<div class="paragraph">
<p>As a presentation layer, `Node`s add human-friendly attributes to the objects they model. The essential ones are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Display Name</strong>—a human readable, user-friendly display name</p>
</li>
<li>
<p><strong>Description</strong>—a human readable, user-friendly description, often shown as a tooltip</p>
</li>
<li>
<p><strong>Icon</strong>—some glyph that graphically indicates the type of object shown and possibly its state</p>
</li>
<li>
<p><strong>Actions</strong>—actions that appear on the context menu when the node is right-clicked, which can be invoked by the user</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the preceding tutorial, you used your <code>EventChildFactory</code> class to create `Node`s, by calling</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">new AbstractNode(Children.create(new EventChildFactory(), true), Lookups.singleton(key));</code></pre>
</div>
</div>
<div class="paragraph">
<p>and then calling <code>setDisplayName(key.toString())</code> to provide a basic display name. There is much more that can be done to make your <code>Node`s more user-friendly. First you will need to create a `Node</code> subclass to work with, as instructed below.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>In the My Editor project, right click the package <code>org.myorg.myeditor</code> and choose New &gt; Java Class. Name the class "EventNode" and press Enter or click Finish.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Change the signature and constructors of the class as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package org.myorg.myeditor;

import org.myorg.myapi.Event;
import org.openide.nodes.AbstractNode;
import org.openide.nodes.Children;
import org.openide.util.lookup.Lookups;

public class EventNode extends AbstractNode {

    public EventNode(Event obj) {
        super (Children.create(new EventChildFactory(), true), Lookups.singleton(obj));
        setDisplayName ("Event " + obj.getIndex());
    }

    public EventNode() {
        super (Children.create(new EventChildFactory(), true));
        setDisplayName ("Root");
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Open <code>MyEditor</code> from the same package, in the code editor. Remove these lines in the constructor:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">mgr.setRootContext(new AbstractNode(new EventChildFactory()));
setDisplayName ("My Editor");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead of the above, add this single line of code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">mgr.setRootContext(new EventNode());</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Now make a similar change to the  <code>EventChildFactory</code>  class. Open it in the editor, and change its <code>createNodeForKey</code> method as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
protected Node createNodeForKey(Event key) {
    return new EventNode(key);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code is now runnable, but so far all you&#8217;ve done is moved logic around. It will do exactly what it did before. The only (non-user-visible) difference you now are using a  <code>Node</code>  subclass instead of just using  <code>AbstractNode</code> .</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_enhancing_display_names_with_html">Enhancing Display Names with HTML</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first enhancement you will provide is an enhanced display name. The Nodes API supports a limited subset of HTML which you can use to enhance how the labels for `Node`s are shown in Explorer UI components. The following tags are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>font color—font size and face settings are not supported, but color is, using standard html syntax</p>
</li>
<li>
<p>font style tags—b,i,u and s tags—bold, italic, underline, strikethrough</p>
</li>
<li>
<p>A limited subset of SGML entities: &amp;quot;, &amp;lt;, &amp;amp;, &amp;lsquo;, &amp;rsquo;, &amp;ldquo;, &amp;rdquo;, &amp;ndash;, &amp;mdash;, &amp;ne;, &amp;le;, &amp;ge;, &amp;copy;, &amp;reg;, &amp;trade;, and &amp;nbsp;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Since there is no terribly exciting data available from your <code>Event</code>, which only has an integer and a creation date, you&#8217;ll extend this artificial example, and decide that odd numbered <code>Events</code> should appear with blue text.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Add the following method to <code>EventNode</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">@Override
public String getHtmlDisplayName() {
    Event obj = getLookup().lookup (Event.class);
    if (obj!=null &amp;amp;&amp;amp; obj.getIndex() % 2 != 0) {
        return "&lt;font color='0000FF'&gt;Event " + obj.getIndex() + "&lt;/font&gt;";
    } else {
        return null;
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>What the above code accomplishes is this—when painting, the Explorer component showing the nodes calls <code>getHtmlDisplayName()</code> first. If it gets a non-null value back, then it will use the HTML string it received and a fast, lightweight HTML renderer to render it. If it is null, then it will fall back to whatever is returned by <code>getDisplayName()</code>. So this way, any <code>EventNode</code> whose <code>Event</code> has an index not divisible by 2 will have a non-null HTML display name. Run the Event Manager again and you should see the following:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/html-display-1.png" alt="html display 1">
</div>
</div>
<div class="paragraph">
<p>There are two reasons for <code>getDisplayName()</code> and <code>getHtmlDisplayName()</code> being separate methods—first, it is an optimization; second, as you will see later, it makes it possible to compose HTML strings together, without needing to strip &lt;html&gt; marker tags.</p>
</div>
<div class="paragraph">
<p>You can enhance this further—in the previous tutorial, the date was included in the HTML string, and you have removed it here. So let&#8217;s make your HTML string a little more complex, and provide HTML display names for all of your nodes.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Modify the <code>getHtmlDisplayName()</code> method as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">@Override
public String getHtmlDisplayName() {
    Event obj = getLookup().lookup (Event.class);
    *if (obj != null) {
        return "&lt;font color='#0000FF'&gt;Event " + obj.getIndex() + "&lt;/font&gt;" +
                " &lt;font color='AAAAAA'&gt;&lt;i&gt;" + obj.getDate() + "&lt;/i&gt;&lt;/font&gt;";
    }* else {
        return null;
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Run the Event Manager again and now you should see the following:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/html-display-2.png" alt="html display 2">
</div>
</div>
<div class="paragraph">
<p>One minor thing you can do to improve appearance here—you are currently using hard-coded colors in your HTML. Yet the NetBeans Platform can run under various look and feels, and there&#8217;s no guarantee that your hard-coded color will not be the same as or very close to the background color of the tree or other UI component your Node appears in.</p>
</div>
<div class="paragraph">
<p>The NetBeans HTML renderer provides a minor extension to the HTML spec which makes it possible to look up colors by passing UIManager keys. The look and feel Swing is using provides a UIManager, which manages a name-value map of the colors and fonts a given look and feel uses. Most (but not all) look and feels find the colors to use for different GUI elements by calling <code>UIManager.getColor(String)</code>, where the string key is some agreed-upon value. So by using values from UIManager, you can guarantee that you will always be producing readable text. The two keys you will use are "textText", which returns the default color for text (usually black unless using a look and feel with a dark-background theme), and "controlShadow" which should give us a color that contrasts, but not too much, with the default control background color.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Modify the <code>getHtmlDisplayName()</code> method as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">@Override
public String getHtmlDisplayName() {
    Event obj = getLookup().lookup (Event.class);
    if (obj != null) {
        return "&lt;font color='!textText'&gt;Event " + obj.getIndex() + "&lt;/font&gt;" +
                " &lt;font color='!controlShadow'&gt;&lt;i&gt;" + obj.getDate() + "&lt;/i&gt;&lt;/font&gt;";
    } else {
        return null;
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Run the Event Manager again and now you should see the following:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/html-display-3.png" alt="html display 3">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You got rid of your blue color and switched to plain old black. Using the value of <code>UIManager.getColor("textText")</code> guarantees us text that will always be readable under any look and feel, which is valuable; also, color should be used sparingly in user interfaces, to avoid the  <a href="http://www.catb.org/jargon/html/A/angry-fruit-salad.html">angry fruit salad</a> effect. If you really want to use wilder colors in your UI, the best bet is to either find a UIManager key/value pair that consistently gets what you want, or create a  <a href="https://netbeans.apache.org/wiki/devfaqmodulesgeneral">ModuleInstall</a> class and  <a href="https://github.com/apache/netbeans/blob/master/platform/o.n.swing.plaf/src/org/netbeans/swing/plaf/util/RelativeColor.java"> <em>derive the color</em></a> <em>from a color you can get from UIManager</em>, or if you are sure you know the color theme of the look and feel, hard-code it on a per-look and feel basis (<code>if ("aqua".equals(UIManager.getLookAndFeel().getID())&#8230;&#8203;</code>).
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_providing_icons">Providing Icons</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Icons, used judiciously, also enhance user interfaces. So providing 16x16 pixel icon is another way to improve the appearance of your UI. One caveat of using icons is, do not attempt to convey too much information via an icon—there are not a lot of pixels there to work with. A second caveat that applies to both icons and display names is, <em>never use only color to distinguish a node</em>— there are many people in the world who are colorblind.</p>
</div>
<div class="paragraph">
<p>Providing an icon is quite simple—you just load an image and set it. You will need to have a GIF or PNG file to use. If you do not have one easily available, here is one you can use:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/icon.png" alt="icon">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Copy the image linked above, or another 16x16 PNG or GIF, into the same package as the <code>MyEditor</code> class.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Add the following method to the <code>EventNode</code> class:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
public Image getIcon (int type) {
    return ImageUtilities.loadImage ("org/myorg/myeditor/icon.png");
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is possible to have different icon sizes and styles—the possible int values passed to <code>getIcon()</code> are constants on <code>java.beans.BeanInfo</code>, such as <code>BeanInfo.ICON_COLOR_16x16</code>. Also, while you can use the standard JDK <code>ImageIO.read()</code> to load your images, <code>ImageUtilities.loadImage()</code> is more optimized, has better caching behavior, and supports branding of images.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>If you run the code now, you will notice one thing—the icon is used for some nodes but not others!</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/icon-display-1.png" alt="icon display 1">
</div>
</div>
<div class="paragraph">
<p>The reason for this is that it is common to use a different icon for an unexpanded versus an expanded <code>Node</code>. All you need to do to fix this is to override another method. Add the following additional method to the <code>EventNode</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
public Image getOpenedIcon(int i) {
    return getIcon (i);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now if you run the Event Manager, all of the Nodes will have the correct icon, as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/icon-display-2.png" alt="icon display 2">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actions_and_nodes">Actions and Nodes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The next aspect of <code>Node`s you will treat is <em>Actions</em>. A `Node</code> has a popup menu which can contain actions that the user can invoke against that <code>Node</code>. Any subclass of <code>javax.swing.Action</code> can be provided by a <code>Node</code>, and will show up in its popup menu. Additionally, there is the concept of <em>presenters</em>, which you will cover later.</p>
</div>
<div class="paragraph">
<p>First, let&#8217;s create a simple action for your nodes to provide:</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Override the <code>getActions()</code> method of <code>EventNode</code> as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
public Action[] getActions (boolean popup) {
    return new Action[] { new MyAction() };
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Now, create the <code>MyAction</code> class as an inner class of <code>EventNode</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private class MyAction extends AbstractAction {

    public MyAction () {
        putValue (NAME, "Do Something");
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        Event obj = getLookup().lookup(Event.class);
        JOptionPane.showMessageDialog(null, "Hello from " + obj);
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Run the Event Manager again and notice that when you right-click on a node, a menu item is shown:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/action-display-1.png" alt="action display 1">
</div>
</div>
<div class="paragraph">
<p>When you select the menu item, the action is invoked:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/action-display-2.png" alt="action display 2">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_presenters">Presenters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Of course, sometimes you will want to provide a submenu or checkbox menu item or some other component, other than a JMenuItem, to display in the popup menu. This is quite easy:</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Add to the signature of <code>MyAction</code> that it implements <code>Presenter.Popup</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private class MyAction extends AbstractAction *implements Presenter.Popup* {</code></pre>
</div>
</div>
<div class="paragraph">
<p>Press Ctrl-Shift-I to fix imports.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Position the caret in the class signature line of <code>MyAction</code> and press Alt-Enter when the lightbulb glyph appears in the margin, and accept the hint "Implement All Abstract Methods". Implement the newly created method <code>getPopupPresenter()</code> as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
public JMenuItem getPopupPresenter() {
    JMenu result = new JMenu("Submenu");  //remember JMenu is a subclass of JMenuItem
    result.add (new JMenuItem(this));
    result.add (new JMenuItem(this));
    return result;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Run the Event Manager again and notice that you now have the following:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/action-display-3.png" alt="action display 3">
</div>
</div>
<div class="paragraph">
<p>The result is not too exciting—you now have a submenu called "Submenu" with two identical menu items. But again, you should get the idea of what is possible here—if you want to return a <code>JCheckBoxMenuItem</code> or some other kind of menu item, it is possible to do that.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_properties_and_the_property_sheet">Properties and the Property Sheet</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The last subject you&#8217;ll cover in this tutorial is properties. You are probably aware that NetBeans IDE contains a "property sheet" which can display the "properties" of a <code>Node</code>. What exactly "properties" means depends on how the <code>Node</code> is implemented. Properties are essentially name-value pairs which have a Java type, which are grouped in sets and shown in the property sheet—where writable properties can be edited via their <em>property editors</em> (see  <a href="https://docs.oracle.com/javase/8/docs/api/java/beans/PropertyEditor.html"><code>java.beans.PropertyEditor</code></a> for general information about property editors).</p>
</div>
<div class="paragraph">
<p>So, built into <code>Node`s from the ground up is the idea that a Node may have properties that can be viewed and, optionally, edited on a property sheet. Adding support for this is quite easy. There is a convenience class in the Nodes API, `Sheet</code>, which represents the entire set of properties for a Node. To it you may add instances of <code>Sheet.Set</code>, which represent "property sets", which appear in the property sheet as groups of properties.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Override <code>EventNode.createSheet()</code> as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
protected Sheet createSheet() {

    Sheet sheet = Sheet.createDefault();
    Sheet.Set set = Sheet.createPropertiesSet();
    Event obj = getLookup().lookup(Event.class);

    try {

        Property indexProp = new PropertySupport.Reflection(obj, Integer.class, "getIndex", null);
        Property dateProp = new PropertySupport.Reflection(obj, Date.class, "getDate", null);

        indexProp.setName("index");
        dateProp.setName("date");

        set.put(indexProp);
        set.put(dateProp);

    } catch (NoSuchMethodException ex) {
        ErrorManager.getDefault();
    }

    sheet.put(set);
    return sheet;

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Press Ctrl-Shift-I to Fix Imports.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Right click the EventManager and choose Run and then, once it is started up, select Window &gt; IDE Tools &gt; Properties to show the NetBeans Platform Properties window.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
Move the selection between different nodes, and notice the property sheet updating, just as your <code>MyViewer</code> component does, as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/prop-display-1.png" alt="prop display 1">
</div>
</div>
<div class="paragraph">
<p>The above code makes use of a very convenient class: <code>PropertySupport.Reflection</code>, which may simply be passed an object, a type, and getter and setter method names, and it will create a Property object that can read (and optionally write) that property of the object in question. So you use <code>PropertySupport.Reflection</code> a simple way to wire one <code>Property</code> object up to the <code>getIndex()</code> method of <code>Event</code>.</p>
</div>
<div class="paragraph">
<p>If you want <code>Property</code> objects for nearly all of the getters/setters on an underlying model object, you may want to use or subclass <code>BeanNode</code>, which is a full implementation of <code>Node</code> that can be given a random object and will try to create all the necessary properties for it (and listen for changes) via reflection (how exactly they are presented can be controlled by creating a  <a href="https://docs.oracle.com/javase/8/docs/api/java/beans/BeanInfo.html"><code>BeanInfo</code></a> for the class of the object to be represented by the node).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Caveat:</strong> Setting the <code>name</code> of your properties is very important. Property objects test their equality based on names. If you are adding some properties to a <code>Sheet.Set</code> and they seem to be disappearing, very probably their name is not set—so putting one property in a <code>HashSet</code> with the same (empty) name as another is causing later added ones to displace earlier added ones.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_read_write_properties">Read-Write Properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To play with this concept further, what you really need is a read/write property. So the next step is to add some additional support to <code>Event</code> to make the <code>Date</code> property settable.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Open <code>org.myorg.myapi.Event</code> in the code editor.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Remove the <code>final</code> keyword from the line declaring the <code>date</code> field</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Add the following setter and property change support methods to <code>Event</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private List listeners = Collections.synchronizedList(new LinkedList());

public void addPropertyChangeListener (PropertyChangeListener pcl) {
    listeners.add (pcl);
}

public void removePropertyChangeListener (PropertyChangeListener pcl) {
    listeners.remove (pcl);
}

private void fire (String propertyName, Object old, Object nue) {
    //Passing 0 below on purpose, so you only synchronize for one atomic call:
    PropertyChangeListener[] pcls = (PropertyChangeListener[]) listeners.toArray(new PropertyChangeListener[0]);
    for (int i = 0; i &lt; pcls.length; i++) {
        pcls[i].propertyChange(new PropertyChangeEvent (this, propertyName, old, nue));
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Now, within the  <code>Event</code> , call the  <code>fire</code>  method above:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public void setDate(Date d) {
    Date oldDate = date;
    date = d;
    fire("date", oldDate, date);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>In <code>EventNode.createSheet()</code>, change the way <code>dateProp</code> is declared, so that it will be writable as well as readable:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">Property dateProp = new PropertySupport.Reflection(obj, Date.class, "date");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, rather than specifying explicit getters and setters, you are just providing the property name, and <code>PropertySupport.Reflection</code> will find the getter and setter methods for us (and in fact it will also find the <code>addPropertyChangeListener()</code> method automatically).</p>
</div>
<div class="paragraph">
<p>1.
Re-run the module Event Manager, and notice that you can now select an instance of <code>EventNode</code> in <code>MyEditor</code> and actually edit the date value, as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/prop-display-2.png" alt="prop display 2">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The result is persisted when you restart the IDE.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>However, there is still one bug in this code—when you change the Date property, you should also update the display name of your node. So you will make one more change to <code>EventNode</code> and have it listen for property changes on <code>Event</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Modify the signature of <code>EventNode</code> so that it implements <code>java.beans.PropertyChangeListener</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class EventNode extends AbstractNode *implements PropertyChangeListener* {</code></pre>
</div>
</div>
<div class="paragraph">
<p>Press Ctrl-Shift-I to Fix Imports.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Placing the caret in the signature line, accept the hint "Implement All Abstract Methods".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Add the following line to the constructor which takes an argument of <code>Event</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">obj.addPropertyChangeListener(WeakListeners.propertyChange(this, obj));</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Here you are using a utility method on <code>org.openide.util.WeakListeners</code>. This is a technique for avoiding memory leaks—an <code>Event</code> will only weakly reference its <code>EventNode</code>, so if the <code>Node&#8217;s parent is collapsed, the `Node</code> can be garbage collected. If the <code>Node</code> were still referenced in the list of listeners owned by <code>Event</code>, it would be a memory leak. In your case, the <code>Node</code> actually owns the <code>Event</code>, so this is not a terrible situation—but in real world programming, objects in a data model (such as files on disk) may be much longer-lived than <code>Node`s displayed to the user. Whenever you add a listener to an object which you never explicitly remove, it is preferable to use `WeakListeners</code>—otherwise you may create memory leaks which will be quite a headache later. If you instantiate a separate listener class, though, be sure to keep a strong reference to it from the code that attaches it—otherwise it will be garbage collected almost as soon as it is added.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Finally, implement the <code>propertyChange()</code> method:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
public void propertyChange(PropertyChangeEvent evt) {
    if ("date".equals(evt.getPropertyName())) {
        this.fireDisplayNameChange(null, getDisplayName());
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Run the module Event Manager again, select a <code>EventNode</code> in the <code>MyEditor</code> window and change its <code>Date</code> property—notice that the display name of the <code>Node</code> is now updated correctly, as shown below, where the year 2009 and is now reflected both on the node and in the property sheet:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/prop-display-3.png" alt="prop display 3">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_grouping_property_sets">Grouping Property Sets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You may have noticed when running Matisse, NetBeans IDE&#8217;s form editor, that there is a set of buttons at the top of the property sheet, for switching between groups of property sets.</p>
</div>
<div class="paragraph">
<p>Generally this is only advisable if you have a really large number of properties, and generally it&#8217;s not advisable for ease-of-use <em>to</em> have a really large number of properties. Nonetheless, if you feel you need to split out your sets of properties into groups, this is easy to accomplish.</p>
</div>
<div class="paragraph">
<p><code>Property</code> has the methods <code>getValue()</code> and <code>setValue()</code>, as does <code>PropertySet</code> (both of them inherit this from  <a href="https://docs.oracle.com/javase/8/docs/api/java/beans/FeatureDescriptor.html"><code>java.beans.FeatureDescriptor</code></a>). These methods can be used in certain cases, for passing ad-hoc "hints" between a given <code>Property</code> or <code>PropertySet</code> and the property sheet or certain kinds of property editor (for example, passing a default filechooser directory to an editor for <code>java.io.File</code>). And that is the technique by which you can specify a group name (to be displayed on a button) for one or more `PropertySet`s. In real world coding, this should be a localized string, not a hard-coded string as below:</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Open <code>EventNode</code> in the code editor</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Modify the method <code>createSheet()</code> as follows (modified and added lines are highlighted):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    @Override
    protected Sheet createSheet() {

        Sheet sheet = Sheet.createDefault();
        Sheet.Set set = Sheet.createPropertiesSet();
        *Sheet.Set set2 = Sheet.createPropertiesSet();
        set2.setDisplayName("Other");
        set2.setName("other");*
        Event obj = getLookup().lookup (Event.class);

        try {

            Property indexProp = new PropertySupport.Reflection(obj, Integer.class, "getIndex", null);
            Property dateProp = new PropertySupport.Reflection(obj, Date.class, "date");

            indexProp.setName("index");
            dateProp.setName ("date");
            set.put (indexProp);

            *set2.put (dateProp);
            set2.setValue("tabName", "Other Tab");*

        } catch (NoSuchMethodException ex) {
            ErrorManager.getDefault();
        }

        sheet.put(set);
        *sheet.put(set2);*
        return sheet;

    }</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Run the Event Manager again, and notice that there are now buttons at the top of the property sheet, and there is one property under each, as seen here:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/prop-display-4.png" alt="prop display 4">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_general_property_sheet_caveats">General Property Sheet Caveats</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you used NetBeans 3.6 or earlier, you may notice that older versions of NetBeans employed the property sheet very heavily as a core element of the UI, whereas it&#8217;s not so prevalent today. The reason is simple—<em>property sheet based UIs are not terribly user-friendly</em>. That doesn&#8217;t mean don&#8217;t use the property sheet, but use it judiciously. If you have the option of providing a customizer with a nice GUI, such as via JavaFX, do so—your users will thank you.</p>
</div>
<div class="paragraph">
<p>And if you have an enormous number of properties on one object, try to find some overall settings that encapsulate the most probable combinations of settings. For example, think of what the settings for a tool for managing imports on a Java class can be—you can provide integers for setting the threshold number of usages of a package required for wildcard imports, the threshold number of uses of a fully qualified class name required before importing it at all, and lots of other numbers ad nauseum. Or you can ask yourself the question, <em>what is the user trying to do?</em>. In this case, it&#8217;s either going to be getting rid of import statements or getting rid of fully qualified names. So probably settings of <em>low noise, medium noise</em> and <em>high noise</em> where "noise" refers to the amount of fully qualified class/package names in the edited source file would do just as well and be much easier to use. Where you can make life simpler for the user, do so.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_review_of_concepts">Review of Concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial has sought to get across the following ideas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Nodes are a presentation layer.</p>
</li>
<li>
<p>The display names of Nodes can be customized using a limited subset of HTML.</p>
</li>
<li>
<p>Nodes have icons, and you can provide custom icons for nodes you create.</p>
</li>
<li>
<p>Nodes have Actions; an Action which implements  <code>Presenter.Popup</code>  can provide its own component to display in a popup menu; the same is true for main menu items using  <code>Presenter.Menu</code> , and toolbar items using  <code>Presenter.Toolbar</code> .</p>
</li>
<li>
<p>Nodes have properties, which can be displayed on the property sheet.
<a href="http://netbeans.apache.org/community/mailing-lists.html">Send Us Your Feedback</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps">Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You&#8217;ve now begun to delve into how to get more out of the property sheet in NetBeans. In the  <a href="nbm-property-editors.html">next tutorial</a>, you will cover how to write custom editors and provide a custom inline editor for use in the property sheet.</p>
</div>
</div>
</div>
            
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="JIRA" href="https://issues.apache.org/jira/projects/NETBEANS/summary"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/80/nbm-nodesapi2.asciidoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

        </div>
        

<div class='grid-container incubator-area' style='margin-top: 64px'>
    <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/">
                <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
            </a>
        </div>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/events/current-event.html">
               <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
            </a>
        </div>
    </div>
</div>
<footer>
    <div class="grid-container">
        <div class="grid-x grid-padding-x">
            <div class="large-auto cell">
                
                <h1><a href="/about/index.html">About</a></h1>
                <ul>
                    <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
                    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                    <li><a href="https://www.apache.org/security/">Security</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/community/index.html">Community</a></h1>
                <ul>
                    <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
                    <li><a href="/community/committer.html">Becoming a committer</a></li>
                    <li><a href="/community/events.html">NetBeans Events</a></li>
                    <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/participate/index.html">Participate</a></h1>
                <ul>
                    <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
                    <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
                    <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/help/index.html">Get Help</a></h1>
                <ul>
                    <li><a href="/help/index.html#documentation">Documentation</a></li>
                    <li><a href="/wiki/index.asciidoc">Wiki</a></li>
                    <li><a href="/help/index.html#support">Community Support</a></li>
                    <li><a href="/help/commercial-support.html">Commercial Support</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/download/nb110/nb110.html">Download</a></h1>
                <ul>
                    <li><a href="/download/index.html">Releases</a></li>                    
                    <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
                    <li><a href="/download/index.html#source">Building from source</a></li>
                    <li><a href="/download/index.html#previous">Previous releases</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<div class='footer-disclaimer'>
    <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2020 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
            <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
            <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
        </div>
        
    </div>
</div>



        <script src="/js/vendor/jquery-3.2.1.min.js"></script>
        <script src="/js/vendor/what-input.js"></script>
        <script src="/js/vendor/jquery.colorbox-min.js"></script>
        <script src="/js/vendor/foundation.min.js"></script>
        <script src="/js/netbeans.js"></script>
        <script>
            
            $(function(){ $(document).foundation(); });
        </script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        <script>
         $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
        </script>
        
    </body>
</html>
