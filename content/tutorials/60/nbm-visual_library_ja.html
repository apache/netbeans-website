
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>NetBeans ビジュアルライブラリのチュートリアル</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NetBeans ビジュアルライブラリのチュートリアル - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans Platform, Platform Tutorials, NetBeans ビジュアルライブラリのチュートリアル">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">NetBeans ビジュアルライブラリのチュートリアル</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/60/nbm-visual_library_ja.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
        <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_モジュールの設定">モジュールの設定</a></li>
<li><a href="#_シーンの作成">シーンの作成</a></li>
<li><a href="#_シーン用のコンポーネントパレットの作成">シーン用のコンポーネントパレットの作成</a></li>
<li><a href="#_layerwidget_の追加">LayerWidget の追加</a></li>
<li><a href="#_ドラッグドロップ機能による_iconnodewidget_の追加">ドラッグ＆ドロップ機能による IconNodeWidget の追加</a></li>
<li><a href="#_シーンへの機能の追加">シーンへの機能の追加</a></li>
<li><a href="#_iconnodewidget_への機能の追加">IconNodeWidget への機能の追加</a></li>
<li><a href="#_次の手順">次の手順</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>このチュートリアルでは、NetBeans ビジュアルライブラリ API の主な機能の使い方について学習します。ビジュアルライブラリ API は、視覚化のための API で、たとえばモデリングやグラフ化などを行う場合に役立ちます。</p>
</div>
<div class="paragraph">
<p>トラブルシューティングのために、 <a href="http://plugins.netbeans.org/PluginPortal/faces/PluginDetailPage.jsp?pluginid=2701">完了したサンプルをダウンロード</a>してソースを調べることもできます (任意)。</p>
</div>
<div class="paragraph">
<p>また、このチュートリアルでは、3 つのアイコンを使用します。ここでそれらのアイコンを右クリックしてローカルに保存し、このチュートリアルでモジュールプロジェクトを作成したあとで、そのモジュールプロジェクトの場所にこれらのアイコンをコピーして使用してもかまいません。その 3 つのアイコンを次に示します。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vislib_image1.png" alt="vislib image1">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vislib_image2.png" alt="vislib image2">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vislib_image3.png" alt="vislib image3">
</div>
</div>
<div class="paragraph">
<p>ビジュアルライブラリ API を使用するために必要な情報は、すべて次の 2 つの場所にまとめられています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://netbeans.apache.org/graph/">ビジュアルライブラリプロジェクトページ</a></p>
</li>
<li>
<p><a href="https://netbeans.apache.org/graph/documentation.html">ビジュアルライブラリ 2.0 - ドキュメント</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>また、Javalobby の  <a href="http://www.javalobby.org/eps/netbeans_visual_library/">Roman Strobl&#8217;s Visual Library Screencast</a> も参照してください。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_モジュールの設定">モジュールの設定</h2>
<div class="sectionbody">
<div class="paragraph">
<p>この節では、ウィザードを使用して、モジュールプロジェクトおよびカスタムウィンドウコンポーネントを作成します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>「ファイル」&gt;「新規プロジェクト」を選択します。「新規プロジェクト」ウィザードで、「カテゴリ」の下にある「NetBeans モジュール」と「プロジェクト」の下にある「モジュール」を選択します。「次へ」をクリックします。「プロジェクト名」に「 <code>ShapeSample</code> 」と入力し、「プロジェクトの場所」をディスク上の適切なフォルダに設定します。「スタンドアロンモジュール」および「主プロジェクトとして設定」が選択されていない場合は、それらを選択します。「次へ」をクリックします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>「コード名ベース」に「 <code>org.netbeans.shapesample</code> 」、「モジュール表示名」に「 <code>Shape Sample</code> 」と入力します。「完了」をクリックします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>プロジェクトを右クリックして「プロパティー」を選択し、「プロジェクトプロパティー」ダイアログで「ライブラリ」をクリックして次の API との依存関係を宣言します。</p>
<div class="ulist">
<ul>
<li>
<p>ビジュアルライブラリ API</p>
</li>
<li>
<p>ユーティリティー API</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>「了解」をクリックします。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>モジュールプロジェクトを右クリックし、「新規」&gt;「ファイル/フォルダ」を選択して「NetBeans モジュールの開発」カテゴリから「ウィンドウコンポーネント」を選択します。「次へ」をクリックします。ドロップダウンリストから  <code>editor</code>  を選択し、「アプリケーションの起動時に開く」を選択します。「次へ」をクリックします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>「クラス名の接頭辞」に「 <code>Shape</code> 」と入力します。任意で 16 × 16 ピクセルのアイコンを追加します。「完了」をクリックします。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>複数のファイルが生成されます。そのうちの 1 つは  <code>ShapeTopComponent</code>  です。このファイルをデザインモードで開きます。次のような表示になります。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vislib_shapetopcomponent.png" alt="vislib shapetopcomponent">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>デザインモードの TopComponent を右クリックし、「レイアウトを設定」を選択して「BorderLayout」を選択します。</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_シーンの作成">シーンの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ビジュアルライブラリ API を使用して行うプログラミングは、Swing でのプログラミングに似ています。ウィジェットと呼ばれる可視の要素のツリーを構築、変更します。ツリーの元はシーンクラスによって表され、シーンの可視データをすべて保持します。シーンはウィジェットです。シーンのビューを作成する必要があり、それは JComponent です。そして、この JComponent を JScrollPane に追加します。</p>
</div>
<div class="paragraph">
<p>この節では、TopComponent に JScrollPane を追加します。そのあとで、新しいシーンを作成します。次に、シーンビューを TopComponent に渡し、TopComponent の JScrollPane に表示されるようにします。そうしたら、モジュールプロジェクトをインストールし、最初のシーンを表示します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>パレット (Ctrl-Shift-8) を使用して、TopComponent に  <code>JScrollPane</code>  をドロップします。インスペクタで、 <code>JScrollPane</code>  を右クリックし、「変数名を変更」を選択して「 <code>shapePane</code> 」と入力します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p><code>org.netbeans.shapesample</code>  パッケージに、 <code>GraphSceneImpl</code>  と呼ばれる Java クラスを作成します。クラスで  <code>GraphScene</code>  を拡張します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>エラーを示す赤い下線と電球が表示されます。IDE でインポート文を生成します。</p>
</div>
<div class="paragraph">
<p>エラーを示す赤い下線と電球がふたたび表示されます。IDE でクラスの抽象メソッドを生成します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>有効な識別子を追加して、必要に応じて  <code>null</code>  が返されるように設定することによって、クラスの模擬的な実装を作成します。これによって、すべてのクラスの必要条件が満たされます。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class GraphSceneImpl extends GraphScene {

    public GraphSceneImpl() {
    }

    protected Widget attachNodeWidget(Object node) {
        return null;
    }

    protected Widget attachEdgeWidget(Object edge) {
        return null;
    }

    protected void attachEdgeSourceAnchor(Object edge, Object oldSourceNode, Object newSourceNode) {

    }

    protected void attachEdgeTargetAnchor(Object edge, Object oldTargetNode, Object newTargetNode) {

    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>ここで、TopComponent のコンストラクタを使用して、 <code>GraphSceneImpl</code>  クラスのインスタンスを保持します。そのために、 <code>ShapeTopComponent</code>  クラスのコンストラクタの最後に次の内容を追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">GraphSceneImpl scene = new GraphSceneImpl();
myView = scene.createView();

shapePane.setViewportView(myView);
add(scene.createSatelliteView(), BorderLayout.WEST);</code></pre>
</div>
</div>
<div class="paragraph">
<p>ここでは 2 つのビューを作成しています。1 つ目は、グラフやモデルなどを視覚化するための大きなビューです。2 つ目はサテライトビューで、TopComponent の WEST (左側) に置いています。これによって、ユーザーはビュー間ですばやくナビゲートできるようになり、また、シーン全体の概要を確認できます。</p>
</div>
<div class="paragraph">
<p>次のように、ビューの JComponent を宣言します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private JComponent myView;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>IDE が再起動するときに、TopComponent を持続する必要はありません。実際に、この場合そうするとエラーが発生します。したがって、次に示すように PERSISTENCE_ALWAYS を PERSISTENCE_NEVER に変更します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public int getPersistenceType() {
   return TopComponent.PERSISTENCE_NEVER;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>プロジェクトノードを右クリックし、「開発中 IDE でのインストール/再読み込み」を選択します。警告のメッセージが表示された場合は、「了解」をクリックします。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>モジュールのインストール時に「ウィンドウ」メニューの下を見ると、メニュー項目のリストの一番上に、「shape」という新しいメニュー項目があります。それを選択すると、ビジュアルライブラリ API 実装が起動することがわかります。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vislib_firstscene.png" alt="vislib firstscene">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_シーン用のコンポーネントパレットの作成">シーン用のコンポーネントパレットの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ビジュアルライブラリ API を便利に使用するには、 <a href="https://bits.netbeans.org/dev/javadoc/org-netbeans-spi-palette/overview-summary.html">パレット API</a> を実装して、このチュートリアルの冒頭に示した形状を含むコンポーネントパレットにします。あとで、ビジュアルライブラリ API のドラッグ＆ドロップ機能を追加して、シーンに形状をドラッグ＆ドロップできるようにします。そのあとで、シーンに拡大/縮小機能や手のひらツール機能などを追加してシーンを充実させることができます。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>このチュートリアルは、パレット API ではなくビジュアルライブラリ API に主眼を置いているため、ここではパレット API の機能については説明していません。この題材については多くのチュートリアルがほかにあります ( <a href="https://netbeans.apache.org/kb/docs/platform.html">ここを参照</a>)。したがって、単に、 <code>org.netbeans.shapesample.palette</code>  と呼ばれる新しいパッケージに次のファイルをコピー＆ペーストします。</p>
<div class="ulist">
<ul>
<li>
<p><a href="images/vislib_Category.java">Category.java</a></p>
</li>
<li>
<p><a href="images/vislib_CategoryChildren.java">CategoryChildren.java</a></p>
</li>
<li>
<p><a href="images/vislib_CategoryNode.java">CategoryNode.java</a></p>
</li>
<li>
<p><a href="images/vislib_PaletteSupport.java">PaletteSupport.java</a></p>
</li>
<li>
<p><a href="images/vislib_Shape.java">Shape.java</a></p>
</li>
<li>
<p><a href="images/vislib_ShapeChildren.java">ShapeChildren.java</a></p>
</li>
<li>
<p><a href="images/vislib_ShapeNode.java">ShapeNode.java</a></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>このチュートリアルの「モジュールの設定」節の手順 3 で説明されているのと同じ手順で、アクション API、ノード API、および共通パレット API との依存関係を追加します。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>次に、この行を TopComponent のコンストラクタの最後に追加して、TopComponent のルックアップにパレットを追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">associateLookup( Lookups.fixed( new Object[] { PaletteSupport.createPalette() } ) );</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>IDE によって  <code>org.openide.util.lookup.Lookups</code>  および  <code>org.netbeans.shapesample.palette.PaletteSupport</code>  用のインポート文を挿入するよう求められます。要求を受け入れて、IDE にインポート文を生成させます。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>このチュートリアルの冒頭にある画像を  <code>org.netbeans.shapesample.palette</code>  に置きます。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>「プロジェクト」ウィンドウは次のようになります。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vislib_proj-window.png" alt="vislib proj window">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>モジュールをもう一度インストールします。メニュー項目から TopComponent を開くと、シーンの右に新しいコンポーネントパレットが表示されます。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vislib_firstpalette.png" alt="vislib firstpalette">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_layerwidget_の追加">LayerWidget の追加</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://netbeans.apache.org/graph/documentation.html#LayerWidget">LayerWidget</a> は、Swing の JGlassPane に似たガラス区画として表されます。これはデフォルトで透過です。したがって、先へ進む前に、シーンに LayerWidget を追加して、シーン上の任意の場所に可視ウィジェットをドラッグ＆ドロップして配置できるようにします。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>次のように、 <code>GraphSceneImpl</code>  クラスで LayerWidget を宣言します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private LayerWidget mainLayer;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p><code>GraphSceneImpl</code>  クラスのコンストラクタで、次のようにシーンの子として LayerWidget を追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">mainLayer = new LayerWidget (this);
addChild (mainLayer);</code></pre>
</div>
</div>
<div class="paragraph">
<p>これで、シーンにウィジェットとしてパレットから項目をドラッグ＆ドロップするときに、LayerWidget の子としてそれらを追加することになります。LayerWidget はデフォルトで透過であるため、LayerWidget を透過的に重ね合わせることで、たとえばシーンに背景画像を追加するなどが可能です。</p>
</div>
<div class="paragraph">
<p>詳細は、Javadoc の  <a href="https://netbeans.apache.org/graph/documentation.html#LayerWidget">LayerWidget</a> を参照してください。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ドラッグドロップ機能による_iconnodewidget_の追加">ドラッグ＆ドロップ機能による IconNodeWidget の追加</h2>
<div class="sectionbody">
<div class="paragraph">
<p>前に、TopComponent の JScrollPane にシーンを渡すために  <code>GraphSceneImpl</code>  クラスのコンストラクタを使用しました。今のところ、シーンは存在しますが動作は何もありません。動作は、アクションを通じて追加されます。この節で確認するアクションは、 <code> <a href="https://netbeans.apache.org/graph/documentation.html#AcceptAction">AcceptAction</a></code>  と呼ばれます。このアクションによってドラッグ＆ドロップ機能が可能になります。ドラッグ＆ドロップ機能はウィジェットにも適用できますが、ここではシーンそのものに適用します。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>``createAcceptAction``  を使用して、パレットからシーンに項目をドラッグしたときの動作を指定します。ここでは、2 つのメソッドが必要になります。1 つめは  ``isAcceptable()``  で、項目をシーンに配置できるかどうかを決定します。ここで transferrable を使用して項目をテストできます。ドラッグの画像を設定することもできます。これは、あとに示す実装で実行します。 ``true``  が返された場合は、 ``accept``  メソッドが呼び出されます。前と同じヘルパーメソッドを使用して、transferrable から画像を取得します。それから  ``addNode``  メソッドを呼び出して、新しい  link:https://netbeans.apache.org/graph/documentation.html#IconNodeWidget[IconNodeWidget] をインスタンス化し、transferable から取得した画像を渡します。</pre>
</div>
</div>
<div class="paragraph">
<p>このセクションのコードはすべて相互に関係があります。そのため、このあとのメソッドをすべて追加し終えるまでは、エラーを示す赤い下線が表示されますが、とにかく論理的な順序ですべてを追加していきます。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>まず、 <code>createAcceptAction</code>  を、その 2 つのメソッドとともに  <code>GraphSceneImpl</code>  クラスのコンストラクタに追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">getActions().addAction(ActionFactory.createAcceptAction(new AcceptProvider() {

    public ConnectorState isAcceptable(Widget widget, Point point, Transferable transferable) {
        Image dragImage = getImageFromTransferable(transferable);
        JComponent view = getView();
        Graphics2D g2 = (Graphics2D) view.getGraphics();
        Rectangle visRect = view.getVisibleRect();
        view.paintImmediately(visRect.x, visRect.y, visRect.width, visRect.height);
        g2.drawImage(dragImage,
                AffineTransform.getTranslateInstance(point.getLocation().getX(),
                point.getLocation().getY()),
                null);
        return ConnectorState.ACCEPT;
    }

    public void accept(Widget widget, Point point, Transferable transferable) {
        Image image = getImageFromTransferable(transferable);
        Widget w = GraphSceneImpl.this.addNode(new MyNode(image));
        w.setPreferredLocation(widget.convertLocalToScene(point));
    }

}));</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
先のコードを追加したあとは、赤い下線の一部はまだ残っています。これらはエラーを示しています。これらのエラーは、このコードが、まだ作成していないメソッドおよびクラスを参照しているために発生します。それらは次の手順で作成します。
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>次に、 <code>GraphSceneImpl</code>  クラスで、transferable から画像を取得するために、次に示すヘルパーメソッドを追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private Image getImageFromTransferable(Transferable transferable) {
    Object o = null;
    try {
        o = transferable.getTransferData(DataFlavor.imageFlavor);
    } catch (IOException ex) {
        ex.printStackTrace();
    } catch (UnsupportedFlavorException ex) {
        ex.printStackTrace();
    }
    return o instanceof Image ? (Image) o : Utilities.loadImage("org/netbeans/shapesample/palette/shape1.png");
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>このヘルパーメソッドから画像が正常に返されない場合は、画像の種類を定義できます。ここでは、代わりに画像  <code>shape1.png</code>  を使用します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p><code>MyNode</code>  という名前の新しいクラスを作成します。このクラスは、グラフ指向のモデルにあるノードを表します。各ノードはモデル内で一意 (「equals」メソッドでチェックされる) でなければならないため、これは直接の画像ではありません。画像を直接使用する場合は、シーンに 3 つのノード (1 つの画像ごとに 1 つ) しか持つことができません。MyNode クラスを使用すると、複数のノードを持つことが可能になり、各ノードは画像のインスタンスを占有または共有できます。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class MyNode {

    private Image image;

    public MyNode(Image image) {
        this.image = image;
    }

    public Image getImage() {
        return image;
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p><code>GraphSceneImpl</code>  クラスの署名を次のように変更し、ビジュアルライブラリの実装クラスがノードを受け取るようにします。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">extends GraphScene&lt;MyNode, String&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>IDE に抽象クラス用の新しいスタブを生成させてください。</p>
</div>
<div class="paragraph">
<p>また、ここでは総称を使用しているため、IDE が JDK 1.5 を使用するようにします。1.6 を使用しているかどうかわからないときは、プロジェクトを右クリックして「プロパティー」を選択し、「ソース」ページに移動します。「ソースレベル」ドロップダウンで 1.5 に変更します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>最後に、 <code>GraphSceneImpl</code>  クラスの新しいウィジェットを定義します。このメソッドは、 <code>accept</code>  メソッドによって自動的に呼び出されます。パレットの項目がドロップされたときにビジュアルライブラリウィジェットを定義するために使用します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">protected Widget attachNodeWidget(MyNode node) {
    IconNodeWidget widget = new IconNodeWidget(this);
    widget.setImage(node.getImage());
    widget.setLabel(Long.toString(node.hashCode()));
    widget.getActions().addAction(ActionFactory.createMoveAction());
    mainLayer.addChild(widget);
    return widget;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>画像をノードから取得するように設定しています。また、ラベル用の乱数も生成するようにしています。デフォルトでは、ウィジェットは存在しますが動作は何もありません。ここで、移動アクションを作成し、シーンでウィジェットを移動できるようにしています。最後に、シーンにウィジェットを返す前に、前の節で作成した LayerWidget に、それを子として追加しています。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>モジュールを再読み込みして「shape」ウィンドウをふたたび開きます。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>これで、パレットの項目をドラッグ＆ドロップできるようになりました。シーンに項目をドラッグすると、ドラッグ画像を確認できます。項目をドロップするときに、それはウィジェットとなり、サテライトビュー内と同じようにシーン内に次のように表示されます。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vislib_finishedscene.png" alt="vislib finishedscene">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_シーンへの機能の追加">シーンへの機能の追加</h2>
<div class="sectionbody">
<div class="paragraph">
<p>前の節では、シーンに  <code> <a href="https://netbeans.apache.org/graph/documentation.html#AcceptAction">AcceptAction</a></code>  を追加しました。その項目をドロップするかどうかを指定し、その項目を変換するために 2 つのメソッドを定義しなければなりませんでした。この節では、 <code> <a href="https://netbeans.apache.org/graph/documentation.html#ZoomAction">ZoomAction</a></code>  を使用して、シーンに拡大/縮小機能を追加します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p><code>GraphSceneImpl</code>  クラスのコンストラクタの最後に次の行を追加します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">getActions().addAction(ActionFactory.createZoomAction());</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>モジュールをもう一度インストールします。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>CTRL キーを押しながら、マウスのホイールを使用してシーンを拡大、縮小します。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vislib_zoom.png" alt="vislib zoom">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vislib_unzoom.png" alt="vislib unzoom">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
形状は画像として描画されます。現在のところ SVG はサポートされていません。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>前述の説明と同じように、次の行を使用して、シーンに手のひらツールの機能を追加できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">getActions().addAction(ActionFactory.createPanAction());</code></pre>
</div>
</div>
<div class="paragraph">
<p>この行を追加すると、ユーザーはマウスホイールを押してシーン内のどの方向にもスクロールできるようになります。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_iconnodewidget_への機能の追加">IconNodeWidget への機能の追加</h2>
<div class="sectionbody">
<div class="paragraph">
<p>前に IconNodeWidget に  <code> <a href="https://netbeans.apache.org/graph/documentation.html#MoveAction">MoveAction</a></code>  を追加し、ウィジェットの移動動作を使用可能にしました。これと同じ方法で、ほかの多くの動作をウィジェットに追加できます。この節では、 <code> <a href="https://netbeans.apache.org/graph/documentation.html#HoverAction">HoverAction</a></code> 、 <code> <a href="https://netbeans.apache.org/graph/documentation.html#SelectAction">SelectAction</a></code> 、および  <code> <a href="https://netbeans.apache.org/graph/documentation.html#InplaceEditorAction">InplaceEditorAction</a></code>  を追加します。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>``InplaceEditorAction``  は、ユーザーがラベルを変更できるようにします。</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vislib_editable.png" alt="vislib editable">
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>``SelectAction``  はウィジェットが選択されたときに、 ``HoverAction``  はウィジェット上にマウスを置いているときに、ラベルの色を変更します。</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vislib_selectable-hoverable.png" alt="vislib selectable hoverable">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>まず、次のように IconNodeWidget に追加するエディタアクションを定義します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private WidgetAction editorAction = ActionFactory.createInplaceEditorAction(new LabelTextFieldEditor());</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>ここで、次のように  <code>LabelTextFieldEditor</code>  を定義します。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private class LabelTextFieldEditor implements TextFieldInplaceEditor {

    public boolean isEnabled(Widget widget) {
        return true;
    }

    public String getText(Widget widget) {
        return ((LabelWidget) widget).getLabel();
    }

    public void setText(Widget widget, String text) {
        ((LabelWidget) widget).setLabel(text);
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>最後に、IconNodeWidget にエディタアクションを割り当てます。方法は、前に行なった移動アクションと同じです。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">widget.getLabelWidget().getActions().addAction(editorAction);</code></pre>
</div>
</div>
<div class="paragraph">
<p>これで、まず IconNodeWidget の LabelWidget を取得します。それから LabelWidget にエディタアクションを追加します。</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>IDE によっていくつかのインポート文を追加するよう求められます。それぞれについて、IDE の提案を受け入れます。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>次に、 <code>SelectAction</code>  および  <code>HoverAction</code>  の場合、次に示すように、IconNodeWidget にこれらのアクションを割り当てるだけです。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">widget.getActions().addAction(createSelectAction());
widget.getActions().addAction(createObjectHoverAction());</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>次に、作成したアクションの順序について検討する必要があります。詳細は、ドキュメントの <a href="https://netbeans.apache.org/graph/documentation.html#OrderOfActions">アクションの順序</a>の節を参照してください。アクションの順序を変更すると、 <code>attachNodeWidget</code>  は次のようになります。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">protected Widget attachNodeWidget(MyNode node) {
    IconNodeWidget widget = new IconNodeWidget(this);
    widget.setImage(node.getImage());
    widget.setLabel(Long.toString(node.hashCode()));

    //ダブルクリック、ダブルクリック時にのみイベントが使用される:
    widget.getLabelWidget().getActions().addAction(editorAction);

    //シングルクリック、イベントは使用されない:
    widget.getActions().addAction(createSelectAction());

    //マウスをドラッグ、マウスのドラッグ時にイベントが使用される:
    widget.getActions().addAction(ActionFactory.createMoveAction());

    //マウスを置く、マウスをウィジェットに置くときにイベントが使用される:
    widget.getActions().addAction(createObjectHoverAction());

    mainLayer.addChild(widget);
    return widget;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>モジュールをふたたびインストールして実際に使用してみます。この節の最初に説明したように、ウィジェットのラベルにマウスを置いたときや選択したときに、その色が変わります。また、ラベルをクリックするとその内容を編集できます。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>これで NetBeans 6.0 のビジュアルライブラリ 2.0 のチュートリアルは終了です。</p>
</div>
<div class="paragraph">
<p><a href="http://netbeans.apache.org/community/mailing-lists.html">ご意見をお寄せください</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_次の手順">次の手順</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ビジュアルライブラリ API の使用方法の詳細については、次のドキュメントを参照してください。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Javalobby の  <a href="http://www.javalobby.org/eps/netbeans_visual_library/">Roman Strobl&#8217;s Visual Library Screencast</a></p>
</li>
<li>
<p><a href="https://netbeans.apache.org/graph/">ビジュアルライブラリプロジェクトページ</a></p>
</li>
<li>
<p><a href="https://netbeans.apache.org/graph/documentation.html">ビジュアルライブラリ 2.0 - ドキュメント</a></p>
</li>
</ul>
</div>
</div>
</div>
        
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/60/nbm-visual_library_ja.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
