
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Руководство по разработке приложений для рисования на платформе NetBeans</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Руководство по разработке приложений для рисования на платформе NetBeans - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans Platform, Platform Tutorials, Руководство по разработке приложений для рисования на платформе NetBeans">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>

  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 19</h1>
            <p><a class="button success" href="/download/nb19/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">Руководство по разработке приложений для рисования на платформе NetBeans</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/60/nbm-paintapp_ru.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
        <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_введение_в_разработку_приложения_для_рисования">Введение в разработку приложения для рисования</a></li>
<li><a href="#_создание_приложения_для_рисования">Создание приложения для рисования</a>
<ul class="sectlevel2">
<li><a href="#_создание_пакета_модулей">Создание пакета модулей</a></li>
<li><a href="#_создание_проекта_модуля_обертки_библиотеки">Создание проекта модуля-обертки библиотеки</a></li>
<li><a href="#_создание_проекта_модуля">Создание проекта модуля</a></li>
<li><a href="#_определение_зависимостей_проекта_модуля">Определение зависимостей проекта модуля</a></li>
</ul>
</li>
<li><a href="#_создание_и_внедрение_элемента_paint_canvas">Создание и внедрение элемента "Paint Canvas"</a>
<ul class="sectlevel2">
<li><a href="#_создание_элемента_canvas">Создание элемента "Canvas"</a></li>
<li><a href="#_подготовка_класса_topcomponent">Подготовка класса "TopComponent"</a></li>
<li><a href="#_инициализация_класса_topcomponent">Инициализация класса "TopComponent"</a></li>
<li><a href="#_заполнение_кодом_скелетных_методов">Заполнение кодом скелетных методов</a></li>
<li><a href="#_функция_сохранения_изображения_на_диске">Функция сохранения изображения на диске</a></li>
</ul>
</li>
<li><a href="#_создание_пункта_меню_для_создания_нового_холста_new_canvas">Создание пункта меню для создания нового холста "New Canvas"</a></li>
<li><a href="#_создание_пункта_меню_для_сохранения_холста_save_canvas">Создание пункта меню для сохранения холста "Save Canvas"</a></li>
<li><a href="#_заключительная_подготовка">Заключительная подготовка</a></li>
<li><a href="#_создание_дистрибутива">Создание дистрибутива</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>В этом руководстве представлены базовые аспекты разработки функционально насыщенных клиентских приложений на платформе NetBeans. Разработка приложений на платформе NetBeans подразумевает использование при разработке возможностей ядра среды IDE NetBeans. Все модули среды IDE, которые не требуются для разрабатываемого приложения, будут исключены, тогда как необходимые модули будут использоваться. Использование уже готовых компонентов ядра среды IDE экономит значительное количество времени и сил.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_введение_в_разработку_приложения_для_рисования">Введение в разработку приложения для рисования</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Целью этого руководства является быстрая подготовка читателя к практической работе. Необходимо будет создать и установить простое приложение на платформе NetBeans. Это приложение позволит пользователю рисовать на экране и сохранять результаты:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_result-without-menus-60.png" alt="paintapp result without menus 60">
</div>
</div>
<div class="paragraph">
<p>Такая начальная версия далека от полнофункционального приложения для рисования, но, тем не менее, она иллюстрирует самый простой вариант создания приложения на базе платформы NetBeans.</p>
</div>
<div class="paragraph">
<p>*Примечание: Если необходимо получить дополнительные сведения о модулях NetBeans, а не о функционально насыщенных клиентских приложениях, рекомендуется обратиться к руководству *  <a href="nbm-google_ru.html">Быстрое начало работы с подключаемыми модулями в среде NetBeans</a>.</p>
</div>
<div class="paragraph">
<p>В настоящем руководстве создается приложение на основе шаблона, поставляемого со средой IDE. Для просмотра готового приложения или разрешения проблем, возникающих при работе с этим руководством, в окне мастера создания проекта можно открыть шаблон по пути, указанному ниже:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_sample-in-new-project-60.png" alt="paintapp sample in new project 60">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_создание_приложения_для_рисования">Создание приложения для рисования</h2>
<div class="sectionbody">
<div class="paragraph">
<p>В этом разделе необходимо будет создать структуру будущего приложения. Для начала потребуется создать проект пакета модулей, представляющий собой приложение. Приложение зависит от библиотеки, поэтому необходимо будет создать проект для модуля-обертки библиотеки, содержащего соответствующий файл JAR. В завершение будет создан проект модуля, содержащий код.</p>
</div>
<div class="sect2">
<h3 id="_создание_пакета_модулей">Создание пакета модулей</h3>
<div class="paragraph">
<p>Пакет модулей является эквивалентом приложения и представляет собой ряд модулей, используемых совместно в целях достижения определенных результатов. Кроме того, он позволяет назначать собственный экран заставки (стиль), имя приложения, а также тип и количество необходимых модулей NetBeans. Можно также воспользоваться такими возможностями, как создание дистрибутива в формате ZIP и построение приложения на базе Java WebStart (JNLP), являющимися важными средствами распространения приложения среди других пользователей.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Выберите <span class="menuseq"><b class="menu">File</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">New Project</b></span>. В области "Categories" выберите "NetBeans Modules". В области "Projects" выберите "Module Suite Project" и нажмите кнопку "Next".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>На экране "Name and Location" введите  <code>PaintApp</code>  в поле "Project Name". В поле "Project Location" укажите любой каталог на компьютере. Не снимайте флажок "Set as Main Project":</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_newmodulesuite-60.png" alt="paintapp newmodulesuite 60">
</div>
</div>
<div class="paragraph">
<p>Нажмите кнопку "Finish".</p>
</div>
<div class="paragraph">
<p>В среде IDE откроется новый проект пакета модулей. Он содержит один узел в окне "Project". Этот узел "Modules" предназначен для добавления проектов модуля и проектов для модуля-обертки библиотеки к проекту пакета модулей вручную. При помощи мастера создания проектов модулей или мастера создания модулей-оберток библиотек созданный модуль может быть автоматически добавлен к проекту пакета модулей.</p>
</div>
</div>
<div class="sect2">
<h3 id="_создание_проекта_модуля_обертки_библиотеки">Создание проекта модуля-обертки библиотеки</h3>
<div class="paragraph">
<p>Модуль-обертка библиотеки – это модуль, файл JAR которого содержит не код, а только указатель на библиотеку. Благодаря этому библиотека становится модулем NetBeans; поэтому к ней применяются все защитные функции системы загрузчика классов NetBeans без изменения первоначального файла JAR. В дальнейшем создаваемое приложение зависит от библиотеки так же, как если бы библиотека была обычным модулем NetBeans. При появлении новых версий библиотеки в дистрибутиве изменяется только единственный файл модуля NetBeans (NBM) для библиотеки оберток.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
К преимуществам построения приложений на платформе NetBeans относится интерфейс пользователя на базе стандартного инструментария для разработки интерфейса пользователя для Java – Swing. Так как Swing используется в течение долгого времени, существует множество компонентов, которые можно использовать в создаваемом приложении. В этом руководстве применяется существующий компонент JavaBean для выбора цветов (исходный код приведен в CVS NetBeans, в области  <code>contrib/coloreditor</code> ). Имя файла JAR –  <code>ColorChooser.jar</code> . Библиотеку можно загрузить  <a href="http://web.archive.org/web/20081119053233/http://colorchooser.dev.java.net/">здесь</a>. Сохраните ее в любом месте файловой системы. Для создания модуля-обертки библиотеки для файла  <code>ColorChooser.jar</code>  выполните следующие действия:
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Выберите <span class="menuseq"><b class="menu">File</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">New Project</b></span>. В области "Categories" выберите "NetBeans Modules". В области "Projects" выберите "Library Wrapper Module Project" и нажмите кнопку "Next".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>На экране "Name and Location" в текстовом поле "Library" либо укажите путь к  <code>ColorChooser.jar</code> , либо перейдите к этому файлу путем поиска.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Текстовое поле "License" оставьте пустым. Если предполагается создание дистрибутива готового продукта, необходимо включить лицензионный файл внешней библиотеки.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Нажмите кнопку "Next", после чего на экране должно появиться следующее:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_newmodulesuite-library-60.png" alt="paintapp newmodulesuite library 60">
</div>
</div>
<div class="paragraph">
<p>Снова нажмите кнопку "Next", а затем кнопку "Finish".</p>
</div>
</div>
<div class="sect2">
<h3 id="_создание_проекта_модуля">Создание проекта модуля</h3>
<div class="paragraph">
<p>Теперь необходимо создать модуль для будущего фактического кода.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Выберите <span class="menuseq"><b class="menu">File</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">New Project</b></span>. В области "Categories" выберите "NetBeans Modules". В области "Projects" выберите "Module Project" и нажмите кнопку "Next".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>На экране "Name and Location" введите  <code>Paint</code>  в поле "Project Name". В поле "Project Location" укажите любой каталог на компьютере. Убедитесь, что выбран переключатель "Add to Module Suite", а в раскрывающемся списке "Module Suite" выбран пакет модулей  <code>PaintApp</code> . Установите флажок "Set as Main Project". Нажмите кнопку "Next".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>На экране "Basic Module Configuration" замените  <code>yourorghere</code>  в поле "Code Name Base" на  <code>netbeans</code> , чтобы получилось имя  <code>org.netbeans.paint</code> . В поле "Module Display Name" оставьте имя  <code>Paint</code> . Не изменяйте местоположение пакета локализации и файла layer.xml для их сохранения в пакете с именем  <code>org.netbeans.paint</code> . Эти файлы предназначены для следующего:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Пакет локализации.</strong> Указывает строки на конкретном языке в целях интернационализации.</p>
</li>
<li>
<p><strong>Файл "layer.xml".</strong> Регистрирует элементы, такие как меню и кнопки панели инструментов, в системе NetBeans.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Нажмите кнопку "Finish".</p>
</div>
<div class="paragraph">
<p>Средой IDE будет создан проект  <code>Paint</code> . Проект содержит все исходные файлы и метаданные проекта, например, сценарий сборки Ant. Проект открывается в среде IDE. Логическую структуру проекта можно просмотреть в окне "Projects" (Ctrl-1), а структуру файлов – в окне "Files" (Ctrl-2). Например, окно "Projects" теперь должно выглядеть следующим образом:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_initial-proj-window60.png" alt="paintapp initial proj window60">
</div>
</div>
<div class="paragraph">
<p>Кроме пакета локализации и файла layer.xml, проект также содержит следующие важные файлы:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Манифест модуля.</strong> Объявляет проект модулем. Кроме того, он определяет некоторые характерные для модуля параметры настройки, например, местоположение файла layer.xml, местоположение пакета локализации и версию модуля.</p>
</li>
<li>
<p><strong>Сценарий сборки.</strong> Предусматривает пространство для создания собственных параметров Ant и переопределения параметров, указанных в  <code>nbproject/build-impl.xml</code> .</p>
</li>
<li>
<p><strong>Метаданные проекта.</strong> Содержит такую информацию, как тип проекта, содержимое, платформа, путь к классам, зависимости и связи между командами проекта и параметрами в сценариях Ant.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>В этом руководстве изменять эти файлы не придется.</p>
</div>
</div>
<div class="sect2">
<h3 id="_определение_зависимостей_проекта_модуля">Определение зависимостей проекта модуля</h3>
<div class="paragraph">
<p>Необходимо будет создать подклассы для нескольких классов, принадлежащих  <a href="https://bits.netbeans.org/dev/javadoc/"> интерфейсам API NetBeans</a>. Кроме того, проект должен зависеть от файла  <code>ColorChooser.jar</code> . Все интерфейсы API NetBeans реализованы модулями, поэтому выполнение обеих задач подразумевает лишь добавление в список модулей некоторых необходимых для выполнения модулей.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>В окне "Projects" щелкните правой кнопкой мыши узел проекта  <code>Paint</code>  и выберите "Properties". Откроется диалоговое окно "Project Properties". В области "Categories" выберите "Libraries".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Для каждого указанного в приведенной ниже таблице интерфейса API выберите "Add Dependency&#8230;&#8203;", а затем в текстовом поле "Filter" начинайте вводить имя класса, для которого требуется подкласс.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Класс</strong></th>
<th class="tableblock halign-left valign-top"><strong>Интерфейс API</strong></th>
<th class="tableblock halign-left valign-top"><strong>Цель</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ColorChooser</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ColorChooser</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Модуль-обертка библиотеки для созданного элемента выбора цветов</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DataObject</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Datasystems API</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Модуль NetBeans, содержащий класс "DataObject"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DialogDisplayer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Dialogs API</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Позволяет создавать уведомления пользователя, описания диалогового окна и разрешает выводить их на экран.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AbstractFile</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>File System API</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Позволяет общему интерфейсу API обращаться к файлам единообразным способом.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AbstractNode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Nodes API</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Основное средство визуализации объектов в NetBeans.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>StatusDisplayer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>UI Utilities API</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Класс "StatusDisplayer" используется для создания строки состояния в главном окне.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WeakListeners</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Utilities API</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Этот класс содержит класс "WeakListeners".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TopComponent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Window System API</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Этот класс содержит класс "TopComponent JPanel".</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>В вышеприведенной таблице в первом столбце перечислены все классы, которым в этом руководстве потребуются подклассы. В каждом из этих случаев начинайте вводить имя класса в поле "Filter" и просматривайте сужающийся список в поле "Module". Второй столбец таблицы следует использовать для выбора подходящего интерфейса API (или, в случае  <code>ColorChooser</code> , библиотеки) из сокращенного списка "Module"; для подтверждения выбора нажмите кнопку "OK":</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_libfilter-60.png" alt="paintapp libfilter 60">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Нажмите кнопку "OK" для закрытия диалогового окна "Project Properties".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Если в окне "Projects" не развернут узел проекта модуля "Paint", разверните его. Затем разверните узел "Important Files" и дважды щелкните узел "Project Metadata". Обратите внимание, что выбранные интерфейсы API были объявлены как зависимости модулей.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_создание_и_внедрение_элемента_paint_canvas">Создание и внедрение элемента "Paint Canvas"</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_создание_элемента_canvas">Создание элемента "Canvas"</h3>
<div class="paragraph">
<p>Следующим действием будет создание фактического элемента, на котором пользователь сможет рисовать. В этом случае необходимо использовать только элемент Swing, поэтому будут рассмотрены не подробности его реализации, а лишь окончательная версия. Для этой панели в исходном коде используется элемент выбора цветов, для которого был создан модуль-обертка библиотеки. При запуске готового приложения он отобразится на панели инструментов редактирования изображений.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>В окне "Projects" разверните узел  <code>Paint</code> , затем узел "Source Packages", после этого щелкните правой кнопкой мыши узел  <code>org.netbeans.paint</code> . Выберите <span class="menuseq"><b class="menu">Choose New</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Java Class</b></span>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>В поле "Class Name" введите имя класса  <code>PaintCanvas</code> . Убедитесь, что файл  <code>org.netbeans.paint</code>  определен как "Package". Нажмите кнопку "Finish". В редакторе исходного кода откроется файл  <code>PaintCanvas.java</code> .</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Замените стандартное содержимое файла содержимым, которое можно найти  <a href="https://netbeans.apache.org/platform/guide/tutorials/paintTutorial/PaintCanvas.java">здесь</a>. Если пакет имеет имя, отличное от  <code>org.netbeans.paint</code> , исправьте имя пакета в редакторе исходного кода.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_подготовка_класса_topcomponent">Подготовка класса "TopComponent"</h3>
<div class="paragraph">
<p>Теперь необходимо будет написать первый класс для  <a href="https://bits.netbeans.org/dev/javadoc/"> интерфейсов API среды NetBeans</a>. Это класс  <code> <a href="https://bits.netbeans.org/dev/javadocorg-openide-windows/org/openide/windows/TopComponent.html">TopComponent</a></code> . Класс  <code>TopComponent</code>  – это класс  <code>JPanel</code> , для которого у системы управления окнами NetBeans имеются методы взаимодействия, поэтому его можно будет разместить внутри контейнера с вкладками в главном окне.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>В окне "Projects" разверните узел  <code>Paint</code> , затем узел "Source Packages", после этого щелкните правой кнопкой мыши узел  <code>org.netbeans.paint</code> . Выберите <span class="menuseq"><b class="menu">Choose New</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Java Class</b></span>.
Введите имя класса <code>PaintTopComponent</code> в поле "Class Name". Убедитесь, что файл <code>org.netbeans.paint</code> определен как "Package". Нажмите кнопку "Finish". В редакторе исходного кода откроется файл <code>PaintTopComponent.java</code> .</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>В верхней части файла измените объявление класса на следующее:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    public class PaintTopComponent extends TopComponent implements ActionListener, ChangeListener {</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Нажмите Ctrl-Shift-I для исправления операторов импорта и кнопку в диалоговом окне кнопку "OK". Среда IDE произведет необходимые объявления пакета импорта в верхней части файла.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Обратите внимание на красную линию под введенным объявлением класса. Установите курсор в строке и обратите внимание на лампочку, появившуюся в левом поле. Щелкните изображение лампочки (или нажмите Alt-Enter), как показано ниже:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_lightbulb-60.png" alt="paintapp lightbulb 60">
</div>
</div>
<div class="paragraph">
<p>Выберите "Implement all abstract methods". Среда IDE создаст два скелетных метода:  <code>actionPerformed()</code>  и  <code>stateChanged()</code> . Немного позднее их необходимо будет заполнить кодом.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Над классом  <code>PaintTopComponent</code>  добавьте следующие три объявления переменных, а затем исправьте операторы импорта (Ctrl-Shift-I).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    private PaintCanvas canvas = new PaintCanvas(); //Элемент, предназначенный для рисования
    private JComponent preview; //Элемент на панели инструментов, обозначающий размер кисти
    private static int ct = 0; //Счетчик, который дает имена новым изображениям</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Теперь необходимо реализовать два шаблонных метода. Первый сообщает системе управления окнами о необходимости игнорирования открытых окон, если приложение закрыто; второй предоставляет основную строку для уникального идентификатора строки создаваемого элемента. Каждый элемент  <code>TopComponent</code>  имеет уникальный идентификатор строки, который используется при сохранении  <code>TopComponent</code> . Вставьте два следующих метода в класс  <code>PaintTopComponent</code> :</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    public int getPersistenceType() {
        return PERSISTENCE_NEVER;
    }

    public String preferredID() {
        return "Image";
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>После этого класс должен выглядеть следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class PaintTopComponent extends TopComponent implements ActionListener, ChangeListener {

    private PaintCanvas canvas = new PaintCanvas(); //Элемент, предназначенный для рисования
    private JComponent preview; //Элемент на панели инструментов, обозначающий размер кисти
    private static int ct = 0; //Счетчик, который дает имена новым изображениям

    public PaintTopComponent() {
    }

    public void actionPerformed(ActionEvent arg0) {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    public void stateChanged(ChangeEvent arg0) {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    public int getPersistenceType() {
        return PERSISTENCE_NEVER;
    }

    public String preferredID() {
        return "Image";
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_инициализация_класса_topcomponent">Инициализация класса "TopComponent"</h3>
<div class="paragraph">
<p>В этом разделе будет добавлен код, инициализирующий интерфейс пользователя.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Заполните конструктор, созданный средой IDE рядом с верхней частью класса, а затем исправьте операторы импорта (Ctrl-Shift-I):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    public PaintTopComponent() {

        initComponents();

        String displayName = NbBundle.getMessage(
                PaintTopComponent.class,
                "UnsavedImageNameFormat",
                new Object[] { new Integer(ct++) }
        );

        setDisplayName(displayName);

    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Код в этом случае довольно прост. Первым вызывается еще не написанный метод  <code>initComponents()</code> , который добавит панель инструментов и элемент "PaintCanvas" к элементу  <code>TopComponent</code> . Так как этот метод еще не написан, он подчеркивается красной линией. Как и в предыдущем случае, щелкните изображение лампочки (или нажмите Alt-Enter) и примите предложение:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_lightbulb-initcomponents-60.png" alt="paintapp lightbulb initcomponents 60">
</div>
</div>
<div class="paragraph">
<p>Будет создан скелетный код метода  <code>initComponents()</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Разверните пакет  <code>org.netbeans.paint</code>  в окне "Projects". Дважды щелкните файл  <code>Bundle.properties</code>  для его открытия в редакторе исходного кода. В конец добавьте следующую строку:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    UnsavedImageNameFormat=Image {0}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Она отвечает за текст, который будет использоваться для идентификации нового файла изображения перед его сохранением пользователем. Например, когда пользователь в первый раз выбирает "New Canvas" в готовом приложении, над редактором исходного кода появится вкладка с текстом "Image 0". Перед продолжением не забудьте сохранить файл.</p>
</div>
</div>
<div class="sect2">
<h3 id="_заполнение_кодом_скелетных_методов">Заполнение кодом скелетных методов</h3>
<div class="paragraph">
<p>В этом разделе будет написан код интерфейса пользователя для создаваемого приложения. Для визуальной разработки формата можно также использовать GUI Builder среды IDE.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Метод  <code>initComponents()</code>  устанавливает в панели элементы, благодаря которым пользователь получает возможность взаимодействия с приложением. Его скелетный код был создан в предыдущем разделе в классе  <code>PaintTopComponent.java</code> . Заполните его следующим образом:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    private void initComponents() {

        setLayout(new BorderLayout());
        JToolBar bar = new JToolBar();

        ColorChooser fg = new ColorChooser();
        preview = canvas.createBrushSizeView();

        //Теперь сформируйте панель инструментов:

        //Обеспечьте правильное размещение элементов:
        Dimension min = new Dimension(32, 32);
        preview.setMaximumSize(min);
        fg.setPreferredSize(new Dimension(16, 16));
        fg.setMinimumSize(min);
        fg.setMaximumSize(min);

        JButton clear = new JButton(
          	    NbBundle.getMessage(PaintTopComponent.class, "LBL_Clear"));

        JLabel fore = new JLabel(
         	    NbBundle.getMessage(PaintTopComponent.class, "LBL_Foreground"));

        fg.addActionListener(this);
        clear.addActionListener(this);

        JSlider js = new JSlider();
        js.setMinimum(1);
        js.setMaximum(24);
        js.setValue(canvas.getDiam());
        js.addChangeListener(this);

        fg.setColor(canvas.getColor());

        bar.add(clear);
        bar.add(fore);
        bar.add(fg);
        JLabel bsize = new JLabel(
     	    NbBundle.getMessage(PaintTopComponent.class, "LBL_BrushSize"));

        bar.add(bsize);
        bar.add(js);
        bar.add(preview);

        JLabel spacer = new JLabel("   "); //Выровняйте разделитель так, чтобы кисть в предварительном просмотре не была растянута до конца панели инструментов:

        spacer.setPreferredSize(new Dimension(400, 24));
        bar.add(spacer);

        //Установите панель инструментов и элемент для рисования:
        add(bar, BorderLayout.NORTH);
        add(canvas, BorderLayout.CENTER);

    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Нажмите Ctrl-Shift-I для автоматического создания необходимых операторов импорта.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Заполните два других созданных метода. Они используются для прослушивания класса  <code>PaintTopComponent</code> :</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    public void actionPerformed(ActionEvent e) {

        if (e.getSource() instanceof JButton) {
           canvas.clear();
        } else if (e.getSource() instanceof ColorChooser) {
           ColorChooser cc = (ColorChooser) e.getSource();
           canvas.setPaint (cc.getColor());
        }

        preview.paintImmediately(0, 0, preview.getWidth(), preview.getHeight());

    }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    public void stateChanged(ChangeEvent e) {

        JSlider js = (JSlider) e.getSource();
        canvas.setDiam (js.getValue());
        preview.paintImmediately(0, 0, preview.getWidth(), preview.getHeight());

    }</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>В конец файла  <code>Bundle.properties</code>  добавьте следующие пары "ключ-значение":</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    LBL_Clear = Clear
    LBL_Foreground = Foreground
    LBL_BrushSize = Brush Size</code></pre>
</div>
</div>
<div class="paragraph">
<p>Перед продолжением не забудьте сохранить файл.</p>
</div>
</div>
<div class="sect2">
<h3 id="_функция_сохранения_изображения_на_диске">Функция сохранения изображения на диске</h3>
<div class="paragraph">
<p>В новом приложении необходимо реализовать возможность сохранения созданных изображений пользователем. Эта функциональная возможность активируется включением следующего кода в класс  <code>PaintTopComponent</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Вставьте следующий код в класс  <code>PaintTopComponent</code> :</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    public void save() throws IOException {

        if (getDisplayName().endsWith(".png")) {
	    doSave(new File(getDisplayName()));
        } else {
	    saveAs();
        }

    }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    public void saveAs() throws IOException {

        JFileChooser ch = new JFileChooser();
        if (ch.showSaveDialog(this) == JFileChooser.APPROVE_OPTION &amp;amp;&amp;amp; ch.getSelectedFile() != null) {

	    File f = ch.getSelectedFile();

	    if (!f.getPath().endsWith(".png")) {
	        f = new File(f.getPath() + ".png");
	    }

	    if (!f.exists()) {

	        if (!f.createNewFile()) {
		    String failMsg = NbBundle.getMessage(
		             PaintTopComponent.class,
			    "MSG_SaveFailed", new Object[] { f.getPath() }
	            );
		    JOptionPane.showMessageDialog(this, failMsg);
		    return;
	        }

	    } else {
	        String overwriteMsg = NbBundle.getMessage(
		    PaintTopComponent.class,
                    "MSG_Overwrite", new Object[] { f.getPath() }
	        );

	        if (JOptionPane.showConfirmDialog(this, overwriteMsg)
	        != JOptionPane.OK_OPTION) {
		    return;
	        }

	    }

	    doSave(f);

        }

    }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    private void doSave(File f) throws IOException {

        BufferedImage img = canvas.getImage();
        ImageIO.write(img, "png", f);
        String statusMsg = NbBundle.getMessage(PaintTopComponent.class,
            "MSG_Saved", new Object[] { f.getPath() });
        StatusDisplayer.getDefault().setStatusText(statusMsg);
        setDisplayName(f.getName());

    }</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Добавьте следующие строки в файл  <code>Bundle.properties</code> :</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    MSG_SaveFailed = Could not write to file {0}
    MSG_Overwrite = {0} exists.  Overwrite?
    MSG_Saved = Saved image to {0}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Перед продолжением не забудьте сохранить файл.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Нажмите Ctrl-Shift-I для исправления операторов импорта. Для класса  <code>File</code>  будут отображены два полностью определенных имени. Выберите вариант  <code>java.io.File</code> .</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_создание_пункта_меню_для_создания_нового_холста_new_canvas">Создание пункта меню для создания нового холста "New Canvas"</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Для создания основных функциональных возможностей модуля используются шаблоны файлов разработки модуля. При использовании шаблона файла среда IDE регистрирует созданный элемент в файле  <code>layer.xml</code> . После выполнения мастера для создания шаблона файла для дальнейшей разработки модуля используются  <a href="https://bits.netbeans.org/dev/javadoc/"> интерфейсы API NetBeans</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>В окне "Projects" щелкните правой кнопкой мыши узел проекта модуля "Paint" и выберите <span class="menuseq"><b class="menu">New</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">File/Folder</b></span>. В мастере создания файла в области "Categories and Action" под полем "File Types" выберите "NetBeans Module Development". Нажмите кнопку "Next".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>На экране "Action Type" примите значения по умолчанию. Нажмите кнопку "Next".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>На экране "GUI Registration" выберите "Global Menu Item" и "Global Toolbar Button". Установите следующие значения:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Category:</strong> Edit</p>
</li>
<li>
<p><strong>Menu:</strong> File</p>
</li>
<li>
<p><strong>Position:</strong> Любое местоположение!</p>
</li>
<li>
<p><strong>Toolbar:</strong> File</p>
</li>
<li>
<p><strong>Position:</strong> Любое местоположение!</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Местоположение действия не имеет значения, однако оно должно находиться в меню "File" и на панели инструментов "File".
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Экран должен выглядеть следующим образом:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_newcanvasaction-60.png" alt="paintapp newcanvasaction 60">
</div>
</div>
<div class="paragraph">
<p>Нажмите кнопку "Next".</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>На экране "Name, Icon, and Location" в поле "Class Name" введите имя класса  <code>NewCanvasAction</code>  и в поле "Display Name" укажите имя  <code>New Canvas</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>В поле "Icon" вставьте этот значок (щелкните здесь правой кнопкой мыши, а затем сохраните его в папке  <code>org.netbeans.paint</code> ):
image::images/paintapp_new_icon.png[]</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Нажмите кнопку "Finish".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Среда IDE создаст файл  <code>NewCanvasAction.java</code>  в  <code>org.netbeans.paint</code>  и откроет его в редакторе исходного кода. На экране должно отобразиться следующее (для просмотра соответствующей документации Javadoc для интерфейса API среды NetBeans перейдите по ссылкам):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    package org.netbeans.paint;

    import  link:https://bits.netbeans.org/dev/javadoc/org-openide-util/org/openide/util/HelpCtx.html[org.openide.util.HelpCtx];
    import  link:https://bits.netbeans.org/dev/javadoc/org-openide-util/org/openide/util/NbBundle.html[org.openide.util.NbBundle];
    import  link:https://bits.netbeans.org/dev/javadoc/org-openide-util/org/openide/util/actions/CallableSystemAction.html[org.openide.util.actions.CallableSystemAction];

    public final class NewCanvasAction extends CallableSystemAction {

       public void  link:https://bits.netbeans.org/dev/javadoc/org-openide-util/org/openide/util/actions/CallableSystemAction.html#performAction()[performAction()] {
   	// Добавить: тело действия
       }

       public String  link:https://bits.netbeans.org/dev/javadoc/org-openide-util/org/openide/util/actions/SystemAction.html#getName()[getName()] {
       	return NbBundle.getMessage(NewCanvasAction.class, "CTL_NewCanvasAction");
       }

       protected String  link:https://bits.netbeans.org/dev/javadoc/org-openide-util/org/openide/util/actions/SystemAction.html#iconResource()[iconResource()] {
        return "org/netbeans/paint/new_icon.png";
       }

       public HelpCtx  link:https://bits.netbeans.org/dev/javadoc/org-openide-util/org/openide/util/actions/SystemAction.html#getHelpCtx()[getHelpCtx()] {
        return HelpCtx.DEFAULT_HELP;
       }

       protected boolean  link:https://bits.netbeans.org/dev/javadoc/org-openide-util/org/openide/util/actions/CallableSystemAction.html#asynchronous()[asynchronous()] {
        return false;
       }

    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Как указано на экране "GUI Registration", среда IDE регистрирует класс действия как пункт меню и как кнопку на панели инструментов в файле  <code>layer.xml</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>В редакторе исходного кода откройте  <code>NewCanvasAction.java</code>  и заполните метод  <code>performAction()</code>  следующим кодом:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    public void performAction() {

        PaintTopComponent tc = new PaintTopComponent();
	tc.open();
	tc.requestActive();

    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Этот код создает новый экземпляр элемента редактирования изображения; откройте его, в результате чего он появится в главном окне, а затем активируйте его путем установки курсора и выбора связанной с ним вкладки.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_создание_пункта_меню_для_сохранения_холста_save_canvas">Создание пункта меню для сохранения холста "Save Canvas"</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Как и в предыдущем разделе, для создания элемента меню используется мастер создания действий, с помощью которого далее будет создана функция сохранения изображений.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>В окне "Projects" щелкните правой кнопкой мыши узел проекта модуля "Paint" и выберите <span class="menuseq"><b class="menu">New</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">File/Folder</b></span>. В мастере создания файла в области "Categories and Action" под полем "File Types" выберите "NetBeans Module Development". Нажмите кнопку "Next".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>На экране "Action Type" примите значения по умолчанию. Нажмите кнопку "Next".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>На экране "GUI Registration" выберите "Global Menu Item" и "Global Toolbar Button". Установите следующие значения:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Category:</strong> Edit</p>
</li>
<li>
<p><strong>Menu:</strong> File</p>
</li>
<li>
<p><strong>Position:</strong> Любое местоположение!</p>
</li>
<li>
<p><strong>Toolbar:</strong> File</p>
</li>
<li>
<p><strong>Position:</strong> Любое местоположение!</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Местоположение действия не имеет значения, однако оно должно находиться в меню "File" и на панели инструментов "File".
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Нажмите кнопку "Next".</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>На экране "Name, Icon, and Location" в поле "Class Name" введите имя класса  <code>SaveCanvasAction</code>  и в поле "Display Name" укажите имя  <code>Save Canvas</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>В поле "Icon" вставьте этот значок (щелкните здесь правой кнопкой мыши, а затем сохраните его в папке  <code>org.netbeans.paint</code> ):
image::images/paintapp_save_icon.png[]</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Нажмите кнопку "Finish".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Среда IDE создаст файл  <code>SaveCanvasAction.java</code>  в  <code>org.netbeans.paint</code>  и откроет его в редакторе исходного кода.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>В редакторе исходного кода убедитесь в том, что файл  <code>SaveCanvasAction.java</code>  открыт, и заполните метод  <code>performAction()</code>  следующим кодом:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    public void performAction() {

        TopComponent tc = TopComponent.getRegistry().getActivated();

        if (tc instanceof PaintTopComponent) {

	    try {
	       	((PaintTopComponent) tc).saveAs();
            } catch (IOException ioe) {
                ErrorManager.getDefault().notify (ioe);
            }

        } else {

            //Теоретически за промежуток времени между нажатием кнопки в меню или в панели инструментов и вызовом действия активный элемент мог измениться.  Вряд ли,
            //но теоретически возможно
            Toolkit.getDefaultToolkit().beep();

        }

    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Нажмите Ctrl-Shift-I для создания необходимых операторов импорта:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_fiximports-60.png" alt="paintapp fiximports 60">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Путем изменения объявления класса добавьте прослушивающий процесс изменения свойств:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    public final class SaveCanvasAction extends CallableSystemAction implements PropertyChangeListener {</code></pre>
</div>
</div>
<div class="paragraph">
<p>Снова появится красная линия. Нажмите Alt-Enter для вызова сообщения с лампочкой и выберите предложение:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_lightbulb-listener1-60.png" alt="paintapp lightbulb listener1 60">
</div>
</div>
<div class="paragraph">
<p>Снова появится красная линия. Повторите процедуру и примите предложение:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_lightbulb-listener2-60.png" alt="paintapp lightbulb listener2 60">
</div>
</div>
<div class="paragraph">
<p>Заполните созданный метод  <code>propertyChange()</code>  следующим кодом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    public void propertyChange(PropertyChangeEvent evt) {

        if (TopComponent.Registry.PROP_ACTIVATED.equals(evt.getPropertyName())){
	    updateEnablement();
        }

    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>При появлении красной линии нажмите Alt+Enter, и среда IDE создаст метод  <code>updateEnablement()</code>  в классе  <code>SaveCanvasAction</code> .</p>
</div>
<div class="paragraph">
<p>Затем определите метод  <code>updateEnablement()</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    private void updateEnablement() {

        setEnabled(TopComponent.getRegistry().getActivated()
        instanceof PaintTopComponent);

    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>После этого определите конструктор:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    public SaveCanvasAction() {

        TopComponent.getRegistry().addPropertyChangeListener (
	    WeakListeners.propertyChange(this,
	    TopComponent.getRegistry()));

        updateEnablement();

    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>При появлении красной линии нажмите Alt+Enter для импорта средой IDE  <code>org.openide.util.WeakListeners</code> .</p>
</div>
<div class="paragraph">
<p>Важной частью кода является добавление прослушивающего процесса изменения свойств.  <code>TopComponent.Registry</code>  – это реестр всех открытых  <code>TopComponents</code>  в системе, т.е. всех открытых вкладок. Он должен прослушиваться на наличие изменений и предусматривать разрешение или запрет выполнения действия в зависимости от текущего фокуса.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Вместо непосредственного добавления прослушивающего процесса изменения свойств можно вызвать  <code>WeakListeners.propertyChange()</code> . В результате будет создан прослушивающий процесс изменения свойств, слабо связанный с рассматриваемым действием. Несмотря на то, что действие активно только при открытом приложении, если код ни при каких условиях не открепляет прослушивающий процесс, рекомендуется предусмотреть слабосвязанный прослушивающий процесс. В противном случае возможна потенциальная утечка памяти – действие никогда не сможет быть обработано сборщиком мусора, так как реестр будет ссылаться на него в своем списке прослушивающих процессов.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>В окне "Projects" должно отображаться следующее:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_final-proj-window-60.png" alt="paintapp final proj window 60">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_заключительная_подготовка">Заключительная подготовка</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Безусловно, основной задачей является создание приложения, а не среды IDE, поэтому необходимо выполнить несколько заключительных операций для исключения лишних модулей IDE и элементов интерфейса пользователя. Во-первых, необходимо создать экран-заставку для приложения, во-вторых, удалить лишние модули и, наконец, создать дистрибутив в формате ZIP и приложение на базе JNLP.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Выполните проект  <code>PaintApp</code> . После запуска приложения установите небольшой размер основного экрана и нарисуйте экран-заставку. Для сохранения экрана используйте кнопку "Save".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>В первоначальном проекте щелкните правой кнопкой мыши узел  <code>PaintApp</code> , выберите "Properties", а затем в диалоговом окне "Project Properties" нажмите кнопку "Build".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Выберите "Create Standalone Application". Теперь можно ввести название приложения (имя в средстве запуска, создаваемом средой IDE) и текст заголовка (который будет выводиться в строке заголовка). По умолчанию должно отображаться следующее:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_splashscreen1-60.png" alt="paintapp splashscreen1 60">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Выберите "Splash Screen". Найдите собственный экран-заставку. Если такового не имеется, можно использовать  <a href="https://netbeans.apache.org/platform/images/tutorials/paintapp/splash.gif">этот</a>. Нажмите кнопку "OK" для его прикрепления к приложению:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_splashscreen-60.png" alt="paintapp splashscreen 60">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Выберите "Libraries" и разверните узел  <code>platform7</code> . Это единственный кластер, содержащий модули, которые будут связаны с созданным приложением для рисования. Отмеченные модули включаются, неотмеченные – исключаются. Обратите внимание, что многие модули уже исключены. Один из модулей необходимо исключить вручную:  <code>Core UI</code> . Для этого отмените его выбор.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Затем в файле  <code>layer.xml</code>  модуля Paint добавьте следующие теги в папку "Menu". Эти теги удаляют меню "GoTo" и "View", которые не должны быть представлены в приложении для рисования.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">&lt;file name="GoTo_hidden"/&gt;
&lt;file name="View_hidden"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>В качестве альтернативы, вместо добавления вышеуказанных тегов вручную можно удалить папки в узле  <code>&lt;this layer in context&gt;</code>  файла  <code>layer.xml</code> . Для этого разверните  <code>&lt;this layer in context&gt;</code> , а затем разверните узел "Menu Bar". Щелчком правой кнопки мыши вызовите меню для узлов "GoTo" и "View" и выберите "Delete".</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>После этого снова запустите приложение и проверьте появившийся экран-заставку. Обратите внимание, что в запущенном приложении в строке заголовка выводится указанный текст. Кроме того, сократилось количество пунктов меню, кнопок на панели инструментов и других элементов:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/paintapp_result-without-menus-60.png" alt="paintapp result without menus 60">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_создание_дистрибутива">Создание дистрибутива</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Теперь необходимо выбрать тип дистрибутива. Щелкните правой кнопкой мыши узел  <code>PaintApp</code>  и для сборки готового приложения со всеми необходимыми модулями и файлами в один файл ZIP выберите "Create ZIP Distribution". Кроме того, можно выбрать "Build JNLP Application" для создания версии приложения на базе JavaWebStart™, которое можно будет разместить на веб-сервере и переходить к нему по ссылке напрямую с веб-страницы (потребуется указать точный URL-адрес – созданный дескриптор будет использовать протокол "file:", поэтому можно будет тестировать созданный веб-дистрибутив на локальном компьютере).</p>
</div>
<div class="paragraph">
<p>Поздравляем! Создание первого приложения на базе платформы NetBeans завершено. Следующая тема:  <a href="https://netbeans.apache.org/tutorials/60/nbm-feedreader_ru.html">Руководство по созданию приложения для чтения каналов на платформе NetBeans 6.0</a>.</p>
</div>
<div class="paragraph">
<p><a href="http://netbeans.apache.org/community/mailing-lists.html">Мы ждем ваших отзывов</a></p>
</div>
</div>
</div>
        
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/60/nbm-paintapp_ru.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
