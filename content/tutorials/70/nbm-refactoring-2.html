
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>NetBeans Refactoring Module Tutorial - Part 2</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NetBeans Refactoring Module Tutorial - Part 2 - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans Platform, Platform Tutorials, NetBeans Refactoring Module Tutorial - Part 2">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>

  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="/blogs/index.html">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 19</h1>
            <p><a class="button success" href="/download/nb19/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">NetBeans Refactoring Module Tutorial - Part 2</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/70/nbm-refactoring-2.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
        <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_prerequisite_knowledge">Prerequisite Knowledge</a></li>
<li><a href="#_netbeans_refactoring">NetBeans Refactoring</a></li>
<li><a href="#_project_setup">Project Setup</a></li>
<li><a href="#_the_refactoring">The Refactoring</a></li>
<li><a href="#_refactoring_plugin">Refactoring Plugin</a></li>
<li><a href="#_refactoring_transformer">Refactoring Transformer</a></li>
<li><a href="#_javarefactoringspluginfactory">JavaRefactoringsPluginFactory</a></li>
<li><a href="#_inlineui">InlineUI</a></li>
<li><a href="#_inlinepanel">InlinePanel</a></li>
<li><a href="#_actionsprovider">ActionsProvider</a></li>
<li><a href="#_next_steps">Next Steps</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial demonstrates how to create a module suite that provides one or more Java Refactorings. The tutorial is split into three parts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Part1: Initiate</p>
</li>
<li>
<p>Part2: Configurate and Execute</p>
</li>
<li>
<p>Part3: Testing and Distribution</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>At the end of this series we will have a fully tested implementation of the Inline Constant Refactoring.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisite_knowledge">Prerequisite Knowledge</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial is a follow up on NetBeans Refactoring Module Tutorial for NetBeans Platform 6.7 Part 1. You will need the knowledge and modules created by that tutorial as a starting point for this one.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_netbeans_refactoring">NetBeans Refactoring</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Part 1 of this tutorial we talked about the following steps you do, when you refactor in NetBeans.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select</p>
</li>
<li>
<p>Initiate</p>
</li>
<li>
<p>Configure</p>
</li>
<li>
<p>Preview</p>
</li>
<li>
<p>Execute</p>
</li>
<li>
<p>Undo</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The steps Select, Preview and Undo are all automagically done by NetBeans. In this tutorial, Part 2, we will take care of the Configure and Execute steps. Part 3 will look at writing tests and make it ready to distribute.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_project_setup">Project Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For this tutorial you need the module suite created in Part 1.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Open the module suite InlineDemo.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Add a new module to the suite with the name  <code>InlineDemoJava</code>  and the CodeNameBase  <code>org.nb.inlinedemo.java</code> . We won&#8217;t need an XML layer in this module, as we are going to use the Action from our API.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Our module will use different API&#8217;s from the NetBeans Platform and IDE. Setup the dependencies as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/refactoring2_APIDependencies2.png" alt="refactoring2 APIDependencies2">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_refactoring">The Refactoring</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We start by writing the Refactoring. The refactoring class serves as an API for invoking the refactoring. Also it is used by various refactoring plugins to determine refactoring parameters. This class itself should do almost no work - all the work is done by the plugins. The refactoring class usually contains just getters and setters for the refactoring parameters.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Right-click the InlineDemoJava project, choose New &gt; Other and choose Java Class from the Java category.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Type  <code>InlineRefactoring</code>  in Class Name and  <code>org.nb.inlinedemo.java.api</code>  in Package.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Extend the class AbstractRefactoring from the package  <code>org.netbeans.modules.refactoring.api</code> .</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Add a constructor using the following code:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public InlineRefactoring(TreePathHandle field) {
    super(Lookups.fixed(field));
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>For the Inline Constant refactoring, we need to know the name and the initialization string of the constant. Add the fields to the class</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private Tree initializerTree;
private String fieldName;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Use the Encapsulate Field refactoring to create a Getter and Setter for the fields.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>The next step is to have your module export the <code>org.nb.inlinedemo.java.api</code> package so other modules can use it.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
In the API Versioning page in the Project Properties dialog box, check the checkbox for <code>org.nb.inlinedemo.java.api</code> in the Public Packages list, shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/refactoring2_ExportPackage2.png" alt="refactoring2 ExportPackage2">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_refactoring_plugin">Refactoring Plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every refactoring has plugins - it should have at least one plugin - these actually do all the work. The refactoring module itself should provide the basic plugin that does the J2SE refactoring. Other modules can add other plugins - this makes them able to participate in the refactoring. For example, when using inline on a constant, a J2EE plugin needs to take care of replacing all the occurrences inside JSP documents.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Right-click the InlineDemoJava project, choose New &gt; Other and choose Java Class from the Java category.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Type  <code>InlineRefactoringPlugin</code>  in Class Name and  <code>org.nb.inlinedemo.java.plugins</code>  in Package.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Extend the class JavaRefactoringPlugin from the package  <code>org.netbeans.modules.refactoring.java.spi</code> .</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click the lightbulb and implement all abstract methods.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Create a constructor and two fields using the following code:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private final InlineRefactoring refactoring;
private final TreePathHandle treePathHandle;

public InlineRefactoringPlugin(InlineRefactoring inlineRefactoring) {
    refactoring = inlineRefactoring;
    treePathHandle = refactoring.getRefactoringSource().lookup(TreePathHandle.class);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Fill the method  <code>getJavaSource</code>  with this:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">protected JavaSource getJavaSource(Phase p) {
    if (treePathHandle == null) {
        return null;
    }
    switch (p) {
        case PRECHECK:
        case FASTCHECKPARAMETERS:
            return JavaSource.forFileObject(treePathHandle.getFileObject());
        case CHECKPARAMETERS:
            ClasspathInfo cpInfo = getClasspathInfo(refactoring);
            JavaSource source = JavaSource.create(cpInfo, treePathHandle.getFileObject());
            return source;
    }
    throw new IllegalStateException();
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Only two methods need to be implemented;  <code>precheck</code>  and  <code>prepare</code> . Prepare is called when the refactoring is executed and therefore, you have to implement it. Precheck is called before the configuration dialog is displayed. Add precheck using the following code:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">protected Problem preCheck(CompilationController info) throws IOException {
    Problem preCheckProblem = null;
    fireProgressListenerStart(InlineRefactoring.PRE_CHECK, 2);
    info.toPhase(JavaSource.Phase.RESOLVED);
    Element el = treePathHandle.resolveElement(info);
    preCheckProblem = isElementAvail(treePathHandle, info);
    if (preCheckProblem != null) {
        return preCheckProblem;
    }

    preCheckProblem = isSourceElement(el, info);
    if (preCheckProblem != null) {
        return preCheckProblem;
    }

    switch (el.getKind()) {
        case FIELD:
            fireProgressListenerStep();
            Set&lt;Modifier&gt; modifiers = el.getModifiers();
            ArrayList&lt;Modifier&gt; needed = new ArrayList&lt;Modifier&gt;(2);
            needed.add(Modifier.FINAL);
            needed.add(Modifier.STATIC);
            if (!modifiers.containsAll(needed)) {
                preCheckProblem = createProblem(preCheckProblem, false, NbBundle.getMessage(InlineRefactoringPlugin.class, "ERR_InlineNonConstant", el));
            }
            fireProgressListenerStep();
            VariableTree tree = (VariableTree) info.getTrees().getTree(el);
            refactoring.setFieldName(tree.getName().toString());
            refactoring.setInitializerTree(tree.getInitializer());
            if(refactoring.getInitializerTree() == null) {
                preCheckProblem = createProblem(preCheckProblem, true, NbBundle.getMessage(InlineRefactoringPlugin.class, "ERR_InlineNoInitializer"));
                return preCheckProblem;
            }
            break;
        default:
            preCheckProblem = createProblem(preCheckProblem, true, NbBundle.getMessage(InlineRefactoringPlugin.class, "ERR_InlineWrongType"));
    }
    fireProgressListenerStop();
    return preCheckProblem;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code checks three things</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Is the selected element a Field?</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Is the selected Field static and final?</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Is the field initialized during declaration?
If one of these tests fail, the problem is presented to the user.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Create a Bundle.properties file in  <code>org.nb.inlinedemo.java.plugins</code>  and add the following string:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">ERR_InlineNonConstant=Cannot inline a field which is not a constant field.
ERR_InlineWrongType=Inline Refactoring can only inline constant fields.
ERR_InlineNoInitializer=Cannot find the field initializer.
ERR_ProjectNotOpened=Cannot refactor {0} that is defined outside of an open project.
ERR_CannnotRefactorLibrary=Cannot change parameters of "{0}" which overrides method from library class.</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Precheck uses the method isSourceElement to check if the selected element is in an opened project and is not part of a library. Add it using the following code:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public static final Problem isSourceElement(Element el, CompilationInfo info) {
    Problem preCheckProblem = null;
    if (isFromLibrary(el, info.getClasspathInfo())) { //NOI18N
        preCheckProblem = new Problem(true, NbBundle.getMessage(
                InlineRefactoringPlugin.class, "ERR_CannotRefactorLibraryClass",
                el.getEnclosingElement()));
        return preCheckProblem;
    }
    FileObject file = SourceUtils.getFile(el, info.getClasspathInfo());
    // isFromLibrary already checked file for null
    if (!isElementInOpenProject(file)) {
        preCheckProblem = new Problem(true, NbBundle.getMessage(
                InlineRefactoringPlugin.class,
                "ERR_ProjectNotOpened",
                FileUtil.getFileDisplayName(file)));
        return preCheckProblem;
    }
    return null;
}

public static boolean isElementInOpenProject(FileObject f) {
    if (f == null) {
        return false;
    }
    Project p = FileOwnerQuery.getOwner(f);
    return isOpenProject(p);
}

public static boolean isFromLibrary(Element element, ClasspathInfo info) {
    FileObject file = SourceUtils.getFile(element, info);
    if (file == null) {
        //no source for given element. Element is from library
        return true;
    }
    return FileUtil.getArchiveFile(file) != null;
}

private static boolean isOpenProject(Project p) {
    return OpenProjects.getDefault().isProjectOpen(p);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>The prepare method itself is quite small. It only queries for the files relevant to this refactoring and delegates the hard work to a TransformTask. Fill the prepare method using the following code:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public Problem prepare(RefactoringElementsBag elements) {
    if (treePathHandle == null) {
        return null;
    }
    Set&lt;FileObject&gt; a = getRelevantFiles();
    fireProgressListenerStart(ProgressEvent.START, a.size());
    TransformTask transform = new TransformTask(new InlineTransformer(refactoring.getInitializerTree()), treePathHandle);
    Problem problem = createAndAddElements(a, transform, elements, refactoring);
    fireProgressListenerStop();
    return problem;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p>The getRelevantFiles method will need to look like this:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private Set&lt;FileObject&gt; getRelevantFiles() {
    ClasspathInfo cpInfo = getClasspathInfo(refactoring);
    final Set&lt;FileObject&gt; set = new HashSet&lt;FileObject&gt;();
    JavaSource source = JavaSource.create(cpInfo, treePathHandle.getFileObject());

    try {
        source.runUserActionTask(new CancellableTask&lt;CompilationController&gt;() {

            public void cancel() {
                throw new UnsupportedOperationException("Not supported yet."); // NOI18N
            }

            public void run(CompilationController info) throws Exception {
                final ClassIndex idx = info.getClasspathInfo().getClassIndex();
                info.toPhase(JavaSource.Phase.RESOLVED);
                Element el = treePathHandle.resolveElement(info);
                ElementHandle&lt;TypeElement&gt; enclosingType;
                if (el instanceof TypeElement) {
                    enclosingType = ElementHandle.create((TypeElement) el);
                } else {
                    enclosingType = ElementHandle.create(info.getElementUtilities().enclosingTypeElement(el));
                }
                set.add(SourceUtils.getFile(el, info.getClasspathInfo()));
                if (!el.getModifiers().contains(Modifier.PRIVATE)) {
                    set.addAll(idx.getResources(enclosingType, EnumSet.of(ClassIndex.SearchKind.FIELD_REFERENCES), EnumSet.of(ClassIndex.SearchScope.SOURCE)));
                }
            }
        }, true);
    } catch (IOException ioe) {
        throw (RuntimeException) new RuntimeException().initCause(ioe);
    }
    return set;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_refactoring_transformer">Refactoring Transformer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Although the name may let you think otherwise, the Transformer will not change your source files. Instead it will create RefactoringElements - each of the elements represent a single change that the refactoring should do. So, in case of our Inline Constant Refactoring, the field declaration and every usage of the field being inlined would have a corresponding RefactoringElement. These elements will then be used by the refactoring preview, to execute the refactoring and by the undo refactoring. To create the transformer, we will make use of the RefactoringVisitor from the package  <code>org.netbeans.modules.refactoring.java.spi</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>First, create a new class  <code>InlineTransformer</code>  in the package  <code>org.nb.inlinedemo.plugins</code></p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Extend the class RefactoringVisitor and use the following code:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private final Tree initializerTree;

public InlineTransformer(Tree initializerTree) {
    this.initializerTree = initializerTree;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>First, we will remove the declaration of the field. Use the following code:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
public Tree visitClass(ClassTree node, Element p) {
    Tree tree = workingCopy.getTrees().getTree(p);
    if (!node.getMembers().contains(tree)) {
        return super.visitClass(node, p);
    }
    ClassTree nNode = make.removeClassMember(node, tree);
    rewrite(node, nNode);
    return super.visitClass(node, p);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Second, we need to replace every usage of the field with the string from the initializer. For this, we use the following three methods:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
public Tree visitIdentifier(IdentifierTree node, Element p) {
    renameUsageIfMatch(getCurrentPath(), node, p);
    return super.visitIdentifier(node, p);
}

@Override
public Tree visitMemberSelect(MemberSelectTree node, Element p) {
    renameUsageIfMatch(getCurrentPath(), node, p);
    return super.visitMemberSelect(node, p);
}

private void renameUsageIfMatch(TreePath path, Tree tree, Element elementToFind) {
    if (workingCopy.getTreeUtilities().isSynthetic(path)) {
        return;
    }
    Trees trees = workingCopy.getTrees();
    Element el = workingCopy.getTrees().getElement(path);
    if (el == null) {
        path = path.getParentPath();
        if (path != null &amp;amp;&amp;amp; path.getLeaf().getKind() == Tree.Kind.IMPORT) {
            ImportTree impTree = (ImportTree) path.getLeaf();
            if (!impTree.isStatic()) {
                return;
            }
            Tree idTree = impTree.getQualifiedIdentifier();
            if (idTree.getKind() != Tree.Kind.MEMBER_SELECT) {
                return;
            }
            final Name id = ((MemberSelectTree) idTree).getIdentifier();
            if (id == null || id.contentEquals("*")) { // NOI18N
                // skip import static java.lang.Math.*
                return;
            }
            Tree classTree = ((MemberSelectTree) idTree).getExpression();
            path = trees.getPath(workingCopy.getCompilationUnit(), classTree);
            el = trees.getElement(path);
            if (el == null) {
                return;
            }
            Iterator iter = workingCopy.getElementUtilities().getMembers(el.asType(), new ElementUtilities.ElementAcceptor() {

                public boolean accept(Element e, TypeMirror type) {
                    return id.equals(e.getSimpleName());
                }
            }).iterator();
            if (iter.hasNext()) {
                el = (Element) iter.next();
            }
            if (iter.hasNext()) {
                return;
            }
        } else {
            return;
        }
    }

    if (el.equals(elementToFind)) {
        rewrite(tree, initializerTree);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_javarefactoringspluginfactory">JavaRefactoringsPluginFactory</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Plugins are instantiated by the refactoring class automatically when some code creates an instance of a refactoring. The instantiation of the plugins is done by plugin factories that get called by the refactoring.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Create the class  <code>JavaRefactoringsPluginFactory</code>  in the package  <code>org.nb.inlinedemo.java.plugins</code></p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Implement the interface  <code>RefactoringPluginFactory</code>  and register it using the following annotation:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@org.openide.util.lookup.ServiceProvider(service=org.netbeans.modules.refactoring.spi.RefactoringPluginFactory.class, position=100)</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Add the method createInstance:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public RefactoringPlugin createInstance(AbstractRefactoring refactoring) {
    if (refactoring instanceof InlineRefactoring) {
        return new InlineRefactoringPlugin((InlineRefactoring) refactoring);
    }
    return null;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Our refactoring itself is now finished, it does the needed checks and transforms the java code. But, before it can be connected to our action, we first have to make the InlineUI.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inlineui">InlineUI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>InlineUI will be an implementation of RefactoringUI interface. It plugs into the refactoring framework to which it provides a refactoring parameters panel, display name of the refactoring, reference to the Refactoring Class, etc.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Create the class  <code>InlineUI</code>  in the package  <code>org.nb.inlinedemo.java.ui</code>  using the following code:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class InlineUI implements RefactoringUI {

    private CustomRefactoringPanel panel;
    private InlineRefactoring refactoring;

    InlineUI(TreePathHandle selectedElement, CompilationInfo info) {
        refactoring = new InlineRefactoring(selectedElement);
    }

    public String getName() {
        return NbBundle.getMessage(InlineUI.class, "LBL_Inline");
    }

    public String getDescription() {
        String name = refactoring.getFieldName();
        return new MessageFormat(NbBundle.getMessage(InlineUI.class, "DSC_Inline")).format(
                new Object[]{name});
    }

    public boolean isQuery() {
        return false;
    }

    public CustomRefactoringPanel getPanel(ChangeListener parent) {
        if (panel == null) {
            panel = new InlinePanel(refactoring);
        }
        return panel;
    }

    public Problem setParameters() {
        return setParameters(false);
    }

    public Problem checkParameters() {
        return setParameters(true);
    }

    public boolean hasParameters() {
        return true;
    }

    public AbstractRefactoring getRefactoring() {
        return refactoring;
    }

    public HelpCtx getHelpCtx() {
        return new HelpCtx(InlineUI.class);
    }

    private Problem setParameters(boolean checkOnly) {
        if (checkOnly) {
            return refactoring.fastCheckParameters();
        } else {
            return refactoring.checkParameters();
        }
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Create a  <code>Bundle.properties</code>  in  <code>org.nb.inlinedemo.java.ui</code>  and add the following strings:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">LBL_Inline=Inline
DSC_Inline=Inline instances of {0}?;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inlinepanel">InlinePanel</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now we will create the configuration panel. Because there are no parameters to be set for this refactoring, the user will be presented with a simple message.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Add a new JPanel to  <code>org.nb.inlinedemo.java.ui</code>  with the name  <code>InlinePanel</code> .</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Add a JLabel to the center of the panel with the text:  <code>Inline instances of {0}?</code></p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Using the editor let the panel implement  <code>CustomRefactoringPanel</code>  from the package  <code>org.netbeans.modules.refactoring.spi.ui</code></p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Change the body of  <code>getComponent</code>  to:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">return this;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Change the body of  <code>initialize</code>  to:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">jLabel1.setText(new MessageFormat(NbBundle.getMessage(InlineUI.class, "DSC_Inline")).format(
                new Object[]{refactoring.getFieldName()}));</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Add the parameter  <code>InlineRefactoring refactoring</code>  to the constructor. Select the parameter, click the lightbulb and choose Create Field.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actionsprovider">ActionsProvider</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now we can connect the refactoring to our Action. We will need do create the methods canInline and doInline. The first method (canInline) determines when the action should be enabled based on the currently active (selected) nodes in the IDE. By convention the implementation of this method should not do anything expensive - preferably it should not tough the Java metadata and decide purely on whether there are JavaDataObjects behind the selected nodes and how many nodes are selected (some actions may be applicable to several nodes at once as in case of Pull Up refactoring, where you can select several members to be pulled up, some actions may be able operate on a single node only). For performance reasons the coInline method does not get information about the position of the caret in the editor - that&#8217;s why the checks in this method should be weak. Most of the other checks are be done in refactoring preCheck() method (we talked about this method earlier), which can provide user with a descriptive message for why the refactoring cannot be performed on a selected object and how user can fix it.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Create the class  <code>JavaRefactoringActionsProvider</code>  in the package  <code>org.nb.inlinedemo.java.ui</code> .</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Extend the class  <code>ActionsImplementationProvider</code>  and register it using the annotation:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@org.openide.util.lookup.ServiceProvider(service = org.nb.inlinedemo.spi.ui.ActionsImplementationProvider.class, position = 100)</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Add the following code to the class:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
public boolean canInline(Lookup lookup) {
    Collection&lt;? extends Node&gt; nodes = new HashSet&lt;Node&gt;(lookup.lookupAll(Node.class));
    if (nodes.size() != 1) {
        return false;
    }
    Node n = nodes.iterator().next();
    TreePathHandle tph = n.getLookup().lookup(TreePathHandle.class);
    if (tph != null) {
        return RetoucheUtils.isRefactorable(tph.getFileObject());
    }
    DataObject dob = n.getCookie(DataObject.class);
    if (dob == null) {
        return false;
    }
    FileObject fo = dob.getPrimaryFile();
    if (RetoucheUtils.isRefactorable(fo)) { //NOI18N
        return true;
    }
    return false;
}

@Override
public void doInline(Lookup lookup) {
    Runnable task;
    EditorCookie ec = lookup.lookup(EditorCookie.class);
    if (isFromEditor(ec)) {
        task = new TextComponentTask(ec) {

            @Override
            protected RefactoringUI createRefactoringUI(TreePathHandle selectedElement, int startOffset, int endOffset, CompilationInfo info) {
                return new InlineUI(selectedElement, info);
            }
        };
    } else if (nodeHandle(lookup)) {
        task = new TreePathHandleTask(new HashSet&lt;Node&gt;(lookup.lookupAll(Node.class)), true) {

            RefactoringUI ui;

            @Override
            protected void treePathHandleResolved(TreePathHandle handle, CompilationInfo javac) {
                ui = new InlineUI(handle, javac);
            }

            @Override
            protected RefactoringUI createRefactoringUI(Collection&lt;TreePathHandle&gt; handles) {
                return ui;
            }
        };
    } else {
        task = new NodeToFileObjectTask(Collections.singleton(lookup.lookup(Node.class))) {

            RefactoringUI ui;

            @Override
            protected void nodeTranslated(Node node, Collection&lt;TreePathHandle&gt; handles, CompilationInfo javac) {
                TreePathHandle tph = handles.iterator().next();
                ui = new InlineUI(tph, javac);
            }

            @Override
            protected RefactoringUI createRefactoringUI(FileObject[] selectedElements, Collection&lt;TreePathHandle&gt; handles) {
                return ui;
            }
        };
    }
    RetoucheUtils.invokeAfterScanFinished(task, getActionName(RefactoringActionsFactory.inlineAction()));
}

static boolean isFromEditor(EditorCookie ec) {
    if (ec != null &amp;amp;&amp;amp; ec.getOpenedPanes() != null) {
        TopComponent activetc = TopComponent.getRegistry().getActivated();
        if (activetc instanceof CloneableEditorSupport.Pane) {
            return true;
        }
    }
    return false;
}

static boolean nodeHandle(Lookup lookup) {
    Node n = lookup.lookup(Node.class);
    if (n!=null) {
        if (n.getLookup().lookup(TreePathHandle.class)!=null)
            return true;
    }
    return false;
}

static String getActionName(Action action) {
    String arg = (String) action.getValue(Action.NAME);
    arg = arg.replace("&amp;amp;", ""); // NOI18N
    return arg.replace("...", ""); // NOI18N
}

public static abstract class TextComponentTask implements Runnable, CancellableTask&lt;CompilationController&gt; {
    private JTextComponent textC;
    private int caret;
    private int start;
    private int end;
    private RefactoringUI ui;

    public TextComponentTask(EditorCookie ec) {
        this.textC = ec.getOpenedPanes()[0];
        this.caret = textC.getCaretPosition();
        this.start = textC.getSelectionStart();
        this.end = textC.getSelectionEnd();
        assert caret != -1;
        assert start != -1;
        assert end != -1;
    }

    public void cancel() {
    }

    public void run(CompilationController cc) throws Exception {
        TreePath selectedElement = null;
        cc.toPhase(Phase.RESOLVED);
        selectedElement = cc.getTreeUtilities().pathFor(caret);
        //workaround for issue 89064
        if (selectedElement.getLeaf().getKind() == Tree.Kind.COMPILATION_UNIT) {
            List&lt;? extends Tree&gt; decls = cc.getCompilationUnit().getTypeDecls();
            if (!decls.isEmpty()) {
                selectedElement = TreePath.getPath(cc.getCompilationUnit(), decls.get(0));
            }
        }
        ui = createRefactoringUI(TreePathHandle.create(selectedElement, cc), start, end, cc);
    }

    public final void run() {
        try {
            JavaSource source = JavaSource.forDocument(textC.getDocument());
            source.runUserActionTask(this, true);
        } catch (IOException ioe) {
            ErrorManager.getDefault().notify(ioe);
            return ;
        }
        TopComponent activetc = TopComponent.getRegistry().getActivated();

        if (ui!=null) {
            UI.openRefactoringUI(ui, activetc);
        } else {
            JOptionPane.showMessageDialog(null,NbBundle.getMessage(JavaRefactoringActionsProvider.class, "ERR_CannotRenameKeyword"));
        }
    }

    protected abstract RefactoringUI createRefactoringUI(TreePathHandle selectedElement,int startOffset,int endOffset, CompilationInfo info);
}

public static abstract class TreePathHandleTask implements Runnable, CancellableTask&lt;CompilationController&gt; {
    private Collection&lt;TreePathHandle&gt; handles = new ArrayList&lt;TreePathHandle&gt;();
    private TreePathHandle current;
    boolean renameFile;

    public TreePathHandleTask(Collection&lt;? extends Node&gt; nodes) {
        this(nodes, false);
    }

    public TreePathHandleTask(Collection&lt;? extends Node&gt; nodes, boolean useFirstHandle) {
        for (Node n:nodes) {
            TreePathHandle temp = n.getLookup().lookup(TreePathHandle.class);
            if (temp!=null) {
                handles.add(temp);
                if (useFirstHandle) {
                    break;
                }
            }
        }
    }

    public void cancel() {
    }

    public void run(CompilationController info) throws Exception {
        info.toPhase(Phase.ELEMENTS_RESOLVED);
        Element el = current.resolveElement(info);
        if (el!=null &amp;amp;&amp;amp; el instanceof TypeElement &amp;amp;&amp;amp; !((TypeElement)el).getNestingKind().isNested()) {
            if (info.getFileObject().getName().equals(el.getSimpleName().toString())) {
                renameFile = true;
            }
        }
        treePathHandleResolved(current, info);
    }

    public void run() {
        for (TreePathHandle handle:handles) {
            FileObject f = handle.getFileObject();
            current = handle;
            JavaSource source = JavaSource.forFileObject(f);
            assert source != null;
            try {
                source.runUserActionTask(this, true);
            } catch (IllegalArgumentException ex) {
                ex.printStackTrace();
            } catch (IOException ex) {
                ex.printStackTrace();
            }
        }

        TopComponent activetc = TopComponent.getRegistry().getActivated();

        RefactoringUI ui = createRefactoringUI(handles);
        if (ui!=null) {
            UI.openRefactoringUI(ui, activetc);
        } else {
            JOptionPane.showMessageDialog(null,NbBundle.getMessage(JavaRefactoringActionsProvider.class, "ERR_CannotRenameKeyword"));
        }
    }

    /**
     * This is the place where subclasses may collect info about handles.
     * @param handle handle
     * @param javac context of running transaction
     */
    protected void treePathHandleResolved(TreePathHandle handle, CompilationInfo javac) {
    }

    protected abstract RefactoringUI createRefactoringUI(Collection&lt;TreePathHandle&gt; handles);
}

public static abstract class NodeToFileObjectTask implements Runnable, CancellableTask&lt;CompilationController&gt; {
    private Collection&lt;? extends Node&gt; nodes;
    public NonRecursiveFolder pkg[];
    Collection&lt;TreePathHandle&gt; handles = new ArrayList&lt;TreePathHandle&gt;();
    private Node currentNode;

    public NodeToFileObjectTask(Collection&lt;? extends Node&gt; nodes) {
        this.nodes = nodes;
    }

    public void cancel() {
    }

    public void run(CompilationController info) throws Exception {
        info.toPhase(Phase.ELEMENTS_RESOLVED);
        Collection&lt;TreePathHandle&gt; handlesPerNode = new ArrayList&lt;TreePathHandle&gt;();
        CompilationUnitTree unit = info.getCompilationUnit();
        Collection&lt;TreePathHandle&gt; publicHandles = new ArrayList&lt;TreePathHandle&gt;();
        Collection&lt;TreePathHandle&gt; sameNameHandles = new ArrayList&lt;TreePathHandle&gt;();
        for (Tree t: unit.getTypeDecls()) {
            Element e = info.getTrees().getElement(TreePath.getPath(unit, t));
            if (e == null || !(e.getKind().isClass() || e.getKind().isInterface())) {
                // syntax errors #111195
                continue;
            }
            if (e.getSimpleName().toString().equals(info.getFileObject().getName())) {
                TreePathHandle representedObject = TreePathHandle.create(TreePath.getPath(unit,t),info);
                sameNameHandles.add(representedObject);
            }
            if (e.getModifiers().contains(Modifier.PUBLIC)) {
                TreePathHandle representedObject = TreePathHandle.create(TreePath.getPath(unit,t),info);
                publicHandles.add(representedObject);
            }
        }
        if (!publicHandles.isEmpty()) {
            handlesPerNode.addAll(publicHandles);
        } else {
            handlesPerNode.addAll(sameNameHandles);
        }

        if (!handlesPerNode.isEmpty()) {
            handles.addAll(handlesPerNode);
            nodeTranslated(currentNode, handlesPerNode, info);
        }
    }

    public void run() {
        FileObject[] fobs = new FileObject[nodes.size()];
        pkg = new NonRecursiveFolder[fobs.length];
        int i = 0;
        for (Node node:nodes) {
            DataObject dob = node.getCookie(DataObject.class);
            if (dob!=null) {
                fobs[i] = dob.getPrimaryFile();
                if (RetoucheUtils.isJavaFile(fobs[i])) {
                    JavaSource source = JavaSource.forFileObject(fobs[i]);
                    assert source != null;
                    try {
                        currentNode = node;
                        // XXX this could be optimize by ClasspasthInfo in case of more than one file
                        source.runUserActionTask(this, true);
                    } catch (IllegalArgumentException ex) {
                        ex.printStackTrace();
                    } catch (IOException ex) {
                        ex.printStackTrace();
                    } finally {
                        currentNode = null;
                    }
                }

                pkg[i++] = node.getLookup().lookup(NonRecursiveFolder.class);
            }
        }
        RefactoringUI ui = createRefactoringUI(fobs, handles);
        if (ui!=null) {
            UI.openRefactoringUI(ui);
        } else {
            JOptionPane.showMessageDialog(null,NbBundle.getMessage(JavaRefactoringActionsProvider.class, "ERR_NoTypeDecls"));
        }
    }

    /**
     * Notifies subclasses about the translation.
     * This is the place where subclasses may collect info about handles.
     * @param node node that is translated
     * @param handles handles translated from the node
     * @param javac context of running translation
     */
    protected void nodeTranslated(Node node, Collection&lt;TreePathHandle&gt; handles, CompilationInfo javac) {
    }

    protected abstract RefactoringUI createRefactoringUI(FileObject[] selectedElement, Collection&lt;TreePathHandle&gt; handles);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>The file RetoucheUtils is in the current version not in a public package. We will need to change the dependency on Java Refactoring to its implementation version. Expand the libraries node and select Java Refactoring.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Right-click and choose Edit&#8230;&#8203;</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
Check Implementation Version as shown below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/refactoring2_ImplementationVersion.png" alt="refactoring2 ImplementationVersion">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps">Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You now have a working Inline Constant Refactoring. In the next tutorial we will test the refactoring and look at distribution.</p>
</div>
</div>
</div>
        
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/70/nbm-refactoring-2.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
