
<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Criando o aplicativo CRUD da plataforma NetBeans utilizando Maven</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Criando o aplicativo CRUD da plataforma NetBeans utilizando Maven - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans Platform, Platform Tutorials, Criando o aplicativo CRUD da plataforma NetBeans utilizando Maven">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
     <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet"> 
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
</head>


    <body>
        

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


        
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 12.1</h1>
            <p><a class="button success" href="/download/nb121/index.html">Find out more</a></p>
        </div>
    </div>
</section>

        <div class='grid-container main-content tutorial'>
            <h1 class="sect0">Criando o aplicativo CRUD da plataforma NetBeans utilizando Maven</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://issues.apache.org/jira/projects/NETBEANS/issues">open a JIRA issue</a>, 
                     or <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/74/nbm-maven-crud_pt_BR.asciidoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
            <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_configurando_o_maven">Configurando o Maven</a>
<ul class="sectlevel2">
<li><a href="#_visualizando_os_repositórios_maven">Visualizando os repositórios Maven</a></li>
</ul>
</li>
<li><a href="#_criando_o_projeto_do_aplicativo_da_plataforma_netbeans">Criando o projeto do aplicativo da plataforma NetBeans</a>
<ul class="sectlevel2">
<li><a href="#_criando_o_projeto">Criando o projeto</a></li>
<li><a href="#_criando_um_módulo">Criando um módulo</a></li>
<li><a href="#_tornando_o_módulo_uma_dependência">Tornando o módulo uma dependência</a></li>
<li><a href="#_marcando_o_aplicativo">Marcando o aplicativo</a></li>
</ul>
</li>
<li><a href="#_criando_as_classes_de_entidade">Criando as classes de entidade</a>
<ul class="sectlevel2">
<li><a href="#_adicionando_do_derbyclient_como_uma_dependência_do_tempo_de_execução">Adicionando do DerbyClient como uma dependência do tempo de execução</a></li>
<li><a href="#_gerando_classes_de_entidade_a_partir_do_banco_de_dados">Gerando classes de entidade a partir do banco de dados</a></li>
</ul>
</li>
<li><a href="#_ler_leitura_e_exibição_de_um_registro">LER: Leitura e Exibição de um registro</a>
<ul class="sectlevel2">
<li><a href="#_adicionando_um_componente_de_janela">Adicionando um Componente de janela</a></li>
<li><a href="#_adicionando_uma_visualização_de_árvore">Adicionando uma visualização de árvore</a></li>
<li><a href="#_criação_de_uma_classe_de_fábrica">Criação de uma Classe de fábrica</a></li>
<li><a href="#_executando_do_aplicativo">Executando do aplicativo</a></li>
</ul>
</li>
<li><a href="#_atualizaÇÃo_edição_de_um_registro">ATUALIZAÇÃO: Edição de um registro</a>
<ul class="sectlevel2">
<li><a href="#_criando_a_janela_editor">Criando a janela Editor</a></li>
<li><a href="#_utilizando_um_lookuplistener">Utilizando um LookupListener</a></li>
<li><a href="#_adição_dos_comandos_desfazer_e_refazer">Adição dos comandos Desfazer e Refazer</a></li>
<li><a href="#_adicionando_a_função_salvar">Adicionando a função Salvar</a></li>
<li><a href="#_alterações_persistentes">Alterações persistentes</a></li>
<li><a href="#_adição_da_função_atualizar">Adição da função Atualizar</a></li>
</ul>
</li>
<li><a href="#_criar_adição_de_um_novo_registro">CRIAR: Adição de um novo registro</a>
<ul class="sectlevel2">
<li><a href="#_adicionando_a_ação_criar">Adicionando a ação Criar</a></li>
<li><a href="#_crianbdo_e_salvando_um_objeto_novo">Crianbdo e salvando um objeto novo</a></li>
</ul>
</li>
<li><a href="#_construindo_e_executando_o_aplicativo">Construindo e executando o aplicativo</a></li>
<li><a href="#_veja_também">Veja também</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Bem-vindo à  <a href="https://netbeans.apache.org/platform/"><strong>Plataforma NetBeans</strong></a>!</p>
</div>
<div class="paragraph">
<p>Este documento mostra como utilizar a estrutura de construção Maven para criar um aplicativo da plataforma NetBeans que possa ser lido e gravado num banco de dados. Neste documento poderão ser utilizados os arquétipos Maven para criar o aplicativo e o módulo da plataforma NetBeans e o kit de ferramentas da Interface do usuário Swing e o construtor de GUI "Matisse" para criar componentes da janela.</p>
</div>
<div class="paragraph">
<p>Este documento se baseia no  <a href="nbm-crud_pt_BR.html">Tutorial do aplicativo NetBeans CRUD com base Ant para a plataforma NetBeans</a> e ilustra algumas das diferenças entre o uso de Ant e Maven para desenvolver os aplicativos da plataforma NetBeans. Após entender como Maven se diferencia de Ant, é possível prosseguir facilmente através de outros tutoriais na  <a href="https://netbeans.apache.org/kb/docs/platform_pt_BR.html">Trilha de aprendizagem da plataforma NetBeans</a>.</p>
</div>
<div class="paragraph">
<p>O aplicativo modelo CRUD é um dos modelos Maven disponíveis no assistente do Novo projeto.</p>
</div>
<div class="paragraph">
<p>Caso não tenha experiência com a plataforma NetBeans, recomenda-se assistir à série de screencasts  <a href="https://netbeans.apache.org/tutorials/nbm-10-top-apis.html">As 10 principais APIs NetBeans</a>.</p>
</div>
<div class="paragraph">
<p><strong>Para seguir este tutorial, são necessários o software e os recursos listados na tabela a seguir.</strong></p>
</div>
<div class="paragraph">
<p>NOTE:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>O servidor do banco de dados JavaDB e um banco de dados modelo estão incluídos no pacote do GlassFish Server Open Source Edition 3.0.1.</p>
</li>
<li>
<p>Não é necessário fazer o download de uma versão avulsa da plataforma NetBeans para desenvolver os aplicativos para a plataforma NetBeans. Normalmente, se desenvolve os aplicativos e módulos no NetBeans IDE e, a seguir, inclui-se somente os módulos necessários para executar a plataforma NetBeans e seu aplicativo.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Antes de começar este tutorial, talvez você queira se familiarizar com a documentação a seguir.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://wiki.netbeans.org/MavenBestPractices">Melhores práticas para o Apache Maven no NetBeans 6.x</a></p>
</li>
<li>
<p><a href="http://www.sonatype.com/books/maven-book/reference/introduction.html">Capítulo 1. Introdução ao Apache Maven</a> (do  <a href="http://www.sonatype.com/books/maven-book/reference/public-book.html">Maven: o guia definitivo</a>)</p>
</li>
<li>
<p><a href="https://netbeans.apache.org/kb/docs/java/gui-functionality_pt_BR.html">Introdução à construção de GUI</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configurando_o_maven">Configurando o Maven</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Se este for seu primeiro projeto Maven, talvez você queira verificar as definições de configurações do Maven na janela Opções. Para completar este tutorial é preciso ter o Maven instalado em seu sistema local. É possível fazer o download do instalador a partir do  <a href="http://maven.apache.org/">site do Maven</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Selecione a categoria Diversos na janela Opções e clique na aba Maven.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Especifique a localização da instalação local do Maven (exige-se o 2.0.9 ou um mais recente).</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Verifique se a localização do repositório local do Maven está correta.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Clique em OK.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Na maioria dos casos, se a configuração do Maven for típica a informação na janela Opções já deve estar correta.</p>
</div>
<div class="paragraph">
<p>O IDE usa o Maven SCM para a verificação de artefatos Maven. Talvez você queira verificar se todos os clientes necessários para a verificação de fontes estão instalados no seu computador e configurados corretamente.</p>
</div>
<div class="paragraph">
<p>Para obter mais detalhes sobre o Maven SCM, consulte a  <a href="http://maven.apache.org/scm/index.html">página Maven SCM</a>.</p>
</div>
<div class="sect2">
<h3 id="_visualizando_os_repositórios_maven">Visualizando os repositórios Maven</h3>
<div class="paragraph">
<p>Os artefatos que são utilizados pelo Maven para construir todos os seus projetos são armazenados em seu repositório local Maven. Quando um artefato é declarado como uma dependência do projeto, o artefato é baixado para seu repositório local a partir de um dos repositórios remotos registrados.</p>
</div>
<div class="paragraph">
<p>O repositório NetBeans e vários super conhecidos repositórios indexados Maven são, por padrão, registrados e listados na janela do Navegador do repositório. O repositório NetBeans contém a maioria dos artefatos públicos necessários para a construção do seu projeto. É possível utilizar o navegador do repositório Maven para visualizar o conteúdo dos repositórios locais e remotos. É possível expandir o nó Repositório local para ver os artefatos que estão presentes localmente. Os artefatos listados sob os nós repositório NetBeans podem ser adicionados como dependências de projeto, mas nem todos eles estão presentes no local. Eles são adicionados ao repositório local somente quando são declarados como dependências do projeto.</p>
</div>
<div class="paragraph">
<p>Para abrir o navegador do repositório Maven:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Selecione Janela &gt; Outro &gt; Navegador do repositório Maven no menu principal.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/maven-nbm-netbeans-repo.png" alt="maven nbm netbeans repo">
</div>
<div class="title">Figure 1. Captura de tela do navegador do repositório Maven</div>
</div>
<div class="paragraph">
<p>Quando seu cursor estiver sobre um artefato, o IDE exibirá uma dica de ferramenta com as coordenadas do artefato. É possível visualizar detalhes adicionais sobre um artefato ao clicar duas vezes no arquivo JAR do artefato no navegador.</p>
</div>
<div class="paragraph">
<p>É possível pesquisar por um artefato ao clicar no botão Localizar da barra de ferramentas do navegador do repositório Maven ou ao utilizar o campo de texto Pesquisa rápida na barra de ferramentas principal.</p>
</div>
<div class="paragraph">
<p>Para saber mais sobre como gerenciar as dependências do classpath Maven e sobre como trabalhar com repositórios Maven no IDE, consulte a seção  <a href="http://wiki.netbeans.org/MavenBestPractices#Dependency_management">Gerenciamento de dependência</a> em  <a href="http://wiki.netbeans.org/MavenBestPractices">Melhores práticas para o Apache Maven no NetBeans 6.x</a>.</p>
</div>
<div class="paragraph">
<p>Para assistir a uma demonstração sobre como utilizar o Visualizador de artefato, consulte o screencast  <a href="https://netbeans.apache.org/kb/docs/java/maven-dependencies-screencast.html"> Trabalhando com dependências Maven</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_criando_o_projeto_do_aplicativo_da_plataforma_netbeans">Criando o projeto do aplicativo da plataforma NetBeans</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nesta seção será utilizado o assistente Novo projeto para criar um aplicativo da plataforma NetBeans a partir de um arquétipo Maven. O assistente criará os projetos do módulo Maven que serão necessários para desenvolver um aplicativo da plataforma NetBeans. Será utilizado também o assistente Novo projeto para criar o módulo NetBeans.</p>
</div>
<div class="sect2">
<h3 id="_criando_o_projeto">Criando o projeto</h3>
<div class="paragraph">
<p>Siga as seguintes etapas para criar o aplicativo da plataforma NetBeans utilizando o assistente do Novo projeto.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Selecione Arquivo &gt; Novo projeto (Ctrl-Shift-N) para abrir o assistente do Novo projeto.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Selecione Aplicativo NetBeans Maven na categoria Maven. Clique em Próximo.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Digite <strong>MavenPlatformCRUDApp</strong> para o nome do projeto e defina a localização do projeto. Clique em Concluir.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
é possível clicar em Próximo e criar um projeto do módulo no assistente ao criar o aplicativo da plataforma, mas para fins de demonstração neste tutorial, será criado o aplicativo e o módulo separadamente.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mavencrud-new-project.png" alt="mavencrud new project">
</div>
<div class="title">Figure 2. Captura de tela do assistente do Novo projeto</div>
</div>
<div class="paragraph">
<p>Ao clicar em Concluir, por padrão, o IDE cria os seguintes tipos de projetos Maven.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Aplicativo da plataforma NetBeans.</strong> Este projeto é um projeto recipiente para o aplicativo da plataforma e lista os modelos a serem incluídos e a localização dos repositórios do projeto. Este projeto não contém nenhuma origem. O IDE gera os módulos contendo as origens e recursos nos subdiretórios deste projeto.</p>
</li>
<li>
<p><strong>Plataforma NetBeans com base no aplicativo.</strong> Este projeto especifica os artefatos (fontes) necessários para a compilação do aplicativo. As dependências exigidas (artefatos IDE, artefatos de módulos) são especificados no arquivo  <code>pom.xml</code>  do projeto.</p>
</li>
<li>
<p><strong>Recursos da marca do aplicativo da plataforma.</strong> Este projeto contém os recursos utilizados para identificação da marca do aplicativo.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mavencrud-projects-window1.png" alt="mavencrud projects window1">
</div>
<div class="title">Figure 3. Estrutura do projeto na janela Projetos</div>
</div>
<div class="paragraph">
<p><strong>Notas.</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Caso este seja seu primeiro aplicativo da plataforma NetBeans utilizando o Maven, pode ser que leve mais tempo para criar os projetos, pois o IDE precisa baixar todos os artefatos necessários a partir do repositório NetBeans.</p>
</li>
<li>
<p>Ao criar o projeto, será possível ver que alguns dos projetos (por exemplo, o projeto do aplicativo com base na Plataforma NetBeans) são evidenciados porque algumas das dependências declaradas no arquivo (POM) <code>pom.xml</code>  não se encontram disponíveis.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_criando_um_módulo">Criando um módulo</h3>
<div class="paragraph">
<p>Neste exercício será utilizado o assistente do Novo projeto para criar o módulo NetBeans.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Selecione Arquivo &gt; Novo projeto (Ctrl-Shift-N) para abrir o assistente do Novo projeto.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Selecione Módulo NetBeans Maven na categoria Maven. Clique em Próximo.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Digite <strong>MavenPlatformCRUDApp-dbaccess</strong> para o Nome do projeto.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Especifique a localização do projeto clicando em Navegador e localizando o diretório <strong>MavenPlatformCRUDApp-dbaccess</strong>. Clique em Abrir.
image::images/mavencrud-select-location.png[title="caixa de diálogo Selecionar localização do projeto mostrando o diretório do projeto"]</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Clique em Concluir.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ao clicar em Concluir, o assistente cria um projeto de módulo NetBeans chamado <strong>MavenPlatformCRUDApp-dbaccess</strong>. O módulo será automaticamente configurado para ser incluído no aplicativo ao ser salvo num subdiretório. Caso abra o POM para o projeto, é possível notar que o MavenPlatformCRUDApp foi declarado como o projeto pai.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;parent&gt;
    &lt;artifactId&gt;MavenPlatformCRUDApp&lt;/artifactId&gt;
    &lt;groupId&gt;com.mycompany&lt;/groupId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
&lt;/parent&gt;
&lt;artifactId&gt;MavenPlatformCRUDApp-dbaccess&lt;/artifactId&gt;
&lt;packaging&gt;nbm&lt;/packaging&gt;
&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
&lt;name&gt;MavenPlatformCRUDApp - dbaccess NetBeans Module&lt;/name&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>É possível alterar a exibição do nome para o módulo editando o elemento  <code>&lt;nome&gt;</code>  no POM ou modificando o nome na janela Propriedades do projeto. O nome de exibição padrão é a Id do artefato do projeto  <code>MavenPlatformCRUDApp-dbaccess</code> .</p>
</div>
<div class="paragraph">
<p>Se observar o POM para o aplicativo da plataforma NetBeans sob o nó Arquivos do projeto na janela Projetos, é possível notar que três módulos estão listados como módulos no aplicativo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;modules&gt;
   &lt;module&gt;branding&lt;/module&gt;
   &lt;module&gt;application&lt;/module&gt;
   &lt;module&gt;MavenPlatformCRUDApp-dbaccess&lt;/module&gt;
&lt;/modules&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tornando_o_módulo_uma_dependência">Tornando o módulo uma dependência</h3>
<div class="paragraph">
<p>Agora será necessário adicionar o módulo como uma dependência do aplicativo com base na plataforma NetBeans. É possível adicionar a dependência editando  <code>pom.xml</code>  no editor ou utilizando a caixa de diálogo Adicionar dependência.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Amplie o nó <strong>Aplicativo com base na plataforma NetBeans</strong> na janela Projetos.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Clique com o botão direito do mouse no nó Bibliotecas e selecione Adicionar dependência.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Clique na aba Abrir projetos e selecione <strong>MavenPlatformCRUDApp - dbaccess</strong>. Clique em OK.
image::images/mavencrud-add-dependency1.png[title="aba Abrir projetos na caixa de diálogo Adicionar dependência"]</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Caso amplie o nó Bibliotecas do aplicativo com base na plataforma NetBeans na janela Projetos, é possível notar que o MavenPlatformCRUDApp-dbaccess está agora listado como uma dependência.</p>
</div>
<div class="paragraph">
<p>Se observar o POM do aplicativo com base na plataforma NetBeans, verá que o artefato  <code>MavenPlatformCRUDApp-dbaccess</code>  está listado como uma dependência necessária para a compilação do aplicativo. O artefato estará disponível após a construção do projeto do módulo e a instalação do artefato no seu repositório local.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;${project.groupId}&lt;/groupId&gt;
    &lt;artifactId&gt;*MavenPlatformCRUDApp-dbaccess*&lt;/artifactId&gt;
    &lt;version&gt;${project.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_marcando_o_aplicativo">Marcando o aplicativo</h3>
<div class="paragraph">
<p>O módulo da marca especifica os recursos da marca que são utilizados ao construir o aplicativo da plataforma. A caixa de diálogo da marca lhe permite especificar facilmente o nome do aplicativo, a tela de splash e o ícone do aplicativo e modificar os valores dos elementos do texto.</p>
</div>
<div class="paragraph">
<p>Neste exercício será substituída a imagem de splash padrão. Por padrão, o módulo da marca gerado pelo IDE contém uma imagem que é exibida ao iniciar o aplicativo da plataforma. É possível substituí-la por uma imagem diferente executando os passos a seguir.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Clique com o botão direito no módulo <strong>Recursos da marca do aplicativo da plataforma</strong> na janela Projetos e selecione Marca.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Na aba Tela de splash, especifique uma imagem para utilizar como a tela de splash clicando no botão Navegador ao lado da imagem da tela de splash e localizando a imagem que deseja utilizar. Clique em OK.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Por exemplo, é possível copiar a imagem abaixo no sistema local e especificar a imagem na caixa de diálogo Marca.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/splash-crud.gif" alt="splash crud">
</div>
<div class="title">Figure 4. Exemplo de imagem de splash padrão</div>
</div>
<div class="paragraph">
<p>Ao iniciar o aplicativo, a nova imagem aparecerá durante a inicialização.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_criando_as_classes_de_entidade">Criando as classes de entidade</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nesta seção será possível gerar algumas entidades a partir das tabelas no banco de dados do Java DB. Para criar as classes de entidades e utilizar o Java Persistence API (JPA) no seu aplicativo, é necessário ter acesso ao servidor do banco de dados e às bibliotecas do provedor de persistência JPA. Este tutorial usa o servidor do banco de dados do JavaDB, mas é possível configurar o aplicativo para utilizar outros servidores de banco de dados.</p>
</div>
<div class="paragraph">
<p>O jeito mais fácil de tornar os recursos disponíveis é registrar uma instância do GlassFish Server Open Source Edition 3.0.1 que vem com o IDE. O servidor do banco de dados do Java DB, um banco de dados modelo e um provedor de persistência JPA estão incluídos no servidor GlassFish. Antes de criar classes de entidades, inicie o Java DB executando os passos a seguir.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Na janela Serviços, amplie o nó Servidores e verifique se há uma instância GlassFish registrada.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Amplie o nó Banco de dados, clique com o botão direito no nó conexão do banco de dados para o <strong>banco de dados</strong> do aplicativo no Java DB ( <code>jdbc:derby://localhost:1527/sample [app on APP]</code>  e selecione Conectar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ao selecionar Conectar, o IDE iniciará o banco de dados, caso este já não tenha sido iniciado.</p>
</div>
<div class="sect2">
<h3 id="_adicionando_do_derbyclient_como_uma_dependência_do_tempo_de_execução">Adicionando do DerbyClient como uma dependência do tempo de execução</h3>
<div class="paragraph">
<p>Nesta seção será possível adicionar a biblioteca do derbyclient-10.5.3.0_1 como uma dependência.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Clique com o botão direito no nó Bibliotecas do módulo <strong>dbaccess</strong> e selecione Adicionar dependência.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Adicione a biblioteca digitando <strong>org.apache.derby</strong> para a Id do grupo, <strong>derbyclient</strong> para a Id do artefato e <strong>10.5.3.0_1</strong> para a Versão.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Selecione <strong>Tempo de execução</strong> na lista suspensa Escopo. Clique em OK.
image::images/mavencrud-add-dependency-derby.png[title="Adição do JAR derbyclient na caixa de diálogo Adicionar dependência"]</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Caso amplie o nó Bibliotecas do tempo de execução na janela Projetos, é possível notar que a biblioteca  <code>derbyclient</code>  está listada como uma dependência.</p>
</div>
<div class="paragraph">
<p>Também é possível modificar o POM no editor para especificar o valor do elemento  <code>&lt;escopo&gt;</code>  de uma dependência.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependência&gt;
            &lt;Id do grupo&gt;org.apache.derby&lt;/Id do grupo&gt;
            &lt;Id do artefato&gt;derbyclient&lt;/Id do artefato&gt;
            &lt;versão&gt;10.5.3.0_1&lt;/versão&gt;
            &lt;escopo&gt;tempo de execução&lt;/escopo&gt;
        &lt;/dependência&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_gerando_classes_de_entidade_a_partir_do_banco_de_dados">Gerando classes de entidade a partir do banco de dados</h3>
<div class="paragraph">
<p>Nesta seção será utilizado um assistente para gerar classes de entidade no módulo <strong>dbaccess</strong>.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Clique com o botão direito em Pacotes originais do módulo <strong>dbaccess</strong> e selecione Novo &gt; Outro.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Selecione Classes de entidade a partir do banco de dados na categoria Persistência. Clique em Próximo.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Selecione o banco de dados modelo Java DB na lista suspensa Conexão do banco de dados.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Selecione a tabela Cliente na lista Tabelas disponíveis, e clique em Adicionar. Ao clicar em Adicionar, a tabela relacionada Códigodedesconto também é adicionada à lista Tabelas selecionadas. Clique em Próximo.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Digite <strong>com.mycompany.mavenplatformcrudapp.dbaccess</strong> para o nome do pacote. Certifique-se de que os comandos Criar unidade de persistência e Gerar anotações de consultas nomeadas estejam selecionados. Clique em Concluir.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ao clicar em Concluir, o IDE gera as classes de entidade Cliente e Código de desconto. O IDE também gera o arquivo  <code>persistence.xml</code> no pacote  <code>META-INF</code>  sob o nó Outras fontes, no diretório  <code>src/main/resources</code> .</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ler_leitura_e_exibição_de_um_registro">LER: Leitura e Exibição de um registro</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nesta seção será utilizado um assistente para adicionar um Componente de janela ao módulo <strong>dbaccess</strong>. Será ativada uma visualização de árvore no componente de janela exiba os objetos como nós. É possível visualizar os dados para cada registro na janela de propriedades dos nós.</p>
</div>
<div class="sect2">
<h3 id="_adicionando_um_componente_de_janela">Adicionando um Componente de janela</h3>
<div class="paragraph">
<p>Neste exercício será criado o componente de janela.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Clique com o botão direito do mouse no nó Projeto na janela Projetos e selecione Nova &gt; Janela.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Selecione: <strong>editor*na lista suspensa Posição da janela e selecione *Abrir na inicialização do aplicativo</strong>. Clique em Próximo.
image::images/mavencrud-new-window-customer.png[title="página Configuração básica do assistente Nova janela"]</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Digite: <strong>Cliente</strong> como o Prefixo do nome da classe.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Digite: <strong>com.mycompany.mavenplatformcrudapp.viewer</strong> para o pacote. Clique em Concluir.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>O assistente exibe uma lista de arquivos que serão criados e modificados.</p>
</div>
<div class="paragraph">
<p>Ao clicar em Concluir, na janela Projetos, é possível notar que o IDE gera a classe  <code>CustomerTopComponent.java</code>  em  <code>com.mycompany.mavenplatformcrudapp.viewer</code>  sob Pacotes originais. É possível visualizar a estrutura do projeto na janela Arquivos. Para compilar um projeto Maven, somente podem ser localizados arquivos de origem sob o diretório Pacotes originais ( <code>src/main/java</code>  na janela Arquivos). Arquivos de recursos (ex. arquivos XML) devem estar localizados sob o diretório Outras fontes ( <code>src/main/resources</code> na janela Arquivos).</p>
</div>
</div>
<div class="sect2">
<h3 id="_adicionando_uma_visualização_de_árvore">Adicionando uma visualização de árvore</h3>
<div class="paragraph">
<p>Agora será modificado o componente de janela a fim de exibir registros do banco de dados numa visualização de árvore. Será adicionado o gerenciador de entidade ao construtor e ativará uma visualização de árvore bean.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Clique na aba Origem do  <code>CustomerTopComponent.java</code>  para visualizar o código da fonte no editor.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Modifique o construtor para adicionar os seguintes comandos.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">EntityManager entityManager = Persistence.createEntityManagerFactory("com.mycompany_MavenPlatformCRUDApp-dbaccess_nbm_1.0-SNAPSHOTPU").createEntityManager();
    Query query = entityManager.createQuery("SELECT c FROM Customer c");
    List&lt;Customer&gt; resultList = query.getResultList();*EntityManager entityManager = Persistence.createEntityManagerFactory("com.mycompany_MavenPlatformCRUDApp-dbaccess_nbm_1.0-SNAPSHOTPU").createEntityManager();
    Query query = entityManager.createQuery("SELECT c FROM Customer c");
    List&lt;Customer&gt; resultList = query.getResultList();*}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Certifique-se de que o nome da unidade persistente no código esteja correto comparando-o ao nome especificado no  <code>persistence.xml</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Modifique a assinatura de classe para implementar o  <code>ExplorerManager.Provider.</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public final class CustomerTopComponent extends TopComponent *implements ExplorerManager.Provider*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Corrija as importações para importar o  <code><strong>javax.persistence.Query</strong></code>  e o  <code><strong>javax.util.List</strong></code> .</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Declare e inicialize o ExplorerManager:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private static ExplorerManager em = new ExplorerManager();</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Implemente os métodos abstratos e modifique o método  <code>getExplorerManager</code>  para retornar  <code>em</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public ExplorerManager getExplorerManager() {
    return em;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>É possível colocar o cursor de inserção na assinatura de classe e pressionar Alt+Enter para implementar os métodos abstratos.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Adicione os comando seguintes ao construtor para ativar a visualização de árvore.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">BeanTreeView beanTreeView = new BeanTreeView();
adicionar(beanTreeView, BorderLayout.CENTER);</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Na visualização Desenho, clique com o botão direito no componente e selecione Definir Layout &gt; Layout da borda. Salve as alterações.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_criação_de_uma_classe_de_fábrica">Criação de uma Classe de fábrica</h3>
<div class="paragraph">
<p>Agora será criado criar uma nova classe <strong>CustomerChildFactory</strong> no pacote  <code>com.mycompany.mavenplatformcrudapp.viewer</code>  que cria um novo BeanNode para cada cliente no seu banco de dados.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Clique com o botão direito no pacote  <code><strong>com.mycompany.mavenplatformcrudapp.viewer</strong></code> e selecione Nova &gt; Classe Java.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Digite <strong>CustomerChildFactory</strong> para o Nome da classe. Clique em Concluir.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Modifique a assinatura para estender  <code>ChildFactory&lt;Cliente&gt;</code> .</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Declare o campo  <code>resultList</code>  para a lista de itens na tabela e adicione o método  <code>CustomerChildFactory</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private List&lt;Customer&gt; resultList;

public CustomerChildFactory(List&lt;Customer&gt; resultList) {
    this.resultList = resultList;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Implemente e, a seguir, modifique o método abstrato  <code>createKeys</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
    protected boolean createKeys(List&lt;Customer&gt; list) {
      for (Customer customer : resultList) {
          list.add(customer);
      }
      return true;
    }</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Adicione um método par criar nós.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
protected Node createNodeForKey(Customer c) {
    try {
        return new BeanNode(c);
    } catch (IntrospectionException ex) {
        Exceptions.printStackTrace(ex);
        return null;
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Corrija as importações para importar o  <code>org.openide.nodes.Node</code>  e o  <code>java.beans.InstrospectionException</code> . Salve as alterações.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A classe se parecerá com:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package com.mycompany.mavenplatformcrudapp.viewer;

import com.mycompany.mavenplatformcrudapp.dbaccess.Customer;
import java.beans.IntrospectionException;
import java.util.List;
import org.openide.nodes.BeanNode;
import org.openide.nodes.ChildFactory;
import org.openide.nodes.Node;
import org.openide.util.Exceptions;

public class CustomerChildFactory extends ChildFactory&lt;Customer&gt; {

    private List&lt;Customer&gt; resultList;

    public CustomerChildFactory(List&lt;Customer&gt; resultList) {
        this.resultList = resultList;
    }    @Override
    protected boolean createKeys(List&lt;Customer&gt; list) {
        for (Customer customer : resultList) {
            list.add(customer);
        }        return true;    }
    @Override    protected Node createNodeForKey(Customer c) {        try {
            return new BeanNode(c);
        } catch (IntrospectionException ex) {
            Exceptions.printStackTrace(ex);
            return null;
        }    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>É necessário modificar o <strong>CustomerTopComponent</strong> para utilizar o ExplorerManager para passar a lista de resultados da consulta JPA para o Nó.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Adicione as linhas a seguir ao construtor CustomerTopComponent para definir o contexto da raiz para os nós e para adicionar o ActionMap do TopComponent e o ExplorerManager à Pesquisa do TopComponent.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">    EntityManager entityManager =  Persistence.createEntityManagerFactory("com.mycompany_MavenPlatformCRUDApp-dbaccess_nbm_1.0-SNAPSHOTPU").createEntityManager();
    Query query = entityManager.createQuery("SELECT c FROM Customer c");
    List&lt;Customer&gt; resultList = query.getResultList();
    *em.setRootContext(new AbstractNode(Children.create(new CustomerChildFactory(resultList), true)));
    associateLookup(ExplorerUtils.createLookup(em, getActionMap()));*</code></pre>
</div>
</div>
<div class="paragraph">
<p>Isto sincronizará a janela propriedades e o texto da dica de ferramenta para cada nó selecionado.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Corrija as importações e salve as alterações.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_executando_do_aplicativo">Executando do aplicativo</h3>
<div class="paragraph">
<p>Neste exercício será testado o aplicativo para confirmar que este é capaz de acessar e ler corretamente as tabelas do banco de dados. Antes de construir e executar o aplicativo é necessário modificar o POM pois o aplicativo exige uma dependência direta nos JARs  <code>org-openide-nodes</code>  e  <code>org-openide-explorer</code> . É possível modificar a dependência na janela Projetos.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Amplie o nó Bibliotecas do módulo <strong>dbaccess</strong>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Clique com o botão direito no JAR  <code>org-openide-nodes</code>  e selecione Declarar como dependência direta.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Clique com o botão direito no JAR  <code>org-openide-explorer</code>  e selecione Declarar como dependência direta.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Clique com o botão direito no <strong>aplicativo com base na plataforma NetBeans MavenPlatformCRUDApp</strong> e selecione Construir com dependências.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A Janela de saída exibe os módulos que serão incluídos.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mavencrud-build-output1.png" alt="mavencrud build output1">
</div>
<div class="title">Figure 5. Janela de saída mostrando a ordem de construção</div>
</div>
<div class="paragraph">
<p>A Janela de saída exibe também o status da construção.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mavencrud-build-output2.png" alt="mavencrud build output2">
</div>
<div class="title">Figure 6. Janela de saída mostrando que a construção foi bem sucedida</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Clique com o botão direito do mouse no aplicativo e selecione Executar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ao iniciar o aplicativo, a janela Cliente aparecerá com um nó para cada um dos registros na tabela do banco de dados.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mavencrud-customer-window1.png" alt="mavencrud customer window1">
</div>
<div class="title">Figure 7. janela Cliente no aplicativo</div>
</div>
<div class="paragraph">
<p>É possível clicar com o botão direito num nó na árvore da janela Cliente e selecionar Propriedades, para visualizar detalhes adicionais sobre o item.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mavencrud-read-properties.png" alt="mavencrud read properties">
</div>
<div class="title">Figure 8. janela Propriedades mostrando detalhes do nó selecionado</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_atualizaÇÃo_edição_de_um_registro">ATUALIZAÇÃO: Edição de um registro</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nesta seção será adicionado um componente de janela para editar os detalhes de um registro.</p>
</div>
<div class="sect2">
<h3 id="_criando_a_janela_editor">Criando a janela Editor</h3>
<div class="paragraph">
<p>Neste exercício será criada uma nova janela MyEditor a qual conterá dois campos de texto para a edição dos campos do nome e da cidade do nó selecionado. Será então modificado o arquivo  <code>layer.xml</code>  de maneira que a janela Cliente seja aberta no modo explorer ao invés de no modo editor.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Clique com o botão direito no módulo <strong>dbaccess</strong> e selecione Nova &gt; Janela.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Selecione <strong>editor</strong> na lista suspensa e selecione <strong>Abrir na inicialização do aplicativo</strong>. Clique em Próximo.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Digite <strong>MyEditor</strong> como o Prefixo do nome de classe.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Digite <strong>com.mycompany.mavenplatformcrudapp.editor</strong> como o pacote. Clique em Concluir.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Adicione dois JLabels e dois JTextFileds na visualização Desenho do  <code>MyEditorTopComponent</code> .</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Defina os textos dos rótulos como "Nome" e "Cidade" e defina os nomes das variáveis dos dois JTextFields como  <code><strong>jTextField1</strong></code>  e  <code><strong>jTextField2</strong></code> . Salve as alterações.
image::images/mavencrud-myeditor-window.png[title=" Componente de janela na visualização Desenho"]</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Amplie o nó Arquivos importantes na janela Projetos e clique duas vezes na <strong>Camada XML</strong> para abrir o arquivo  <code>layer.xml</code>  no editor.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Modifique  <code>layer.xml</code>  para especificar que a janela CustomerTopComponent aparecerá no modo explorer. Salve as alterações.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;folder name="Modes"&gt;
    &lt;folder name="editor"........&lt;file name="MyEditorTopComponent.wstcref" url="MyEditorTopComponentWstcref.xml"/&gt;
    &lt;/folder&gt;*&lt;folder name="explorer"&gt;
        &lt;file name="CustomerTopComponent.wstcref" url="CustomerTopComponentWstcref.xml"/&gt;
    &lt;/folder&gt;*&lt;/folder&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Agora é possível testar o aplicativo para certificar-se de que as janelas estejam abertas e situadas no local correto.</p>
</div>
<div class="paragraph">
<p>Lembre-se de limpar o aplicativo antes de construir utilizando dependências.</p>
</div>
<div class="paragraph">
<p>Agora é possível adicionar o código de maneira que ao selecionar um nó na janela Cliente, os campos do nome e da cidade do objeto estejam exibidos no editor.</p>
</div>
</div>
<div class="sect2">
<h3 id="_utilizando_um_lookuplistener">Utilizando um LookupListener</h3>
<div class="paragraph">
<p>Neste exercício será possível modificar a janela Cliente de maneira que quando um nó estiver selecionado, um novo objeto  <code>Cliente</code>  é adicionado à função Pesquisar do nó. Será então modificado o MyEditor de maneira que a janela implementará o  <code> <a href="http://bits.netbeans.org/dev/javadoc/org-openide-util-lookup/org/openide/util/LookupListener.html">LookupListener</a></code>  para ouvir os objetos  <code>Clientes</code>  que foram adicionados à função Pesquisar.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Modifique o método  <code>createNodeForKey</code>  em <strong>CustomerChildFactory</strong> para criar um  <code>AbstractNode</code>  ao invés de um  <code>BeanNode</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
protected Node createNodeForKey(Customer c) {*Node node = new AbstractNode(Children.LEAF, Lookups.singleton(c));
  node.setDisplayName(c.getName());
  node.setShortDescription(c.getCity());
  return node;*//        tente {
//            retorne o novo BeanNode(c);
//        } capture (IntrospectionException ex) {
//            Exceptions.printStackTrace(ex);
//            retorne nulo;
//        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ao selecionar um novo nó na janela Cliente, o objeto selecionado  <code>Cliente</code>  é adicionado à função Pesquisar da janela.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Clique na aba Origem do <strong>MyEditorTopComponent</strong> e modifique a assinatura da classe para implementar o  <code>LookupListener</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public final class MyEditorTopComponent extends TopComponent *implementa o LookupListener*</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Adicione uma variável para armazenar os resultados.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private Lookup.Result result = null;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Implemente os métodos abstratos necessários para adicionar o método  <code>resultChanged</code> .</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Modifique o método  <code>resultChanged</code>  para atualizar o jTextFields toda vez que um novo objeto  <code>Cliente</code>  for introduzido na função Pesquisar.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">      @Override
      public void resultChanged(LookupEvent le) {
          Lookup.Result r = (Lookup.Result) le.getSource();
          Collection&lt;Customer&gt; coll = r.allInstances();
          if (!coll.isEmpty()) {
              for (Customer cust : coll) {
                  jTextField1.setText(cust.getName());
                  jTextField2.setText(cust.getCity());
              }
          } else {
              jTextField1.setText("[no name]");
              jTextField2.setText("[no city]");
          }
      }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Após definir o LookupListener, é possível adicioná-lo ao  <code>Lookup.Result</code>  obtido a partir do contexto global. O contexto global aproxima o contexto do nó selecionado. Por exemplo, se o "Ford Motor Co" estiver selecionado na hierarquia da árvore, o objeto  <code>Cliente</code>  para "Ford Motor Co" é adicionado à função Pesquisar do nó. Como este é o nó atualmente selecionado, o objeto  <code>Cliente</code>  para "Ford Motor Co" está agora disponível no contexto global. Isso é, então, o que é passado para o  <code>resultChanged</code> , fazendo com que os campos de texto sejam preenchidos.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Modifique os métodos  <code>componentOpened</code>  e  <code>componentClosed</code>  para ativar o LookupListener ao abrir a janela editor.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">      @Override
      public void componentOpened() {
          result = WindowManager.getDefault().findTopComponent("CustomerTopComponent").getLookup().lookupResult(Customer.class);
          result.addLookupListener(this);
          resultChanged(new LookupEvent(result));
      }

      @Override
      public void componentClosed() {
          result.removeLookupListener(this);
          result = null;
      }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Como a janela editor está configurada para ser aberta quando for iniciado o aplicativo, o LookupListener também estará disponível na hora em que o aplicativo for iniciado.</p>
</div>
<div class="paragraph">
<p>Neste exemplo está sendo utilizada a função Pesquisar fornecida pela janela Cliente. A janela é identificada explicitamente neste caso pela string " <code>CustomerTopComponent</code> ". A string é especificada no código de origem do  <code>CustomerTopComponent</code>  como a ID do CustomerTopComponent. Esta abordagem funciona somente se o MyEditorTopComponent puder encontrar um TopComponent com a ID "CustomerTopComponent".</p>
</div>
<div class="paragraph">
<p>Uma abordagem mais flexível que envolve a regravação do modelo de seleção é descrita por Tim Bordeau, nesta  <a href="http://weblogs.java.net/blog/timboudreau/archive/2007/01/how_to_replace.html">entrada de blog</a>.</p>
</div>
<div class="paragraph">
<p>É possível executar o aplicativo novamente após executar o comando Limpar e Construir com dependências. A janela editor estará atualizada ao selecionar um novo nó na janela Cliente. Nenhuma propriedade está exibida na janela Propriedades do nó uma vez que está sendo utilizado agora o  <code>AbstractNode</code>  ao invés do  <code>BeanNode</code> .</p>
</div>
</div>
<div class="sect2">
<h3 id="_adição_dos_comandos_desfazer_e_refazer">Adição dos comandos Desfazer e Refazer</h3>
<div class="paragraph">
<p>Neste exercício serão ativadas funções Desfazer e Refazer ao implementar o gerenciador  <code> <a href="http://bits.netbeans.org/dev/javadoc/org-openide-awt/org/openide/awt/UndoRedo.html">UndoRedo</a></code> . Os botões Desfazer e Refazer na barra de ferramentas e os itens do menu Desfazer e Refazer serão ativados quando um usuário fizer uma alteração num dos campos na janela Editor.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Declare e instancie um novo UndoRedoManager na parte superior do MyEditorTopComponent.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private UndoRedo.Manager manager = new UndoRedo.Manager();</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Crie um método  <code>getUndoRedo()</code>  no MyEditorTopComponent:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public UndoRedo getUndoRedo() {
  return manager;
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Adicione os seguintes comandos ao construtor.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">jTextField1.getDocument().addUndoableEditListener(manager);
jTextField2.getDocument().addUndoableEditListener(manager);</code></pre>
</div>
</div>
<div class="paragraph">
<p>É possível executar o aplicativo para testar os botões e itens do menu para as funções Desfazer e Refazer que estão em funcionamento.</p>
</div>
</div>
<div class="sect2">
<h3 id="_adicionando_a_função_salvar">Adicionando a função Salvar</h3>
<div class="paragraph">
<p>Neste exercício será integrada a função Salvar plataforma NetBeans. O arquivo  <code>layer.xml</code> será modificado para ocultar o botão "Salvar tudo" na barra de ferramentas e para adicionar o botão "Salvar". Serão adicionados então listeners para detectar alterações nos campos de texto e um método  <code>ativar</code>  que é ativado quando é detectada uma mudança.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Abra e modifique o arquivo  <code>layer.xml</code>  do módulo <strong>dbaccess</strong> para adicionar um elemento Barra de ferramenta.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">    *&lt;folder name="Toolbars"&gt;
      &lt;folder name="File"&gt;
          &lt;file name="org-openide-actions-SaveAction.shadow"&gt;
              &lt;attr name="originalFile" stringvalue="Actions/System/org-openide-actions-SaveAction.instance"/&gt;
              &lt;attr name="position" intvalue="444"/&gt;
          &lt;/file&gt;
          &lt;file name="org-openide-actions-SaveAllAction.shadow_hidden"/&gt;
      &lt;/folder&gt;
    &lt;/folder&gt;*&lt;/filesystem&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>No construtor <strong>MyEditorTopComponent</strong>, adicione a chamada seguinte para acionar um método quando for detectada uma alteração nos campos de texto.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public MyEditorTopComponent() {

          ...
    jTextField1.getDocument().addUndoableEditListener(manager);
    jTextField2.getDocument().addUndoableEditListener(manager);

    *jTextField1.getDocument().addDocumentListener(new DocumentListener() {
        public void insertUpdate(DocumentEvent arg0) {
          fire(true);
        }
        public void removeUpdate(DocumentEvent arg0) {
          fire(true);
        }
        public void changedUpdate(DocumentEvent arg0) {
          fire(true);
        }
    });

    jTextField2.getDocument().addDocumentListener(new DocumentListener() {
        public void insertUpdate(DocumentEvent arg0) {
          fire(true);
        }
        public void removeUpdate(DocumentEvent arg0) {
          fire(true);
        }
        public void changedUpdate(DocumentEvent arg0) {
          fire(true);
        }
    });

    //Cria uma nova instância para a implementação SaveCookie:
    impl = new SaveCookieImpl();

    //Cria uma nova instância para o objeto dinâmico:
    content = new InstanceContent();

    //Adiciona o objeto dinâmico ao TopComponent Lookup:
    associateLookup(new AbstractLookup(content));*

    ...
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Adicione o método  <code>acionar</code>  que é chamado sempre que é detectada uma alteração.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public void fire(boolean modified) {
  if (modified) {
      //Se o texto for modificado,
      //adicione SaveCookie impl ao Lookup:
      content.add(impl);
  } else {
      //Do contrário, remova o SaveCookie impl do lookup:
      content.remove(impl);
  }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Adicione a implementação a seguir da função  <code> <a href="http://bits.netbeans.org/dev/javadoc/org-openide-nodes/org/openide/cookies/SaveCookie.html">SalvarCookie</a></code>  que foi adicionada à  <code>InstanceContent</code>  pelo método  <code>acionar</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private class SaveCookieImpl implements SaveCookie {

  @Override
  public void save() throws IOException {

     Confirmation message = new NotifyDescriptor.Confirmation("Do you want to save \""
              + jTextField1.getText() + " (" + jTextField2.getText() + ")\"?",
              NotifyDescriptor.OK_CANCEL_OPTION,
              NotifyDescriptor.QUESTION_MESSAGE);

      Object result = DialogDisplayer.getDefault().notify(message);
      //Quando o usuário clica em "Sim", indicando que realmente deseja salvar,
      //é necessário desabilitar a ação Salvar,
      //de forma que isto só será utilizável quando for feita a próxima mudança       //à JTextArea:
      if (NotifyDescriptor.YES_OPTION.equals(result)) {
          acionar(falso);
          //Implemente aqui a função salvar.
      }
  }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Adicione os campos a seguir ao MyEditorTopComponent.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private final SaveCookieImpl impl;
private final InstanceContent content;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Corrija as importações e salve as alterações.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Clique com o botão direito no JAR  <code>org-opnide-dialogs</code>  sob o nó Bibliotecas na janela Projetos e selecione Declarar como dependência direta.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>É possível agora limpar, construir com dependências e executar o aplicativo para confirmar que o botão Salvar esteja ativado ao modificar um campo de texto.</p>
</div>
</div>
<div class="sect2">
<h3 id="_alterações_persistentes">Alterações persistentes</h3>
<div class="paragraph">
<p>No próximo exercício será adicionado o código para persistir as alterações. No momento, o aplicativo reconhece corretamente quando uma alteração é feita num campo e ativa a opção para salvar as mudanças. Ao clicar em Salvar, aparece uma caixa de diálogo solicitando que confirme que deseja salvar as alterações. No entanto, as alterações não persistem quando clica em OK na caixa de diálogo. Para vigorar as alterações, é necessário adicionar alguns códigos JPA para controlar a persistência do banco de dados.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Adicione os campos a seguir ao <strong>MyEditorTopComponent</strong>.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">cliente Cliente privado;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Adicione o código JPA para vigorar as alterações modificando o método  <code>salvar</code>  para substituir o comentário  <code>"//Implemente aqui a função Salvar." </code>  com o código a seguir.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public void save() throws IOException {
...
    if (NotifyDescriptor.YES_OPTION.equals(result)) {
        fire(false); * EntityManager entityManager = Persistence.createEntityManagerFactory("com.mycompany_MavenPlatformCRUDApp-dbaccess_nbm_1.0-SNAPSHOTPU").createEntityManager();
        entityManager.getTransaction().begin();
        Customer c = entityManager.find(Customer.class, customer.getCustomerId());
        c.setName(jTextField1.getText());
        c.setCity(jTextField2.getText());
        entityManager.getTransaction().commit();*    }}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verifique se o nome da unidade persistente está correto.</p>
</div>
<div class="paragraph">
<p>O "cliente" em  <code>customer.getCustomerId()</code> está atualmente indefinido. Na próxima etapa será definido o  <code>cliente</code>  como o objeto atual  <code>Cliente</code>  usado para obter a ID do Cliente.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Adicione a linha a seguir em negrito ao método  <code>resultChanged</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public void resultChanged(LookupEvent le) {
    Lookup.Result r = (Lookup.Result) le.getSource();
    Collection&lt;Customer&gt; coll = r.allInstances();
    if (!coll.isEmpty()) {
      for (Customer cust : coll) {
          *customer = cust;*           jTextField1.setText(cust.getName());
          jTextField2.setText(cust.getCity());
      }
    } else {
      jTextField1.setText("[no name]");
      jTextField2.setText("[no city]");
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Corrija as importações e salve as alterações.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>É possível executar o aplicativo e alterar alguns dados para testar se a função Salvar está funcionando corretamente e se persistem as alterações. No momento, o editor não atualiza os campos para refletir os dados alterados. Para verificar se os dados persistem será necessário reiniciar o aplicativo.</p>
</div>
<div class="paragraph">
<p>No próximo exercício será adicionada uma função "Atualizar" que recarregará os dados do banco de dados e lhe permitirá visualizar as alterações no editor.</p>
</div>
</div>
<div class="sect2">
<h3 id="_adição_da_função_atualizar">Adição da função Atualizar</h3>
<div class="paragraph">
<p>Neste exercício será adicionada a funcionalidade para atualizar o observador do Cliente adicionando um item de menu "Atualizar" ao nó raiz na janela Cliente.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Clique com o botão direito do mouse no pacote  <code><strong>com.mycompany.mavenplatformcrudapp.viewer</strong></code> e selecione Nova &gt; Classe Java e crie uma classe chamada <strong>CustomerRootNode</strong>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Modifique a classe para ampliar o  <code>AbstractNode</code>  e adicione os seguintes métodos.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class CustomerRootNode extends AbstractNode {

    * public CustomerRootNode(Children kids) {
      super(kids);
      setDisplayName("Root");
    }

    @Override
    public Action[] getActions(boolean context) {
      Action[] result = new Action[]{
          new RefreshAction()};
      return result;
    }

    private final class RefreshAction extends AbstractAction {

      public RefreshAction() {
          putValue(Action.NAME, "Refresh");
      }

      public void actionPerformed(ActionEvent e) {
          CustomerTopComponent.refreshNode();
      }
    }*}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Observe que a ação "Atualizar" está vinculado ao novo nó Raiz.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Corrija as importações para importar * <code>javax.swing.Action</code> *. Salve as alterações.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Modifique <strong>CustomerTopComponent</strong> para adicionar o método seguinte para atualizar a visualização:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public static void refreshNode() {
    EntityManager entityManager = Persistence.createEntityManagerFactory("com.mycompany_MavenPlatformCRUDApp-dbaccess_nbm_1.0-SNAPSHOTPU").createEntityManager();
    Query query = entityManager.createQuery("SELECT c FROM Customer c");
    List&lt;Customer&gt; resultList = query.getResultList();
    em.setRootContext(new *CustomerRootNode*(Children.create(new CustomerChildFactory(resultList), true)));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Observe que o método usa <strong>CustomerRootNode</strong> para configuração do contexto de raiz.</p>
</div>
<div class="paragraph">
<p>Na classe  <code>CustomerRootNode</code> , é possível pressionar Alt+Enter na linha contendo  <code>refreshNode</code>  caso deseje que o IDE gere o esqueleto do método.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Modifique o código no construtor do CustomerTopComponent com uma chamada para <strong>CustomerRootNode</strong> ao invés de <strong>AbstractNode</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ao chamar o  <code>CustomerRootNode</code>  chama automaticamente o método  <code>refreshNode</code>  e invoca uma "Atualização".</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Corrija as importações e salve as alterações.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Caso execute o aplicativo, será possível ver que há um novo nó de raiz com uma ação "Atualizar" disponível no menu pop-up.</p>
</div>
<div class="paragraph">
<p>É possível reutilizar o método  <code>refreshNode</code>  e implementar uma atualização automática chamando o método  <code>refreshNode</code> do método  <code>salvar</code> . Alternativamente, seria possível criar um módulo separado contendo a ação atualizada e o módulo pode ser compartilhado entre os módulos.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_criar_adição_de_um_novo_registro">CRIAR: Adição de um novo registro</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nesta seção, você permite que o usuário crie uma nova entrada no banco de dados.</p>
</div>
<div class="sect2">
<h3 id="_adicionando_a_ação_criar">Adicionando a ação Criar</h3>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Clique com o botão direito do mouse no módulo <strong>dbaccess</strong> e selecione Nova &gt; Ação.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Selecione Sempre ativado. Clique em Próximo.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Selecione <strong>Arquivo</strong> na lista suspensa Categoria.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Selecione o botão Barra de ferramentas global. Clique em Próximo.
image::images/mavencrud-new-action.png[title="Registro GUI no assistente Nova ação"]</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Digite <strong>NovaAção</strong> para o nome da classe.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Digite <strong>Minha nova ação</strong> para o nome da exibição.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Clique no Navegador e selecione uma imagem que será usada na barra de ferramentas.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>É possível copiar a imagem a seguir  <code>abc16.png</code>  para a área de trabalho e especificar a imagem no assistente. ( 
image::images/abc16.png[title="Ícone do modelo 16 x 16"] )</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Selecione o pacote <strong>com.mycompany.mavenplatformcrudapp.editor</strong>. Clique em Concluir.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Modifique a classe  <code>NovaAção</code>  para abrir o MyEditorTopComponent e apagar os campos.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public final class NewAction implements ActionListener {

    public void actionPerformed(ActionEvent e) {
        MyEditorTopComponent tc = MyEditorTopComponent.getDefault();
        tc.resetFields();
        tc.open();
        tc.requestActive();
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A ação implementa a classe ActionListener, que está vinculada ao aplicativo através das entradas no arquivo de camada, colocada lá pelo assistente Nova ação.</p>
</div>
</div>
<div class="sect2">
<h3 id="_crianbdo_e_salvando_um_objeto_novo">Crianbdo e salvando um objeto novo</h3>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Em <strong>MyEditorTopComponent</strong>, adicione o método a seguir para redefinir o JTextFields e criar um novo objeto  <code>Cliente</code> .</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public void resetFields() {
    customer = new Customer();
    jTextField1.setText("");
    jTextField2.setText("");
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Na classe  <code>NovaAção</code>  é possível pressionar Alt+Enter na chamada para  <code>redefinirCampos</code>  se deseja que o IDE gere um esqueleto do método em MyEditorTopComponent.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Em SaveCookie, assegure-se de que um retorno de nulo indica que uma nova entrada foi salva, ao invés da atualização de uma entrada existente:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public void save() throws IOException {

    Confirmation message = new NotifyDescriptor.Confirmation("Do you want to save \""
                  + jTextField1.getText() + " (" + jTextField2.getText() + ")\"?",
                  NotifyDescriptor.OK_CANCEL_OPTION,
                  NotifyDescriptor.QUESTION_MESSAGE);

    Object result = DialogDisplayer.getDefault().notify(msg);

    //Quando o usuário clica em "Sim", indicando que realmente deseja salvar,
    //é necessário disabilitar o botão Salvar e o item do menu Salvar,     //de forma que isto só será utilizável quando for feita a próxima mudança     //ao campo de texto:
    if (NotifyDescriptor.YES_OPTION.equals(result)) {
        fire(false);
        EntityManager entityManager = Persistence.createEntityManagerFactory("CustomerLibraryPU").createEntityManager();
        entityManager.getTransaction().begin();
        *if (customer.getCustomerId() != null) {*             Customer c = entityManager.find(Customer.class, cude.getCustomerId());
            c.setName(jTextField1.getText());
            c.setCity(jTextField2.getText());
            entityManager.getTransaction().commit();￼        *} else {
            Query query = entityManager.createQuery("SELECT c FROM Customer c");
            List&lt;Customer&gt; resultList = query.getResultList();
            customer.setCustomerId(resultList.size()+1);
            customer.setName(jTextField1.getText());
            customer.setCity(jTextField2.getText());
            //adiciona mais campos que serão populados nas colunas zip e discountCode
            customer.setZip("12345");
            customer.setDiscountCode(entityManager.find(DiscountCode.class, 'H'));

            entityManager.persist(customer);
            entityManager.getTransaction().commit();
        }*    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>O código também grava alguns dados arbitrários no DiscountCode uma vez que o campo não pode estar vazio.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Corrija as importações para importar o  <code><strong>javax.persistence.Query</strong></code> . Salve as alterações.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_construindo_e_executando_o_aplicativo">Construindo e executando o aplicativo</h2>
<div class="sectionbody">
<div class="paragraph">
<p>O aplicativo agora executa três das funções CRUD: Criar, Ler e Atualizar. Agora é possível construir e executar o aplicativo para verificar que todas as funções estão funcionando corretamente.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Clique com o botão direito do mouse no nó do projeto do <strong>aplicativo com base na plataforma NetBeans MavenPlatformCRUDApp</strong> e selecione Limpar.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Clique com o botão direito do mouse no nó do projeto do <strong>aplicativo com base na plataforma NetBeans MavenPlatformCRUDApp</strong> e selecione Construir utilizando dependências.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Clique com o botão direito do mouse no nó do projeto do <strong>aplicativo com base na plataforma NetBeans MavenPlatformCRUDApp</strong> e selecione Executar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ao clicar em Executar, o IDE ativa o aplicativo da plataforma. O aplicativo preenche a árvore na janela Cliente com os nomes dos clientes no banco de dados. Ao selecionar um nó na janela Cliente, a janela Meu editor exibe o nome e a cidade do cliente selecionado. É possível modificar e salvar os dados nos campos Nome e Cidade. Para criar um novo cliente, clique no botão Minha ação na barra de ferramentas e insira um nome para a cidade no campo de texto vazio na janela Meu editor e, a seguir, clique em Salvar.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mavencrud-finished-app.png" alt="mavencrud finished app">
</div>
<div class="title">Figure 9.  Aplicativo concluído exibindo as janelas Cliente e Meu Editor.</div>
</div>
<div class="paragraph">
<p>Após criar ou modificar um cliente, será necessário atualizar o nó Raiz na janela Cliente caso não tenha implementado a ação Atualizar na opção Salvar.</p>
</div>
<div class="paragraph">
<p>Este tutorial demonstrou que criar um aplicativo da plataforma NetBeans utilizando Maven não é muito diferente de criar um aplicativo utilizando Ant. A principal diferença é entender como o POM Maven controla a montagem do aplicativo. Para mais exemplos sobre como construir aplicativos e módulos da plataforma NetBeans, consulte os tutoriais listados na  <a href="https://netbeans.apache.org/kb/docs/platform_pt_BR.html">Trilha de aprendizagem da plataforma NetBeans</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_veja_também">Veja também</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Isto conclui o tutorial CRUD. Este documento descreve como utilizar a estrutrua de construção Maven para criar um novo aplicativo da plataforma NetBeans como a funcionalidade CRUD. Para mais informações sobre a criação e o desenvolvimento dos aplicativos, consulte os resursos a seguir.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://netbeans.apache.org/kb/docs/platform_pt_BR.html">Trilha de aprendizagem da plataforma NetBeans</a></p>
</li>
<li>
<p><a href="http://bits.netbeans.org/dev/javadoc/">Javadoc da API do NetBeans </a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Caso tenha qualquer dúvida sobre a plataforma NetBeans, sinta-se à vontade para nos mandar um e-mail para <a href="mailto:dev@platform.netbeans.org">dev@platform.netbeans.org</a> ou ou veja o  <a href="https://netbeans.org/projects/platform/lists/dev/archive">arquivo de endereços da plataforma NetBeans</a>.</p>
</div>
</div>
</div>
            
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="JIRA" href="https://issues.apache.org/jira/projects/NETBEANS/summary"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/74/nbm-maven-crud_pt_BR.asciidoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

        </div>
        

<div class='grid-container incubator-area' style='margin-top: 64px'>
    <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/">
                <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
            </a>
        </div>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/events/current-event.html">
               <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
            </a>
        </div>
    </div>
</div>
<footer>
    <div class="grid-container">
        <div class="grid-x grid-padding-x">
            <div class="large-auto cell">
                
                <h1><a href="/about/index.html">About</a></h1>
                <ul>
                    <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
                    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                    <li><a href="https://www.apache.org/security/">Security</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/community/index.html">Community</a></h1>
                <ul>
                    <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
                    <li><a href="/community/committer.html">Becoming a committer</a></li>
                    <li><a href="/community/events.html">NetBeans Events</a></li>
                    <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/participate/index.html">Participate</a></h1>
                <ul>
                    <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
                    <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
                    <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/help/index.html">Get Help</a></h1>
                <ul>
                    <li><a href="/help/index.html#documentation">Documentation</a></li>
                    <li><a href="/wiki/index.asciidoc">Wiki</a></li>
                    <li><a href="/help/index.html#support">Community Support</a></li>
                    <li><a href="/help/commercial-support.html">Commercial Support</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/download/nb110/nb110.html">Download</a></h1>
                <ul>
                    <li><a href="/download/index.html">Releases</a></li>                    
                    <li><a href="/plugins/index.html">Plugins</a></li>
                    <li><a href="/download/index.html#source">Building from source</a></li>
                    <li><a href="/download/index.html#previous">Previous releases</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<div class='footer-disclaimer'>
    <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2020 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
            <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
            <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
        </div>
        
    </div>
</div>



        <script src="/js/vendor/jquery-3.2.1.min.js"></script>
        <script src="/js/vendor/what-input.js"></script>
        <script src="/js/vendor/jquery.colorbox-min.js"></script>
        <script src="/js/vendor/foundation.min.js"></script>
        <script src="/js/netbeans.js"></script>
        <script>
            
            $(function(){ $(document).foundation(); });
        </script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        <script>
         $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
        </script>
        
    </body>
</html>
