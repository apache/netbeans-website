
<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Tutorial do aplicativo CRUD para a plataforma NetBeans</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Tutorial do aplicativo CRUD para a plataforma NetBeans - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans Platform, Platform Tutorials, Tutorial do aplicativo CRUD para a plataforma NetBeans">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
     <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet"> 
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
</head>


    <body>
        

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


        
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 15</h1>
            <p><a class="button success" href="/download/nb15/">Download</a></p>
        </div>
    </div>
</section>

        <div class='grid-container main-content tutorial'>
            <h1 class="sect0">Tutorial do aplicativo CRUD para a plataforma NetBeans</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/68/nbm-crud_pt_BR.asciidoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
            <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_configurando_o_aplicativo">Configurando o aplicativo</a></li>
<li><a href="#_integrando_o_banco_de_dados">Integrando o banco de dados</a>
<ul class="sectlevel2">
<li><a href="#_criando_as_classes_de_entidade">Criando as classes de entidade</a></li>
<li><a href="#_colocando_a_classe_da_entidade_jar_em_um_módulo">Colocando a classe da entidade JAR em um módulo</a></li>
<li><a href="#_criando_outros_módulos_relacionados">Criando outros módulos relacionados</a></li>
<li><a href="#_projetando_a_interface_do_usuário">Projetando a interface do usuário</a></li>
<li><a href="#_configurando_as_dependências">Configurando as dependências</a></li>
<li><a href="#_executando_o_protótipo">Executando o protótipo</a></li>
</ul>
</li>
<li><a href="#_integrando_a_funcionalidade_crud">Integrando a funcionalidade CRUD</a>
<ul class="sectlevel2">
<li><a href="#_ler">Ler</a></li>
<li><a href="#_atualizar">Atualizar</a></li>
<li><a href="#_criar">Criar</a></li>
<li><a href="#_excluir">Excluir</a></li>
</ul>
</li>
<li><a href="#_consulte_também">Consulte também</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Este tutorial mostra como integrar um banco de dados Java DB com um aplicativo da plataforma NetBeans. Começamos por explorar um banco de dados Java DB, do qual criamos uma classe de entidade. No entanto, observe que estas instruções não são aplicáveis somente ao Java DB. Ao invés disso, elas são relevantes para qualquer banco de dados relacional suportado pelo NetBeans IDE. A seguir, colocamos as classes da entidade em um módulo, junto com os módulos dos JPA JARS relacionados.</p>
</div>
<div class="paragraph">
<p>Uma vez que os módulos acima fizerem parte do nosso aplicativo, criamos um novo módulo que fornece a interface do usuário para o nosso aplicativo. O novo módulo fornece ao usuário uma hierarquia em árvore mostrando os dados do banco de dados. Nós então criamos outro módulo que permite que o usuário edite os dados exibidos pelo primeiro módulo. Ao separar o visualizador do editor em módulos distintos, permitimos que o usuário instale um editor diferente para o mesmo visualizador, já que editores diferentes poderiam ser criados por fornecedores externos, alguns comercialmente e alguns sem custo. É esta a flexibilidade que a arquitetura modular da plataforma NetBeans torna possível.</p>
</div>
<div class="paragraph">
<p>Uma vez que tivermos um editor, começamos a adicionar a funcionalidade CRUD (Create, Read, Update, Delete). Primeiro, o "R" que indica "Read" (ler) é manipulado pelo visualizador acima descrito. A seguir, é manipulado o "U" para "Update" (atualizar), seguido pelo "C" para "Create" (criar) e pelo "D" para "Delete" (excluir).</p>
</div>
<div class="paragraph">
<p>Ao final do tutorial, você terá aprendido sobre a gama de recursos da plataforma NetBeans que lhe ajudam na criação de aplicativos deste tipo. Por exemplo, você aprendeu sobre o  <code> <a href="http://bits.netbeans.org/dev/javadoc/org-openide-awt/org/openide/awt/UndoRedo.Manager.html">UndoRedo.Manager</a></code>  e o  <code> <a href="http://bits.netbeans.org/dev/javadoc/org-openide-explorer/org/openide/explorer/ExplorerManager.html">ExplorerManager</a></code> , assim como sobre os componentes Swing da plataforma NetBeans, tais como  <code> <a href="http://bits.netbeans.org/dev/javadoc/org-openide-windows/org/openide/windows/TopComponent.html">TopComponent</a></code>  e  <code> <a href="http://bits.netbeans.org/dev/javadoc/org-openide-explorer/org/openide/explorer/view/BeanTreeView.html">BeanTreeView</a></code> .</p>
</div>
<div class="paragraph">
<p><strong>Observação:</strong> este documento usa a versão NetBeans IDE 6.8. Se você estiver usando uma versão anterior, veja  <a href="67/nbm-crud.html">a versão 6.7 deste documento</a>.</p>
</div>
<div class="paragraph">
<p>O aplicativo que você criará neste tutorial terá esta aparência:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="http://netbeans.dzone.com/sites/all/files/customer-app-on-nb.png" alt="customer app on nb">
</div>
</div>
<div class="paragraph">
<p>É aconselhável assistir à série de screencasts  <a href="https://netbeans.apache.org/tutorials/nbm-10-top-apis.html">As 10 principais APIs do NetBeans</a> antes de começar a trabalhar neste tutorial. Muitos dos conceitos tratados neste tutorial são discutidos em maior detalhe dentro da série de screencasts.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configurando_o_aplicativo">Configurando o aplicativo</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vamos começar por criar um novo aplicativo NetBeans.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Escolha Arquivo &gt; Novo projeto (Ctrl-Shift-N). Em Categorias, selecione Módulos do NetBeans. Em Projetos, selecione Aplicativo da plataforma NetBeans. Clique em Próximo.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>No painel Nome e localização, digite  <code>DBManager</code>  no campo Nome do projeto. Clique em Terminar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>O IDE cria o projeto  <code>DBManager</code> . O projeto é um contêiner para todos os outros módulos que você criará.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-1.png" alt="crud 68dbmanager 1">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_integrando_o_banco_de_dados">Integrando o banco de dados</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para poder integrar o banco de dados, é preciso criar classes de entidades de seu banco de dados e integrar estas classes de entidades, junto com seus JARs relacionados, com os módulos que fazem parte de seu aplicativo da plataforma NetBeans.</p>
</div>
<div class="sect2">
<h3 id="_criando_as_classes_de_entidade">Criando as classes de entidade</h3>
<div class="paragraph">
<p>Nesta seção, você gera classes de entidade de um banco de dados selecionado.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Neste exemplo, use a janela Serviços para conectar-se ao banco de dados de amostra que está incluído no NetBeans IDE:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-2.png" alt="crud 68dbmanager 2">
</div>
</div>
<div class="paragraph">
<p>Como alternativa, use qualquer banco de dados que desejar e adapte as etapas que se seguem para seu caso particular. No caso do MySQL, consulte  <a href="https://netbeans.apache.org/kb/docs/ide/mysql_pt_BR.html">Conectando-se a um banco de dados MySQL</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>No IDE, escolha Arquivo | Novo projeto, seguido por Java | Biblioteca de classes Java, para criar uma nova biblioteca denominada  <code>CustomerLibrary</code> .</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Na janela Projetos, clique com o botão direito do mouse no projeto da biblioteca e escolha Arquivo | Novo arquivo, seguido por Persistência | Classes de entidade do banco de dados. No assistente, selecione o banco de dados e as tabelas necessárias. Aqui, escolhemos "Customer" e, a seguir, "Discount Code" é adicionado automaticamente, dado que há uma relação entre estas duas tabelas.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-3.png" alt="crud 68dbmanager 3">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Especifique a estratégia de persistência, que pode ser qualquer uma das opções disponíveis. Aqui, visto que precisamos escolher algo, escolheremos EclipseLink:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-4.png" alt="crud 68dbmanager 4">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Especifique "demo" como o nome do pacote no qual as classes de entidade serão geradas.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-5.png" alt="crud 68dbmanager 5">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Clique em Terminar. Após ter completado esta etapa, examine o código gerado e observe que, entre outras coisas, você agora tem um arquivo  <code>persistence.xml</code>  em uma pasta denominada META-INF, assim como as classes de entidade para cada uma de suas tabelas:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-7.png" alt="crud 68dbmanager 7">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Construa a biblioteca Java e você terá um arquivo JAR na pasta "dist" do projeto da biblioteca, a qual poderá visualizar na janela Arquivos:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-8.png" alt="crud 68dbmanager 8">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_colocando_a_classe_da_entidade_jar_em_um_módulo">Colocando a classe da entidade JAR em um módulo</h3>
<div class="paragraph">
<p>Nesta seção, você adiciona seu primeiro módulo ao aplicativo! O novo módulo NetBeans conterá o arquivo JAR que você criou na seção anterior.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Clique com o botão direito do mouse no nó do módulo  <code>DBManager</code>  na janela Projetos e escolha Adicionar nova biblioteca.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Selecione o JAR criado na subsseção anterior e complete o assistente, especificando quaisquer valores que desejar. Vamos supor que o aplicativo destina-se a tratar com clientes no shop.org, em cujo caso um identificador único "org.shop.model" é apropriado para o nome de base do código:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-9.png" alt="crud 68dbmanager 9">
</div>
</div>
<div class="paragraph">
<p>Você agora tem seu primeiro módulo personalizado no novo aplicativo, contendo o JAR que contém as classes de entidade e o arquivo persistence.xml:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-91.png" alt="crud 68dbmanager 91">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_criando_outros_módulos_relacionados">Criando outros módulos relacionados</h3>
<div class="paragraph">
<p>Nesta seção, você cria dois novos módulos, colocando o EclipseLinks JARs, assim como o JAR do conector do banco de dados.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Faça o mesmo que fez ao criar o wrapper de bibliotecas para a classe de entidade JAR, mas desta vez para os JARs de EclipseLink, que estão na biblioteca Java "CustomerLibrary" criada anteriormente:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-94.png" alt="crud 68dbmanager 94">
</div>
</div>
<div class="paragraph">
<p>No assistente para módulo de wrapper de bibliotecas, você pode usar Ctrl-clique para selecionar vários JARs.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>A seguir, crie outro módulo de wrapper de bibliotecas, desta vez para o JAR cliente do banco de dados Java DB, que está disponível na sua distribuição do JDK em  <code>db/lib/derbyclient.jar</code> .</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_projetando_a_interface_do_usuário">Projetando a interface do usuário</h3>
<div class="paragraph">
<p>Nesta seção, você cria um protótipo simples de interface do usuário, fornecendo uma janela que usa uma  <code>JTextArea</code>  para exibir os dados recuperados do banco de dados.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Clique com o botão direito do mouse no nó do módulo  <code>DBManager</code>  na janela Projetos e escolha Adicionar novo. Crie um novo módulo denominado  <code>CustomerViewer</code> , com o nome de base de código  <code>org.shop.ui</code> .</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Na janela Projetos, clique com o botão direito do mouse no novo módulo e escolha Novo | Componente de janela. Especifique que ele deve ser criado na posição do  <code>editor</code>  e que deve ser aberto quando o aplicativo for iniciado. Defina  <code>Customer</code>  como o prefixo do nome da classe da janela.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Use a paleta (Ctrl-Shift-8) para arrastar e soltar uma  <code>JTextArea</code>  na nova janela:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-93.png" alt="crud 68dbmanager 93">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Adicione isto no fim do construtor TopComponent:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">EntityManager entityManager = Persistence.createEntityManagerFactory("CustomerLibraryPU").createEntityManager();
Query query = entityManager.createQuery("SELECT c FROM Customer c");
List&lt;Customer&gt; resultList = query.getResultList();
for (Customer c : resultList) {
  jTextArea1.append(c.getName() + " (" + c.getCity() + ")" + "\n");
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Como você não definiu dependências no módulo que fornece o objeto Customer e as JARS de persistência, as declarações acima serão marcadas com linhas sublinhadas em vermelho indicando o erro. Estes serão corrigidos na seção que segue.</p>
</div>
<div class="paragraph">
<p>Acima, você pode ver as referências à unidade de persistência denominada "CustomerLibraryPU", que é o mesmo nome definido no arquivo  <code>persistence.xml</code> . Além disso, há uma referência a uma das classes de entidade, denominada  <code>Customer</code> , que está no módulo de classes de entidade. Adapte estas partes às suas necessidades caso sejam diferentes das de cima.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configurando_as_dependências">Configurando as dependências</h3>
<div class="paragraph">
<p>Nesta seção, você habilita alguns dos módulos para usar o código de alguns dos outros módulos. Você faz isso de forma bem explícita ao definir contratos intencionais entre módulos relacionados, ou seja, o oposto à reutilização acidental e caótica do código, que tende a acontecer quando não há uma arquitetura modular estrita, como a fornecida pela plataforma NetBeans.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>O módulo de classes de entidade precisa ter dependências no módulo Derby Client, assim como no módulo EclipseLink. Clique com o botão direito do mouse no módulo  <code>CustomerLibrary</code> , escolha Propriedades e use a aba Bibliotecas para definir as dependências nos dois módulos que o módulo  <code>CustomerLibrary</code>  necessita.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>O módulo  <code>CustomerViewer</code>  precisa de uma dependência no módulo EclipseLink, assim como no módulo de classes de entidade. Clique com o botão direito do mouse no módulo  <code>CustomerViewer</code> , escolha Propriedades e use a aba Bibliotecas para definir as dependências nos dois módulos que o módulo  <code>CustomerViewer</code>  necessita.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Abra o  <code>CustomerTopComponent</code>  na visualização Código-fonte, clique com o botão direito do mouse no editor e escolha "Corrigir importações". O IDE agora é capaz de adicionar as declarações importadas, porque os módulos que fornecem as classes necessárias agora estão disponíveis no  <code>CustomerTopComponent</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Você agora definiu os contratos entre os módulos em seu aplicativo, fornecendo-lhe o controle sobre as dependências entre as distintas partes do código.</p>
</div>
</div>
<div class="sect2">
<h3 id="_executando_o_protótipo">Executando o protótipo</h3>
<div class="paragraph">
<p>Nesta seção, você executa o aplicativo para que possa ver se está acessando corretamente seu banco de dados.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Inicie seu servidor de banco de dados.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Execute o aplicativo. O seguinte deverá ser exibido:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-92.png" alt="crud 68dbmanager 92">
</div>
</div>
<div class="paragraph">
<p>Você agora tem um protótipo simples que compreende um aplicativo da plataforma NetBeans que exibe os dados do seu banco de dados, o qual será ampliado na próxima seção.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_integrando_a_funcionalidade_crud">Integrando a funcionalidade CRUD</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para poder criar a funcionalidade CRUD que se integra com suavidade à plataforma NetBeans, alguns padrões bem específicos de codificação da plataforma NetBeans precisam ser implementados. A seção que segue descreve estes padrões em detalhes.</p>
</div>
<div class="sect2">
<h3 id="_ler">Ler</h3>
<div class="paragraph">
<p>Nesta seção, você altera a  <code>JTextArea</code> , apresentada na seção anterior, para uma visualização do explorador da plataforma NetBeans. As visualizações do explorador da plataforma NetBeans são componentes Swing que se integram melhor com a plataforma NetBeans do que os componentes padrão do Swing. Entre outras coisas, elas oferecem suporte à noção de um contexto, o que permite que elas detectem o contexto.</p>
</div>
<div class="paragraph">
<p>Ao representar seus dados, você terá um modelo hierárquico genérico fornecido por uma classe  <code>Node</code>  da plataforma NetBeans, que pode ser exibido por quaisquer das visualizações do explorador da plataforma NetBeans. Esta seção termina com uma explicação de como sincronizar as visualizações do explorador com a janela Propriedades da plataforma Netbeans.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Em seu  <code>TopComponent</code> , exclua a  <code>JTextArea</code>  na visualização Desenho e comente seu código relacionado na visualização Código-fonte:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">EntityManager entityManager =  Persistence.createEntityManagerFactory("CustomerLibraryPU").createEntityManager();
Query query = entityManager.createQuery("SELECT c FROM Customer c");
List&lt;Customer&gt; resultList = query.getResultList();
//for (Customer c : resultList) {
//    jTextArea1.append(c.getName() + " (" + c.getCity() + ")" + "\n");
//}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Clique com o botão direito do mouse no módulo  <code>CustomerViewer</code> , escolha Propriedades e use a aba Bibliotecas para definir as dependências nos nós da API e a API do explorador e da folha de propriedades.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>A seguir, altere a assinatura da classe para implementar o  <code>ExplorerManager.Provider</code> :</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">final class CustomerTopComponent extends TopComponent implements ExplorerManager.Provider</code></pre>
</div>
</div>
<div class="paragraph">
<p>Será necessário sobrepor o  <code>getExplorerManager()</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
public ExplorerManager getExplorerManager() {
    return em;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Acima da classe, declare e inicialize o  <code>ExplorerManager</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private static ExplorerManager em = new ExplorerManager();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assista  <a href="https://netbeans.apache.org/tutorials/nbm-10-top-apis.html">As 10 principais APIs do NetBeans</a> para obter os detalhes para o código acima, especialmente o screencast que trata dos nós da API e da API do explorador e da folha de propriedades.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Alterne para a visualização Desenho do  <code>TopComponent</code>  , clique com o botão direito do mouse na paleta, escolha Gerenciador de paleta | Adicionar do JAR. A seguir, vá a  <code>org-openide-explorer.jar</code> , que está na pasta  <code>platform11/modules</code> , dentro do diretório de instalação do NetBeans IDE. Feche a BeanTreeView e complete o assistente. Agora você deveria ver a  <code>BeanTreeView</code>  na paleta. Arraste-a da paleta e solte-a na janela.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Crie uma classe de fábrica que criará um novo  <a href="http://bits.netbeans.org/dev/javadoc/org-netbeans-modules-db/org/netbeans/api/db/explorer/node/BaseNode.html">BeanNode</a> para cada cliente do seu banco de dados:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">import demo.Customer;
import java.beans.IntrospectionException;
import java.util.List;
import org.openide.nodes.BeanNode;
import org.openide.nodes.ChildFactory;
import org.openide.nodes.Node;
import org.openide.util.Exceptions;

public class CustomerChildFactory extends ChildFactory&lt;Customer&gt; {

    private List&lt;Customer&gt; resultList;

    public CustomerChildFactory(List&lt;Customer&gt; resultList) {
        this.resultList = resultList;
    }

    @Override
    protected boolean createKeys(List&lt;Customer&gt; list) {
        for (Customer Customer : resultList) {
            list.add(Customer);
        }
        return true;
    }

    @Override
    protected Node createNodeForKey(Customer c) {
        try {
            return new BeanNode(c);
        } catch (IntrospectionException ex) {
            Exceptions.printStackTrace(ex);
            return null;
        }
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>De volta ao  <code>CustomerTopComponent</code> , use o  <code>ExplorerManager</code>  para passar a lista de resultados da consulta JPA para  <code>Node</code> :</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">EntityManager entityManager =  Persistence.createEntityManagerFactory("CustomerLibraryPU").createEntityManager();
Query query = entityManager.createQuery("SELECT c FROM Customer c");
List&lt;Customer&gt; resultList = query.getResultList();
*em.setRootContext(new AbstractNode(Children.create(new CustomerChildFactory(resultList), true)));*
//for (Customer c : resultList) {
//    jTextArea1.append(c.getName() + " (" + c.getCity() + ")" + "\n");
//}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Execute o aplicativo. Quando o aplicativo estiver sendo executado abra a janela Propriedades. Observe que embora os dados estejam disponíveis, exibidos em uma  <code>BeanTreeView</code> , a  <code>BeanTreeView</code>  não está sincronizada com a janela Propriedades, que está disponível através de Janela | Propriedades. Em outras palavras, nada é exibido na janela Propriedades quando você move acima e abaixo na hierarquia da árvore.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Sincronize a janela Propriedades com  <code>BeanTreeView</code>  ao adicionar o seguinte construtor no  <code>TopComponent</code> :</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">associateLookup(ExplorerUtils.createLookup(em, getActionMap()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Aqui nós adicionamos o  <code>ExplorerManager</code>  e o  <code>ActionMap</code>  do  <code>TopComponent</code>  ao  <code>Lookup</code>  do  <code>TopComponent</code> . Uma consequência disso, é que a janela Propriedades começa a exibir o nome e o texto da dica de ferramenta do  <code>Node</code>  selecionado.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Execute novamente o aplicativo e observe que a janela Propriedades agora está sincronizada com a visualização do explorador:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-95.png" alt="crud 68dbmanager 95">
</div>
</div>
<div class="paragraph">
<p>Agora você pode visualizar seus dados na hierarquia da árvore, assim como deveria ser capaz de fazer com um  <code>JTree</code> . No entanto, também é possível alternar entre diferentes visualizações do explorador sem a necessidade de alterar nada no modelo porque o  <code>ExplorerManager</code>  faz a mediação entre o modelo e a visualização. Finalmente, agora também é possível sincronizar a visualização com a janela Propriedades.</p>
</div>
</div>
<div class="sect2">
<h3 id="_atualizar">Atualizar</h3>
<div class="paragraph">
<p>Nesta seção, primeiro você cria um editor. O editor será fornecido por um novo módulo do NetBeans. Portanto, primeiro você criará um novo módulo. A seguir, dentro daquele novo módulo, criará um novo  <code>TopComponent</code> , contendo dois  <code>JTextFields</code> , em cada uma das colunas que deseja permitir que sejam editadas pelo usuário. Será necessário deixar que o módulo do visualizador se comunique com o módulo do editor. Sempre que um novo  <code>Node</code>  for selecionado no módulo do visualizador, você adicionará o objeto  <code>Customer</code>  atual ao  <code>Lookup</code> . No módulo do editor, você ouvirá o  <code>Lookup</code>  para a apresentação dos objetos  <code>Customer</code> . Sempre que um novo objeto  <code>Customer</code>  for introduzido no  <code>Lookup</code> , você atualizará o  <code>JTextFields</code>  no editor.</p>
</div>
<div class="paragraph">
<p>A seguir, você sincronizará seu  <code>JTextFields</code>  com a funcionalidade de Desfazer, Refazer e Salvar da plataforma NetBeans. Em outras palavras, quando o usuário faz alterações em um  <code>JTextField</code> , você deseja que a funcionalidade existente da plataforma NetBeans se torne disponível para que, em vez de ter que criar uma nova funcionalidade, você tenha somente que utilizar o suporte da plataforma NetBeans. Para este fim, será necessário usar o  <code>UndoRedoManager</code>  junto com o  <code>SaveCookie</code> .</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Crie um novo módulo denominado  <code>CustomerEditor</code>  com o  <code>org.shop.editor</code>  como o nome de base do código.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Clique com o botão direito do mouse no módulo  <code>CustomerEditor</code>  e escolha Novo | Componente de janela. Certifique-se de especificar que a janela deve aparecer na posição do  <code>editor</code>  e que deve abrir quando o aplicativo for iniciado. No painel final do assistente, defina "Editor" como o prefixo do nome da classe.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Use a paleta (Ctrl-Shift-8) para adicionar dois  <code>JLabels</code>  e dois  <code>JTextFields</code>  na nova janela. Defina os textos dos rótulos como "Nome" e "Cidade" e defina os nomes das variáveis dos dois  <code>JTextFields</code>  como  <code>jTextField1</code>  e  <code>jTextField2</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>No construtor de GUI, a janela agora deve se parecer com a figura seguinte:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-96.png" alt="crud 68dbmanager 96">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Volte para o módulo  <code>CustomerViewer</code>  e altere o arquivo  <code>layer.xml</code>  para que especifique que a janela  <code>CustomerTopComponent</code>  aparecerá no modo  <code>explorer</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Clique com o botão direito do mouse no projeto do aplicativo e escolha "Limpar", após alterar o arquivo  <code>layer.xml</code> . Porquê? Porque sempre que você executa o aplicativo e o fecha, as posições da janela são armazenadas no diretório do usuário. Portanto, se o  <code>CustomerViewer</code>  foi inicialmente exibido no modo  <code>editor</code> , ele permanecerá no modo  <code>editor</code>  até que você faça "Limpar", redefinindo, assim, o diretório do usuário (ou seja, <em>excluindo</em> o diretório do usuário) e permitindo que o  <code>CustomerViewer</code>  seja exibido na posição definida atualmente no arquivo  <code>layer.xml</code> .</p>
</div>
<div class="paragraph">
<p>Verifique também se  <code>BeanTreeView</code>  no  <code>CustomerViewer</code>  será ampliada na horizontal e na vertical quando o usuário redimensionar o aplicativo. Verifique isso abrindo a janela, selecionando  <code>BeanTreeView</code>  e clicando nos botões de seta na barra de ferramentas do construtor da GUI.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Execute o aplicativo e certifique-se de ver o seguinte quando o aplicativo se iniciar:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-97.png" alt="crud 68dbmanager 97">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Agora podemos começar a adicionar alguns códigos. Primeiramente, precisamos mostrar no editor o objeto Customer atualmente selecionado:</p>
<div class="ulist">
<ul>
<li>
<p>Inicie por adaptar o módulo  <code>CustomerViewer</code>  para que o objeto  <code>Customer</code>  atual seja adicionado ao  <code>Lookup</code>  da janela do visualizador sempre que um novo  <code>Node</code>  for selecionado. Para isso, crie um  <code>AbstractNode</code> , em vez de um  <code>BeanNode</code> , na classe  <code>CustomerChildFactory</code> . Isso permite adicionar o objeto  <code>Customer</code>  atual ao  <code>Lookup</code>  do Node, conforme ilustrado a seguir (observe a parte em negrito):</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
protected Node createNodeForKey(Customer c) {
    Node node = new AbstractNode(Children.LEAF, Lookups.singleton(c));
    node.setDisplayName(c.getName());
    node.setShortDescription(c.getCity());
    return node;
//        try {
//            return new BeanNode(c);
//        } catch (IntrospectionException ex) {
//            Exceptions.printStackTrace(ex);
//            return null;
//        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Agora, sempre que um novo  <code>Node</code>  for criado, o que acontece sempre que o usuário seleciona um novo estado no visualizador, um novo objeto  <code>Customer</code>  é adicionado ao  <code>Lookup</code>  do  <code>Node</code> .</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Agora vamos alterar o módulo do editor de tal forma que sua janela detecte os objetos  <code>Customer</code>  que são adicionados ao  <code>Lookup</code> . Primeiro, defina uma dependência no módulo do editor que fornece a classe da entidade, bem como o módulo que fornece os JARS de persistência.</p>
</li>
<li>
<p>A seguir, altere a assinatura da classe  <code>EditorTopComponente</code>  para implementar o  <code>LookupListener</code> :</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public final class EditorTopComponent extends TopComponent implements LookupListener</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Substitua o  <code>resultChanged</code>  para que os  <code>JTextFields</code>  sejam atualizados sempre que um novo objeto  <code>Customer</code>  for introduzido no  <code>Lookup</code> :</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
public void resultChanged(LookupEvent lookupEvent) {
    Lookup.Result r = (Lookup.Result) lookupEvent.getSource();
    Collection&lt;Customer&gt; coll = r.allInstances();
    if (!coll.isEmpty()) {
        for (Customer cust : coll) {
            jTextField1.setText(cust.getName());
            jTextField2.setText(cust.getCity());
        }
    } else {
        jTextField1.setText("[no name]");
        jTextField2.setText("[no city]");
    }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Agora que o  <code>LookupListener</code>  está definido, precisamos adicioná-lo a algo. Aqui, nós o adicionamos ao  <code>Lookup.Result</code>  obtido do contexto global. Os proxies do contexto global do contexto do  <code>Node</code>  selecionado. Por exemplo, se "Ford Motor Co" for selecionado na hierarquia da árvore, o objeto  <code>Customer</code>  de "Ford Motor Co" é adicionado ao  <code>Lookup</code>  do  <code>Node</code>  que, por ser o  <code>Node</code>  atualmente selecionado, significa que o objeto  <code>Customer</code>  de "Ford Motor Co" agora está disponível no contexto global. Isso é, então, passado para o  <code>resultChanged</code> , fazendo com que os campos de texto sejam preenchidos.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Todo o acima começa a acontecer, ou seja, o  <code>LookupListener</code>  se torna ativo sempre que a janela do editor for aberta, como pode ser visto abaixo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
public void componentOpened() {
    result = Utilities.actionsGlobalContext().lookupResult(Customer.class);
    result.addLookupListener(this);
    resultChanged(new LookupEvent(result));
}

@Override
public void componentClosed() {
    result.removeLookupListener(this);
    result = null;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Como a janela do editor é aberta quando o aplicativo é iniciado, o  <code>LookupListener</code>  está disponível no momento da inicialização do aplicativo.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Finalmente, declare a variável do resultado acima da classe, como segue:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private Lookup.Result result = null;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute novamente o aplicativo e observe que a janela do editor é atualizada sempre que você seleciona um novo  <code>Node</code> :</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-98.png" alt="crud 68dbmanager 98">
</div>
</div>
<div class="paragraph">
<p>No entanto, observe o que acontece quando você alterna o foco para a janela do editor:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-99.png" alt="crud 68dbmanager 99">
</div>
</div>
<div class="paragraph">
<p>Como o  <code>Node</code>  não é mais o atual, o objeto  <code>Customer</code>  não está mais no contexto global. Isto se deve, conforme mostrado acima, aos proxies do contexto global do  <code>Lookup</code>  do  <code>Node</code>  atual. Portanto, neste caso, não podemos usar o contexto global. Em vez disso, usaremos o  <code>Lookup</code>  local fornecido pela janela Clientes.</p>
</div>
<div class="paragraph">
<p>Reescreva esta linha:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">result = Utilities.actionsGlobalContext().lookupResult(Customer.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">result = WindowManager.getDefault().findTopComponent("CustomerTopComponent").getLookup().lookupResult(Customer.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>A string "CustomerTopComponent" é a ID do  <code>CustomerTopComponent</code> , que é uma constante da string que você pode encontrar no código-fonte do  <code>CustomerTopComponent</code> . Uma desvantagem da abordagem acima é a de que seu novo  <code>EditorTopComponent</code>  funciona somente se ele puder encontrar um  <code>TopComponent</code>  com a ID "CustomerTopComponent". Isto precisa ser explicitamente documentado para que os desenvolvedores de editores alternativos possam saber que precisam identificar o visualizador  <code>TopComponent</code>  desta forma, ou é necessário reescrever o modelo de seleção,  <a href="http://weblogs.java.net/blog/timboudreau/archive/2007/01/how_to_replace.html">conforme descrito aqui</a> por Tim Boudreau.</p>
</div>
<div class="paragraph">
<p>Se usar uma das abordagens acima, verificará que o contexto não se perde ao alternar o foco para o  <code>EditorTopComponent</code> , conforme ilustrado abaixo:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-991.png" alt="crud 68dbmanager 991">
</div>
</div>
<div class="paragraph">
<p>Visto que agora você está usando  <code>AbstractNode</code> , em vez de  <code>BeanNode</code> , nenhuma propriedade é mostrada na janela Propriedades. Você mesmo precisa fornecê-las, conforme descrito no  <a href="https://netbeans.apache.org/tutorials/nbm-nodesapi2.html">Tutorial da API de nós</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Em segundo lugar, vamos trabalhar na funcionalidade Desfazer/Refazer. O que gostaríamos que acontecesse é que sempre que o usuário fizer uma alteração em um dos  <code>JTextFields</code> , o botão "Desfazer" e o botão "Refazer", assim como os itens de menu relacionados no meu Editar, se tornem habilitados. Para este fim, a plataforma NetBeans torna o  <a href="http://bits.netbeans.org/dev/javadoc/org-openide-awt/org/openide/awt/UndoRedo.Manager.html">UndoRedo.Manager</a> disponível.</p>
<div class="ulist">
<ul>
<li>
<p>Declare e crie uma instância de um novo UndoRedoManager acima do  <code>EditorTopComponent</code> :</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private UndoRedo.Manager manager = new UndoRedo.Manager();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>A seguir, sobreponha o método  <code>getUndoRedo()</code>  no  <code>EditorTopComponent</code> :</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
public UndoRedo getUndoRedo() {
    return manager;
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>No construtor do  <code>EditorTopComponent</code> , adicione um  <code>KeyListener</code>  ao  <code>JTextFields</code>  e, dentro dos métodos relacionados que você precisa implementar, adicione o  <code>UndoRedoListeners</code> :</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">jTextField1.getDocument().addUndoableEditListener(manager);
jTextField2.getDocument().addUndoableEditListener(manager);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute o aplicativo e mostre a funcionalidade Desfazer e Refazer em ação, os botões e também os itens de menu. A funcionalidade funciona exatamente como esperado. Você pode desejar alterar o  <code>KeyListener</code>  para que nem TODAS as teclas causem a habilitação da funcionalidade Desfazer/Refazer. Por exemplo, quando Enter é pressionado, você provavelmente não deseja que a funcionalidade Desfazer/Refazer se torne disponível. Portanto, adapte o código acima para se adequar às suas necessidades administrativas.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Em terceiro lugar, precisamos integrar com a funcionalidade Salvar do NetBeans.</p>
<div class="ulist">
<ul>
<li>
<p>Por padrão, o botão "Salvar todos" está disponível na barra de ferramentas da plataforma NetBeans. Em nosso cenário atual, não desejamos salvar "todos", por que "todos" se refere a vários documentos. Em nosso caso, temos somente um "documento", que é o editor que estamos reutilizando para todos os nós na hierarquia da árvore. Remova o botão "Salvar todos" e adicione "Salvar" em seu lugar, ao adicionar o seguinte arquivo de camada do módulo  <code>CustomerEditor</code> :</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;folder name="Toolbars"&gt;
    &lt;folder name="File"&gt;
        &lt;file name="org-openide-actions-SaveAction.shadow"&gt;
            &lt;attr name="originalFile" stringvalue="Actions/System/org-openide-actions-SaveAction.instance"/&gt;
            &lt;attr name="position" intvalue="444"/&gt;
        &lt;/file&gt;
        &lt;file name="org-openide-actions-SaveAllAction.shadow_hidden"/&gt;
    &lt;/folder&gt;
&lt;/folder&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Agora, quando você executar o aplicativo, verá um ícone diferente na barra de ferramentas. Ao invés do botão "Salvar todos", você agora tem o botão "Salvar" disponível.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Defina as dependências na API das caixas de diálogo e na API dos nós.</p>
</li>
<li>
<p>No construtor  <code>EditorTopCompontn</code> , adicione uma chamada para disparar um método (que será definido na etapa seguinte) sempre que uma alteração for detectada:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public EditorTopComponent() {

        ...
        ...
        ...

        jTextField1.getDocument().addDocumentListener(new DocumentListener() {
            public void insertUpdate(DocumentEvent arg0) {
                fire(true);
            }
            public void removeUpdate(DocumentEvent arg0) {
                fire(true);
            }
            public void changedUpdate(DocumentEvent arg0) {
                fire(true);
            }
        });

        jTextField2.getDocument().addDocumentListener(new DocumentListener() {
            public void insertUpdate(DocumentEvent arg0) {
                fire(true);
            }
            public void removeUpdate(DocumentEvent arg0) {
                fire(true);
            }
            public void changedUpdate(DocumentEvent arg0) {
                fire(true);
            }
        });

        //Create a new instance of our SaveCookie implementation:
        impl = new SaveCookieImpl();

        //Create a new instance of our dynamic object:
        content = new InstanceContent();

        //Add the dynamic object to the TopComponent Lookup:
        associateLookup(new AbstractLookup(content));

    }

    ...
    ...
    ...</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Aqui estão os dois métodos mencionados acima. Primeiro, o método que é disparado sempre que uma alteração for detectada. Uma implementação do  <code>SaveCookie</code>  da API de nós é adicionada ao  <code>InstanceContent</code>  sempre que uma alteração for detectada:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    public void fire(boolean modified) {
        if (modified) {
            //If the text is modified,
            //we add SaveCookie impl to Lookup:
            content.add(impl);
        } else {
            //Otherwise, we remove the SaveCookie impl from the lookup:
            content.remove(impl);
        }
    }

    private class SaveCookieImpl implements SaveCookie {

        @Override
        public void save() throws IOException {

           Confirmation message = new NotifyDescriptor.Confirmation("Do you want to save \""
                    + jTextField1.getText() + " (" + jTextField2.getText() + ")\"?",
                    NotifyDescriptor.OK_CANCEL_OPTION,
                    NotifyDescriptor.QUESTION_MESSAGE);

            Object result = DialogDisplayer.getDefault().notify(message);
            //When user clicks "Yes", indicating they really want to save,
            //we need to disable the Save action,
            //so that it will only be usable when the next change is made
            //to the JTextArea:
            if (NotifyDescriptor.YES_OPTION.equals(result)) {
                fire(false);
                //Implement your save functionality here.
            }
        }
    }</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute o aplicativo e observe a habilitação/desabilitação do botão Salvar:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-992.png" alt="crud 68dbmanager 992">
</div>
</div>
<div class="paragraph">
<p>No momento, nada acontece quando você clica em OK na caixa de diálogo acima. Na próxima etapa, adicionamos alguns códigos JPA para manipular a persistências de nossas alterações.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A seguir, adicionamos o código JPA para persistência de nossa alteração. Faça isso substituindo o comentário "//Implement your save functionality here." (Implemente sua funcionalidade salva aqui). O comentário deveria ser substituído pelo código a seguir:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">EntityManager entityManager = Persistence.createEntityManagerFactory("CustomerLibraryPU").createEntityManager();
entityManager.getTransaction().begin();
Customer c = entityManager.find(Customer.class, customer.getCustomerId());
c.setName(jTextField1.getText());
c.setCity(jTextField2.getText());
entityManager.getTransaction().commit();</code></pre>
</div>
</div>
<div class="paragraph">
<p>O "customer" de  <code>customer.getCustomerId()()</code>  não está definido no momento. Adicione a linha em negrito ao  <code>resultChanged</code>  abaixo, após declarar  <code>Customer customer;</code>  acima da classe, de modo que o objeto  <code>Customer</code>  atual defina o  <code>customer</code> , o qual é então usado no código de persistência acima para obter a ID do objeto  <code>Customer</code>  atual.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Override
public void resultChanged(LookupEvent lookupEvent) {
    Lookup.Result r = (Lookup.Result) lookupEvent.getSource();
    Collection&lt;Customer&gt; c = r.allInstances();
    if (!c.isEmpty()) {
        for (Customer customer : c) {
            *customer = cust;*
            jTextField1.setText(customer.getName());
            jTextField2.setText(customer.getCity());
        }
    } else {
        jTextField1.setText("[no name]");
        jTextField2.setText("[no city]");
    }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute o aplicativo e altere alguns dados. No momento, não temos a funcionalidade "Atualizar" (que será adicionada na etapa seguinte), portanto, para ver os dados alterados, reinicie o aplicativo. Aqui, por exemplo, a hierarquia da árvore mostra o nome do cliente persistente "Ford Motor Co":</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-993.png" alt="crud 68dbmanager 993">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Em quarto lugar, precisamos adicionar a funcionalidade de atualização para o visualizador Customer. Você pode desejar adicionar um  <code>Temporizador</code>  que periodicamente atualiza o visualizador. No entanto, neste exemplo, nós adicionaremos um item de menu "Atualizar" no nó Raiz, para que o usuário seja capaz de atualizar manualmente o visualizador.</p>
<div class="ulist">
<ul>
<li>
<p>No pacote principal do módulo  <code>CustomerViewer</code> , crie um novo  <code>Node</code> , que substituirá o  <code>AbstractNode</code>  que estamos usando atualmente como a raiz dos filhos do visualizador. Observe que também vinculamos uma ação "Atualizar" com nosso novo nó raiz.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class CustomerRootNode extends AbstractNode {

    public CustomerRootNode(Children kids) {
        super(kids);
        setDisplayName("Root");
    }

    @Override
    public Action[] getActions(boolean context) {
        Action[] result = new Action[]{
            new RefreshAction()};
        return result;
    }

    private final class RefreshAction extends AbstractAction {

        public RefreshAction() {
            putValue(Action.NAME, "Refresh");
        }

        public void actionPerformed(ActionEvent e) {
            CustomerTopComponent.refreshNode();
        }
    }

}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Adicione este método ao  <code>CustomerTopComponent</code>  para atualizar a visualização:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public static void refreshNode() {
    EntityManager entityManager = Persistence.createEntityManagerFactory("CustomerLibraryPU").createEntityManager();
    Query query = entityManager.createQuery("SELECT c FROM Customer c");
    List&lt;Customer&gt; resultList = query.getResultList();
    em.setRootContext(new *CustomerRootNode*(Children.create(new CustomerChildFactory(resultList), true)));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Agora, substitua o código acima no construtor do  <code>CustomerTopComponent</code>  por uma chamada para código acima. Como você pode ver na parte realçada acima, agora estamos usando nosso  <code>CustomerRootNode</code>  ao invés do  <code>AbstractNode</code> . O  <code>CustomerRootNode</code>  inclui a ação "Atualizar", que chama o código acima.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Na sua funcionalidade de salvar, adicione a chamada ao método acima para que, sempre que os dados forem salvos, ocorra uma atualização automática. É possível utilizar diferentes abordagens ao implementar esta extensão à funcionalidade de salvar. Por exemplo, você pode criar um novo módulo que contém a ação de atualização. Tal módulo é, então, compartilhado entre o módulo do visualizador e o módulo do editor, proporcionando a funcionalidade que é comum a ambos.</p>
</li>
<li>
<p>Execute novamente o aplicativo e observe que você tem um novo nó raiz com uma ação "Atualizar".</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/crud_68dbmanager-994.png" alt="crud 68dbmanager 994">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Altere alguns dados, salve-os, chame a ação Atualizar e observe que o visualizador está atualizado.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Você agora aprendeu como a plataforma NetBeans tem a permissão de manipular as alterações no  <code>JTextFields</code> . Sempre que o texto muda, os botões Desfazer e Refazer da plataforma NetBeans são habilitados ou desabilitados. Também, o botão Salvar é corretamente habilitado ou desabilitado, permitindo que o usuário salve os dados alterados no banco de dados.</p>
</div>
</div>
<div class="sect2">
<h3 id="_criar">Criar</h3>
<div class="paragraph">
<p>Nesta seção, você permite que o usuário crie uma nova entrada no banco de dados.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Clique com o botão direito do mouse no módulo  <code>CustomerEditor</code>  e escolha "Nova ação". Use o assistente Nova ação para criar uma nova ação "Sempre habilitado". A nova ação deve ser exibida na barra de ferramentas ou na barra de menus. Na próxima etapa do assistente, chame a ação  <code>NewAction</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Certifique-se de ter disponível um ícone 16x16, que o assistente força que seja selecionado, se for indicado que deseja que a ação seja chamada da barra de ferramentas.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Na nova ação, deixe que o  <code>TopComponent</code>  seja aberto com  <code>JTextFields</code>  vazios:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public final class NewAction implements ActionListener {

    public void actionPerformed(ActionEvent e) {
        EditorTopComponent tc = EditorTopComponent.getDefault();
        tc.resetFields();
        tc.open();
        tc.requestActive();
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A ação implementa a classe  <code>ActionListener</code>  que está vinculada ao aplicativo através de entradas no arquivo de camadas, colocado pelo assistente Nova ação. Imagine que fácil será quando transferir seu aplicativo Swing existente para a plataforma NetBeans, já que você simplesmente poderá usar as mesmas classes  <code>Action</code>  usadas em seu aplicativo original, sem a necessidade de reescrevê-las para estarem em conformidade com as classes  <code>Action</code>  fornecidas pela plataforma NetBeans!</p>
</div>
<div class="paragraph">
<p>No  <code>EditorTopComponent</code> , adicione o seguinte método para redefinir o  <code>JTextFields</code>  e para criar um novo objeto  <code>Customer</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public void resetFields() {
    customer = new Customer();
    jTextField1.setText("");
    jTextField2.setText("");
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>No  <code>SaveCookie</code> , assegure que um retorno de  <code>null</code>  indique que a nova entrada está salva, ao invés de uma entrada existente ser atualizada:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public void save() throws IOException {

    Confirmation message = new NotifyDescriptor.Confirmation("Do you want to save \""
                    + jTextField1.getText() + " (" + jTextField2.getText() + ")\"?",
                    NotifyDescriptor.OK_CANCEL_OPTION,
                    NotifyDescriptor.QUESTION_MESSAGE);

    Object result = DialogDisplayer.getDefault().notify(msg);

    //When user clicks "Yes", indicating they really want to save,
    //we need to disable the Save button and Save menu item,
    //so that it will only be usable when the next change is made
    //to the text field:
    if (NotifyDescriptor.YES_OPTION.equals(result)) {
        fire(false);
        EntityManager entityManager = Persistence.createEntityManagerFactory("CustomerLibraryPU").createEntityManager();
        entityManager.getTransaction().begin();
        *if (customer.getCustomerId() != null)* {
            Customer c = entityManager.find(Customer.class, cude.getCustomerId());
            c.setName(jTextField1.getText());
            c.setCity(jTextField2.getText());
            entityManager.getTransaction().commit();
        } else {
            *Query query = entityManager.createQuery("SELECT c FROM Customer c");
            List&lt;Customer&gt; resultList = query.getResultList();
            customer.setCustomerId(resultList.size()+1);
            customer.setName(jTextField1.getText());
            customer.setCity(jTextField2.getText());
            //add more fields that will populate all the other columns in the table!
            entityManager.persist(customer);
            entityManager.getTransaction().commit();*
        }
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Execute novamente o aplicativo e adicione um novo cliente no banco de dados.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_excluir">Excluir</h3>
<div class="paragraph">
<p>Nesta seção, você permite que o usuário exclua uma entrada selecionada no banco de dados. Usando os conceitos e códigos acima descritos, implemente você mesmo a ação Excluir.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Crie uma nova ação,  <code>DeleteAction</code> . Decida se deseja vinculá-la a um nó Customer ou se deseja vinculá-la à barra de ferramentas, à barra de menus, ao atalho do teclado ou a uma combinação destes. Dependendo de onde deseja vinculá-la, você precisará usar uma abordagem em seu código. Leia novamente o tutorial para obter ajuda, especialmente ao examinar como a ação "Novo" foi criada, enquanto a compara com a ação "Atualizar" no nó raiz.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Obtenha o  <code>Customer</code>  atual, retorne uma caixa de diálogo 'Tem certeza?', e a seguir exclua a entrada. Para obter ajuda neste ponto, leia novamente o tutorial, focando na parte onde a funcionalidade "Salvar" é implementada. Ao invés de salvar, você agora deseja excluir uma entrada do banco de dados.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_consulte_também">Consulte também</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Isto conclui o tutorial CRUD da plataforma NetBeans. Este documento descreveu como criar um novo aplicativo na plataforma NetBeans com a funcionalidade CRUD para um determinado banco de dados. Para obter mais informações sobre a criação e o desenvolvimento de aplicativos, consulte os seguintes recursos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://netbeans.apache.org/kb/docs/platform_pt_BR.html">Trilha do aprendizado da plataforma NetBeans</a></p>
</li>
<li>
<p><a href="http://bits.netbeans.org/dev/javadoc/">Javadoc da API da NetBeans </a></p>
</li>
</ul>
</div>
</div>
</div>
            
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/68/nbm-crud_pt_BR.asciidoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

        </div>
        

<div class='grid-container incubator-area' style='margin-top: 64px'>
    <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/">
                <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
            </a>
        </div>
        <div class='large-auto cell text-center'>
            <a href="https://www.apache.org/events/current-event.html">
               <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
            </a>
        </div>
    </div>
</div>
<footer>
    <div class="grid-container">
        <div class="grid-x grid-padding-x">
            <div class="large-auto cell">
                
                <h1><a href="/about/index.html">About</a></h1>
                <ul>
                    <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
                    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                    <li><a href="https://www.apache.org/security/">Security</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/community/index.html">Community</a></h1>
                <ul>
                    <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
                    <li><a href="/community/committer.html">Becoming a committer</a></li>
                    <li><a href="/community/events.html">NetBeans Events</a></li>
                    <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/participate/index.html">Participate</a></h1>
                <ul>
                    <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
                    <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
                    <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/help/index.html">Get Help</a></h1>
                <ul>
                    <li><a href="/help/index.html#documentation">Documentation</a></li>
                    <li><a href="/wiki/index.asciidoc">Wiki</a></li>
                    <li><a href="/help/index.html#support">Community Support</a></li>
                    <li><a href="/help/commercial-support.html">Commercial Support</a></li>
                </ul>
            </div>
            <div class="large-auto cell">
                <h1><a href="/download/index.html">Download</a></h1>
                <ul>
                    <li><a href="/download/index.html">Releases</a></li>                    
                    <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
                    <li><a href="/download/index.html#source">Building from source</a></li>
                    <li><a href="/download/index.html#previous">Previous releases</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<div class='footer-disclaimer'>
    <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2022 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
            <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
            <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
            <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
        
    </div>
</div>



        <script src="/js/vendor/jquery-3.2.1.min.js"></script>
        <script src="/js/vendor/what-input.js"></script>
        <script src="/js/vendor/jquery.colorbox-min.js"></script>
        <script src="/js/vendor/foundation.min.js"></script>
        <script src="/js/netbeans.js"></script>
        <script>
            
            $(function(){ $(document).foundation(); });
        </script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        <script>
         $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
        </script>
        
    </body>
</html>
