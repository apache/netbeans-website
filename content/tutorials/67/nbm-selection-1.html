
<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>NetBeans Selection Management Tutorial I—Using a TopComponent&#8217;s Lookup</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NetBeans Selection Management Tutorial I—Using a TopComponent's Lookup - Apache NetBeans">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans Platform, Platform Tutorials, NetBeans Selection Management Tutorial I—Using a TopComponent's Lookup">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"> 
    <link rel="stylesheet" href="/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    

<div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="/"><img src='/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <a href="/community/index.html">Community</a> </li>
            <li> <a href="/participate/index.html">Participate</a> </li>
            <li> <a href="https://blogs.apache.org/netbeans/">Blog</a></li>
            <li> <a href="/help/index.html">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="/download/index.html">Download</a> </li>
        </ul>
    </div>
</div>


    
<!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 18</h1>
            <p><a class="button success" href="/download/nb18/">Download</a></p>
        </div>
    </div>
</section>

    <div class='grid-container main-content tutorial'>
      <h1 class="sect0">NetBeans Selection Management Tutorial I—Using a TopComponent&#8217;s Lookup</h1>
            
            <div class="sectionbody">
              <div class="admonitionblock note">
                <table>
                  <tbody><tr>
                  <td class="icon"><i class="fa icon-note" title="Note"></i></td>
                  <td class="content">This tutorial needs a review. 
                     You can <a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/67/nbm-selection-1.adoc" title="Edit this tutorial in github">edit it in GitHub </a>
                     following these <a href="/kb/docs/contributing.html">contribution guidelines.</a></td>
                  </tr></tbody>
                </table>
              </div>
            </div>
            
        <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_introduction_to_selection">Introduction to Selection</a></li>
<li><a href="#_creating_the_module_suite_and_projects">Creating the Module Suite and Projects</a></li>
<li><a href="#_creating_an_api_and_setting_up_dependencies">Creating an API and Setting Up Dependencies</a></li>
<li><a href="#_creating_the_viewer_component">Creating the Viewer Component</a></li>
<li><a href="#_creating_the_editor_component">Creating the Editor Component</a></li>
<li><a href="#_opening_editor_components">Opening Editor Components</a></li>
<li><a href="#_running_the_code">Running the Code</a></li>
<li><a href="#_so_whats_the_point">So, What&#8217;s the Point?</a></li>
<li><a href="#_changing_selected_objects_on_the_fly">Changing Selected Objects on the Fly</a></li>
<li><a href="#_providing_more_than_one_object">Providing More Than One Object</a></li>
<li><a href="#_miscellaneous_things_worth_noticing">Miscellaneous Things Worth Noticing</a></li>
<li><a href="#_next_steps">Next Steps</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial covers how to write components that provide a "selected object" and how to write components that update themselves as the global selection changes.</p>
</div>
<div class="paragraph">
<p>Optionally, for troubleshooting purposes, you can  <a href="http://plugins.netbeans.org/PluginPortal/faces/PluginDetailPage.jsp?pluginid=3146">download the completed sample</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction_to_selection">Introduction to Selection</h2>
<div class="sectionbody">
<div class="paragraph">
<p>"Selection" is an important concept for any non-trivial application. NetBeans has two basic concepts of selection—the contents of the focused `  <a href="https://netbeans.apache.org/wiki/devfaqwindowstopcomponent">TopComponent</a><code>'s ` <a href="https://netbeans.apache.org/wiki/devfaqlookup">Lookup</a></code>, and the focused <code>TopComponent&#8217;s  <a href="https://netbeans.apache.org/wiki/devfaqwhatisanode"> activated `Node</code>(s)</a>. Here you will deal only with the Lookup portion of selection—doing more advanced things will be covered in a later tutorial.</p>
</div>
<div class="paragraph">
<p>Selection is used to make possible such things as context sensitive actions (actions that are enabled or disabled depending on what is displayed), and palette windows such as the Property Sheet or Navigator components in the IDE, which each display some aspect of whatever is selected.</p>
</div>
<div class="paragraph">
<p>Basically, each <code>TopComponent</code> has a bag of objects that it can put things into, and which other code is able to query. That bag of objects is its <em>Lookup</em>—essentially a Map where the keys are class objects and the values are objects that extend or implement the key-class. The thing that makes this approach tremendously useful is the ability to use this mechanism to decouple the components that provide some object and the components that consume those objects—so they can be implemented in separate modules, or new editors for old objects can be provided and the rest of the system will continue to work transparently.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_the_module_suite_and_projects">Creating the Module Suite and Projects</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The example for this tutorial will contain three modules, contained within a module suite, as illustrated below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/selection-1_project-setup-60.png" alt="selection 1 project setup 60">
</div>
</div>
<div class="paragraph">
<p>Start by creating the module suite to contain all three modules:</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Choose File &gt; New Project (Ctrl-Shift-N). Under Categories, select NetBeans Modules. Under Projects, select Module Suite Project and click Next.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>In the Name and Location panel, type  <code>SelectionSuite</code>  in Project Name. Change the Project Location to any directory on your computer. Click Finish.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Choose File &gt; New Project (Ctrl-Shift-N) again. Under Categories, select NetBeans Modules. Under Projects, select Module Project and click Next.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>In the Name and Location panel, type  <code>MyAPI</code>  in Project Name. The default in the wizard should be to create the module underneath the directory where you just created the suite, which is fine. Click Next.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>In the Basic Module Configuration panel, replace  <code>yourorg</code>  in Code Name Base with  <code>myorg</code> , so that the whole code name base is  <code>org.myorg.myapi</code> . Add spaces to the default Module Display Name, so that it is changed to  <code>My API</code> . Leave the location of the localizing bundle, so that they will be stored in a package with the name  <code>org/myorg/myapi</code> . Do not let the IDE create an XML layer file, because you will not need it in this tutorial. Click Finish.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>You&#8217;re going to create two more modules now—follow the same steps above, but using the names "MyEditor" and "MyViewer". The reason you are creating three modules will be clear as you continue.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_an_api_and_setting_up_dependencies">Creating an API and Setting Up Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>What you&#8217;re going to do here is create a trivial API class. In the real world, such an API might represent files or some other kind of data that is being modelled programmatically. For the purposes of this tutorial it will suffice to have simple objects with a couple of properties.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Right click the <code>org.myorg.myapi</code> package and choose New &gt; Java Class, as shown below:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/selection-1_create-java-class-60.png" alt="selection 1 create java class 60">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Name the class <code>APIObject</code>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Replace the default code with the following:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public final class APIObject {

   private final Date date = new Date();
   private static int count = 0;
   private final int index;

   public APIObject() {
      index = count++;
   }

   public Date getDate() {
      return date;
   }

   public int getIndex() {
      return index;
   }

   public String toString() {
       return index + " - " + date;
   }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will be all of the code that this module contains. As you can see, each time a new instance of <code>APIObject</code> is created, a counter is incremented—so there will be some unique attribute to each instance of <code>APIObject</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>The next step is to have your API module export the <code>org.myorg.myapi</code> package so other modules can see classes in it. Right click the My API project and choose Properties.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
In the API Versioning page in the Project Properties dialog box, check the checkbox for <code>org.myorg.api</code> in the Public Packages list, shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/selection-1_export-package-60.png" alt="selection 1 export package 60">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Now you need to set up some dependencies between your modules. The other two modules, My Editor and My Viewer, will use the <code>APIObject</code> class, so each of them needs to say that they <em>depend on</em> the API module. For each of the other module projects in turn, right click the project node and choose Properties.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
In the Libraries page of each Project Properties dialog box, click the Add Dependency button. In the dialog box that pops up, type <code>APIObject</code>—there should be only one match, which is your API module. Select it and click OK to add the dependency.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/selection-1_add-deps-60.png" alt="selection 1 add deps 60">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_the_viewer_component">Creating the Viewer Component</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now you will create a singleton component that will track if there is an <code>APIObject</code> available in the global selection (i.e., if the focused <code>TopComponent</code> has one in its Lookup). If there is one, it will display some data about it. One common use case for this sort of thing is creating master/detail views.</p>
</div>
<div class="paragraph">
<p>A "singleton component" is a component like the Projects window in the NetBeans IDE, or the Property Sheet or the Navigator—a component that there is only ever one of in the system. The Window Component wizard will automatically generate all of the code needed to create such a singleton component—you just have to use the form designer or write code to provide the contents of your singleton component.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Right click the <code>org.myorg.myviewer</code> package and choose New &gt; Other.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>In the resulting dialog, select Module Development &gt; Window Component and click Next (or press Enter).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
On the "Basic Settings" page of the wizard, select <code>navigator</code> as the location in which to place your viewer component, and check the checkbox to open the component on startup, as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/selection-1_new-window-60.png" alt="selection 1 new window 60">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click Next to continue to the "Name, Icon and Location" page of the wizard.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>On the following page, name the class <code>MyViewer</code> and click Finish (or press Enter).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You now have a skeleton <code>TopComponent</code>—a singleton component called <code>MyViewerTopComponent</code>. Click the editor tab for <code>MyViewerTopComponent</code>—the form editor should be visible. You will add two labels to the component, which will display some information about the selected <code>APIObject</code> if there is one.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Drag two JLabels to the form from the Palette, one below the other.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/selection-1_viewer-form-editor.png" alt="selection 1 viewer form editor">
</div>
</div>
<div class="paragraph">
<p>Change the text of the first as shown above, so that by default it displays "[nothing selected]".</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Click the Source button in the editor toolbar to switch to the code editor</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Modify the signature of the class, so that <code>MyViewerTopComponent</code> implements <code>LookupListener</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class MyViewerTopComponent extends TopComponent implements LookupListener {</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Right-click in the editor and choose Fix Imports, so that <code>LookupListener</code> is imported.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>1.
Put the caret in the signature line as shown below. A lightbulb glyph should appear in the editor margin. Press Alt-Enter, and then Enter again when the popup appears with the text "Implement All Abstract Methods". This will add the LookupListener method to your class.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/selection-1_implement-methods.png" alt="selection 1 implement methods">
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>You now have a class that implements <code>LookupListener</code>. Now it needs something to listen to. In your case, there is a convenient global Lookup object, which simply proxies the Lookup of whatever component has focus—it can be obtained from the call <code>Utilities.actionsGlobalContext()</code>. So rather than tracking what component has focus yourself, you can simply listen to this one global selection lookup, which will fire appropriate changes whenever focus changes. Edit the source code so that it contains the following methods as shown here:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">    private Lookup.Result result = null;
    public void componentOpened() {
        Lookup.Template tpl = new Lookup.Template (APIObject.class);
        result = Utilities.actionsGlobalContext().lookup(tpl);
        result.addLookupListener (this);
    }

    public void componentClosed() {
        result.removeLookupListener (this);
        result = null;
    }

    public void resultChanged(LookupEvent lookupEvent) {
        Lookup.Result r = (Lookup.Result) lookupEvent.getSource();
        Collection c = r.allInstances();
        if (!c.isEmpty()) {
            APIObject o = (APIObject) c.iterator().next();
            jLabel1.setText (Integer.toString(o.getIndex()));
            jLabel2.setText (o.getDate().toString());
        } else {
            jLabel1.setText("[no selection]");
            jLabel2.setText ("");
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>componentOpened()</code> is called whenever the component is made visible by the window system; <code>componentClosed()</code> is called whenever the user clicks the X button on its tab to close it. So whenever the component is showing, you want it to be tracking the selection—which is what the above code does.</p>
</div>
<div class="paragraph">
<p>The <code>resultChanged()</code> method is your implementation of <code>LookupListener</code>. Whenever the selected <code>APIObject</code> changes, it will update the two `JLabel`s you put on the form.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_the_editor_component">Creating the Editor Component</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now you need something to actually provide instances of <code>APIObject</code>, for this code to be of any use. Fortunately this is quite simple.</p>
</div>
<div class="paragraph">
<p>You will create another <code>TopComponent</code>, this time, one that opens in the editor area and offers an instance of <code>APIObject</code> from its <code>Lookup</code>. You <em>could</em> use the Window Component template again, but that template is designed for creating singleton components, rather than components there can be many of. So you will simply create a <code>TopComponent</code> subclass without the template, and an action which will open additional ones.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>You will need to add three dependencies to the My Editor module for it to be able to find the classes you will be using. Right click the My Editor project and choose Properties. On the Library page of the Project Properties dialog box, click the Add Dependency button, and type <code>TopComponent</code>. The dialog should automatically suggest setting a dependency on the Window System API. Do the same thing for <code>Lookups</code> (Utilities API).</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Right-click the <code>org.myorg.myeditor</code> package in the My Editor project, and choose New &gt; JPanel Form.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Name it "MyEditor", and finish the wizard.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>When the form editor opens, drop two JTextFields on the form, one above the other. On the property sheet, set the Editable property (checkbox) to <code>false</code> for each one.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Click the Source button in the editor toolbar to switch to the code editor.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Change the signature of <code>MyEditor</code> to extends <code>TopComponent</code> instead of <code>javax.swing.JPanel</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class MyEditor extends TopComponent {</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Add the following code to the constructor of <code>MyEditor</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">APIObject obj = new APIObject();
associateLookup (Lookups.singleton (obj));
jTextField1.setText ("APIObject #" + obj.getIndex());
jTextField2.setText ("Created: " + obj.getDate());
setDisplayName ("MyEditor " + obj.getIndex());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Right-click in the editor and choose Fix Imports.</p>
</div>
<div class="paragraph">
<p>The line <code>associateLookup (Lookups.singleton (obj));</code> will create a Lookup that contains only one object—the new instance of <code>APIObject</code>—and assign that <code>Lookup</code> to be what is returned by <code>MyEditor.getLookup()</code>. While this is an artificial example, you can imagine how <code>APIObject</code> might represent a file, an entity in a database or anything else you might want to edit or view. Probably you can also imagine one component that allowed you to select or edit multiple unique instances of <code>APIObject</code>—that will be the subject of the next tutorial.</p>
</div>
<div class="paragraph">
<p>To make your editor component at least somewhat interesting (though it doesn&#8217;t actually edit anything), you set the text fields' values to values from the <code>APIObject</code>, so you have something to display.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_opening_editor_components">Opening Editor Components</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now you need a way to open <code>MyEditor</code> components in the editor area, so that there will be something to show. To do anything meaningful with selection, you will need more than one editor so that there is more than one <code>APIObject</code> to track. Since you will want multiple editors, you need a simple action on the main menu which will create and open another instance of <code>MyEditor</code> in the window system (as opposed to what the Window Component template would create for us, which is an action that always looks up a singleton component such as the Navigator or Property Sheet components in the IDE).</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Right click the <code>org.myorg.myeditor</code> package and choose New &gt; Other.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>In the dialog, choose Module Development &gt; Action and click Next.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Accept the defaults ("always enabled") and press Next again.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>On the GUI Registration page, accept the defaults by pressing Next again (this will cause your action to appear at the top of the File menu).</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>On the final page of the wizard, name the action <code>OpenEditorAction</code> and set its display name to say "Open Editor".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Press Finish to generate the action class.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>The code editor should now be open over a class called <code>OpenEditorAction</code>, which implements <code>ActionListener</code>. Add the following code to its <code>actionPerformed()</code> method:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">MyEditor editor = new MyEditor();
editor.open();
editor.requestActive();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above code will simply create a new instance of <code>MyEditor</code> (which in turn will create a new instance of <code>APIObject</code> and put it in its <code>Lookup</code>) and open it in the window system.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_the_code">Running the Code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now you&#8217;re ready to run the tutorial. Simply right click <code>SelectionSuite</code>, the module suite which owns your three modules, and choose Run from the popup menu. When the IDE opens, simply choose File &gt; Open Editor—invoke your action. Do this a couple of times, so that there are several of your editor components open. Your singleton <code>MyViewer</code> window should also be open. Notice how the <code>MyViewer</code> window&#8217;s contents change as you click different tabs, as shown here:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/selection-1_result-1-60.png" alt="selection 1 result 1 60">
</div>
</div>
<div class="paragraph">
<p>If you click in the Projects window, notice that the text changes to "[No Selection]", as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/selection-1_result-2-60.png" alt="selection 1 result 2 60">
</div>
</div>
<div class="paragraph">
<p>If you do not see the <code>MyViewer</code> window, you probably did not check the checkbox in the wizard to open it on system start—simply go to the Window menu and choose Open MyViewer Window to display it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_so_whats_the_point">So, What&#8217;s the Point?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You might be wondering what the point of this exercise is—you&#8217;ve just shown that you can handle selection—big deal! The key to the importance of this is the way the code is split into three modules: The My Viewer module knows nothing about the My Editor module—either one can run by itself. They only share a common dependency on My API. That&#8217;s important—it means two things: 1. My Viewer and My Editor can be developed and shipped independently, and 2. Any module that wants to provide a different sort of editor than My Editor can do so, and the viewer component will work perfectly with it, as long as the replacement editor offers an instance of <code>APIObject</code> from its Lookup.</p>
</div>
<div class="paragraph">
<p>To really picture the value of this, imagine <code>APIObject</code> were something much more complex; imagine that <code>MyEditor</code> is an image editor, and ` APIObject` represents an image being edited. The thing that&#8217;s powerful here is that you could replace <code>MyEditor</code> with, say, an SVG vector-based editor, and the viewer component (presumably showing attributes of the currently edited image) will work transparently with that new editor. It is this model of doing things that is the reason you can add new tools into the NetBeans IDE that work against Java files, and they will work in different versions of NetBeans, and that you can have an alternate editor (such as the form editor) for Java files and all the components and actions that work against Java files still work when the form editor is used.</p>
</div>
<div class="paragraph">
<p>This is very much the way NetBeans works with Java and other source files— in their case, the thing that is available from the editor&#8217;s Lookup is a ` <a href="https://netbeans.apache.org/wiki/devfaqdataobject">DataObject</a><code>, and components like Navigator and the Property Sheet are simply watching what object is being made available by the focused `TopComponent</code>.</p>
</div>
<div class="paragraph">
<p>Another valuable thing about this approach is that often people are migrating existing applications to the NetBeans platform. The object that is part of the data model, in that case, is probably existing, working code that should not be changed in order to integrate it into NetBeans. By keeping the data model&#8217;s API in a separate module, the NetBeans integration can be kept separate from the core business logic.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_changing_selected_objects_on_the_fly">Changing Selected Objects on the Fly</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To make it really evident how powerful this approach can be, you&#8217;ll take one more step, and add a button to your editor component that lets it replace the <code>APIObject</code> it has with a new one on the fly.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Open <code>MyEditor</code> in the form editor (click the Design toolbar button in the editor toolbar), and drag a <code>JButton</code> to it.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Set the <code>text</code> property of the JButton to "Replace".</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Right click the <code>JButton</code> and choose Events &gt; Action &gt; actionPerformed. This will cause the code editor to open with the caret in an event handler method.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>At the head of the class definition, you will add one final field:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public class MyEditor extends TopComponent {
    private final InstanceContent content = new InstanceContent();</code></pre>
</div>
</div>
<div class="paragraph">
<p>InstanceContent is a class which allows us to modify the content of a Lookup (specifically an instance of <code>AbstractLookup</code>) on the fly.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Copy all of the lines you added earlier to the constructor to the clipboard, and delete them from the constructor, except for the line beginning "associateLookup&#8230;&#8203;". That line of the constructor should be changed as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">associateLookup (new AbstractLookup (content));</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>You will be using the lines that you put on the clipboard in the action handler for the JButton—so you should run this code once when you first initialize the component. Add the following line to the constructor, after the line above:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">jButton1ActionPerformed (null);</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Modify the event handler method so it appears as follows, pasting from the clipboard and adding the line at the end:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {
    APIObject obj = new APIObject();
    jTextField1.setText ("APIObject #" + obj.getIndex());
    jTextField2.setText ("Created: " + obj.getDate());
    setDisplayName ("MyEditor " + obj.getIndex());
    content.set(Collections.singleton (obj), null);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Right-click in the editor and choose Fix Imports.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You&#8217;re now ready to run the suite again. Right click SelectionSuite again and choose Run. Notice how, now, when you click the Replace button, all of the components update, including the instance of <code>MyViewer</code>—everything.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/selection-1_first-run-60.png" alt="selection 1 first run 60">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_providing_more_than_one_object">Providing More Than One Object</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is all well and good for decoupling, but isn&#8217;t providing this one object from your component a bit like having a <code>Map</code> that only contains one key and one value? The answer is, yes, it is like that. Where this technique becomes even more powerful is when you provide multiple objects from multiple APIs.</p>
</div>
<div class="paragraph">
<p>As an example, it is very common in NetBeans to provide context sensitive actions. A case in point is the built-in <code>SaveAction</code> that is part of NetBeans' Actions API. What this action actually does is, it simply listens for the presence of something called <code>SaveCookie</code> on the global context— the same way your viewer window listens for <code>APIObject</code>. If a <code>SaveCookie</code> appears (editors typically add one to their lookup when the content of the file is modified but not yet saved), the action becomes enabled, so the Save toolbar button and menu items become enabled. When the Save action is invoked, it calls <code>SaveCookie.save()</code>, which in turn causes the <code>SaveCookie</code> to disappear, so the Save action then becomes disabled until a new one appears.</p>
</div>
<div class="paragraph">
<p>As you may have noticed, context sensitivity was one option in the New Action wizard. The actions currently generated by the wizard actually use a way of doing this that pre-dates <code>Lookup</code>; the Lookup-based way of doing such context sensitive actions is described  <a href="https://netbeans.apache.org/wiki/devfaqactioncontextsensitive">in the developer FAQ</a>.</p>
</div>
<div class="paragraph">
<p>So the pattern in practice is to provide more than just a single object from your component&#8217;s <code>Lookup</code>—different auxilliary components and different actions will be interested in different aspects of the object being edited. These aspects can be cleanly separated into interfaces which those auxilliary components and actions can depend on and listen for.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_miscellaneous_things_worth_noticing">Miscellaneous Things Worth Noticing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While not directly related to the topic of this tutorial, it&#8217;s worth noticing that if you open three <code>MyEditor</code> instances, and shut down and restart NetBeans, you end up with three <code>MyEditor</code> instances magically appearing on restart. By default, your editors are serialized to disk on shutdown and restored on restart.</p>
</div>
<div class="paragraph">
<p>If you do not want this behavior, there are two other choices. Override the following method on <code>MyEditor</code> to cause editors <em>never</em> to be reopened on restart:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">public int getPersistenceType() {
    return PERSISTENCE_NEVER;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to persist the components that are open but discard those that have been closed, return <code>PERSISTENCE_ONLY_OPENED</code> instead. The default (for backward compatibility reasons) is <code>PERSISTENCE_ALWAYS</code>, which is not appropriate for editor-style componenents—it means that even editors that have been closed are kept forever and reloaded on restart.</p>
</div>
<div class="paragraph">
<p>Note, though, that part of what is serialized to disk is the <em>location</em> of your component in the main window. So singleton <code>TopComponents`s such as the property sheet, or our viewer component, should use `PERSISTENCE_ALWAYS</code> - otherwise if they are closed once by the user, the next time they are opened they will appear in the editor area instead of where they are supposed to be.</p>
</div>
<div class="paragraph">
<p><a href="http://netbeans.apache.org/community/mailing-lists.html">Send Us Your Feedback</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps">Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By now you may have noticed that some components have more granular selection logic, and even involve multiple selection. In the  <a href="nbm-selection-2.html"> next tutorial</a> you will cover how to use the  <a href="https://bits.netbeans.org/dev/javadoc/org-openide-nodes/overview-summary.html">Nodes API</a> to handle that.</p>
</div>
</div>
</div>
        
<section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        
        <li><a href="https://github.com/apache/netbeans-website/blob/master/netbeans.apache.org/src/content/tutorials/67/nbm-selection-1.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>

    </div>
    

    <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
                    
            <h1><a href="/about/index.html">About</a></h1>
            <ul>
              <li><a href="https://netbeans.apache.org/community/who.html">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/community/index.html">Community</a></h1>
            <ul>
              <li><a href="/community/mailing-lists.html">Mailing lists</a></li>
              <li><a href="/community/committer.html">Becoming a committer</a></li>
              <li><a href="/community/events.html">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/participate/index.html">Participate</a></h1>
            <ul>
              <li><a href="/participate/submit-pr.html">Submitting Pull Requests</a></li>
              <li><a href="/participate/report-issue.html">Reporting Issues</a></li>
              <li><a href="/participate/index.html#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/help/index.html">Get Help</a></h1>
            <ul>
              <li><a href="/help/index.html#documentation">Documentation</a></li>
              <li><a href="/wiki/index.html">Wiki</a></li>
              <li><a href="/help/index.html#support">Community Support</a></li>
              <li><a href="/help/commercial-support.html">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="/download/index.html">Download</a></h1>
            <ul>
              <li><a href="/download/index.html">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="/download/index.html#source">Building from source</a></li>
              <li><a href="/download/index.html#previous">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
            
      </div>
    </div>


    

    <script src="/js/vendor/jquery-3.2.1.min.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.min.js"></script>
    <script src="/js/vendor/jquery.colorbox-min.js"></script>
    <script src="/js/netbeans.js"></script>
    <script>

       $(function(){ $(document).foundation(); });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
       $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); }); 
    </script>

  </body>
</html>
