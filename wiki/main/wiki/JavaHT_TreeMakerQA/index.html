<!doctype html>
<html class="no-js" lang="en" dir="ltr">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>TreeMaker Difficulties, Questions and Answers</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Apache NetBeans wiki JavaHT TreeMakerQA">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans wiki JavaHT TreeMakerQA">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="../../../../_/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="../../../../_/css/highlight-11.9.0.default.min.css">
    <link rel="stylesheet" href="../../../../_/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../_/images/fav/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../_/images/fav/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../_/images/fav/favicon-16x16.png">
    <link rel="manifest" href="../../../../_/images/fav/site.webmanifest">
    <link rel="mask-icon" href="../../../../_/images/fav/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="../../../../_/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="../../../../index.html"><img src='../../../../_/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <input id="search-input" type="text" placeholder="Search the docs"> </li>
            <li> <a href="../../../../front/main/community">Community</a> </li>
            <li> <a href="../../../../front/main/participate">Participate</a> </li>
            <li> <a href="../../../../front/main/blogs">Blog</a></li>
            <li> <a href="../../../../front/main/help">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="../../../../front/main/download">Download</a> </li>
        </ul>
    </div>
</div>

    <!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 22</h1>
            <p><a class="button success" href="../../../../front/main/download/nb22">Download</a></p>
        </div>
    </div>
</section>
    <div class='grid-container main-content'>
      <article class="doc">
      <h1 style="visibily: hidden">TreeMaker Difficulties, Questions and Answers</h1>
      <div class='aside' style='text-align: center; padding: 20px;'>
    <a href="../../../../wiki/main/wiki" title="Apache NetBeans WIKI">Apache NetBeans Wiki Index</a>
    <p><b>Note:</b> These pages are being reviewed.</p>
</div>
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_question_how_to_rewrite_javamdr_modification_code_to_new_api">Question: How to rewrite Java/MDR modification code to new API?</a></li>
<li><a href="#_question_i_need_to_make_textual_replace_of_the_tags_from_the_template_with_some_values_in_method_body">Question: I need to make textual replace of the tags from the template with some values in method body</a></li>
<li><a href="#_question_how_do_i_create_a_constructor_passing_typekind_void_as_the_return_type_to_treemaker_method_generates_a_method_with_a_void_return_type">Question: How do I create a constructor? Passing TypeKind.VOID as the return type to TreeMaker.Method() generates a method with a void return type.</a></li>
<li><a href="#_question_create_an_import_and_add_it_to_a_class">Question: Create an Import and add it to a class</a></li>
<li><a href="#_question_create_that_some_imports_are_not_already_there">Question: Create that some imports are not already there</a></li>
<li><a href="#_question_create_a_method">Question: Create a method</a></li>
<li><a href="#_question_add_a_method_to_a_class">Question: Add a method to a class</a></li>
<li><a href="#_question_set_a_super_class">Question: Set a super class</a></li>
<li><a href="#_question_add_a_parameter_to_a_constructor">Question: Add a parameter to a constructor</a></li>
<li><a href="#_question_add_a_field_to_a_class">Question: Add a field to a class</a></li>
<li><a href="#_question_remove_constructors_throws_clause">Question: Remove constructor&#8217;s 'throws' clause</a></li>
<li><a href="#_question_clear_body_text">Question: Clear body text</a></li>
<li><a href="#_question_type_object">Question: Type object</a></li>
<li><a href="#_question_access_to_the_string_representation_of_a_method_body">Question: Access to the String representation of a method body</a></li>
<li><a href="#_question_contextualize_the_java_classes_search">Question: Contextualize the Java classes search</a></li>
<li><a href="#_question_add_a_set_of_exceptions_to_a_method">Question: Add a set of Exceptions to a method</a></li>
<li><a href="#_question_how_to_make_the_class_implements_an_interface">Question: How to make the class implements an interface</a></li>
<li><a href="#_question_how_do_i_create_a_field_with_an_initial_value_if_the_initial_value_is_not_a_primitive_for_example_something_like_the_following">Question: How do I create a field with an initial value if the initial value is not a primitive, for example something like the following?</a></li>
<li><a href="#_question_how_to_access_and_update_the_javadoc_of_an_existing_class">Question: How to access and update the Javadoc of an existing class.</a></li>
<li><a href="#_question_how_to_create_a_comment_within_an_annotation">Question: How to create a comment within an annotation?</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="_question_how_to_rewrite_javamdr_modification_code_to_new_api"><a class="anchor" href="#_question_how_to_rewrite_javamdr_modification_code_to_new_api"></a>Question: How to rewrite Java/MDR modification code to new API?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Answer: Most of the actions can be replaced by the new method. There are several conceptual differences: The most important and visible is immutability of the new trees, so you cannot modify original model elements (in Java/MDR speech), you have to always create new tree (in Retouche speech). Here are couple of examples:</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_i_need_to_make_textual_replace_of_the_tags_from_the_template_with_some_values_in_method_body"><a class="anchor" href="#_question_i_need_to_make_textual_replace_of_the_tags_from_the_template_with_some_values_in_method_body"></a>Question: I need to make textual replace of the tags from the template with some values in method body</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Answer: Currently there is no direct way how to do that. We could consider to add method to obtain body as a text to TreeMaker class, but bear in mind that such a method does not modify source, so it is not correct place. For the time being, you can workaround it by following code:</p>
</div>
<div class="paragraph">
<p>(Code will not work, there are still many bugs.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    ...
    TreeMaker make = workingCopy.getTreeMaker();
    ...
    MethodTree method = ...;
    BlockTree body = method.getBody();

    // get SourcePositions instance for your working copy and
    // fetch out start and end position.
    SourcePositions sp = workingCopy.getTrees().getSourcePositions();
    int start = (int) sp.getStartPosition(cut, body);
    int end = (int) sp.getEndPosition(cut, body);
    // get body text from source text
    String bodyText = workingCopy.getText().substring(start, end);
    MethodTree modified = make.Method(
        method.getModifiers(), // copy original values
        method.getName(),
        method.getReturnType(),
        method.getTypeParameters(),
        method.getParameters(),
        method.getThrows(),
        bodyText.replace("{0}", "-tag-replace-"), // replace body with the new text
        null // not applicable here
    );
    // rewrite the original modifiers with the new one:
    workingCopy.rewrite(method, modified);
    ...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_how_do_i_create_a_constructor_passing_typekind_void_as_the_return_type_to_treemaker_method_generates_a_method_with_a_void_return_type"><a class="anchor" href="#_question_how_do_i_create_a_constructor_passing_typekind_void_as_the_return_type_to_treemaker_method_generates_a_method_with_a_void_return_type"></a>Question: How do I create a constructor? Passing TypeKind.VOID as the return type to TreeMaker.Method() generates a method with a void return type.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Answer: by passing "&lt;init&gt;" as the method name and null as the return type. See also issue 88697.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_create_an_import_and_add_it_to_a_class"><a class="anchor" href="#_question_create_an_import_and_add_it_to_a_class"></a>Question: Create an Import and add it to a class</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Retouche:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">TreeMaker make;
CompilationUnitTree cut = ...;
CompilationUnitTree copy = make.addCompUnitImport(
    cut,
    make.Import(make.Identifier("java.io.IOException"), false)
);
workingCopy.rewrite(node, copy);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There is a management tool which allows to handle imports automatically. Use make.QualIdent to create expression tree - import will be handled for it, if it does not exist yet.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_create_that_some_imports_are_not_already_there"><a class="anchor" href="#_question_create_that_some_imports_are_not_already_there"></a>Question: Create that some imports are not already there</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is some kind of workaround. Users should use automatic import management (QualIdentTree) in the most cases. For those who request manual handling, use similar scenario in retouche:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">CompilationUnitTree cut = ...;
List&lt;ImportTree&gt; imports = cut.getImports();
for (ImportTree dovoz : imports) [
   if ("whateverYouWant".equals(dovoz.getQualifiedIndetifier().toString())) {
       found = true; break;
   }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is not recommended to make your own import management, instead of, use the automatic one. Use your own solution only if automatic one does not fit to your needs!
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_create_a_method"><a class="anchor" href="#_question_create_a_method"></a>Question: Create a method</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is very similar to other creations. All the stuff is done in TreeMaker. Here is a short example: Retouche:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// create modifiers for parameters (no modifier present) and create annotations. (again empty list)
ModifiersTree parMods = make.Modifiers(Collections.&lt;Modifier&gt;emptySet(), Collections.&lt;AnnotationTree&gt;emptyList());
// make a variable trees - representing parameters
VariableTree par1 = make.Variable(parMods, "a", make.PrimitiveType(TypeKind.INT), null);
VariableTree par2 = make.Variable(parMods, "b", make.PrimitiveType(TypeKind.FLOAT), null);
List&lt;VariableTree&gt; parList = new ArrayList&lt;VariableTree&gt;(2);
parList.add(par1);
parList.add(par2);

// now, start the method creation
MethodTree newMethod = make.Method(
            make.Modifiers(Collections.singleton(Modifier.PUBLIC)), // modifiers and annotations
            "newlyCreatedMethod", // name
            make.PrimitiveType(TypeKind.VOID), // return type
            Collections.&lt;TypeParameterTree&gt;emptyList(), // type parameters for parameters
            parList, // parameters
            Collections.singletonList(make.Identifier("java.io.IOException")), // throws
            make.Block(Collections.EMPTY_LIST, false), // empty statement block
            null // default value - not applicable here, used by annotations
        );</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_add_a_method_to_a_class"><a class="anchor" href="#_question_add_a_method_to_a_class"></a>Question: Add a method to a class</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Consider you have created method and want to add it to a superclass:</p>
</div>
<div class="paragraph">
<p>Java/MDR:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Class clazz = ...;
Method method = ...;
clazz.getContents().add(method);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retouche:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">TreeMaker make = ...;
ClassTree clazz = ...;
MethodTree method = make.Method(...);
ClassTree copy = make.addClassMember(clazz, method);
workingCopy.rewrite(clazz, copy);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_set_a_super_class"><a class="anchor" href="#_question_set_a_super_class"></a>Question: Set a super class</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Java/MDR:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Class clazz = ...;
clazz.setSuperClassName("motherClassName");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retouche:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClassTree clazz = ...;
ClassTree copy = clazz.setExtends(clazz, make.Identifier("MotherClassName");
workingCopy.rewrite(clazz, copy);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_add_a_parameter_to_a_constructor"><a class="anchor" href="#_question_add_a_parameter_to_a_constructor"></a>Question: Add a parameter to a constructor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Java/MDR:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Constructor construct = tgtClass.getConstructor(new ArrayList(), false);
Parameter param = pkg.getParameter().createParameter(
        "theRef", // NOI18N
        Collections.EMPTY_LIST, // annotations
        false, // is final
        getTypeRef(pkg, mbean.getWrappedClassName()), // typename
        0, // dimCount
        false);
construct.getParameters().add(param);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retouche:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">TreeMaker make = ...;
ClassTree clazz = ...;
MethodTree constr = ...;
VariableTree var = make.Variable(make.Modifiers(Collections.&lt;Modifier&gt;emptySet()), "theRef", make.Identifier("someType"), null);
MethodTree copy = make.addMethodParameter(constr, var);
workingCopy.rewrite(constr, copy);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_add_a_field_to_a_class"><a class="anchor" href="#_question_add_a_field_to_a_class"></a>Question: Add a field to a class</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Java/MDR:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Class clazz = ...;
Field refField = pkg.getField().createField("theRef", Collections.EMPTY_LIST, Modifier.PRIVATE, null, ...);
clazz.getFeatures().add(0, refField);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retouche:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">TreeMaker make = ...;
ClassTree clazz = ...;
VariableTree var = make.Variable(make.Modifiers(Modifier.PUBLIC), "theRef", make.Identifier("someType", null);
ClassTree clazzCopy = make.insertClassMember(0, var);
workingCopy.rewrite(clazz, clazzCopy);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All fields, local variables and parameters is represented by VariableTree in Jsr199.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_remove_constructors_throws_clause"><a class="anchor" href="#_question_remove_constructors_throws_clause"></a>Question: Remove constructor&#8217;s 'throws' clause</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Java/MDR:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Constructor construct = ...;
construct.getExceptionNames().clear();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retouche:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">TreeMaker make = ...;
MethodTree method = ...;
MethodTree modified = make.Method( // copy original values
    method.getModifiers(),
    method.getName(),
    method.getReturnType(),
    method.getTypeParameters(),
    method.getParameters(),
    Collections.&lt;ExpressionTree&gt;emptyList(), // use empty list instead of orig. value
    method.getBody(),
    null // not applicable here
);
workingCopy.rewrite(method, modified);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For exact 'throws' item removal, you can use methods make.removeMethodThrows(&#8230;&#8203;) in TreeMaker class.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_clear_body_text"><a class="anchor" href="#_question_clear_body_text"></a>Question: Clear body text</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Java/MDR:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Method method = ...;
method.setBodyText("");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retouche:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">TreeMaker make = ...;
MethodTree method = ..;
BlockTree emptyBlock = make.Block(Collections.&lt;StatementTree&gt;emptyList(), false);
workingCopy.rewrite(method.getBody(), emptyBlock);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_type_object"><a class="anchor" href="#_question_type_object"></a>Question: Type object</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_question_access_to_the_string_representation_of_a_method_body"><a class="anchor" href="#_question_access_to_the_string_representation_of_a_method_body"></a>Question: Access to the String representation of a method body</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is not any direct support for such a functionality. You have to obtain positions and then cut the string from the source. We consider about adding such a method somewhere to the API. (Currently no suitable places has been found.)</p>
</div>
<div class="paragraph">
<p>Java/MDR:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    String bodyText = method.getBodyText();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retouche:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    ...
    TreeMaker make = workingCopy.getTreeMaker();
    ...
    MethodTree method = ...;
    BlockTree body = method.getBody();

    // get SourcePositions instance for your working copy and
    // fetch out start and end position.
    SourcePositions sp = workingCopy.getTrees().getSourcePositions();
    int start = (int) sp.getStartPosition(cut, body);
    int end = (int) sp.getEndPosition(cut, body);
    // get body text from source text
    String bodyText = workingCopy.getText().substring(start, end);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_contextualize_the_java_classes_search"><a class="anchor" href="#_question_contextualize_the_java_classes_search"></a>Question: Contextualize the Java classes search</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_question_add_a_set_of_exceptions_to_a_method"><a class="anchor" href="#_question_add_a_set_of_exceptions_to_a_method"></a>Question: Add a set of Exceptions to a method</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Java/MDR:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">method.getExceptionNames().addAll(exceptions);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retouche:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">MethodTree node = ...; // original MethodTree node to modify
MethodTree copy = make.addMethodThrows(node, make.Identifier("IOException"));
copy = make.addMethodThrows(copy, make.Identifier("FileNotFoundException"));
workingCopy.rewrite(node, copy);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Short comment about functionality is available below in next question.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_how_to_make_the_class_implements_an_interface"><a class="anchor" href="#_question_how_to_make_the_class_implements_an_interface"></a>Question: How to make the class implements an interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Java/MDR:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">JavaModelPackage pkg = (JavaModelPackage) tgtClass.refImmediatePackage();
tgtClass.getInterfaceNames().add(pkg.getMultipartId().createMultipartId(
            "MBeanRegistration", // NOI18N
            null,
            Collections.EMPTY_LIST));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retouche:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">workingCopy.toPhase(Phase.RESOLVED);
TreeMaker make = workingCopy.getTreeMaker();
ClassTree clazz = ...; // obtain class somewhere
ClassTree copy = class.addImplementsClause(make.Identifier("MBeanRegistration"));
workingCopy.rewrite(class, copy);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Java/MDR:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">method.getExceptionNames().addAll(exceptions);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retouche:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">MethodTree method = ...;
List&lt;ExpressionTree&gt; listCopy = new ArrayList&lt;ExpressionTree&gt;(method.getThrows());
listCopy.add(exceptions);
MethodTree copy = make.Method(
       method.getModifiers(),
       method.getName(),
       method.getReturnType(),
       method.getTypeParameters(),
       method.getParameters(),
       listCopy,
       method.getBody(),
       null
);
workingCopy.rewrite(method, copy);</code></pre>
</div>
</div>
<div class="paragraph">
<p>From the example above, it is obvious that this solution is not straightforward enough. You have also another chance how to do it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Collection&lt;IdentifierTree&gt; exceptions = ...;
MethodTree method = ...;
MethodTree copy = make.addMethodThrows(method, make.Identifier("IOException"));
copy = make.addMethodThrows(copy, make.Identifier("FileNotFoundException"));
copy = make.addMethodThrows(copy, make.Identifier("IllegalArgumentException));
... etc.
workingCopy.rewrite(method, copy);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Bear in mind that in every next 'add' call, you have to use created copy instead of the original method MethodTree! (See the first parameter of addMethodThrows invocation.) This solution is shorter and simple to write, but it has minor performance impact when adding many items .It is up to user if he uses first or second solution, the result is the same. It is obvious that if you want to add just one item, you will use provided addMethodThrows method.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Users can be confused when add multiple 'extends' clause to interface. Extends clause in interface is represented by 'implements' clause in class.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_how_do_i_create_a_field_with_an_initial_value_if_the_initial_value_is_not_a_primitive_for_example_something_like_the_following"><a class="anchor" href="#_question_how_do_i_create_a_field_with_an_initial_value_if_the_initial_value_is_not_a_primitive_for_example_something_like_the_following"></a>Question: How do I create a field with an initial value if the initial value is not a primitive, for example something like the following?</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">MyClass field = Something.getMyClass();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Answer: Obviously you have to create appropriate tree, in the example above method invocation with member select tree inside.</p>
</div>
<div class="paragraph">
<p>Such a code might look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">...
CompilationUnitTree cut = workingCopy.getCompilationUnit();
TreeMaker make = workingCopy.getTreeMaker();
ClassTree clazz = (ClassTree) cut.getTypeDecls().get(0);
VariableTree var = make.Variable(make.Modifiers(
    Collections.&lt;Modifier&gt;emptySet(), Collections.&lt;AnnotationTree&gt;emptyList()),
    "myField",
    make.Identifier("MyClass"),
    make.MethodInvocation(
    Collections.&lt;ExpressionTree&gt;emptyList(),
    make.MemberSelect(
        make.Identifier("Something"), "getMyClass"),
        Collections.&lt;ExpressionTree&gt;emptyList()
    )
);
ClassTree copy = make.addClassMember(clazz, var);
workingCopy.rewrite(clazz, copy);
...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_how_to_access_and_update_the_javadoc_of_an_existing_class"><a class="anchor" href="#_question_how_to_access_and_update_the_javadoc_of_an_existing_class"></a>Question: How to access and update the Javadoc of an existing class.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Currently totally broken, there are issues reported and will be addressed in M7: (#89873, #90302, #92325) There are methods in CommentHandlerService, they will be perhaps reused.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are not familiar with trees enough, write sample source code, run user action task against the source code and dump the tree to some readable form. That allows you to learn how expressions are represented in tree.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_question_how_to_create_a_comment_within_an_annotation"><a class="anchor" href="#_question_how_to_create_a_comment_within_an_annotation"></a>Question: How to create a comment within an annotation?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It should be possible to add the comment using IdentifierTree (not a completely clean solution, though)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">IdentifierTree commentTree = make.Identifier("/* ... */");
AnnotationTree newAnnotation = treeMaker.Annotation(
treeMaker.QualIdent("com.acme.InsertedAnnotation"),
Collections.singletonList(commentTree));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Taken from <a href="mailto:nbdev@netbeans.org">nbdev@netbeans.org</a> / answered by jlahoda</p>
</div>
</div>
</div>
      <section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        <li><a href="https://github.com/apache/netbeans-antora-wiki/edit/main/modules/ROOT/pages/wiki/JavaHT_TreeMakerQA.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>
      </article>
    </div>
        <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="../../../../_/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/about">About</a></h1>
            <ul>
              <li><a href="../../../../front/main/community/who">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/community">Community</a></h1>
            <ul>
              <li><a href="../../../../front/main/community/mailing-lists">Mailing lists</a></li>
              <li><a href="../../../../front/main/community/committer">Becoming a committer</a></li>
              <li><a href="../../../../front/main/community/events">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/participate">Participate</a></h1>
            <ul>
              <li><a href="../../../../front/main/participate/submit-pr">Submitting Pull Requests</a></li>
              <li><a href="../../../../front/main/participate/report-issue">Reporting Issues</a></li>
              <li><a href="../../../../front/main/participate/#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/help">Get Help</a></h1>
            <ul>
              <li><a href="../../../../front/main/help/#documentation">Documentation</a></li>
              <li><a href="../../../../wiki/main/wiki">Wiki</a></li>
              <li><a href="../../../../front/main/help/#support">Community Support</a></li>
              <li><a href="../../../../front/main/help/commercial-support">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/download">Download</a></h1>
            <ul>
              <li><a href="../../../../front/main/download">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="../../../../front/main/download/#_daily_builds_and_building_from_source">Building from source</a></li>
              <li><a href="../../../../front/main/download/#_older_releases">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2024 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
      </div>
    </div>

    
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
    <script src="../../../../_/js/vendor/jquery-3.7.1.min.js"></script>
    <script src="../../../../_/js/vendor/what-input.js"></script>
    <script src="../../../../_/js/vendor/foundation.min.js"></script>
    <script src="../../../../_/js/vendor/jquery.colorbox-min.js"></script>
    <script src="../../../../_/js/netbeans.js"></script>
    <script>
       $(function(){ $(document).foundation(); });
    </script>
    <script src="../../../../_/js/vendor/highlight-11.9.0.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
         document.querySelectorAll('pre code').forEach((el) => {
         hljs.highlightElement(el);
        });
      });
    </script>
  </body>
</html>
