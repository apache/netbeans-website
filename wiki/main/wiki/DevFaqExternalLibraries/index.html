<!doctype html>
<html class="no-js" lang="en" dir="ltr">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>How to store external libraries in the NetBeans Hg repository</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Apache NetBeans wiki DevFaqExternalLibraries">
    <meta name="author" content="Apache NetBeans">
    <meta name="keywords" content="Apache NetBeans wiki DevFaqExternalLibraries">
    <meta name="generator" content="Apache NetBeans">
    <link rel="stylesheet" href="../../../../_/css/font-awesome.min.css">
    <link rel="alternate" type="application/atom+xml" title="Apache NetBeans Blog" href="https://netbeans.apache.org/blogs/atom" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
    <link rel="stylesheet" href="../../../../_/css/netbeans.css">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../_/images/fav/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../_/images/fav/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../_/images/fav/favicon-16x16.png">
    <link rel="manifest" href="../../../../_/images/fav/site.webmanifest">
    <link rel="mask-icon" href="../../../../_/images/fav/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
    <link href="../../../../_/css/font-open-sans.css" rel="stylesheet">
    <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at
        http://www.apache.org/licenses/LICENSE-2.0
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    -->
  </head>
  <body>
    <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
    <button type="button" data-toggle="responsive-menu"><i style='font-size: 32px; color: #fff; padding: 8px' class='fa fa-bars'></i></button>
    <div class="title-bar-title">Apache NetBeans</div>
</div>
<div class="top-bar" id="responsive-menu">
    <div class='top-bar-left'>
        <a class='title' href="../../../../index.html"><img src='../../../../_/images/apache-netbeans.svg' style='padding: 8px; height: 48px;'></img> Apache NetBeans</a>
    </div>
    <div class="top-bar-right">
        <ul class="vertical medium-horizontal menu" data-responsive-menu="drilldown medium-dropdown">
            <li> <input id="search-input" type="text" placeholder="Search the docs"> </li>
            <li> <a href="../../../../front/main/community">Community</a> </li>
            <li> <a href="../../../../front/main/participate">Participate</a> </li>
            <li> <a href="../../../../front/main/blogs">Blog</a></li>
            <li> <a href="../../../../front/main/help">Get Help</a> </li>
            <li> <a href="https://plugins.netbeans.apache.org/">Plugins</a> </li>
            <li> <a href="../../../../front/main/download">Download</a> </li>
        </ul>
    </div>
</div>

    <!-- src/templates/news -->
<section class="hero news alternate">
    <div class='grid-container'>
        <div class='cell'>
            <div class="annotation">Latest release</div>
            <h1>Apache NetBeans 19</h1>
            <p><a class="button success" href="../../../../front/main/download/nb19">Download</a></p>
        </div>
    </div>
</section>
    <div class='grid-container main-content'>
      <article class="doc">
      <h1 class="sect1">How to store external libraries in the NetBeans Hg repository</h1>
      <div class='aside' style='text-align: center; padding: 20px;'>
    <a href="../../../../wiki/main/wiki" title="Apache NetBeans WIKI">Apache NetBeans Wiki Index</a>
    <p><b>Note:</b> These pages are being reviewed.</p>
</div>
      <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_license_file_format">License file format</a></li>
<li><a href="#_template_based_licenses">Template-based licenses</a></li>
<li><a href="#_nbm_build_managing_correct_license_for_nbms">NBM build, managing correct license for NBMs</a></li>
<li><a href="#_normalized_names">Normalized names</a></li>
<li><a href="#_netbeans_samples">NetBeans Samples</a></li>
<li><a href="#_common_mistakes">Common mistakes</a></li>
<li><a href="#_implementation_work">Implementation work</a>
<ul class="sectlevel2">
<li><a href="#_static_verification_of_hg">Static verification of Hg</a></li>
<li><a href="#_things_done_in_ide_build">Things done in IDE build</a></li>
<li><a href="#_things_done_in_nbm_build">Things done in NBM build</a></li>
<li><a href="#_golden_files">Golden files</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In the spirit of building on the shoulders of giants,
NetBeans takes advantage of external libraries which are not developed on netbeans.org.
Those libraries are either open-source software,
or binary-only software but with liberal licenses.
A few examples: Apache Tomcat; JUnit; JavaHelp (runtime);
javac compiler; JSR-88 interface classes.</p>
</div>
<div class="paragraph">
<p>For convenience, these libraries are stored
in the same Hg repository as the source code under CDDL/GPL.
They are placed in well-known places in the source tree.
The license text is associated with the binary file
to make it clear which terms and conditions the users/developers must agree to
besides being compliant with the CDDL/GPL itself.
Only source code covered by the CDDL/GPL (or BSD, in the case of samples)
can be hosted in the <code><a href="http://hg.netbeans.org/main/">http://hg.netbeans.org/main/</a></code> repository.
As the NetBeans Hg tree is growing, we need to initiate stricter rules
and check that all external binary files have a correct associated license.
There are also several recommendations
on avoiding unnecessary additions of binary files into Hg.</p>
</div>
<div class="paragraph">
<p>The build system will automatically check if all binary files under <code>&lt;nbmodule&gt;/external</code>
are stored correctly with appropriate license and all required information.
<code>&lt;nbmodule&gt;</code> means NetBeans project module, e.g. <code>external</code> is on same level as <code>nbproject</code>.
<strong>Failing to do so will result in a broken build!</strong></p>
</div>
<div class="paragraph">
<p>Questions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>I need to store some binaries in my own VCS repository. Should I follow same rules as well? No, you do not have to. You can store your binaries under release/modules/ext/, more details are described in <code>harness/README</code></p>
</li>
<li>
<p>My binary is not a library and I need to store it somewhere else. It has been also created under CDDL. Then you should update <code>nbbuild/antsrc/org/netbeans/nbbuild/extlibs/ignored-binaries</code></p>
</li>
<li>
<p>How can I check all is all right? Run <code>ant verify-libs-and-licenses</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here are the rules NetBeans committers must follow when placing external libraries into NetBeans Hg:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Legal due diligence must be observed before using a new external library, to make sure that the library license is suitable for use in NetBeans.</p>
</li>
<li>
<p>All external binaries should be stored under a subdirectory named <code>&lt;nbmodule&gt;/external</code>, and nowhere else. (For the <code>contrib</code> repository, the path will be <code>contrib/&lt;nbmodule&gt;/external</code>.)</p>
</li>
<li>
<p>External binaries are versioned in Hg. <a href="#./ExternalBinaries.adoc" class="xref unresolved">ExternalBinaries</a> describes how the actual binary content is stored outside Hg, while the Hg repository actually tracks the SHA-1 hash of the binary. <code>ant download-selected-extbins</code> suffices to download all external binaries in a fresh checkout.</p>
</li>
<li>
<p>Each external binary should have a corresponding license file stored in the same directory as the binary itself. You will upload the binary itself through the Web form, but will add the license file directly to Mercurial (e.g. <code>hg add external/somelib-x.y.z-license.txt</code>).</p>
</li>
<li>
<p>The name of the binary must follow the convention <code>somelib-x.y.z.jar</code> or <code>somelib-x.y.z.zip</code> where <code>x.y.z</code> is the version number. The corresponding license file must be named <code>somelib-x.y.z-license.txt</code>.</p>
</li>
<li>
<p>All license files should be in UTF-8 encoding with appropriate line and paragraph breaks. The license file must end with a newline. Lines should not exceed 80 characters.</p>
</li>
<li>
<p>The license file should follow a specific format. Details below.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_license_file_format"><a class="anchor" href="#_license_file_format"></a>License file format</h2>
<div class="sectionbody">
<div class="paragraph">
<p>License files should be in the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Name: SomeLib
Version: 1.2.3
Description: Library for management of some blah blah blah.
License: Apache_V20 [SeeNoteRegardingNormalizedNames]
OSR: 1234 [OSRNumber,ReferToLFIPreviously;SunInternalLegal]
Origin: http://www.xyz.org [WhereFile(s)WereDownloadedFrom]
Files: xyz.jar, xyz-doc.zip, xyz-src.zip [Optional;SeeBelowForExplanation]
Source: URL to source [MandatoryForLGPL,OtherwiseOptional]
Comment: needed until NB runs on JDK 6+ [Optional:WhyIsThisLibraryHere]

Use of SomeLib version 1.2.3 is governed by the terms of the license below:

[TEXTOFTHELICENSE]</code></pre>
</div>
</div>
<div class="paragraph">
<p>As hinted at above, the OSR field refers to a Sun-internal system.  Those contributing patches from outside of Sun can leave this field blank.  Also note that a single license file may cover multiple JAR files from the same project.  For example, if  your patch depends on a third-party library distributed under the same license as two JARs, you will only need one license file and can account for both of these JARs in its Files header.</p>
</div>
<div class="paragraph">
<p>If the <code>Files</code> header is not present, then a license <code>name-x.y.z-license.txt</code> must
correspond to a binary <code>name-x.y.z.jar</code> or <code>name-x.y.z.zip</code>.
If present, it should list the names of all binaries to which it corresponds.</p>
</div>
<div class="paragraph">
<p>The header fields are read during the build process and removed.
Therefore this information will not appear in the final build or NBMs.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_template_based_licenses"><a class="anchor" href="#_template_based_licenses"></a>Template-based licenses</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If there is template-based license (like BSD one <a href="http://www.opensource.org/licenses/bsd-license.php">http://www.opensource.org/licenses/bsd-license.php</a>),
e.g. the license file has several ad hoc places to be updated accordingly.
The template itself should have the license file stored under <code>nbbuild/licenses</code>
with well-defined tags &lt;pre&gt;*TAGNAME*&lt;/pre&gt;; these tags will be replaced during the build.
Template-based licenses stored along with the binary in Hg
must have be in original form as they came with binary:</p>
</div>
<div class="paragraph">
<p>Example BSD License, as it is stored in <code>nbbuild/licenses</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Copyright (c) '''YEAR''', '''OWNER'''

All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice,
      this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright notice,
      this list of conditions and the following disclaimer in the documentation
      and/or other materials provided with the distribution.
    * Neither the name of '''ORGANIZATION''' nor the names of its contributors
      may be used to endorse or promote products derived from this software
      without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example BSD License, as it is stored in Hg along with binary:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Copyright (c) 2007, NetBeans

All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice,
      this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright notice,
      this list of conditions and the following disclaimer in the documentation
      and/or other materials provided with the distribution.
    * Neither the name of NetBeans nor the names of its contributors
      may be used to endorse or promote products derived from this software
      without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_nbm_build_managing_correct_license_for_nbms"><a class="anchor" href="#_nbm_build_managing_correct_license_for_nbms"></a>NBM build, managing correct license for NBMs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Required licenses should be listed in <code>project.properties</code>.
(There still must be a license along with the binary in Hg.)
The new entry will be called <code>extra.license.files</code>,
where the license files will be relative to project basedir,
e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">extra.license.files=external/x-1.0-license.txt,external/y-2.0-license.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create an NBM with two extra licenses besides the usual CDDL.
This also maintains compatibility with the current build system.</p>
</div>
<div class="paragraph">
<p>As a convenient shortcut for the common case that you simply want to
copy some files to the target cluster
(but cannot use the <code>release</code> directory since third-party binaries are involved),
you may use the newly introduced <code>release.*</code> Ant properties
which should be specified in <code>project.properties</code>.
Each key names a file in the source project;
the value is a path in the target cluster.
Any such pair will automatically:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy the source file to the cluster. (No need to override the <code>release</code> Ant target.)</p>
</li>
<li>
<p>Cause the target file to be included in the NBM file list. (No need to add to <code>extra.module.files</code>.)</p>
</li>
<li>
<p>In the case of <code>release.external/*</code> properties, cause the associated binary to be included in the NBM license. (No need to override the <code>nbm</code> Ant target or add to <code>extra.license.files</code>.)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example (from the <code>form</code> module):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">release.external/beansbinding-0.6.1.jar=modules/ext/beansbinding-0.6.1.jar
release.external/beansbinding-0.6.1-doc.zip=docs/beansbinding-0.6.1-doc.zip</code></pre>
</div>
</div>
<div class="paragraph">
<p>(Note: if you wish for the binary to be in the classpath of the module as a library,
you will still need a <code>&lt;class-path-extension&gt;</code> in your <code>project.xml</code>.)
You can also use a ZIP entry on the left side and it will be extracted from the ZIP
to your cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">release.external/stuff-1.0.zip!/stuff.jar=modules/ext/stuff-1.0.jar</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_normalized_names"><a class="anchor" href="#_normalized_names"></a>Normalized names</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There will be a license repository under <code>nbbuild/licenses</code>
where all licenses in use should be available.
Each license type will be given a unique name: <code>Apache_V11</code>, <code>Apache_V20</code>, etc.
This name must be referred to in the <code>License</code> field.
This allows us to count licenses and file names and build a 3rd-party <code>README</code>
as well as NBMs.
Make sure that the license for a new binary is correctly included under <code>nbbuild/licenses</code>.
If there is no existing license of the same type, it must be reviewed prior to committing.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_netbeans_samples"><a class="anchor" href="#_netbeans_samples"></a>NetBeans Samples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If a sample is created for NetBeans itself,
it can be packaged into ZIP file and should not be in the <code>external/</code> folder.
To ensure tests correctly skip over it,
the owner must add an entry for the binary into <code>nbbuild/antsrc/org/netbeans/nbbuild/extlibs/ignored-binaries</code>
and include a brief explanatory comment.</p>
</div>
<div class="paragraph">
<p>Alternately, it may be preferable to keep the sample files unpacked directly in Hg,
and create the ZIP during the module&#8217;s build process
(either directly into the cluster, or into <code>build/classes</code> for inclusion inside the module).
This not only prevents tests from warning about it,
but can make it easier to update minor parts of a sample
and may make version control operations more pleasant.</p>
</div>
<div class="paragraph">
<p>The sample itself must be covered by the BSD license;
the license must be included in every file (excepting binaries such as icons).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Copyright (c) &lt;YEAR&gt;, Sun Microsystems, Inc.

All rights reserved.

Redistribution and use in source and binary forms, with or
without modification, are permitted provided that the following
conditions are met:

* Redistributions of source code must retain the above
  copyright notice, this list of conditions and the following
  disclaimer.
* Redistributions in binary form must reproduce the above
  copyright notice, this list of conditions and the following
  disclaimer in the documentation and/or other materials
  provided with the distribution.
* Neither the name of Sun Microsystems, Inc. nor the names of
  its contributors may be used to endorse or promote products
  derived from this software without specific prior written
  permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR
TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF
THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If sample is not created solely for NetBeans,
e.g. bundled in a third-party product and covered by a separate license,
it must follow the same rules as for any other binary library.</p>
</div>
<div class="paragraph">
<p>-</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_common_mistakes"><a class="anchor" href="#_common_mistakes"></a>Common mistakes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A binary file has no associated license. (E.g. <code>xyz.jar</code> is missing <code>xyz-license.txt</code>.)</p>
</div>
<div class="paragraph">
<p>A binary file has an associated license, but does not maintain the naming convention,
or has typos. (E.g. <code>xyz.jar</code> with <code>xy-license.txt</code>.)</p>
</div>
<div class="paragraph">
<p>Licenses are not pure text. (E.g. they contain HTML.)</p>
</div>
<div class="paragraph">
<p>A binary file is duplicated in several places.
Before adding a new library,
please make sure that library is not already available in the Hg tree.
If it is, check if the version there is suitable for you;
if so, communicate with the owner regarding possible upgrades and/or available packages
if they are not available.
You might need to move the library to a parent cluster as well.
If you do depend on such a third cluster,
make sure your module is marked as eager, otherwise it will get disabled.</p>
</div>
<div class="paragraph">
<p>The names of the binary and its license file will change when the binary is
upgraded to a newer version. Update <code>project.properties</code>
(or, less commonly, <code>build.xml</code>) to reflect this change.</p>
</div>
<div class="paragraph">
<p>Before moving from my own repository to NetBeans Hg, I used <code>release/modules/ext/</code> for storing my binary libraries. They need to be moved into <code>external/</code> unless the library itself is covered by CDDL, build script, licenses etc., must be updated accordingly!</p>
</div>
<div class="paragraph">
<p>How do I know if some other modules is relying on the source location of my external binaries?
Answer: it&#8217;s not hard to find out. For example, if you want to know who uses
<code>httpserver/external</code>, try this (Unix / Bash syntax):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">cd nb-main
for f in */{build.xml,nbproject/*.{properties,xml`; \
  do fgrep -H httpserver/external $f; done</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_work"><a class="anchor" href="#_implementation_work"></a>Implementation work</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Interesting files from build:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="http://deadlock.netbeans.org/hudson/job/nbms-and-javadoc/lastStableBuild/artifact/nbbuild/build/generated/external-libraries.txt">Current license summary</a></p>
</li>
<li>
<p><a href="http://deadlock.netbeans.org/hudson/job/nbms-and-javadoc/lastStableBuild/artifact/nbbuild/build/verifylibsandlicenses.xml">VerifyLibsAndLicenses test</a></p>
</li>
<li>
<p><a href="http://deadlock.netbeans.org/hudson/job/nbms-and-javadoc/lastSuccessfulBuild/testReport/org.netbeans.nbbuild.extlibs/CreateLicenseSummary/">CreateLicenseSummary test</a></p>
</li>
<li>
<p><a href="http://deadlock.netbeans.org/hudson/job/nbms-and-javadoc/lastSuccessfulBuild/testReport/org.netbeans.nbbuild/DeleteUnreferencedClusterFiles/">Unreferenced or overreferenced files</a></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_static_verification_of_hg"><a class="anchor" href="#_static_verification_of_hg"></a>Static verification of Hg</h3>
<div class="paragraph">
<p>Part of regular build.
Only pays attention to Hg-controlled files in the checkout,
so can run on a built source tree without becoming confused.
Writes results in JUnit format for easy browsing from Hudson.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Look for <code><strong>.jar</code> not in <code></strong>/external/</code> dirs (with some exceptions).</p>
</li>
<li>
<p>Every license file has at least mandatory headers.</p>
</li>
<li>
<p>Every license file has lines at most 80 characters long, etc.</p>
</li>
<li>
<p>For LGPL, must have <code>Source</code> header.</p>
</li>
<li>
<p>Check that every external <code><strong>.jar</code> or <code></strong>.zip</code> has a matching license. (Or it can be mentioned in <code>Files</code> header of some license.)</p>
</li>
<li>
<p>Every binary has a version number in name.</p>
</li>
<li>
<p>No binary occurs more than once, under any name (so check by CRC-32 or SHA-1 etc.). (Look inside ZIP files for nested JARs.)</p>
</li>
<li>
<p>Every license file&#8217;s <code>License</code> field refers to something in <code>nbbuild/licenses</code>.</p>
</li>
<li>
<p>The file in <code>nbbuild/licenses</code> exactly matches the body of the license file. Whitespace-only changes are permitted, e.g. rewrapping lines to make them fit. For licenses with templates (e.g. BSD License) any tokens between two underscores can match whatever character sequence.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_things_done_in_ide_build"><a class="anchor" href="#_things_done_in_ide_build"></a>Things done in IDE build</h3>
<div class="paragraph">
<p>Generate a third-party JAR &amp; license summary.
Find every binary in the IDE build which is either
present directly in some <code><strong>/external</code> dir
or present inside a ZIP in some <code></strong>/external</code> dir.
For every such binary, retrieve the license from <code>nbbuild/licenses</code>.
Make a single document listing all of the binaries and licenses.</p>
</div>
<div class="paragraph">
<p>Verify that no such binary is present in more than one place.</p>
</div>
<div class="paragraph">
<p>Saved as <code>THIRDPARTYLICENSE-generated.txt</code> in development builds.</p>
</div>
</div>
<div class="sect2">
<h3 id="_things_done_in_nbm_build"><a class="anchor" href="#_things_done_in_nbm_build"></a>Things done in NBM build</h3>
<div class="paragraph">
<p><code>nbbuild/templates/projectized.xml</code> (netbeans.org modules only)
will look up <code>extra.license.files</code> and use them in <code>Info.xml</code>.</p>
</div>
<div class="paragraph">
<p><code>release.*</code> properties honored (see above).</p>
</div>
</div>
<div class="sect2">
<h3 id="_golden_files"><a class="anchor" href="#_golden_files"></a>Golden files</h3>
<div class="paragraph">
<p><code>nbbuild/build/generated/external-libraries.txt</code> is generated
directly from <code>external</code> dirs.</p>
</div>
<div class="paragraph">
<p>Does not yet take account <code>extra.license.files</code> correctly.
Also may not be a complete list of libraries.</p>
</div>
<div class="paragraph">
<p>Applies to: NetBeans 6.8 and above</p>
</div>
</div>
</div>
</div>
      <section class='tools'>
    <ul class="menu align-center">
        <li><a title="Facebook" href="https://www.facebook.com/NetBeans"><i class="fa fa-md fa-facebook"></i></a></li>
        <li><a title="Twitter" href="https://twitter.com/netbeans"><i class="fa fa-md fa-twitter"></i></a></li>
        <li><a title="Github" href="https://github.com/apache/netbeans"><i class="fa fa-md fa-github"></i></a></li>
        <li><a title="YouTube" href="https://www.youtube.com/user/netbeansvideos"><i class="fa fa-md fa-youtube"></i></a></li>
        <li><a title="Atom Feed" href="https://netbeans.apache.org/blogs/atom"><i class="fa fa-mf fa-rss"></i></a></li>
        <li><a title="Slack" href="https://tinyurl.com/netbeans-slack-signup/"><i class="fa fa-md fa-slack"></i></a></li>
        <li><a title="Issues" href="https://github.com/apache/netbeans/issues"><i class="fa fa-mf fa-bug"></i></a></li>
    </ul>
    <ul class="menu align-center">
        <li><a href="https://github.com/apache/netbeans-antora-wiki/edit/main/modules/ROOT/pages/wiki/DevFaqExternalLibraries.adoc" title="See this page in github"><i class="fa fa-md fa-edit"></i> See this page in GitHub.</a></li>
    </ul>
</section>
      </article>
    </div>
        <div class='grid-container incubator-area' style='margin-top: 64px'>
      <div class='grid-x grid-padding-x'>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/">
            <img style="width: 320px" title="Apache Software Foundation" src="../../../../_/images/asf_logo_wide.svg" />
          </a>
        </div>
        <div class='large-auto cell text-center'>
          <a href="https://www.apache.org/events/current-event.html">
            <img style="width:234px; height: 60px;" title="Apache Software Foundation current event" src="https://www.apache.org/events/current-event-234x60.png"/>
          </a>
        </div>
      </div>
    </div>
    <footer>
      <div class="grid-container">
        <div class="grid-x grid-padding-x">
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/about">About</a></h1>
            <ul>
              <li><a href="../../../../front/main/community/who">Who's Who</a></li>
              <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
              <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              <li><a href="https://www.apache.org/security/">Security</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/community">Community</a></h1>
            <ul>
              <li><a href="../../../../front/main/community/mailing-lists">Mailing lists</a></li>
              <li><a href="../../../../front/main/community/committer">Becoming a committer</a></li>
              <li><a href="../../../../front/main/community/events">NetBeans Events</a></li>
              <li><a href="https://www.apache.org/events/current-event.html">Apache Events</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/participate">Participate</a></h1>
            <ul>
              <li><a href="../../../../front/main/participate/submit-pr">Submitting Pull Requests</a></li>
              <li><a href="../../../../front/main/participate/report-issue">Reporting Issues</a></li>
              <li><a href="../../../../front/main/participate/#documentation">Improving the documentation</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/help">Get Help</a></h1>
            <ul>
              <li><a href="../../../../front/main/help/#documentation">Documentation</a></li>
              <li><a href="../../../../wiki/main/wiki">Wiki</a></li>
              <li><a href="../../../../front/main/help/#support">Community Support</a></li>
              <li><a href="../../../../front/main/help/commercial-support">Commercial Support</a></li>
            </ul>
          </div>
          <div class="large-auto cell">
            <h1><a href="../../../../front/main/download">Download</a></h1>
            <ul>
              <li><a href="../../../../front/main/download">Releases</a></li>                    
              <li><a href="https://plugins.netbeans.apache.org/">Plugins</a></li>
              <li><a href="../../../../front/main/download/#_daily_builds_and_building_from_source">Building from source</a></li>
              <li><a href="../../../../front/main/download/#_older_releases">Previous releases</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    <div class='footer-disclaimer'>
      <div class="footer-disclaimer-content">
        <p>Copyright &copy; 2017-2023 <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
        <p>Licensed under the Apache <a href="https://www.apache.org/licenses/">license</a>, version 2.0</p>
        <div style='max-width: 40em; margin: 0 auto'>
          <p>Apache, Apache NetBeans, NetBeans, the Apache feather logo and the Apache NetBeans logo are trademarks of <a href="https://www.apache.org">The Apache Software Foundation</a>.</p>
          <p>Oracle and Java are registered trademarks of Oracle and/or its affiliates.</p>
          <p>The Apache NetBeans website conforms to the <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Apache Software Foundation Privacy Policy</a></p>
        </div>
      </div>
    </div>

    
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
    <script src="../../../../_/js/vendor/jquery-3.7.1.min.js"></script>
    <script src="../../../../_/js/vendor/what-input.js"></script>
    <script src="../../../../_/js/vendor/foundation.min.js"></script>
    <script src="../../../../_/js/vendor/jquery.colorbox-min.js"></script>
    <script src="../../../../_/js/netbeans.js"></script>
    <script>
       $(function(){ $(document).foundation(); });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
      $(document).ready(function() { $("pre code").each(function(i, block) { hljs.highlightBlock(block); }); });
    </script>
  </body>
</html>
